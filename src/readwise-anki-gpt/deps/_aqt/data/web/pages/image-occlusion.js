"use strict";var anki=(()=>{var fy=Object.create;var ko=Object.defineProperty;var py=Object.getOwnPropertyDescriptor;var my=Object.getOwnPropertyNames;var hy=Object.getPrototypeOf,gy=Object.prototype.hasOwnProperty;var by=(t,e,n)=>e in t?ko(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var xy=(t,e)=>()=>(t&&(e=t(t=0)),e);var Xe=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),Ku=(t,e)=>{for(var n in e)ko(t,n,{get:e[n],enumerable:!0})},Ju=(t,e,n,o)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of my(e))!gy.call(t,r)&&r!==n&&ko(t,r,{get:()=>e[r],enumerable:!(o=py(e,r))||o.enumerable});return t};var gt=(t,e,n)=>(n=t!=null?fy(hy(t)):{},Ju(e||!t||!t.__esModule?ko(n,"default",{value:t,enumerable:!0}):n,t)),$u=t=>Ju(ko({},"__esModule",{value:!0}),t);var tt=(t,e,n)=>(by(t,typeof e!="symbol"?e+"":e,n),n);var cf={};Ku(cf,{default:()=>$y});function ki(t){"@babel/helpers - typeof";return ki=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ki(t)}function Hy(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function of(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,Xy(o.key),o)}}function Gy(t,e,n){return e&&of(t.prototype,e),n&&of(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function qy(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var o=n.call(t,e||"default");if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Xy(t){var e=qy(t,"string");return typeof e=="symbol"?e:String(e)}function Xt(t,e){var n=lf(t,e,"get");return Yy(t,n)}function Eo(t,e,n){var o=lf(t,e,"set");return Qy(t,o,n),n}function lf(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Yy(t,e){return e.get?e.get.call(t):e.value}function Qy(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Ky(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Oo(t,e,n){Ky(t,e),e.set(t,n)}function Jy(t){var e=Object.prototype.hasOwnProperty.call(t,"type")&&t.type;if(!e)return"cardinal";if(e==="cardinal"||e==="ordinal")return e;throw new RangeError("Not a valid plural type: "+JSON.stringify(e))}function sf(t){switch(ki(t)){case"number":return t;case"bigint":throw new TypeError("Cannot convert a BigInt value to a number");default:return Number(t)}}function $y(t,e,n,o){var r=function(p){do{if(e(p))return p;p=p.replace(/-?[^-]*$/,"")}while(p);return null},i=function(p){for(var m=af(p),h=0;h<m.length;++h){var b=r(m[h]);if(b)return b}var x=new t().resolvedOptions().locale;return r(x)},a=new WeakMap,s=new WeakMap,c=new WeakMap,l=new WeakMap,u=new WeakMap,d=function(){function f(){var p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Hy(this,f),Oo(this,a,{writable:!0,value:void 0}),Oo(this,s,{writable:!0,value:void 0}),Oo(this,c,{writable:!0,value:void 0}),Oo(this,l,{writable:!0,value:void 0}),Oo(this,u,{writable:!0,value:void 0}),Eo(this,a,i(p)),Eo(this,c,e(Xt(this,a))),Eo(this,s,o(Xt(this,a))),Eo(this,l,Jy(m)),Eo(this,u,new t("en",m))}return Gy(f,[{key:"resolvedOptions",value:function(){var m=Xt(this,u).resolvedOptions(),h=m.minimumIntegerDigits,b=m.minimumFractionDigits,x=m.maximumFractionDigits,y=m.minimumSignificantDigits,M=m.maximumSignificantDigits,E=m.roundingPriority,C={locale:Xt(this,a),type:Xt(this,l),minimumIntegerDigits:h,minimumFractionDigits:b,maximumFractionDigits:x};return typeof y=="number"&&(C.minimumSignificantDigits=y,C.maximumSignificantDigits=M),C.pluralCategories=n(Xt(this,a),Xt(this,l)==="ordinal").slice(0),C.roundingPriority=E||"auto",C}},{key:"select",value:function(m){if(!(this instanceof f))throw new TypeError("select() called on incompatible ".concat(this));if(typeof m!="number"&&(m=Number(m)),!isFinite(m))return"other";var h=Xt(this,u).format(Math.abs(m));return Xt(this,c).call(this,h,Xt(this,l)==="ordinal")}},{key:"selectRange",value:function(m,h){if(!(this instanceof f))throw new TypeError("selectRange() called on incompatible ".concat(this));if(m===void 0)throw new TypeError("start is undefined");if(h===void 0)throw new TypeError("end is undefined");var b=sf(m),x=sf(h);if(!isFinite(b))throw new RangeError("start must be finite");if(!isFinite(x))throw new RangeError("end must be finite");return Xt(this,s).call(this,this.select(b),this.select(x))}}],[{key:"supportedLocalesOf",value:function(m){return af(m).filter(r)}}]),f}();return typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(d.prototype,Symbol.toStringTag,{value:"Intl.PluralRules",writable:!1,configurable:!0}),Object.defineProperty(d,"prototype",{writable:!1}),d}var af,uf=xy(()=>{af=function(e){if(!e)return[];Array.isArray(e)||(e=[e]);for(var n={},o=0;o<e.length;++o){var r,i=e[o];if(i&&ki(i)==="object"&&(i=String(i)),typeof i!="string"){var a="Locales should be strings, ".concat(JSON.stringify(i)," isn't.");throw new TypeError(a)}var s=i.split("-");if(!s.every(function(d){return/[a-z0-9]+/i.test(d)})){var c=JSON.stringify(i),l="The locale ".concat(c," is not a structurally valid BCP 47 language tag.");throw new RangeError(l)}var u=s[0].toLowerCase();s[0]=(r={in:"id",iw:"he",ji:"yi"}[u])!==null&&r!==void 0?r:u,n[s.join("-")]=!0}return Object.keys(n)}});var hf=Xe((AO,mf)=>{"use strict";var Zy=(uf(),$u(cf));function e0(t){return t&&typeof t=="object"&&"default"in t?t:{default:t}}function hs(t,e){return e.forEach(function(n){n&&typeof n!="string"&&!Array.isArray(n)&&Object.keys(n).forEach(function(o){if(o!=="default"&&!(o in t)){var r=Object.getOwnPropertyDescriptor(n,o);Object.defineProperty(t,o,r.get?r:{enumerable:!0,get:function(){return n[o]}})}})}),Object.freeze(t)}var t0=e0(Zy),gs=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function bs(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var xs={exports:{}};(function(t,e){var n=function(l,u){return u?"other":l==1?"one":"other"},o=function(l,u){return u?"other":l==0||l==1?"one":"other"},r=function(l,u){return u?"other":l>=0&&l<=1?"one":"other"},i=function(l,u){var d=String(l).split("."),f=!d[1];return u?"other":l==1&&f?"one":"other"},a=function(l,u){return"other"},s=function(l,u){return u?"other":l==1?"one":l==2?"two":"other"};(function(c,l){Object.defineProperty(l,"__esModule",{value:!0}),t.exports=l})(gs,{af:n,ak:o,am:r,an:n,ar:function(l,u){var d=String(l).split("."),f=Number(d[0])==l,p=f&&d[0].slice(-2);return u?"other":l==0?"zero":l==1?"one":l==2?"two":p>=3&&p<=10?"few":p>=11&&p<=99?"many":"other"},ars:function(l,u){var d=String(l).split("."),f=Number(d[0])==l,p=f&&d[0].slice(-2);return u?"other":l==0?"zero":l==1?"one":l==2?"two":p>=3&&p<=10?"few":p>=11&&p<=99?"many":"other"},as:function(l,u){return u?l==1||l==5||l==7||l==8||l==9||l==10?"one":l==2||l==3?"two":l==4?"few":l==6?"many":"other":l>=0&&l<=1?"one":"other"},asa:n,ast:i,az:function(l,u){var d=String(l).split("."),f=d[0],p=f.slice(-1),m=f.slice(-2),h=f.slice(-3);return u?p==1||p==2||p==5||p==7||p==8||m==20||m==50||m==70||m==80?"one":p==3||p==4||h==100||h==200||h==300||h==400||h==500||h==600||h==700||h==800||h==900?"few":f==0||p==6||m==40||m==60||m==90?"many":"other":l==1?"one":"other"},bal:function(l,u){return l==1?"one":"other"},be:function(l,u){var d=String(l).split("."),f=Number(d[0])==l,p=f&&d[0].slice(-1),m=f&&d[0].slice(-2);return u?(p==2||p==3)&&m!=12&&m!=13?"few":"other":p==1&&m!=11?"one":p>=2&&p<=4&&(m<12||m>14)?"few":f&&p==0||p>=5&&p<=9||m>=11&&m<=14?"many":"other"},bem:n,bez:n,bg:n,bho:o,bm:a,bn:function(l,u){return u?l==1||l==5||l==7||l==8||l==9||l==10?"one":l==2||l==3?"two":l==4?"few":l==6?"many":"other":l>=0&&l<=1?"one":"other"},bo:a,br:function(l,u){var d=String(l).split("."),f=Number(d[0])==l,p=f&&d[0].slice(-1),m=f&&d[0].slice(-2),h=f&&d[0].slice(-6);return u?"other":p==1&&m!=11&&m!=71&&m!=91?"one":p==2&&m!=12&&m!=72&&m!=92?"two":(p==3||p==4||p==9)&&(m<10||m>19)&&(m<70||m>79)&&(m<90||m>99)?"few":l!=0&&f&&h==0?"many":"other"},brx:n,bs:function(l,u){var d=String(l).split("."),f=d[0],p=d[1]||"",m=!d[1],h=f.slice(-1),b=f.slice(-2),x=p.slice(-1),y=p.slice(-2);return u?"other":m&&h==1&&b!=11||x==1&&y!=11?"one":m&&h>=2&&h<=4&&(b<12||b>14)||x>=2&&x<=4&&(y<12||y>14)?"few":"other"},ca:function(l,u){var d=String(l).split("."),f=d[0],p=!d[1],m=f.slice(-6);return u?l==1||l==3?"one":l==2?"two":l==4?"few":"other":l==1&&p?"one":f!=0&&m==0&&p?"many":"other"},ce:n,ceb:function(l,u){var d=String(l).split("."),f=d[0],p=d[1]||"",m=!d[1],h=f.slice(-1),b=p.slice(-1);return u?"other":m&&(f==1||f==2||f==3)||m&&h!=4&&h!=6&&h!=9||!m&&b!=4&&b!=6&&b!=9?"one":"other"},cgg:n,chr:n,ckb:n,cs:function(l,u){var d=String(l).split("."),f=d[0],p=!d[1];return u?"other":l==1&&p?"one":f>=2&&f<=4&&p?"few":p?"other":"many"},cy:function(l,u){return u?l==0||l==7||l==8||l==9?"zero":l==1?"one":l==2?"two":l==3||l==4?"few":l==5||l==6?"many":"other":l==0?"zero":l==1?"one":l==2?"two":l==3?"few":l==6?"many":"other"},da:function(l,u){var d=String(l).split("."),f=d[0],p=Number(d[0])==l;return u?"other":l==1||!p&&(f==0||f==1)?"one":"other"},de:i,doi:r,dsb:function(l,u){var d=String(l).split("."),f=d[0],p=d[1]||"",m=!d[1],h=f.slice(-2),b=p.slice(-2);return u?"other":m&&h==1||b==1?"one":m&&h==2||b==2?"two":m&&(h==3||h==4)||b==3||b==4?"few":"other"},dv:n,dz:a,ee:n,el:n,en:function(l,u){var d=String(l).split("."),f=!d[1],p=Number(d[0])==l,m=p&&d[0].slice(-1),h=p&&d[0].slice(-2);return u?m==1&&h!=11?"one":m==2&&h!=12?"two":m==3&&h!=13?"few":"other":l==1&&f?"one":"other"},eo:n,es:function(l,u){var d=String(l).split("."),f=d[0],p=!d[1],m=f.slice(-6);return u?"other":l==1?"one":f!=0&&m==0&&p?"many":"other"},et:i,eu:n,fa:r,ff:function(l,u){return u?"other":l>=0&&l<2?"one":"other"},fi:i,fil:function(l,u){var d=String(l).split("."),f=d[0],p=d[1]||"",m=!d[1],h=f.slice(-1),b=p.slice(-1);return u?l==1?"one":"other":m&&(f==1||f==2||f==3)||m&&h!=4&&h!=6&&h!=9||!m&&b!=4&&b!=6&&b!=9?"one":"other"},fo:n,fr:function(l,u){var d=String(l).split("."),f=d[0],p=!d[1],m=f.slice(-6);return u?l==1?"one":"other":l>=0&&l<2?"one":f!=0&&m==0&&p?"many":"other"},fur:n,fy:i,ga:function(l,u){var d=String(l).split("."),f=Number(d[0])==l;return u?l==1?"one":"other":l==1?"one":l==2?"two":f&&l>=3&&l<=6?"few":f&&l>=7&&l<=10?"many":"other"},gd:function(l,u){var d=String(l).split("."),f=Number(d[0])==l;return u?l==1||l==11?"one":l==2||l==12?"two":l==3||l==13?"few":"other":l==1||l==11?"one":l==2||l==12?"two":f&&l>=3&&l<=10||f&&l>=13&&l<=19?"few":"other"},gl:i,gsw:n,gu:function(l,u){return u?l==1?"one":l==2||l==3?"two":l==4?"few":l==6?"many":"other":l>=0&&l<=1?"one":"other"},guw:o,gv:function(l,u){var d=String(l).split("."),f=d[0],p=!d[1],m=f.slice(-1),h=f.slice(-2);return u?"other":p&&m==1?"one":p&&m==2?"two":p&&(h==0||h==20||h==40||h==60||h==80)?"few":p?"other":"many"},ha:n,haw:n,he:function(l,u){var d=String(l).split("."),f=d[0],p=!d[1];return u?"other":f==1&&p||f==0&&!p?"one":f==2&&p?"two":"other"},hi:function(l,u){return u?l==1?"one":l==2||l==3?"two":l==4?"few":l==6?"many":"other":l>=0&&l<=1?"one":"other"},hnj:a,hr:function(l,u){var d=String(l).split("."),f=d[0],p=d[1]||"",m=!d[1],h=f.slice(-1),b=f.slice(-2),x=p.slice(-1),y=p.slice(-2);return u?"other":m&&h==1&&b!=11||x==1&&y!=11?"one":m&&h>=2&&h<=4&&(b<12||b>14)||x>=2&&x<=4&&(y<12||y>14)?"few":"other"},hsb:function(l,u){var d=String(l).split("."),f=d[0],p=d[1]||"",m=!d[1],h=f.slice(-2),b=p.slice(-2);return u?"other":m&&h==1||b==1?"one":m&&h==2||b==2?"two":m&&(h==3||h==4)||b==3||b==4?"few":"other"},hu:function(l,u){return u?l==1||l==5?"one":"other":l==1?"one":"other"},hy:function(l,u){return u?l==1?"one":"other":l>=0&&l<2?"one":"other"},ia:i,id:a,ig:a,ii:a,io:i,is:function(l,u){var d=String(l).split("."),f=d[0],p=(d[1]||"").replace(/0+$/,""),m=Number(d[0])==l,h=f.slice(-1),b=f.slice(-2);return u?"other":m&&h==1&&b!=11||p%10==1&&p%100!=11?"one":"other"},it:function(l,u){var d=String(l).split("."),f=d[0],p=!d[1],m=f.slice(-6);return u?l==11||l==8||l==80||l==800?"many":"other":l==1&&p?"one":f!=0&&m==0&&p?"many":"other"},iu:s,ja:a,jbo:a,jgo:n,jmc:n,jv:a,jw:a,ka:function(l,u){var d=String(l).split("."),f=d[0],p=f.slice(-2);return u?f==1?"one":f==0||p>=2&&p<=20||p==40||p==60||p==80?"many":"other":l==1?"one":"other"},kab:function(l,u){return u?"other":l>=0&&l<2?"one":"other"},kaj:n,kcg:n,kde:a,kea:a,kk:function(l,u){var d=String(l).split("."),f=Number(d[0])==l,p=f&&d[0].slice(-1);return u?p==6||p==9||f&&p==0&&l!=0?"many":"other":l==1?"one":"other"},kkj:n,kl:n,km:a,kn:r,ko:a,ks:n,ksb:n,ksh:function(l,u){return u?"other":l==0?"zero":l==1?"one":"other"},ku:n,kw:function(l,u){var d=String(l).split("."),f=Number(d[0])==l,p=f&&d[0].slice(-2),m=f&&d[0].slice(-3),h=f&&d[0].slice(-5),b=f&&d[0].slice(-6);return u?f&&l>=1&&l<=4||p>=1&&p<=4||p>=21&&p<=24||p>=41&&p<=44||p>=61&&p<=64||p>=81&&p<=84?"one":l==5||p==5?"many":"other":l==0?"zero":l==1?"one":p==2||p==22||p==42||p==62||p==82||f&&m==0&&(h>=1e3&&h<=2e4||h==4e4||h==6e4||h==8e4)||l!=0&&b==1e5?"two":p==3||p==23||p==43||p==63||p==83?"few":l!=1&&(p==1||p==21||p==41||p==61||p==81)?"many":"other"},ky:n,lag:function(l,u){var d=String(l).split("."),f=d[0];return u?"other":l==0?"zero":(f==0||f==1)&&l!=0?"one":"other"},lb:n,lg:n,lij:function(l,u){var d=String(l).split("."),f=!d[1],p=Number(d[0])==l;return u?l==11||l==8||p&&l>=80&&l<=89||p&&l>=800&&l<=899?"many":"other":l==1&&f?"one":"other"},lkt:a,ln:o,lo:function(l,u){return u&&l==1?"one":"other"},lt:function(l,u){var d=String(l).split("."),f=d[1]||"",p=Number(d[0])==l,m=p&&d[0].slice(-1),h=p&&d[0].slice(-2);return u?"other":m==1&&(h<11||h>19)?"one":m>=2&&m<=9&&(h<11||h>19)?"few":f!=0?"many":"other"},lv:function(l,u){var d=String(l).split("."),f=d[1]||"",p=f.length,m=Number(d[0])==l,h=m&&d[0].slice(-1),b=m&&d[0].slice(-2),x=f.slice(-2),y=f.slice(-1);return u?"other":m&&h==0||b>=11&&b<=19||p==2&&x>=11&&x<=19?"zero":h==1&&b!=11||p==2&&y==1&&x!=11||p!=2&&y==1?"one":"other"},mas:n,mg:o,mgo:n,mk:function(l,u){var d=String(l).split("."),f=d[0],p=d[1]||"",m=!d[1],h=f.slice(-1),b=f.slice(-2),x=p.slice(-1),y=p.slice(-2);return u?h==1&&b!=11?"one":h==2&&b!=12?"two":(h==7||h==8)&&b!=17&&b!=18?"many":"other":m&&h==1&&b!=11||x==1&&y!=11?"one":"other"},ml:n,mn:n,mo:function(l,u){var d=String(l).split("."),f=!d[1],p=Number(d[0])==l,m=p&&d[0].slice(-2);return u?l==1?"one":"other":l==1&&f?"one":!f||l==0||l!=1&&m>=1&&m<=19?"few":"other"},mr:function(l,u){return u?l==1?"one":l==2||l==3?"two":l==4?"few":"other":l==1?"one":"other"},ms:function(l,u){return u&&l==1?"one":"other"},mt:function(l,u){var d=String(l).split("."),f=Number(d[0])==l,p=f&&d[0].slice(-2);return u?"other":l==1?"one":l==2?"two":l==0||p>=3&&p<=10?"few":p>=11&&p<=19?"many":"other"},my:a,nah:n,naq:s,nb:n,nd:n,ne:function(l,u){var d=String(l).split("."),f=Number(d[0])==l;return u?f&&l>=1&&l<=4?"one":"other":l==1?"one":"other"},nl:i,nn:n,nnh:n,no:n,nqo:a,nr:n,nso:o,ny:n,nyn:n,om:n,or:function(l,u){var d=String(l).split("."),f=Number(d[0])==l;return u?l==1||l==5||f&&l>=7&&l<=9?"one":l==2||l==3?"two":l==4?"few":l==6?"many":"other":l==1?"one":"other"},os:n,osa:a,pa:o,pap:n,pcm:r,pl:function(l,u){var d=String(l).split("."),f=d[0],p=!d[1],m=f.slice(-1),h=f.slice(-2);return u?"other":l==1&&p?"one":p&&m>=2&&m<=4&&(h<12||h>14)?"few":p&&f!=1&&(m==0||m==1)||p&&m>=5&&m<=9||p&&h>=12&&h<=14?"many":"other"},prg:function(l,u){var d=String(l).split("."),f=d[1]||"",p=f.length,m=Number(d[0])==l,h=m&&d[0].slice(-1),b=m&&d[0].slice(-2),x=f.slice(-2),y=f.slice(-1);return u?"other":m&&h==0||b>=11&&b<=19||p==2&&x>=11&&x<=19?"zero":h==1&&b!=11||p==2&&y==1&&x!=11||p!=2&&y==1?"one":"other"},ps:n,pt:function(l,u){var d=String(l).split("."),f=d[0],p=!d[1],m=f.slice(-6);return u?"other":f==0||f==1?"one":f!=0&&m==0&&p?"many":"other"},pt_PT:function(l,u){var d=String(l).split("."),f=d[0],p=!d[1],m=f.slice(-6);return u?"other":l==1&&p?"one":f!=0&&m==0&&p?"many":"other"},rm:n,ro:function(l,u){var d=String(l).split("."),f=!d[1],p=Number(d[0])==l,m=p&&d[0].slice(-2);return u?l==1?"one":"other":l==1&&f?"one":!f||l==0||l!=1&&m>=1&&m<=19?"few":"other"},rof:n,ru:function(l,u){var d=String(l).split("."),f=d[0],p=!d[1],m=f.slice(-1),h=f.slice(-2);return u?"other":p&&m==1&&h!=11?"one":p&&m>=2&&m<=4&&(h<12||h>14)?"few":p&&m==0||p&&m>=5&&m<=9||p&&h>=11&&h<=14?"many":"other"},rwk:n,sah:a,saq:n,sat:s,sc:function(l,u){var d=String(l).split("."),f=!d[1];return u?l==11||l==8||l==80||l==800?"many":"other":l==1&&f?"one":"other"},scn:function(l,u){var d=String(l).split("."),f=!d[1];return u?l==11||l==8||l==80||l==800?"many":"other":l==1&&f?"one":"other"},sd:n,sdh:n,se:s,seh:n,ses:a,sg:a,sh:function(l,u){var d=String(l).split("."),f=d[0],p=d[1]||"",m=!d[1],h=f.slice(-1),b=f.slice(-2),x=p.slice(-1),y=p.slice(-2);return u?"other":m&&h==1&&b!=11||x==1&&y!=11?"one":m&&h>=2&&h<=4&&(b<12||b>14)||x>=2&&x<=4&&(y<12||y>14)?"few":"other"},shi:function(l,u){var d=String(l).split("."),f=Number(d[0])==l;return u?"other":l>=0&&l<=1?"one":f&&l>=2&&l<=10?"few":"other"},si:function(l,u){var d=String(l).split("."),f=d[0],p=d[1]||"";return u?"other":l==0||l==1||f==0&&p==1?"one":"other"},sk:function(l,u){var d=String(l).split("."),f=d[0],p=!d[1];return u?"other":l==1&&p?"one":f>=2&&f<=4&&p?"few":p?"other":"many"},sl:function(l,u){var d=String(l).split("."),f=d[0],p=!d[1],m=f.slice(-2);return u?"other":p&&m==1?"one":p&&m==2?"two":p&&(m==3||m==4)||!p?"few":"other"},sma:s,smi:s,smj:s,smn:s,sms:s,sn:n,so:n,sq:function(l,u){var d=String(l).split("."),f=Number(d[0])==l,p=f&&d[0].slice(-1),m=f&&d[0].slice(-2);return u?l==1?"one":p==4&&m!=14?"many":"other":l==1?"one":"other"},sr:function(l,u){var d=String(l).split("."),f=d[0],p=d[1]||"",m=!d[1],h=f.slice(-1),b=f.slice(-2),x=p.slice(-1),y=p.slice(-2);return u?"other":m&&h==1&&b!=11||x==1&&y!=11?"one":m&&h>=2&&h<=4&&(b<12||b>14)||x>=2&&x<=4&&(y<12||y>14)?"few":"other"},ss:n,ssy:n,st:n,su:a,sv:function(l,u){var d=String(l).split("."),f=!d[1],p=Number(d[0])==l,m=p&&d[0].slice(-1),h=p&&d[0].slice(-2);return u?(m==1||m==2)&&h!=11&&h!=12?"one":"other":l==1&&f?"one":"other"},sw:i,syr:n,ta:n,te:n,teo:n,th:a,ti:o,tig:n,tk:function(l,u){var d=String(l).split("."),f=Number(d[0])==l,p=f&&d[0].slice(-1);return u?p==6||p==9||l==10?"few":"other":l==1?"one":"other"},tl:function(l,u){var d=String(l).split("."),f=d[0],p=d[1]||"",m=!d[1],h=f.slice(-1),b=p.slice(-1);return u?l==1?"one":"other":m&&(f==1||f==2||f==3)||m&&h!=4&&h!=6&&h!=9||!m&&b!=4&&b!=6&&b!=9?"one":"other"},tn:n,to:a,tpi:a,tr:n,ts:n,tzm:function(l,u){var d=String(l).split("."),f=Number(d[0])==l;return u?"other":l==0||l==1||f&&l>=11&&l<=99?"one":"other"},ug:n,uk:function(l,u){var d=String(l).split("."),f=d[0],p=!d[1],m=Number(d[0])==l,h=m&&d[0].slice(-1),b=m&&d[0].slice(-2),x=f.slice(-1),y=f.slice(-2);return u?h==3&&b!=13?"few":"other":p&&x==1&&y!=11?"one":p&&x>=2&&x<=4&&(y<12||y>14)?"few":p&&x==0||p&&x>=5&&x<=9||p&&y>=11&&y<=14?"many":"other"},und:a,ur:i,uz:n,ve:n,vec:function(l,u){var d=String(l).split("."),f=d[0],p=!d[1],m=f.slice(-6);return u?l==11||l==8||l==80||l==800?"many":"other":l==1&&p?"one":f!=0&&m==0&&p?"many":"other"},vi:function(l,u){return u&&l==1?"one":"other"},vo:n,vun:n,wa:o,wae:n,wo:a,xh:n,xog:n,yi:i,yo:a,yue:a,zh:a,zu:r})})(xs);var df=bs(xs.exports),n0=hs({__proto__:null,default:df},[xs.exports]),vs={exports:{}};(function(t,e){var n="zero",o="one",r="two",i="few",a="many",s="other",c={cardinal:[o,s],ordinal:[s]},l={cardinal:[o,s],ordinal:[o,s]},u={cardinal:[s],ordinal:[s]},d={cardinal:[o,r,s],ordinal:[s]};(function(f,p){Object.defineProperty(p,"__esModule",{value:!0}),t.exports=p})(gs,{af:c,ak:c,am:c,an:c,ar:{cardinal:[n,o,r,i,a,s],ordinal:[s]},ars:{cardinal:[n,o,r,i,a,s],ordinal:[s]},as:{cardinal:[o,s],ordinal:[o,r,i,a,s]},asa:c,ast:c,az:{cardinal:[o,s],ordinal:[o,i,a,s]},bal:l,be:{cardinal:[o,i,a,s],ordinal:[i,s]},bem:c,bez:c,bg:c,bho:c,bm:u,bn:{cardinal:[o,s],ordinal:[o,r,i,a,s]},bo:u,br:{cardinal:[o,r,i,a,s],ordinal:[s]},brx:c,bs:{cardinal:[o,i,s],ordinal:[s]},ca:{cardinal:[o,a,s],ordinal:[o,r,i,s]},ce:c,ceb:c,cgg:c,chr:c,ckb:c,cs:{cardinal:[o,i,a,s],ordinal:[s]},cy:{cardinal:[n,o,r,i,a,s],ordinal:[n,o,r,i,a,s]},da:c,de:c,doi:c,dsb:{cardinal:[o,r,i,s],ordinal:[s]},dv:c,dz:u,ee:c,el:c,en:{cardinal:[o,s],ordinal:[o,r,i,s]},eo:c,es:{cardinal:[o,a,s],ordinal:[s]},et:c,eu:c,fa:c,ff:c,fi:c,fil:l,fo:c,fr:{cardinal:[o,a,s],ordinal:[o,s]},fur:c,fy:c,ga:{cardinal:[o,r,i,a,s],ordinal:[o,s]},gd:{cardinal:[o,r,i,s],ordinal:[o,r,i,s]},gl:c,gsw:c,gu:{cardinal:[o,s],ordinal:[o,r,i,a,s]},guw:c,gv:{cardinal:[o,r,i,a,s],ordinal:[s]},ha:c,haw:c,he:d,hi:{cardinal:[o,s],ordinal:[o,r,i,a,s]},hnj:u,hr:{cardinal:[o,i,s],ordinal:[s]},hsb:{cardinal:[o,r,i,s],ordinal:[s]},hu:l,hy:l,ia:c,id:u,ig:u,ii:u,io:c,is:c,it:{cardinal:[o,a,s],ordinal:[a,s]},iu:d,ja:u,jbo:u,jgo:c,jmc:c,jv:u,jw:u,ka:{cardinal:[o,s],ordinal:[o,a,s]},kab:c,kaj:c,kcg:c,kde:u,kea:u,kk:{cardinal:[o,s],ordinal:[a,s]},kkj:c,kl:c,km:u,kn:c,ko:u,ks:c,ksb:c,ksh:{cardinal:[n,o,s],ordinal:[s]},ku:c,kw:{cardinal:[n,o,r,i,a,s],ordinal:[o,a,s]},ky:c,lag:{cardinal:[n,o,s],ordinal:[s]},lb:c,lg:c,lij:{cardinal:[o,s],ordinal:[a,s]},lkt:u,ln:c,lo:{cardinal:[s],ordinal:[o,s]},lt:{cardinal:[o,i,a,s],ordinal:[s]},lv:{cardinal:[n,o,s],ordinal:[s]},mas:c,mg:c,mgo:c,mk:{cardinal:[o,s],ordinal:[o,r,a,s]},ml:c,mn:c,mo:{cardinal:[o,i,s],ordinal:[o,s]},mr:{cardinal:[o,s],ordinal:[o,r,i,s]},ms:{cardinal:[s],ordinal:[o,s]},mt:{cardinal:[o,r,i,a,s],ordinal:[s]},my:u,nah:c,naq:d,nb:c,nd:c,ne:l,nl:c,nn:c,nnh:c,no:c,nqo:u,nr:c,nso:c,ny:c,nyn:c,om:c,or:{cardinal:[o,s],ordinal:[o,r,i,a,s]},os:c,osa:u,pa:c,pap:c,pcm:c,pl:{cardinal:[o,i,a,s],ordinal:[s]},prg:{cardinal:[n,o,s],ordinal:[s]},ps:c,pt:{cardinal:[o,a,s],ordinal:[s]},pt_PT:{cardinal:[o,a,s],ordinal:[s]},rm:c,ro:{cardinal:[o,i,s],ordinal:[o,s]},rof:c,ru:{cardinal:[o,i,a,s],ordinal:[s]},rwk:c,sah:u,saq:c,sat:d,sc:{cardinal:[o,s],ordinal:[a,s]},scn:{cardinal:[o,s],ordinal:[a,s]},sd:c,sdh:c,se:d,seh:c,ses:u,sg:u,sh:{cardinal:[o,i,s],ordinal:[s]},shi:{cardinal:[o,i,s],ordinal:[s]},si:c,sk:{cardinal:[o,i,a,s],ordinal:[s]},sl:{cardinal:[o,r,i,s],ordinal:[s]},sma:d,smi:d,smj:d,smn:d,sms:d,sn:c,so:c,sq:{cardinal:[o,s],ordinal:[o,a,s]},sr:{cardinal:[o,i,s],ordinal:[s]},ss:c,ssy:c,st:c,su:u,sv:l,sw:c,syr:c,ta:c,te:c,teo:c,th:u,ti:c,tig:c,tk:{cardinal:[o,s],ordinal:[i,s]},tl:l,tn:c,to:u,tpi:u,tr:c,ts:c,tzm:c,ug:c,uk:{cardinal:[o,i,a,s],ordinal:[i,s]},und:u,ur:c,uz:c,ve:c,vec:{cardinal:[o,a,s],ordinal:[a,s]},vi:{cardinal:[s],ordinal:[o,s]},vo:c,vun:c,wa:c,wae:c,wo:u,xh:c,xog:c,yi:c,yo:u,yue:u,zh:u,zu:c})})(vs);var ff=bs(vs.exports),r0=hs({__proto__:null,default:ff},[vs.exports]),ys={exports:{}};(function(t,e){var n=function(a,s){return"other"},o=function(a,s){return a==="other"&&s==="one"?"one":"other"},r=function(a,s){return s||"other"};(function(i,a){Object.defineProperty(a,"__esModule",{value:!0}),t.exports=a})(gs,{af:n,ak:o,am:r,an:n,ar:function(a,s){return s==="few"?"few":s==="many"?"many":a==="zero"&&s==="one"||a==="zero"&&s==="two"?"zero":"other"},as:r,az:r,be:r,bg:n,bn:r,bs:r,ca:n,cs:r,cy:r,da:r,de:r,el:r,en:n,es:n,et:n,eu:n,fa:o,fi:n,fil:r,fr:r,ga:r,gl:r,gsw:r,gu:r,he:n,hi:r,hr:r,hu:r,hy:r,ia:n,id:n,io:n,is:r,it:r,ja:n,ka:function(a,s){return a||"other"},kk:r,km:n,kn:r,ko:n,ky:r,lij:r,lo:n,lt:r,lv:function(a,s){return s==="one"?"one":"other"},mk:n,ml:r,mn:r,mr:r,ms:n,my:n,nb:n,ne:r,nl:r,no:n,or:o,pa:r,pcm:n,pl:r,ps:r,pt:r,ro:function(a,s){return s==="few"||s==="one"?"few":"other"},ru:r,sc:r,scn:r,sd:o,si:function(a,s){return a==="one"&&s==="one"?"one":"other"},sk:r,sl:function(a,s){return s==="few"||s==="one"?"few":s==="two"?"two":"other"},sq:r,sr:r,sv:n,sw:r,ta:r,te:r,th:n,tk:r,tr:r,ug:r,uk:r,ur:n,uz:r,vi:n,yue:n,zh:n,zu:r})})(ys);var pf=bs(ys.exports),o0=hs({__proto__:null,default:pf},[ys.exports]),i0=df||n0,a0=ff||r0,s0=pf||o0,ws=function(e){return e==="pt-PT"?"pt_PT":e},l0=function(e){return i0[ws(e)]},c0=function(e,n){return a0[ws(e)][n?"ordinal":"cardinal"]},u0=function(e){return s0[ws(e)]},d0=t0.default(Intl.NumberFormat,l0,c0,u0);mf.exports=d0});var xf=Xe(bf=>{"use strict";var f0=hf();function p0(t){return t&&typeof t=="object"&&"default"in t?t:{default:t}}var jn=p0(f0);typeof Intl>"u"?(typeof global<"u"?global.Intl={PluralRules:jn.default}:typeof window<"u"?window.Intl={PluralRules:jn.default}:bf.Intl={PluralRules:jn.default},jn.default.polyfill=!0):!Intl.PluralRules||!Intl.PluralRules.prototype.selectRange?(Intl.PluralRules=jn.default,jn.default.polyfill=!0):(_s=["en","es","ru","zh"],gf=Intl.PluralRules.supportedLocalesOf(_s),gf.length<_s.length&&(Intl.PluralRules=jn.default,jn.default.polyfill=!0));var _s,gf});var wf=Xe(Un=>{"use strict";var vf=Un&&Un.__awaiter||function(t,e,n,o){function r(i){return i instanceof n?i:new n(function(a){a(i)})}return new(n||(n=Promise))(function(i,a){function s(u){try{l(o.next(u))}catch(d){a(d)}}function c(u){try{l(o.throw(u))}catch(d){a(d)}}function l(u){u.done?i(u.value):r(u.value).then(s,c)}l((o=o.apply(t,e||[])).next())})},yf=Un&&Un.__generator||function(t,e){var n={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},o,r,i,a;return a={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function s(l){return function(u){return c([l,u])}}function c(l){if(o)throw new TypeError("Generator is already executing.");for(;a&&(a=0,l[0]&&(n=0)),n;)try{if(o=1,r&&(i=l[0]&2?r.return:l[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,l[1])).done)return i;switch(r=0,i&&(l=[l[0]&2,i.value]),l[0]){case 0:case 1:i=l;break;case 4:return n.label++,{value:l[1],done:!1};case 5:n.label++,r=l[1],l=[0];continue;case 7:l=n.ops.pop(),n.trys.pop();continue;default:if(i=n.trys,!(i=i.length>0&&i[i.length-1])&&(l[0]===6||l[0]===2)){n=0;continue}if(l[0]===3&&(!i||l[1]>i[0]&&l[1]<i[3])){n.label=l[1];break}if(l[0]===6&&n.label<i[1]){n.label=i[1],i=l;break}if(i&&n.label<i[2]){n.label=i[2],n.ops.push(l);break}i[2]&&n.ops.pop(),n.trys.pop();continue}l=e.call(t,n)}catch(u){l=[6,u],r=0}finally{o=i=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}};Object.defineProperty(Un,"__esModule",{value:!0});Un.postProto=void 0;function m0(t,e,n,o){var r=o.alertOnError,i=r===void 0?!0:r;return vf(this,void 0,void 0,function(){var a,s,c,l;return yf(this,function(u){switch(u.label){case 0:return u.trys.push([0,2,,3]),a=e.toBinary(),s="/_anki/".concat(t),[4,h0(s,a)];case 1:return c=u.sent(),[2,n.fromBinary(c)];case 2:throw l=u.sent(),i&&!(l instanceof Error&&l.message==="500: Interrupted")&&alert(l),l;case 3:return[2]}})})}Un.postProto=m0;function h0(t,e){return vf(this,void 0,void 0,function(){var n,o,r,i,a;return yf(this,function(s){switch(s.label){case 0:return[4,fetch(t,{method:"POST",headers:{"Content-Type":"application/binary"},body:e})];case 1:if(n=s.sent(),n.ok)return[3,6];o="something went wrong",s.label=2;case 2:return s.trys.push([2,4,,5]),[4,n.text()];case 3:return o=s.sent(),[3,5];case 4:return r=s.sent(),[3,5];case 5:throw new Error("".concat(n.status,": ").concat(o));case 6:return[4,n.blob()];case 7:return i=s.sent(),[4,new Response(i).arrayBuffer()];case 8:return a=s.sent(),[2,new Uint8Array(a)]}})})}});var Ep=Xe(()=>{});var Op=Xe(()=>{});var Ap=Xe(()=>{});var Lt=Xe(ne=>{var g=g||{version:"5.3.0"};typeof ne<"u"?ne.fabric=g:typeof define=="function"&&define.amd&&define([],function(){return g});typeof document<"u"&&typeof window<"u"?(document instanceof(typeof HTMLDocument<"u"?HTMLDocument:Document)?g.document=document:g.document=document.implementation.createHTMLDocument(""),g.window=window):(Rp=Ep(),Ws=new Rp.JSDOM(decodeURIComponent("%3C!DOCTYPE%20html%3E%3Chtml%3E%3Chead%3E%3C%2Fhead%3E%3Cbody%3E%3C%2Fbody%3E%3C%2Fhtml%3E"),{features:{FetchExternalResources:["img"]},resources:"usable"}).window,g.document=Ws.document,g.jsdomImplForWrapper=Op().implForWrapper,g.nodeCanvas=Ap().Canvas,g.window=Ws,DOMParser=g.window.DOMParser);var Rp,Ws;g.isTouchSupported="ontouchstart"in g.window||"ontouchstart"in g.document||g.window&&g.window.navigator&&g.window.navigator.maxTouchPoints>0;g.isLikelyNode=typeof Buffer<"u"&&typeof window>"u";g.SHARED_ATTRIBUTES=["display","transform","fill","fill-opacity","fill-rule","opacity","stroke","stroke-dasharray","stroke-linecap","stroke-dashoffset","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","id","paint-order","vector-effect","instantiated_by_use","clip-path"];g.DPI=96;g.reNum="(?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:[eE][-+]?\\d+)?)";g.commaWsp="(?:\\s+,?\\s*|,\\s*)";g.rePathCommand=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:[eE][-+]?\d+)?)/ig;g.reNonWord=/[ \n\.,;!\?\-]/;g.fontPaths={};g.iMatrix=[1,0,0,1,0,0];g.svgNS="http://www.w3.org/2000/svg";g.perfLimitSizeTotal=2097152;g.maxCacheSideLimit=4096;g.minCacheSideLimit=256;g.charWidthsCache={};g.textureSize=2048;g.disableStyleCopyPaste=!1;g.enableGLFiltering=!0;g.devicePixelRatio=g.window.devicePixelRatio||g.window.webkitDevicePixelRatio||g.window.mozDevicePixelRatio||1;g.browserShadowBlurConstant=1;g.arcToSegmentsCache={};g.boundsOfCurveCache={};g.cachesBoundsOfCurve=!0;g.forceGLPutImageData=!1;g.initFilterBackend=function(){if(g.enableGLFiltering&&g.isWebglSupported&&g.isWebglSupported(g.textureSize))return console.log("max texture size: "+g.maxTextureSize),new g.WebglFilterBackend({tileSize:g.textureSize});if(g.Canvas2dFilterBackend)return new g.Canvas2dFilterBackend};typeof document<"u"&&typeof window<"u"&&(window.fabric=g);(function(){function t(a,s){if(this.__eventListeners[a]){var c=this.__eventListeners[a];s?c[c.indexOf(s)]=!1:g.util.array.fill(c,!1)}}function e(a,s){if(this.__eventListeners||(this.__eventListeners={}),arguments.length===1)for(var c in a)this.on(c,a[c]);else this.__eventListeners[a]||(this.__eventListeners[a]=[]),this.__eventListeners[a].push(s);return this}function n(a,s){var c=function(){s.apply(this,arguments),this.off(a,c)}.bind(this);this.on(a,c)}function o(a,s){if(arguments.length===1)for(var c in a)n.call(this,c,a[c]);else n.call(this,a,s);return this}function r(a,s){if(!this.__eventListeners)return this;if(arguments.length===0)for(a in this.__eventListeners)t.call(this,a);else if(arguments.length===1&&typeof arguments[0]=="object")for(var c in a)t.call(this,c,a[c]);else t.call(this,a,s);return this}function i(a,s){if(!this.__eventListeners)return this;var c=this.__eventListeners[a];if(!c)return this;for(var l=0,u=c.length;l<u;l++)c[l]&&c[l].call(this,s||{});return this.__eventListeners[a]=c.filter(function(d){return d!==!1}),this}g.Observable={fire:i,on:e,once:o,off:r}})();g.Collection={_objects:[],add:function(){if(this._objects.push.apply(this._objects,arguments),this._onObjectAdded)for(var t=0,e=arguments.length;t<e;t++)this._onObjectAdded(arguments[t]);return this.renderOnAddRemove&&this.requestRenderAll(),this},insertAt:function(t,e,n){var o=this._objects;return n?o[e]=t:o.splice(e,0,t),this._onObjectAdded&&this._onObjectAdded(t),this.renderOnAddRemove&&this.requestRenderAll(),this},remove:function(){for(var t=this._objects,e,n=!1,o=0,r=arguments.length;o<r;o++)e=t.indexOf(arguments[o]),e!==-1&&(n=!0,t.splice(e,1),this._onObjectRemoved&&this._onObjectRemoved(arguments[o]));return this.renderOnAddRemove&&n&&this.requestRenderAll(),this},forEachObject:function(t,e){for(var n=this.getObjects(),o=0,r=n.length;o<r;o++)t.call(e,n[o],o,n);return this},getObjects:function(t){return typeof t>"u"?this._objects.concat():this._objects.filter(function(e){return e.type===t})},item:function(t){return this._objects[t]},isEmpty:function(){return this._objects.length===0},size:function(){return this._objects.length},contains:function(t,e){return this._objects.indexOf(t)>-1?!0:e?this._objects.some(function(n){return typeof n.contains=="function"&&n.contains(t,!0)}):!1},complexity:function(){return this._objects.reduce(function(t,e){return t+=e.complexity?e.complexity():0,t},0)}};g.CommonMethods={_setOptions:function(t){for(var e in t)this.set(e,t[e])},_initGradient:function(t,e){t&&t.colorStops&&!(t instanceof g.Gradient)&&this.set(e,new g.Gradient(t))},_initPattern:function(t,e,n){t&&t.source&&!(t instanceof g.Pattern)?this.set(e,new g.Pattern(t,n)):n&&n()},_setObject:function(t){for(var e in t)this._set(e,t[e])},set:function(t,e){return typeof t=="object"?this._setObject(t):this._set(t,e),this},_set:function(t,e){this[t]=e},toggle:function(t){var e=this.get(t);return typeof e=="boolean"&&this.set(t,!e),this},get:function(t){return this[t]}};(function(t){var e=Math.sqrt,n=Math.atan2,o=Math.pow,r=Math.PI/180,i=Math.PI/2;g.util={cos:function(a){if(a===0)return 1;a<0&&(a=-a);var s=a/i;switch(s){case 1:case 3:return 0;case 2:return-1}return Math.cos(a)},sin:function(a){if(a===0)return 0;var s=a/i,c=1;switch(a<0&&(c=-1),s){case 1:return c;case 2:return 0;case 3:return-c}return Math.sin(a)},removeFromArray:function(a,s){var c=a.indexOf(s);return c!==-1&&a.splice(c,1),a},getRandomInt:function(a,s){return Math.floor(Math.random()*(s-a+1))+a},degreesToRadians:function(a){return a*r},radiansToDegrees:function(a){return a/r},rotatePoint:function(a,s,c){var l=new g.Point(a.x-s.x,a.y-s.y),u=g.util.rotateVector(l,c);return new g.Point(u.x,u.y).addEquals(s)},rotateVector:function(a,s){var c=g.util.sin(s),l=g.util.cos(s),u=a.x*l-a.y*c,d=a.x*c+a.y*l;return{x:u,y:d}},createVector:function(a,s){return new g.Point(s.x-a.x,s.y-a.y)},calcAngleBetweenVectors:function(a,s){return Math.acos((a.x*s.x+a.y*s.y)/(Math.hypot(a.x,a.y)*Math.hypot(s.x,s.y)))},getHatVector:function(a){return new g.Point(a.x,a.y).multiply(1/Math.hypot(a.x,a.y))},getBisector:function(a,s,c){var l=g.util.createVector(a,s),u=g.util.createVector(a,c),d=g.util.calcAngleBetweenVectors(l,u),f=g.util.calcAngleBetweenVectors(g.util.rotateVector(l,d),u),p=d*(f===0?1:-1)/2;return{vector:g.util.getHatVector(g.util.rotateVector(l,p)),angle:d}},projectStrokeOnPoints:function(a,s,c){var l=[],u=s.strokeWidth/2,d=s.strokeUniform?new g.Point(1/s.scaleX,1/s.scaleY):new g.Point(1,1),f=function(p){var m=u/Math.hypot(p.x,p.y);return new g.Point(p.x*m*d.x,p.y*m*d.y)};return a.length<=1||a.forEach(function(p,m){var h=new g.Point(p.x,p.y),b,x;m===0?(x=a[m+1],b=c?f(g.util.createVector(x,h)).addEquals(h):a[a.length-1]):m===a.length-1?(b=a[m-1],x=c?f(g.util.createVector(b,h)).addEquals(h):a[0]):(b=a[m-1],x=a[m+1]);var y=g.util.getBisector(h,b,x),M=y.vector,E=y.angle,C,j;if(s.strokeLineJoin==="miter"&&(C=-u/Math.sin(E/2),j=new g.Point(M.x*C*d.x,M.y*C*d.y),Math.hypot(j.x,j.y)/u<=s.strokeMiterLimit)){l.push(h.add(j)),l.push(h.subtract(j));return}C=-u*Math.SQRT2,j=new g.Point(M.x*C*d.x,M.y*C*d.y),l.push(h.add(j)),l.push(h.subtract(j))}),l},transformPoint:function(a,s,c){return c?new g.Point(s[0]*a.x+s[2]*a.y,s[1]*a.x+s[3]*a.y):new g.Point(s[0]*a.x+s[2]*a.y+s[4],s[1]*a.x+s[3]*a.y+s[5])},makeBoundingBoxFromPoints:function(a,s){if(s)for(var c=0;c<a.length;c++)a[c]=g.util.transformPoint(a[c],s);var l=[a[0].x,a[1].x,a[2].x,a[3].x],u=g.util.array.min(l),d=g.util.array.max(l),f=d-u,p=[a[0].y,a[1].y,a[2].y,a[3].y],m=g.util.array.min(p),h=g.util.array.max(p),b=h-m;return{left:u,top:m,width:f,height:b}},invertTransform:function(a){var s=1/(a[0]*a[3]-a[1]*a[2]),c=[s*a[3],-s*a[1],-s*a[2],s*a[0]],l=g.util.transformPoint({x:a[4],y:a[5]},c,!0);return c[4]=-l.x,c[5]=-l.y,c},toFixed:function(a,s){return parseFloat(Number(a).toFixed(s))},parseUnit:function(a,s){var c=/\D{0,2}$/.exec(a),l=parseFloat(a);switch(s||(s=g.Text.DEFAULT_SVG_FONT_SIZE),c[0]){case"mm":return l*g.DPI/25.4;case"cm":return l*g.DPI/2.54;case"in":return l*g.DPI;case"pt":return l*g.DPI/72;case"pc":return l*g.DPI/72*12;case"em":return l*s;default:return l}},falseFunction:function(){return!1},getKlass:function(a,s){return a=g.util.string.camelize(a.charAt(0).toUpperCase()+a.slice(1)),g.util.resolveNamespace(s)[a]},getSvgAttributes:function(a){var s=["instantiated_by_use","style","id","class"];switch(a){case"linearGradient":s=s.concat(["x1","y1","x2","y2","gradientUnits","gradientTransform"]);break;case"radialGradient":s=s.concat(["gradientUnits","gradientTransform","cx","cy","r","fx","fy","fr"]);break;case"stop":s=s.concat(["offset","stop-color","stop-opacity"]);break}return s},resolveNamespace:function(a){if(!a)return g;var s=a.split("."),c=s.length,l,u=t||g.window;for(l=0;l<c;++l)u=u[s[l]];return u},loadImage:function(a,s,c,l){if(!a){s&&s.call(c,a);return}var u=g.util.createImage(),d=function(){s&&s.call(c,u,!1),u=u.onload=u.onerror=null};u.onload=d,u.onerror=function(){g.log("Error loading "+u.src),s&&s.call(c,null,!0),u=u.onload=u.onerror=null},a.indexOf("data")!==0&&l!==void 0&&l!==null&&(u.crossOrigin=l),a.substring(0,14)==="data:image/svg"&&(u.onload=null,g.util.loadImageInDom(u,d)),u.src=a},loadImageInDom:function(a,s){var c=g.document.createElement("div");c.style.width=c.style.height="1px",c.style.left=c.style.top="-100%",c.style.position="absolute",c.appendChild(a),g.document.querySelector("body").appendChild(c),a.onload=function(){s(),c.parentNode.removeChild(c),c=null}},enlivenObjects:function(a,s,c,l){a=a||[];var u=[],d=0,f=a.length;function p(){++d===f&&s&&s(u.filter(function(m){return m}))}if(!f){s&&s(u);return}a.forEach(function(m,h){if(!m||!m.type){p();return}var b=g.util.getKlass(m.type,c);b.fromObject(m,function(x,y){y||(u[h]=x),l&&l(m,x,y),p()})})},enlivenObjectEnlivables:function(a,s,c){var l=g.Object.ENLIVEN_PROPS.filter(function(u){return!!a[u]});g.util.enlivenObjects(l.map(function(u){return a[u]}),function(u){var d={};l.forEach(function(f,p){d[f]=u[p],s&&(s[f]=u[p])}),c&&c(d)})},enlivenPatterns:function(a,s){a=a||[];function c(){++u===d&&s&&s(l)}var l=[],u=0,d=a.length;if(!d){s&&s(l);return}a.forEach(function(f,p){f&&f.source?new g.Pattern(f,function(m){l[p]=m,c()}):(l[p]=f,c())})},groupSVGElements:function(a,s,c){var l;return a&&a.length===1?(typeof c<"u"&&(a[0].sourcePath=c),a[0]):(s&&(s.width&&s.height?s.centerPoint={x:s.width/2,y:s.height/2}:(delete s.width,delete s.height)),l=new g.Group(a,s),typeof c<"u"&&(l.sourcePath=c),l)},populateWithProperties:function(a,s,c){if(c&&Array.isArray(c))for(var l=0,u=c.length;l<u;l++)c[l]in a&&(s[c[l]]=a[c[l]])},createCanvasElement:function(){return g.document.createElement("canvas")},copyCanvasElement:function(a){var s=g.util.createCanvasElement();return s.width=a.width,s.height=a.height,s.getContext("2d").drawImage(a,0,0),s},toDataURL:function(a,s,c){return a.toDataURL("image/"+s,c)},createImage:function(){return g.document.createElement("img")},multiplyTransformMatrices:function(a,s,c){return[a[0]*s[0]+a[2]*s[1],a[1]*s[0]+a[3]*s[1],a[0]*s[2]+a[2]*s[3],a[1]*s[2]+a[3]*s[3],c?0:a[0]*s[4]+a[2]*s[5]+a[4],c?0:a[1]*s[4]+a[3]*s[5]+a[5]]},qrDecompose:function(a){var s=n(a[1],a[0]),c=o(a[0],2)+o(a[1],2),l=e(c),u=(a[0]*a[3]-a[2]*a[1])/l,d=n(a[0]*a[2]+a[1]*a[3],c);return{angle:s/r,scaleX:l,scaleY:u,skewX:d/r,skewY:0,translateX:a[4],translateY:a[5]}},calcRotateMatrix:function(a){if(!a.angle)return g.iMatrix.concat();var s=g.util.degreesToRadians(a.angle),c=g.util.cos(s),l=g.util.sin(s);return[c,l,-l,c,0,0]},calcDimensionsMatrix:function(a){var s=typeof a.scaleX>"u"?1:a.scaleX,c=typeof a.scaleY>"u"?1:a.scaleY,l=[a.flipX?-s:s,0,0,a.flipY?-c:c,0,0],u=g.util.multiplyTransformMatrices,d=g.util.degreesToRadians;return a.skewX&&(l=u(l,[1,0,Math.tan(d(a.skewX)),1],!0)),a.skewY&&(l=u(l,[1,Math.tan(d(a.skewY)),0,1],!0)),l},composeMatrix:function(a){var s=[1,0,0,1,a.translateX||0,a.translateY||0],c=g.util.multiplyTransformMatrices;return a.angle&&(s=c(s,g.util.calcRotateMatrix(a))),(a.scaleX!==1||a.scaleY!==1||a.skewX||a.skewY||a.flipX||a.flipY)&&(s=c(s,g.util.calcDimensionsMatrix(a))),s},resetObjectTransform:function(a){a.scaleX=1,a.scaleY=1,a.skewX=0,a.skewY=0,a.flipX=!1,a.flipY=!1,a.rotate(0)},saveObjectTransform:function(a){return{scaleX:a.scaleX,scaleY:a.scaleY,skewX:a.skewX,skewY:a.skewY,angle:a.angle,left:a.left,flipX:a.flipX,flipY:a.flipY,top:a.top}},isTransparent:function(a,s,c,l){l>0&&(s>l?s-=l:s=0,c>l?c-=l:c=0);var u=!0,d,f,p=a.getImageData(s,c,l*2||1,l*2||1),m=p.data.length;for(d=3;d<m&&(f=p.data[d],u=f<=0,u!==!1);d+=4);return p=null,u},parsePreserveAspectRatioAttribute:function(a){var s="meet",c="Mid",l="Mid",u=a.split(" "),d;return u&&u.length&&(s=u.pop(),s!=="meet"&&s!=="slice"?(d=s,s="meet"):u.length&&(d=u.pop())),c=d!=="none"?d.slice(1,4):"none",l=d!=="none"?d.slice(5,8):"none",{meetOrSlice:s,alignX:c,alignY:l}},clearFabricFontCache:function(a){a=(a||"").toLowerCase(),a?g.charWidthsCache[a]&&delete g.charWidthsCache[a]:g.charWidthsCache={}},limitDimsByArea:function(a,s){var c=Math.sqrt(s*a),l=Math.floor(s/c);return{x:Math.floor(c),y:l}},capValue:function(a,s,c){return Math.max(a,Math.min(s,c))},findScaleToFit:function(a,s){return Math.min(s.width/a.width,s.height/a.height)},findScaleToCover:function(a,s){return Math.max(s.width/a.width,s.height/a.height)},matrixToSVG:function(a){return"matrix("+a.map(function(s){return g.util.toFixed(s,g.Object.NUM_FRACTION_DIGITS)}).join(" ")+")"},removeTransformFromObject:function(a,s){var c=g.util.invertTransform(s),l=g.util.multiplyTransformMatrices(c,a.calcOwnMatrix());g.util.applyTransformToObject(a,l)},addTransformToObject:function(a,s){g.util.applyTransformToObject(a,g.util.multiplyTransformMatrices(s,a.calcOwnMatrix()))},applyTransformToObject:function(a,s){var c=g.util.qrDecompose(s),l=new g.Point(c.translateX,c.translateY);a.flipX=!1,a.flipY=!1,a.set("scaleX",c.scaleX),a.set("scaleY",c.scaleY),a.skewX=c.skewX,a.skewY=c.skewY,a.angle=c.angle,a.setPositionByOrigin(l,"center","center")},sizeAfterTransform:function(a,s,c){var l=a/2,u=s/2,d=[{x:-l,y:-u},{x:l,y:-u},{x:-l,y:u},{x:l,y:u}],f=g.util.calcDimensionsMatrix(c),p=g.util.makeBoundingBoxFromPoints(d,f);return{x:p.width,y:p.height}},mergeClipPaths:function(a,s){var c=a,l=s;c.inverted&&!l.inverted&&(c=s,l=a),g.util.applyTransformToObject(l,g.util.multiplyTransformMatrices(g.util.invertTransform(c.calcTransformMatrix()),l.calcTransformMatrix()));var u=c.inverted&&l.inverted;return u&&(c.inverted=l.inverted=!1),new g.Group([c],{clipPath:l,inverted:u})},hasStyleChanged:function(a,s,c){return c=c||!1,a.fill!==s.fill||a.stroke!==s.stroke||a.strokeWidth!==s.strokeWidth||a.fontSize!==s.fontSize||a.fontFamily!==s.fontFamily||a.fontWeight!==s.fontWeight||a.fontStyle!==s.fontStyle||a.textBackgroundColor!==s.textBackgroundColor||a.deltaY!==s.deltaY||c&&(a.overline!==s.overline||a.underline!==s.underline||a.linethrough!==s.linethrough)},stylesToArray:function(c,s){for(var c=g.util.object.clone(c,!0),l=s.split(`
`),u=-1,d={},f=[],p=0;p<l.length;p++){if(!c[p]){u+=l[p].length;continue}for(var m=0;m<l[p].length;m++){u++;var h=c[p][m];if(h&&Object.keys(h).length>0){var b=g.util.hasStyleChanged(d,h,!0);b?f.push({start:u,end:u+1,style:h}):f[f.length-1].end++}d=h||{}}}return f},stylesFromArray:function(a,s){if(!Array.isArray(a))return a;for(var c=s.split(`
`),l=-1,u=0,d={},f=0;f<c.length;f++)for(var p=0;p<c[f].length;p++)l++,a[u]&&a[u].start<=l&&l<a[u].end&&(d[f]=d[f]||{},d[f][p]=Object.assign({},a[u].style),l===a[u].end-1&&u++);return d}}})(ne);(function(){var t=Array.prototype.join,e={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},n={m:"l",M:"L"};function o(v,T,R,A,U,k,w,I,_,F,z){var q=g.util.cos(v),ee=g.util.sin(v),O=g.util.cos(T),B=g.util.sin(T),V=R*U*O-A*k*B+w,$=A*U*O+R*k*B+I,te=F+_*(-R*U*ee-A*k*q),L=z+_*(-A*U*ee+R*k*q),Z=V+_*(R*U*B+A*k*O),ce=$+_*(A*U*B-R*k*O);return["C",te,L,Z,ce,V,$]}function r(v,T,R,A,U,k,w){var I=Math.PI,_=w*I/180,F=g.util.sin(_),z=g.util.cos(_),q=0,ee=0;R=Math.abs(R),A=Math.abs(A);var O=-z*v*.5-F*T*.5,B=-z*T*.5+F*v*.5,V=R*R,$=A*A,te=B*B,L=O*O,Z=V*$-V*te-$*L,ce=0;if(Z<0){var ke=Math.sqrt(1-Z/(V*$));R*=ke,A*=ke}else ce=(U===k?-1:1)*Math.sqrt(Z/(V*te+$*L));var ve=ce*R*B/A,re=-ce*A*O/R,we=z*ve-F*re+v*.5,Te=F*ve+z*re+T*.5,Ae=i(1,0,(O-ve)/R,(B-re)/A),je=i((O-ve)/R,(B-re)/A,(-O-ve)/R,(-B-re)/A);k===0&&je>0?je-=2*I:k===1&&je<0&&(je+=2*I);for(var Re=Math.ceil(Math.abs(je/I*2)),et=[],Ge=je/Re,_t=8/3*Math.sin(Ge/4)*Math.sin(Ge/4)/Math.sin(Ge/2),kt=Ae+Ge,ct=0;ct<Re;ct++)et[ct]=o(Ae,kt,z,F,R,A,we,Te,_t,q,ee),q=et[ct][5],ee=et[ct][6],Ae=kt,kt+=Ge;return et}function i(v,T,R,A){var U=Math.atan2(T,v),k=Math.atan2(A,R);return k>=U?k-U:2*Math.PI-(U-k)}function a(v,T,R,A,U,k,w,I){var _;if(g.cachesBoundsOfCurve&&(_=t.call(arguments),g.boundsOfCurveCache[_]))return g.boundsOfCurveCache[_];var F=Math.sqrt,z=Math.min,q=Math.max,ee=Math.abs,O=[],B=[[],[]],V,$,te,L,Z,ce,ke,ve;$=6*v-12*R+6*U,V=-3*v+9*R-9*U+3*w,te=3*R-3*v;for(var re=0;re<2;++re){if(re>0&&($=6*T-12*A+6*k,V=-3*T+9*A-9*k+3*I,te=3*A-3*T),ee(V)<1e-12){if(ee($)<1e-12)continue;L=-te/$,0<L&&L<1&&O.push(L);continue}ke=$*$-4*te*V,!(ke<0)&&(ve=F(ke),Z=(-$+ve)/(2*V),0<Z&&Z<1&&O.push(Z),ce=(-$-ve)/(2*V),0<ce&&ce<1&&O.push(ce))}for(var we,Te,Ae=O.length,je=Ae,Re;Ae--;)L=O[Ae],Re=1-L,we=Re*Re*Re*v+3*Re*Re*L*R+3*Re*L*L*U+L*L*L*w,B[0][Ae]=we,Te=Re*Re*Re*T+3*Re*Re*L*A+3*Re*L*L*k+L*L*L*I,B[1][Ae]=Te;B[0][je]=v,B[1][je]=T,B[0][je+1]=w,B[1][je+1]=I;var et=[{x:z.apply(null,B[0]),y:z.apply(null,B[1])},{x:q.apply(null,B[0]),y:q.apply(null,B[1])}];return g.cachesBoundsOfCurve&&(g.boundsOfCurveCache[_]=et),et}function s(v,T,R){for(var A=R[1],U=R[2],k=R[3],w=R[4],I=R[5],_=R[6],F=R[7],z=r(_-v,F-T,A,U,w,I,k),q=0,ee=z.length;q<ee;q++)z[q][1]+=v,z[q][2]+=T,z[q][3]+=v,z[q][4]+=T,z[q][5]+=v,z[q][6]+=T;return z}function c(v){var T=0,R=0,A=v.length,U=0,k=0,w,I,_,F=[],z,q,ee;for(I=0;I<A;++I){switch(_=!1,w=v[I].slice(0),w[0]){case"l":w[0]="L",w[1]+=T,w[2]+=R;case"L":T=w[1],R=w[2];break;case"h":w[1]+=T;case"H":w[0]="L",w[2]=R,T=w[1];break;case"v":w[1]+=R;case"V":w[0]="L",R=w[1],w[1]=T,w[2]=R;break;case"m":w[0]="M",w[1]+=T,w[2]+=R;case"M":T=w[1],R=w[2],U=w[1],k=w[2];break;case"c":w[0]="C",w[1]+=T,w[2]+=R,w[3]+=T,w[4]+=R,w[5]+=T,w[6]+=R;case"C":q=w[3],ee=w[4],T=w[5],R=w[6];break;case"s":w[0]="S",w[1]+=T,w[2]+=R,w[3]+=T,w[4]+=R;case"S":z==="C"?(q=2*T-q,ee=2*R-ee):(q=T,ee=R),T=w[3],R=w[4],w[0]="C",w[5]=w[3],w[6]=w[4],w[3]=w[1],w[4]=w[2],w[1]=q,w[2]=ee,q=w[3],ee=w[4];break;case"q":w[0]="Q",w[1]+=T,w[2]+=R,w[3]+=T,w[4]+=R;case"Q":q=w[1],ee=w[2],T=w[3],R=w[4];break;case"t":w[0]="T",w[1]+=T,w[2]+=R;case"T":z==="Q"?(q=2*T-q,ee=2*R-ee):(q=T,ee=R),w[0]="Q",T=w[1],R=w[2],w[1]=q,w[2]=ee,w[3]=T,w[4]=R;break;case"a":w[0]="A",w[6]+=T,w[7]+=R;case"A":_=!0,F=F.concat(s(T,R,w)),T=w[6],R=w[7];break;case"z":case"Z":T=U,R=k;break;default:}_||F.push(w),z=w[0]}return F}function l(v,T,R,A){return Math.sqrt((R-v)*(R-v)+(A-T)*(A-T))}function u(v){return v*v*v}function d(v){return 3*v*v*(1-v)}function f(v){return 3*v*(1-v)*(1-v)}function p(v){return(1-v)*(1-v)*(1-v)}function m(v,T,R,A,U,k,w,I){return function(_){var F=u(_),z=d(_),q=f(_),ee=p(_);return{x:w*F+U*z+R*q+v*ee,y:I*F+k*z+A*q+T*ee}}}function h(v,T,R,A,U,k,w,I){return function(_){var F=1-_,z=3*F*F*(R-v)+6*F*_*(U-R)+3*_*_*(w-U),q=3*F*F*(A-T)+6*F*_*(k-A)+3*_*_*(I-k);return Math.atan2(q,z)}}function b(v){return v*v}function x(v){return 2*v*(1-v)}function y(v){return(1-v)*(1-v)}function M(v,T,R,A,U,k){return function(w){var I=b(w),_=x(w),F=y(w);return{x:U*I+R*_+v*F,y:k*I+A*_+T*F}}}function E(v,T,R,A,U,k){return function(w){var I=1-w,_=2*I*(R-v)+2*w*(U-R),F=2*I*(A-T)+2*w*(k-A);return Math.atan2(F,_)}}function C(v,T,R){var A={x:T,y:R},U,k=0,w;for(w=1;w<=100;w+=1)U=v(w/100),k+=l(A.x,A.y,U.x,U.y),A=U;return k}function j(v,T){for(var R=0,A=0,U=v.iterator,k={x:v.x,y:v.y},w,I,_=.01,F=v.angleFinder,z;A<T&&_>1e-4;)w=U(R),z=R,I=l(k.x,k.y,w.x,w.y),I+A>T?(R-=_,_/=2):(k=w,R+=_,A+=I);return w.angle=F(z),w}function P(v){for(var T=0,R=v.length,A,U=0,k=0,w=0,I=0,_=[],F,z,q,ee=0;ee<R;ee++){switch(A=v[ee],z={x:U,y:k,command:A[0]},A[0]){case"M":z.length=0,w=U=A[1],I=k=A[2];break;case"L":z.length=l(U,k,A[1],A[2]),U=A[1],k=A[2];break;case"C":F=m(U,k,A[1],A[2],A[3],A[4],A[5],A[6]),q=h(U,k,A[1],A[2],A[3],A[4],A[5],A[6]),z.iterator=F,z.angleFinder=q,z.length=C(F,U,k),U=A[5],k=A[6];break;case"Q":F=M(U,k,A[1],A[2],A[3],A[4]),q=E(U,k,A[1],A[2],A[3],A[4]),z.iterator=F,z.angleFinder=q,z.length=C(F,U,k),U=A[3],k=A[4];break;case"Z":case"z":z.destX=w,z.destY=I,z.length=l(U,k,w,I),U=w,k=I;break}T+=z.length,_.push(z)}return _.push({length:T,x:U,y:k}),_}function D(v,T,R){R||(R=P(v));for(var A=0;T-R[A].length>0&&A<R.length-2;)T-=R[A].length,A++;var U=R[A],k=T/U.length,w=U.command,I=v[A],_;switch(w){case"M":return{x:U.x,y:U.y,angle:0};case"Z":case"z":return _=new g.Point(U.x,U.y).lerp(new g.Point(U.destX,U.destY),k),_.angle=Math.atan2(U.destY-U.y,U.destX-U.x),_;case"L":return _=new g.Point(U.x,U.y).lerp(new g.Point(I[1],I[2]),k),_.angle=Math.atan2(I[2]-U.y,I[1]-U.x),_;case"C":return j(U,T);case"Q":return j(U,T)}}function N(v){var T=[],R=[],A,U,k=g.rePathCommand,w="[-+]?(?:\\d*\\.\\d+|\\d+\\.?)(?:[eE][-+]?\\d+)?\\s*",I="("+w+")"+g.commaWsp,_="([01])"+g.commaWsp+"?",F=I+"?"+I+"?"+I+_+_+I+"?("+w+")",z=new RegExp(F,"g"),q,ee,O;if(!v||!v.match)return T;O=v.match(/[mzlhvcsqta][^mzlhvcsqta]*/gi);for(var B=0,V,$=O.length;B<$;B++){A=O[B],ee=A.slice(1).trim(),R.length=0;var te=A.charAt(0);if(V=[te],te.toLowerCase()==="a")for(var L;L=z.exec(ee);)for(var Z=1;Z<L.length;Z++)R.push(L[Z]);else for(;q=k.exec(ee);)R.push(q[0]);for(var Z=0,ce=R.length;Z<ce;Z++)U=parseFloat(R[Z]),isNaN(U)||V.push(U);var ke=e[te.toLowerCase()],ve=n[te]||te;if(V.length-1>ke)for(var re=1,we=V.length;re<we;re+=ke)T.push([te].concat(V.slice(re,re+ke))),te=ve;else T.push(V)}return T}function S(v,T){var R=[],A,U=new g.Point(v[0].x,v[0].y),k=new g.Point(v[1].x,v[1].y),w=v.length,I=1,_=0,F=w>2;for(T=T||0,F&&(I=v[2].x<k.x?-1:v[2].x===k.x?0:1,_=v[2].y<k.y?-1:v[2].y===k.y?0:1),R.push(["M",U.x-I*T,U.y-_*T]),A=1;A<w;A++){if(!U.eq(k)){var z=U.midPointFrom(k);R.push(["Q",U.x,U.y,z.x,z.y])}U=v[A],A+1<v.length&&(k=v[A+1])}return F&&(I=U.x>v[A-2].x?1:U.x===v[A-2].x?0:-1,_=U.y>v[A-2].y?1:U.y===v[A-2].y?0:-1),R.push(["L",U.x+I*T,U.y+_*T]),R}function G(v,T,R){return R&&(T=g.util.multiplyTransformMatrices(T,[1,0,0,1,-R.x,-R.y])),v.map(function(A){for(var U=A.slice(0),k={},w=1;w<A.length-1;w+=2)k.x=A[w],k.y=A[w+1],k=g.util.transformPoint(k,T),U[w]=k.x,U[w+1]=k.y;return U})}g.util.joinPath=function(v){return v.map(function(T){return T.join(" ")}).join(" ")},g.util.parsePath=N,g.util.makePathSimpler=c,g.util.getSmoothPathFromPoints=S,g.util.getPathSegmentsInfo=P,g.util.getBoundsOfCurve=a,g.util.getPointOnPath=D,g.util.transformPath=G})();(function(){var t=Array.prototype.slice;function e(a,s){for(var c=t.call(arguments,2),l=[],u=0,d=a.length;u<d;u++)l[u]=c.length?a[u][s].apply(a[u],c):a[u][s].call(a[u]);return l}function n(a,s){return i(a,s,function(c,l){return c>=l})}function o(a,s){return i(a,s,function(c,l){return c<l})}function r(a,s){for(var c=a.length;c--;)a[c]=s;return a}function i(a,s,c){if(!(!a||a.length===0)){var l=a.length-1,u=s?a[l][s]:a[l];if(s)for(;l--;)c(a[l][s],u)&&(u=a[l][s]);else for(;l--;)c(a[l],u)&&(u=a[l]);return u}}g.util.array={fill:r,invoke:e,min:o,max:n}})();(function(){function t(n,o,r){if(r)if(!g.isLikelyNode&&o instanceof Element)n=o;else if(o instanceof Array){n=[];for(var i=0,a=o.length;i<a;i++)n[i]=t({},o[i],r)}else if(o&&typeof o=="object")for(var s in o)s==="canvas"||s==="group"?n[s]=null:o.hasOwnProperty(s)&&(n[s]=t({},o[s],r));else n=o;else for(var s in o)n[s]=o[s];return n}function e(n,o){return t({},n,o)}g.util.object={extend:t,clone:e},g.util.object.extend(g.util,g.Observable)})();(function(){function t(i){return i.replace(/-+(.)?/g,function(a,s){return s?s.toUpperCase():""})}function e(i,a){return i.charAt(0).toUpperCase()+(a?i.slice(1):i.slice(1).toLowerCase())}function n(i){return i.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function o(i){var a=0,s,c=[];for(a=0,s;a<i.length;a++)(s=r(i,a))!==!1&&c.push(s);return c}function r(i,a){var s=i.charCodeAt(a);if(isNaN(s))return"";if(s<55296||s>57343)return i.charAt(a);if(55296<=s&&s<=56319){if(i.length<=a+1)throw"High surrogate without following low surrogate";var c=i.charCodeAt(a+1);if(56320>c||c>57343)throw"High surrogate without following low surrogate";return i.charAt(a)+i.charAt(a+1)}if(a===0)throw"Low surrogate without preceding high surrogate";var l=i.charCodeAt(a-1);if(55296>l||l>56319)throw"Low surrogate without preceding high surrogate";return!1}g.util.string={camelize:t,capitalize:e,escapeXml:n,graphemeSplit:o}})();(function(){var t=Array.prototype.slice,e=function(){},n=function(){for(var s in{toString:1})if(s==="toString")return!1;return!0}(),o=function(s,c,l){for(var u in c)u in s.prototype&&typeof s.prototype[u]=="function"&&(c[u]+"").indexOf("callSuper")>-1?s.prototype[u]=function(d){return function(){var f=this.constructor.superclass;this.constructor.superclass=l;var p=c[d].apply(this,arguments);if(this.constructor.superclass=f,d!=="initialize")return p}}(u):s.prototype[u]=c[u],n&&(c.toString!==Object.prototype.toString&&(s.prototype.toString=c.toString),c.valueOf!==Object.prototype.valueOf&&(s.prototype.valueOf=c.valueOf))};function r(){}function i(s){for(var c=null,l=this;l.constructor.superclass;){var u=l.constructor.superclass.prototype[s];if(l[s]!==u){c=u;break}l=l.constructor.superclass.prototype}return c?arguments.length>1?c.apply(this,t.call(arguments,1)):c.call(this):console.log("tried to callSuper "+s+", method not found in prototype chain",this)}function a(){var s=null,c=t.call(arguments,0);typeof c[0]=="function"&&(s=c.shift());function l(){this.initialize.apply(this,arguments)}l.superclass=s,l.subclasses=[],s&&(r.prototype=s.prototype,l.prototype=new r,s.subclasses.push(l));for(var u=0,d=c.length;u<d;u++)o(l,c[u],s);return l.prototype.initialize||(l.prototype.initialize=e),l.prototype.constructor=l,l.prototype.callSuper=i,l}g.util.createClass=a})();(function(){var t=!!g.document.createElement("div").attachEvent,e=["touchstart","touchmove","touchend"];g.util.addListener=function(o,r,i,a){o&&o.addEventListener(r,i,t?!1:a)},g.util.removeListener=function(o,r,i,a){o&&o.removeEventListener(r,i,t?!1:a)};function n(o){var r=o.changedTouches;return r&&r[0]?r[0]:o}g.util.getPointer=function(o){var r=o.target,i=g.util.getScrollLeftTop(r),a=n(o);return{x:a.clientX+i.left,y:a.clientY+i.top}},g.util.isTouchEvent=function(o){return e.indexOf(o.type)>-1||o.pointerType==="touch"}})();(function(){function t(a,s){var c=a.style;if(!c)return a;if(typeof s=="string")return a.style.cssText+=";"+s,s.indexOf("opacity")>-1?i(a,s.match(/opacity:\s*(\d?\.?\d*)/)[1]):a;for(var l in s)if(l==="opacity")i(a,s[l]);else{var u=l==="float"||l==="cssFloat"?typeof c.styleFloat>"u"?"cssFloat":"styleFloat":l;c.setProperty(u,s[l])}return a}var e=g.document.createElement("div"),n=typeof e.style.opacity=="string",o=typeof e.style.filter=="string",r=/alpha\s*\(\s*opacity\s*=\s*([^\)]+)\)/,i=function(a){return a};n?i=function(a,s){return a.style.opacity=s,a}:o&&(i=function(a,s){var c=a.style;return a.currentStyle&&!a.currentStyle.hasLayout&&(c.zoom=1),r.test(c.filter)?(s=s>=.9999?"":"alpha(opacity="+s*100+")",c.filter=c.filter.replace(r,s)):c.filter+=" alpha(opacity="+s*100+")",a}),g.util.setStyle=t})();(function(){var t=Array.prototype.slice;function e(p){return typeof p=="string"?g.document.getElementById(p):p}var n,o=function(p){return t.call(p,0)};try{n=o(g.document.childNodes)instanceof Array}catch{}n||(o=function(p){for(var m=new Array(p.length),h=p.length;h--;)m[h]=p[h];return m});function r(p,m){var h=g.document.createElement(p);for(var b in m)b==="class"?h.className=m[b]:b==="for"?h.htmlFor=m[b]:h.setAttribute(b,m[b]);return h}function i(p,m){p&&(" "+p.className+" ").indexOf(" "+m+" ")===-1&&(p.className+=(p.className?" ":"")+m)}function a(p,m,h){return typeof m=="string"&&(m=r(m,h)),p.parentNode&&p.parentNode.replaceChild(m,p),m.appendChild(p),m}function s(p){for(var m=0,h=0,b=g.document.documentElement,x=g.document.body||{scrollLeft:0,scrollTop:0};p&&(p.parentNode||p.host)&&(p=p.parentNode||p.host,p===g.document?(m=x.scrollLeft||b.scrollLeft||0,h=x.scrollTop||b.scrollTop||0):(m+=p.scrollLeft||0,h+=p.scrollTop||0),!(p.nodeType===1&&p.style.position==="fixed")););return{left:m,top:h}}function c(p){var m,h=p&&p.ownerDocument,b={left:0,top:0},x={left:0,top:0},y,M={borderLeftWidth:"left",borderTopWidth:"top",paddingLeft:"left",paddingTop:"top"};if(!h)return x;for(var E in M)x[M[E]]+=parseInt(l(p,E),10)||0;return m=h.documentElement,typeof p.getBoundingClientRect<"u"&&(b=p.getBoundingClientRect()),y=s(p),{left:b.left+y.left-(m.clientLeft||0)+x.left,top:b.top+y.top-(m.clientTop||0)+x.top}}var l;g.document.defaultView&&g.document.defaultView.getComputedStyle?l=function(p,m){var h=g.document.defaultView.getComputedStyle(p,null);return h?h[m]:void 0}:l=function(p,m){var h=p.style[m];return!h&&p.currentStyle&&(h=p.currentStyle[m]),h},function(){var p=g.document.documentElement.style,m="userSelect"in p?"userSelect":"MozUserSelect"in p?"MozUserSelect":"WebkitUserSelect"in p?"WebkitUserSelect":"KhtmlUserSelect"in p?"KhtmlUserSelect":"";function h(x){return typeof x.onselectstart<"u"&&(x.onselectstart=g.util.falseFunction),m?x.style[m]="none":typeof x.unselectable=="string"&&(x.unselectable="on"),x}function b(x){return typeof x.onselectstart<"u"&&(x.onselectstart=null),m?x.style[m]="":typeof x.unselectable=="string"&&(x.unselectable=""),x}g.util.makeElementUnselectable=h,g.util.makeElementSelectable=b}();function u(p){var m=g.jsdomImplForWrapper(p);return m._canvas||m._image}function d(p){if(g.isLikelyNode){var m=g.jsdomImplForWrapper(p);m&&(m._image=null,m._canvas=null,m._currentSrc=null,m._attributes=null,m._classList=null)}}function f(p,m){p.imageSmoothingEnabled=p.imageSmoothingEnabled||p.webkitImageSmoothingEnabled||p.mozImageSmoothingEnabled||p.msImageSmoothingEnabled||p.oImageSmoothingEnabled,p.imageSmoothingEnabled=m}g.util.setImageSmoothing=f,g.util.getById=e,g.util.toArray=o,g.util.addClass=i,g.util.makeElement=r,g.util.wrapElement=a,g.util.getScrollLeftTop=s,g.util.getElementOffset=c,g.util.getNodeCanvas=u,g.util.cleanUpJsdomNode=d})();(function(){function t(o,r){return o+(/\?/.test(o)?"&":"?")+r}function e(){}function n(o,r){r||(r={});var i=r.method?r.method.toUpperCase():"GET",a=r.onComplete||function(){},s=new g.window.XMLHttpRequest,c=r.body||r.parameters;return s.onreadystatechange=function(){s.readyState===4&&(a(s),s.onreadystatechange=e)},i==="GET"&&(c=null,typeof r.parameters=="string"&&(o=t(o,r.parameters))),s.open(i,o,!0),(i==="POST"||i==="PUT")&&s.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),s.send(c),s}g.util.request=n})();g.log=console.log;g.warn=console.warn;(function(){var t=g.util.object.extend,e=g.util.object.clone,n=[];g.util.object.extend(n,{cancelAll:function(){var u=this.splice(0);return u.forEach(function(d){d.cancel()}),u},cancelByCanvas:function(u){if(!u)return[];var d=this.filter(function(f){return typeof f.target=="object"&&f.target.canvas===u});return d.forEach(function(f){f.cancel()}),d},cancelByTarget:function(u){var d=this.findAnimationsByTarget(u);return d.forEach(function(f){f.cancel()}),d},findAnimationIndex:function(u){return this.indexOf(this.findAnimation(u))},findAnimation:function(u){return this.find(function(d){return d.cancel===u})},findAnimationsByTarget:function(u){return u?this.filter(function(d){return d.target===u}):[]}});function o(){return!1}function r(u,d,f,p){return-f*Math.cos(u/p*(Math.PI/2))+f+d}function i(u){u||(u={});var d=!1,f,p=function(){var m=g.runningAnimations.indexOf(f);return m>-1&&g.runningAnimations.splice(m,1)[0]};return f=t(e(u),{cancel:function(){return d=!0,p()},currentValue:"startValue"in u?u.startValue:0,completionRate:0,durationRate:0}),g.runningAnimations.push(f),c(function(m){var h=m||+new Date,b=u.duration||500,x=h+b,y,M=u.onChange||o,E=u.abort||o,C=u.onComplete||o,j=u.easing||r,P="startValue"in u?u.startValue.length>0:!1,D="startValue"in u?u.startValue:0,N="endValue"in u?u.endValue:100,S=u.byValue||(P?D.map(function(G,v){return N[v]-D[v]}):N-D);u.onStart&&u.onStart(),function G(v){y=v||+new Date;var T=y>x?b:y-h,R=T/b,A=P?D.map(function(k,w){return j(T,D[w],S[w],b)}):j(T,D,S,b),U=Math.abs(P?(A[0]-D[0])/S[0]:(A-D)/S);if(f.currentValue=P?A.slice():A,f.completionRate=U,f.durationRate=R,!d){if(E(A,U,R)){p();return}if(y>x){f.currentValue=P?N.slice():N,f.completionRate=1,f.durationRate=1,M(P?N.slice():N,1,1),C(N,1,1),p();return}else M(A,U,R),c(G)}}(h)}),f.cancel}var a=g.window.requestAnimationFrame||g.window.webkitRequestAnimationFrame||g.window.mozRequestAnimationFrame||g.window.oRequestAnimationFrame||g.window.msRequestAnimationFrame||function(u){return g.window.setTimeout(u,1e3/60)},s=g.window.cancelAnimationFrame||g.window.clearTimeout;function c(){return a.apply(g.window,arguments)}function l(){return s.apply(g.window,arguments)}g.util.animate=i,g.util.requestAnimFrame=c,g.util.cancelAnimFrame=l,g.runningAnimations=n})();(function(){function t(n,o,r){var i="rgba("+parseInt(n[0]+r*(o[0]-n[0]),10)+","+parseInt(n[1]+r*(o[1]-n[1]),10)+","+parseInt(n[2]+r*(o[2]-n[2]),10);return i+=","+(n&&o?parseFloat(n[3]+r*(o[3]-n[3])):1),i+=")",i}function e(n,o,r,i){var a=new g.Color(n).getSource(),s=new g.Color(o).getSource(),c=i.onComplete,l=i.onChange;return i=i||{},g.util.animate(g.util.object.extend(i,{duration:r||500,startValue:a,endValue:s,byValue:s,easing:function(u,d,f,p){var m=i.colorEasing?i.colorEasing(u,p):1-Math.cos(u/p*(Math.PI/2));return t(d,f,m)},onComplete:function(u,d,f){if(c)return c(t(s,s,0),d,f)},onChange:function(u,d,f){if(l){if(Array.isArray(u))return l(t(u,u,0),d,f);l(u,d,f)}}}))}g.util.animateColor=e})();(function(){function t(v,T,R,A){return v<Math.abs(T)?(v=T,A=R/4):T===0&&v===0?A=R/(2*Math.PI)*Math.asin(1):A=R/(2*Math.PI)*Math.asin(T/v),{a:v,c:T,p:R,s:A}}function e(v,T,R){return v.a*Math.pow(2,10*(T-=1))*Math.sin((T*R-v.s)*(2*Math.PI)/v.p)}function n(v,T,R,A){return R*((v=v/A-1)*v*v+1)+T}function o(v,T,R,A){return v/=A/2,v<1?R/2*v*v*v+T:R/2*((v-=2)*v*v+2)+T}function r(v,T,R,A){return R*(v/=A)*v*v*v+T}function i(v,T,R,A){return-R*((v=v/A-1)*v*v*v-1)+T}function a(v,T,R,A){return v/=A/2,v<1?R/2*v*v*v*v+T:-R/2*((v-=2)*v*v*v-2)+T}function s(v,T,R,A){return R*(v/=A)*v*v*v*v+T}function c(v,T,R,A){return R*((v=v/A-1)*v*v*v*v+1)+T}function l(v,T,R,A){return v/=A/2,v<1?R/2*v*v*v*v*v+T:R/2*((v-=2)*v*v*v*v+2)+T}function u(v,T,R,A){return-R*Math.cos(v/A*(Math.PI/2))+R+T}function d(v,T,R,A){return R*Math.sin(v/A*(Math.PI/2))+T}function f(v,T,R,A){return-R/2*(Math.cos(Math.PI*v/A)-1)+T}function p(v,T,R,A){return v===0?T:R*Math.pow(2,10*(v/A-1))+T}function m(v,T,R,A){return v===A?T+R:R*(-Math.pow(2,-10*v/A)+1)+T}function h(v,T,R,A){return v===0?T:v===A?T+R:(v/=A/2,v<1?R/2*Math.pow(2,10*(v-1))+T:R/2*(-Math.pow(2,-10*--v)+2)+T)}function b(v,T,R,A){return-R*(Math.sqrt(1-(v/=A)*v)-1)+T}function x(v,T,R,A){return R*Math.sqrt(1-(v=v/A-1)*v)+T}function y(v,T,R,A){return v/=A/2,v<1?-R/2*(Math.sqrt(1-v*v)-1)+T:R/2*(Math.sqrt(1-(v-=2)*v)+1)+T}function M(v,T,R,A){var U=1.70158,k=0,w=R;if(v===0)return T;if(v/=A,v===1)return T+R;k||(k=A*.3);var I=t(w,R,k,U);return-e(I,v,A)+T}function E(v,T,R,A){var U=1.70158,k=0,w=R;if(v===0)return T;if(v/=A,v===1)return T+R;k||(k=A*.3);var I=t(w,R,k,U);return I.a*Math.pow(2,-10*v)*Math.sin((v*A-I.s)*(2*Math.PI)/I.p)+I.c+T}function C(v,T,R,A){var U=1.70158,k=0,w=R;if(v===0)return T;if(v/=A/2,v===2)return T+R;k||(k=A*(.3*1.5));var I=t(w,R,k,U);return v<1?-.5*e(I,v,A)+T:I.a*Math.pow(2,-10*(v-=1))*Math.sin((v*A-I.s)*(2*Math.PI)/I.p)*.5+I.c+T}function j(v,T,R,A,U){return U===void 0&&(U=1.70158),R*(v/=A)*v*((U+1)*v-U)+T}function P(v,T,R,A,U){return U===void 0&&(U=1.70158),R*((v=v/A-1)*v*((U+1)*v+U)+1)+T}function D(v,T,R,A,U){return U===void 0&&(U=1.70158),v/=A/2,v<1?R/2*(v*v*(((U*=1.525)+1)*v-U))+T:R/2*((v-=2)*v*(((U*=1.525)+1)*v+U)+2)+T}function N(v,T,R,A){return R-S(A-v,0,R,A)+T}function S(v,T,R,A){return(v/=A)<1/2.75?R*(7.5625*v*v)+T:v<2/2.75?R*(7.5625*(v-=1.5/2.75)*v+.75)+T:v<2.5/2.75?R*(7.5625*(v-=2.25/2.75)*v+.9375)+T:R*(7.5625*(v-=2.625/2.75)*v+.984375)+T}function G(v,T,R,A){return v<A/2?N(v*2,0,R,A)*.5+T:S(v*2-A,0,R,A)*.5+R*.5+T}g.util.ease={easeInQuad:function(v,T,R,A){return R*(v/=A)*v+T},easeOutQuad:function(v,T,R,A){return-R*(v/=A)*(v-2)+T},easeInOutQuad:function(v,T,R,A){return v/=A/2,v<1?R/2*v*v+T:-R/2*(--v*(v-2)-1)+T},easeInCubic:function(v,T,R,A){return R*(v/=A)*v*v+T},easeOutCubic:n,easeInOutCubic:o,easeInQuart:r,easeOutQuart:i,easeInOutQuart:a,easeInQuint:s,easeOutQuint:c,easeInOutQuint:l,easeInSine:u,easeOutSine:d,easeInOutSine:f,easeInExpo:p,easeOutExpo:m,easeInOutExpo:h,easeInCirc:b,easeOutCirc:x,easeInOutCirc:y,easeInElastic:M,easeOutElastic:E,easeInOutElastic:C,easeInBack:j,easeOutBack:P,easeInOutBack:D,easeInBounce:N,easeOutBounce:S,easeInOutBounce:G}})();(function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.util.object.extend,o=e.util.object.clone,r=e.util.toFixed,i=e.util.parseUnit,a=e.util.multiplyTransformMatrices,s=["path","circle","polygon","polyline","ellipse","rect","line","image","text"],c=["symbol","image","marker","pattern","view","svg"],l=["pattern","defs","symbol","metadata","clipPath","mask","desc"],u=["symbol","g","a","svg","clipPath","defs"],d={cx:"left",x:"left",r:"radius",cy:"top",y:"top",display:"visible",visibility:"visible",transform:"transformMatrix","fill-opacity":"fillOpacity","fill-rule":"fillRule","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","letter-spacing":"charSpacing","paint-order":"paintFirst","stroke-dasharray":"strokeDashArray","stroke-dashoffset":"strokeDashOffset","stroke-linecap":"strokeLineCap","stroke-linejoin":"strokeLineJoin","stroke-miterlimit":"strokeMiterLimit","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","text-decoration":"textDecoration","text-anchor":"textAnchor",opacity:"opacity","clip-path":"clipPath","clip-rule":"clipRule","vector-effect":"strokeUniform","image-rendering":"imageSmoothing"},f={stroke:"strokeOpacity",fill:"fillOpacity"},p="font-size",m="clip-path";e.svgValidTagNamesRegEx=x(s),e.svgViewBoxElementsRegEx=x(c),e.svgInvalidAncestorsRegEx=x(l),e.svgValidParentsRegEx=x(u),e.cssRules={},e.gradientDefs={},e.clipPaths={};function h(k){return k in d?d[k]:k}function b(k,w,I,_){var F=Array.isArray(w),z;if((k==="fill"||k==="stroke")&&w==="none")w="";else{if(k==="strokeUniform")return w==="non-scaling-stroke";if(k==="strokeDashArray")w==="none"?w=null:w=w.replace(/,/g," ").split(/\s+/).map(parseFloat);else if(k==="transformMatrix")I&&I.transformMatrix?w=a(I.transformMatrix,e.parseTransformAttribute(w)):w=e.parseTransformAttribute(w);else if(k==="visible")w=w!=="none"&&w!=="hidden",I&&I.visible===!1&&(w=!1);else if(k==="opacity")w=parseFloat(w),I&&typeof I.opacity<"u"&&(w*=I.opacity);else if(k==="textAnchor")w=w==="start"?"left":w==="end"?"right":"center";else if(k==="charSpacing")z=i(w,_)/_*1e3;else if(k==="paintFirst"){var q=w.indexOf("fill"),ee=w.indexOf("stroke"),w="fill";(q>-1&&ee>-1&&ee<q||q===-1&&ee>-1)&&(w="stroke")}else{if(k==="href"||k==="xlink:href"||k==="font")return w;if(k==="imageSmoothing")return w==="optimizeQuality";z=F?w.map(i):i(w,_)}}return!F&&isNaN(z)?w:z}function x(k){return new RegExp("^("+k.join("|")+")\\b","i")}function y(k){for(var w in f)if(!(typeof k[f[w]]>"u"||k[w]==="")){if(typeof k[w]>"u"){if(!e.Object.prototype[w])continue;k[w]=e.Object.prototype[w]}if(k[w].indexOf("url(")!==0){var I=new e.Color(k[w]);k[w]=I.setAlpha(r(I.getAlpha()*k[f[w]],2)).toRgba()}}return k}function M(k,w){var I,_=[],F,z,q;for(z=0,q=w.length;z<q;z++)I=w[z],F=k.getElementsByTagName(I),_=_.concat(Array.prototype.slice.call(F));return _}e.parseTransformAttribute=function(){function k(re,we){var Te=e.util.cos(we[0]),Ae=e.util.sin(we[0]),je=0,Re=0;we.length===3&&(je=we[1],Re=we[2]),re[0]=Te,re[1]=Ae,re[2]=-Ae,re[3]=Te,re[4]=je-(Te*je-Ae*Re),re[5]=Re-(Ae*je+Te*Re)}function w(re,we){var Te=we[0],Ae=we.length===2?we[1]:we[0];re[0]=Te,re[3]=Ae}function I(re,we,Te){re[Te]=Math.tan(e.util.degreesToRadians(we[0]))}function _(re,we){re[4]=we[0],we.length===2&&(re[5]=we[1])}var F=e.iMatrix,z=e.reNum,q=e.commaWsp,ee="(?:(skewX)\\s*\\(\\s*("+z+")\\s*\\))",O="(?:(skewY)\\s*\\(\\s*("+z+")\\s*\\))",B="(?:(rotate)\\s*\\(\\s*("+z+")(?:"+q+"("+z+")"+q+"("+z+"))?\\s*\\))",V="(?:(scale)\\s*\\(\\s*("+z+")(?:"+q+"("+z+"))?\\s*\\))",$="(?:(translate)\\s*\\(\\s*("+z+")(?:"+q+"("+z+"))?\\s*\\))",te="(?:(matrix)\\s*\\(\\s*("+z+")"+q+"("+z+")"+q+"("+z+")"+q+"("+z+")"+q+"("+z+")"+q+"("+z+")\\s*\\))",L="(?:"+te+"|"+$+"|"+V+"|"+B+"|"+ee+"|"+O+")",Z="(?:"+L+"(?:"+q+"*"+L+")*)",ce="^\\s*(?:"+Z+"?)\\s*$",ke=new RegExp(ce),ve=new RegExp(L,"g");return function(re){var we=F.concat(),Te=[];if(!re||re&&!ke.test(re))return we;re.replace(ve,function(je){var Re=new RegExp(L).exec(je).filter(function(_t){return!!_t}),et=Re[1],Ge=Re.slice(2).map(parseFloat);switch(et){case"translate":_(we,Ge);break;case"rotate":Ge[0]=e.util.degreesToRadians(Ge[0]),k(we,Ge);break;case"scale":w(we,Ge);break;case"skewX":I(we,Ge,2);break;case"skewY":I(we,Ge,1);break;case"matrix":we=Ge;break}Te.push(we.concat()),we=F.concat()});for(var Ae=Te[0];Te.length>1;)Te.shift(),Ae=e.util.multiplyTransformMatrices(Ae,Te[0]);return Ae}}();function E(k,w){var I,_;k.replace(/;\s*$/,"").split(";").forEach(function(F){var z=F.split(":");I=z[0].trim().toLowerCase(),_=z[1].trim(),w[I]=_})}function C(k,w){var I,_;for(var F in k)typeof k[F]>"u"||(I=F.toLowerCase(),_=k[F],w[I]=_)}function j(k,w){var I={};for(var _ in e.cssRules[w])if(P(k,_.split(" ")))for(var F in e.cssRules[w][_])I[F]=e.cssRules[w][_][F];return I}function P(k,w){var I,_=!0;return I=N(k,w.pop()),I&&w.length&&(_=D(k,w)),I&&_&&w.length===0}function D(k,w){for(var I,_=!0;k.parentNode&&k.parentNode.nodeType===1&&w.length;)_&&(I=w.pop()),k=k.parentNode,_=N(k,I);return w.length===0}function N(k,w){var I=k.nodeName,_=k.getAttribute("class"),F=k.getAttribute("id"),z,q;if(z=new RegExp("^"+I,"i"),w=w.replace(z,""),F&&w.length&&(z=new RegExp("#"+F+"(?![a-zA-Z\\-]+)","i"),w=w.replace(z,"")),_&&w.length)for(_=_.split(" "),q=_.length;q--;)z=new RegExp("\\."+_[q]+"(?![a-zA-Z\\-]+)","i"),w=w.replace(z,"");return w.length===0}function S(k,w){var I;if(k.getElementById&&(I=k.getElementById(w)),I)return I;var _,F,z,q=k.getElementsByTagName("*");for(F=0,z=q.length;F<z;F++)if(_=q[F],w===_.getAttribute("id"))return _}function G(k){for(var w=M(k,["use","svg:use"]),I=0;w.length&&I<w.length;){var _=w[I],F=_.getAttribute("xlink:href")||_.getAttribute("href");if(F===null)return;var z=F.slice(1),q=_.getAttribute("x")||0,ee=_.getAttribute("y")||0,O=S(k,z).cloneNode(!0),B=(O.getAttribute("transform")||"")+" translate("+q+", "+ee+")",V,$=w.length,te,L,Z,ce,ke=e.svgNS;if(T(O),/^svg$/i.test(O.nodeName)){var ve=O.ownerDocument.createElementNS(ke,"g");for(L=0,Z=O.attributes,ce=Z.length;L<ce;L++)te=Z.item(L),ve.setAttributeNS(ke,te.nodeName,te.nodeValue);for(;O.firstChild;)ve.appendChild(O.firstChild);O=ve}for(L=0,Z=_.attributes,ce=Z.length;L<ce;L++)te=Z.item(L),!(te.nodeName==="x"||te.nodeName==="y"||te.nodeName==="xlink:href"||te.nodeName==="href")&&(te.nodeName==="transform"?B=te.nodeValue+" "+B:O.setAttribute(te.nodeName,te.nodeValue));O.setAttribute("transform",B),O.setAttribute("instantiated_by_use","1"),O.removeAttribute("id"),V=_.parentNode,V.replaceChild(O,_),w.length===$&&I++}}var v=new RegExp("^\\s*("+e.reNum+"+)\\s*,?\\s*("+e.reNum+"+)\\s*,?\\s*("+e.reNum+"+)\\s*,?\\s*("+e.reNum+"+)\\s*$");function T(k){if(!e.svgViewBoxElementsRegEx.test(k.nodeName))return{};var w=k.getAttribute("viewBox"),I=1,_=1,F=0,z=0,q,ee,O,B,V=k.getAttribute("width"),$=k.getAttribute("height"),te=k.getAttribute("x")||0,L=k.getAttribute("y")||0,Z=k.getAttribute("preserveAspectRatio")||"",ce=!w||!(w=w.match(v)),ke=!V||!$||V==="100%"||$==="100%",ve=ce&&ke,re={},we="",Te=0,Ae=0;if(re.width=0,re.height=0,re.toBeParsed=ve,ce&&(te||L)&&k.parentNode&&k.parentNode.nodeName!=="#document"&&(we=" translate("+i(te)+" "+i(L)+") ",O=(k.getAttribute("transform")||"")+we,k.setAttribute("transform",O),k.removeAttribute("x"),k.removeAttribute("y")),ve)return re;if(ce)return re.width=i(V),re.height=i($),re;if(F=-parseFloat(w[1]),z=-parseFloat(w[2]),q=parseFloat(w[3]),ee=parseFloat(w[4]),re.minX=F,re.minY=z,re.viewBoxWidth=q,re.viewBoxHeight=ee,ke?(re.width=q,re.height=ee):(re.width=i(V),re.height=i($),I=re.width/q,_=re.height/ee),Z=e.util.parsePreserveAspectRatioAttribute(Z),Z.alignX!=="none"&&(Z.meetOrSlice==="meet"&&(_=I=I>_?_:I),Z.meetOrSlice==="slice"&&(_=I=I>_?I:_),Te=re.width-q*I,Ae=re.height-ee*I,Z.alignX==="Mid"&&(Te/=2),Z.alignY==="Mid"&&(Ae/=2),Z.alignX==="Min"&&(Te=0),Z.alignY==="Min"&&(Ae=0)),I===1&&_===1&&F===0&&z===0&&te===0&&L===0)return re;if((te||L)&&k.parentNode.nodeName!=="#document"&&(we=" translate("+i(te)+" "+i(L)+") "),O=we+" matrix("+I+" 0 0 "+_+" "+(F*I+Te)+" "+(z*_+Ae)+") ",k.nodeName==="svg"){for(B=k.ownerDocument.createElementNS(e.svgNS,"g");k.firstChild;)B.appendChild(k.firstChild);k.appendChild(B)}else B=k,B.removeAttribute("x"),B.removeAttribute("y"),O=B.getAttribute("transform")+O;return B.setAttribute("transform",O),re}function R(k,w){for(;k&&(k=k.parentNode);)if(k.nodeName&&w.test(k.nodeName.replace("svg:",""))&&!k.getAttribute("instantiated_by_use"))return!0;return!1}e.parseSVGDocument=function(k,w,I,_){if(k){G(k);var F=e.Object.__uid++,z,q,ee=T(k),O=e.util.toArray(k.getElementsByTagName("*"));if(ee.crossOrigin=_&&_.crossOrigin,ee.svgUid=F,O.length===0&&e.isLikelyNode){O=k.selectNodes('//*[name(.)!="svg"]');var B=[];for(z=0,q=O.length;z<q;z++)B[z]=O[z];O=B}var V=O.filter(function(te){return T(te),e.svgValidTagNamesRegEx.test(te.nodeName.replace("svg:",""))&&!R(te,e.svgInvalidAncestorsRegEx)});if(!V||V&&!V.length){w&&w([],{});return}var $={};O.filter(function(te){return te.nodeName.replace("svg:","")==="clipPath"}).forEach(function(te){var L=te.getAttribute("id");$[L]=e.util.toArray(te.getElementsByTagName("*")).filter(function(Z){return e.svgValidTagNamesRegEx.test(Z.nodeName.replace("svg:",""))})}),e.gradientDefs[F]=e.getGradientDefs(k),e.cssRules[F]=e.getCSSRules(k),e.clipPaths[F]=$,e.parseElements(V,function(te,L){w&&(w(te,ee,L,O),delete e.gradientDefs[F],delete e.cssRules[F],delete e.clipPaths[F])},o(ee),I,_)}};function A(k,w){var I=["gradientTransform","x1","x2","y1","y2","gradientUnits","cx","cy","r","fx","fy"],_="xlink:href",F=w.getAttribute(_).slice(1),z=S(k,F);if(z&&z.getAttribute(_)&&A(k,z),I.forEach(function(ee){z&&!w.hasAttribute(ee)&&z.hasAttribute(ee)&&w.setAttribute(ee,z.getAttribute(ee))}),!w.children.length)for(var q=z.cloneNode(!0);q.firstChild;)w.appendChild(q.firstChild);w.removeAttribute(_)}var U=new RegExp("(normal|italic)?\\s*(normal|small-caps)?\\s*(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)?\\s*("+e.reNum+"(?:px|cm|mm|em|pt|pc|in)*)(?:\\/(normal|"+e.reNum+"))?\\s+(.*)");n(e,{parseFontDeclaration:function(k,w){var I=k.match(U);if(I){var _=I[1],F=I[3],z=I[4],q=I[5],ee=I[6];_&&(w.fontStyle=_),F&&(w.fontWeight=isNaN(parseFloat(F))?F:parseFloat(F)),z&&(w.fontSize=i(z)),ee&&(w.fontFamily=ee),q&&(w.lineHeight=q==="normal"?1:q)}},getGradientDefs:function(k){var w=["linearGradient","radialGradient","svg:linearGradient","svg:radialGradient"],I=M(k,w),_,F=0,z={};for(F=I.length;F--;)_=I[F],_.getAttribute("xlink:href")&&A(k,_),z[_.getAttribute("id")]=_;return z},parseAttributes:function(k,w,I){if(k){var _,F={},z,q;typeof I>"u"&&(I=k.getAttribute("svgUid")),k.parentNode&&e.svgValidParentsRegEx.test(k.parentNode.nodeName)&&(F=e.parseAttributes(k.parentNode,w,I));var ee=w.reduce(function(Z,ce){return _=k.getAttribute(ce),_&&(Z[ce]=_),Z},{}),O=n(j(k,I),e.parseStyleAttribute(k));ee=n(ee,O),O[m]&&k.setAttribute(m,O[m]),z=q=F.fontSize||e.Text.DEFAULT_SVG_FONT_SIZE,ee[p]&&(ee[p]=z=i(ee[p],q));var B,V,$={};for(var te in ee)B=h(te),V=b(B,ee[te],F,z),$[B]=V;$&&$.font&&e.parseFontDeclaration($.font,$);var L=n(F,$);return e.svgValidParentsRegEx.test(k.nodeName)?L:y(L)}},parseElements:function(k,w,I,_,F){new e.ElementsParser(k,w,I,_,F).parse()},parseStyleAttribute:function(k){var w={},I=k.getAttribute("style");return I&&(typeof I=="string"?E(I,w):C(I,w)),w},parsePointsAttribute:function(k){if(!k)return null;k=k.replace(/,/g," ").trim(),k=k.split(/\s+/);var w=[],I,_;for(I=0,_=k.length;I<_;I+=2)w.push({x:parseFloat(k[I]),y:parseFloat(k[I+1])});return w},getCSSRules:function(k){var w=k.getElementsByTagName("style"),I,_,F={},z;for(I=0,_=w.length;I<_;I++){var q=w[I].textContent;q=q.replace(/\/\*[\s\S]*?\*\//g,""),q.trim()!==""&&(z=q.split("}"),z=z.filter(function(ee){return ee.trim()}),z.forEach(function(ee){var O=ee.split("{"),B={},V=O[1].trim(),$=V.split(";").filter(function(ce){return ce.trim()});for(I=0,_=$.length;I<_;I++){var te=$[I].split(":"),L=te[0].trim(),Z=te[1].trim();B[L]=Z}ee=O[0].trim(),ee.split(",").forEach(function(ce){ce=ce.replace(/^svg/i,"").trim(),ce!==""&&(F[ce]?e.util.object.extend(F[ce],B):F[ce]=e.util.object.clone(B))})}))}return F},loadSVGFromURL:function(k,w,I,_){k=k.replace(/^\n\s*/,"").trim(),new e.util.request(k,{method:"get",onComplete:F});function F(z){var q=z.responseXML;if(!q||!q.documentElement)return w&&w(null),!1;e.parseSVGDocument(q.documentElement,function(ee,O,B,V){w&&w(ee,O,B,V)},I,_)}},loadSVGFromString:function(k,w,I,_){var F=new e.window.DOMParser,z=F.parseFromString(k.trim(),"text/xml");e.parseSVGDocument(z.documentElement,function(q,ee,O,B){w(q,ee,O,B)},I,_)}})})(ne);g.ElementsParser=function(t,e,n,o,r,i){this.elements=t,this.callback=e,this.options=n,this.reviver=o,this.svgUid=n&&n.svgUid||0,this.parsingOptions=r,this.regexUrl=/^url\(['"]?#([^'"]+)['"]?\)/g,this.doc=i};(function(t){t.parse=function(){this.instances=new Array(this.elements.length),this.numElements=this.elements.length,this.createObjects()},t.createObjects=function(){var e=this;this.elements.forEach(function(n,o){n.setAttribute("svgUid",e.svgUid),e.createObject(n,o)})},t.findTag=function(e){return g[g.util.string.capitalize(e.tagName.replace("svg:",""))]},t.createObject=function(e,n){var o=this.findTag(e);if(o&&o.fromElement)try{o.fromElement(e,this.createCallback(n,e),this.options)}catch(r){g.log(r)}else this.checkIfDone()},t.createCallback=function(e,n){var o=this;return function(r){var i;o.resolveGradient(r,n,"fill"),o.resolveGradient(r,n,"stroke"),r instanceof g.Image&&r._originalElement&&(i=r.parsePreserveAspectRatioAttribute(n)),r._removeTransformMatrix(i),o.resolveClipPath(r,n),o.reviver&&o.reviver(n,r),o.instances[e]=r,o.checkIfDone()}},t.extractPropertyDefinition=function(e,n,o){var r=e[n],i=this.regexUrl;if(i.test(r)){i.lastIndex=0;var a=i.exec(r)[1];return i.lastIndex=0,g[o][this.svgUid][a]}},t.resolveGradient=function(e,n,o){var r=this.extractPropertyDefinition(e,o,"gradientDefs");if(r){var i=n.getAttribute(o+"-opacity"),a=g.Gradient.fromElement(r,e,i,this.options);e.set(o,a)}},t.createClipPathCallback=function(e,n){return function(o){o._removeTransformMatrix(),o.fillRule=o.clipRule,n.push(o)}},t.resolveClipPath=function(e,n){var o=this.extractPropertyDefinition(e,"clipPath","clipPaths"),r,i,a,s,c,l;if(o){s=[],a=g.util.invertTransform(e.calcTransformMatrix());for(var u=o[0].parentNode,d=n;d.parentNode&&d.getAttribute("clip-path")!==e.clipPath;)d=d.parentNode;d.parentNode.appendChild(u);for(var f=0;f<o.length;f++)r=o[f],i=this.findTag(r),i.fromElement(r,this.createClipPathCallback(e,s),this.options);s.length===1?o=s[0]:o=new g.Group(s),c=g.util.multiplyTransformMatrices(a,o.calcTransformMatrix()),o.clipPath&&this.resolveClipPath(o,d);var l=g.util.qrDecompose(c);o.flipX=!1,o.flipY=!1,o.set("scaleX",l.scaleX),o.set("scaleY",l.scaleY),o.angle=l.angle,o.skewX=l.skewX,o.skewY=0,o.setPositionByOrigin({x:l.translateX,y:l.translateY},"center","center"),e.clipPath=o}else delete e.clipPath},t.checkIfDone=function(){--this.numElements===0&&(this.instances=this.instances.filter(function(e){return e!=null}),this.callback(this.instances,this.elements))}})(g.ElementsParser.prototype);(function(t){"use strict";var e=t.fabric||(t.fabric={});if(e.Point){e.warn("fabric.Point is already defined");return}e.Point=n;function n(o,r){this.x=o,this.y=r}n.prototype={type:"point",constructor:n,add:function(o){return new n(this.x+o.x,this.y+o.y)},addEquals:function(o){return this.x+=o.x,this.y+=o.y,this},scalarAdd:function(o){return new n(this.x+o,this.y+o)},scalarAddEquals:function(o){return this.x+=o,this.y+=o,this},subtract:function(o){return new n(this.x-o.x,this.y-o.y)},subtractEquals:function(o){return this.x-=o.x,this.y-=o.y,this},scalarSubtract:function(o){return new n(this.x-o,this.y-o)},scalarSubtractEquals:function(o){return this.x-=o,this.y-=o,this},multiply:function(o){return new n(this.x*o,this.y*o)},multiplyEquals:function(o){return this.x*=o,this.y*=o,this},divide:function(o){return new n(this.x/o,this.y/o)},divideEquals:function(o){return this.x/=o,this.y/=o,this},eq:function(o){return this.x===o.x&&this.y===o.y},lt:function(o){return this.x<o.x&&this.y<o.y},lte:function(o){return this.x<=o.x&&this.y<=o.y},gt:function(o){return this.x>o.x&&this.y>o.y},gte:function(o){return this.x>=o.x&&this.y>=o.y},lerp:function(o,r){return typeof r>"u"&&(r=.5),r=Math.max(Math.min(1,r),0),new n(this.x+(o.x-this.x)*r,this.y+(o.y-this.y)*r)},distanceFrom:function(o){var r=this.x-o.x,i=this.y-o.y;return Math.sqrt(r*r+i*i)},midPointFrom:function(o){return this.lerp(o)},min:function(o){return new n(Math.min(this.x,o.x),Math.min(this.y,o.y))},max:function(o){return new n(Math.max(this.x,o.x),Math.max(this.y,o.y))},toString:function(){return this.x+","+this.y},setXY:function(o,r){return this.x=o,this.y=r,this},setX:function(o){return this.x=o,this},setY:function(o){return this.y=o,this},setFromPoint:function(o){return this.x=o.x,this.y=o.y,this},swap:function(o){var r=this.x,i=this.y;this.x=o.x,this.y=o.y,o.x=r,o.y=i},clone:function(){return new n(this.x,this.y)}}})(ne);(function(t){"use strict";var e=t.fabric||(t.fabric={});if(e.Intersection){e.warn("fabric.Intersection is already defined");return}function n(o){this.status=o,this.points=[]}e.Intersection=n,e.Intersection.prototype={constructor:n,appendPoint:function(o){return this.points.push(o),this},appendPoints:function(o){return this.points=this.points.concat(o),this}},e.Intersection.intersectLineLine=function(o,r,i,a){var s,c=(a.x-i.x)*(o.y-i.y)-(a.y-i.y)*(o.x-i.x),l=(r.x-o.x)*(o.y-i.y)-(r.y-o.y)*(o.x-i.x),u=(a.y-i.y)*(r.x-o.x)-(a.x-i.x)*(r.y-o.y);if(u!==0){var d=c/u,f=l/u;0<=d&&d<=1&&0<=f&&f<=1?(s=new n("Intersection"),s.appendPoint(new e.Point(o.x+d*(r.x-o.x),o.y+d*(r.y-o.y)))):s=new n}else c===0||l===0?s=new n("Coincident"):s=new n("Parallel");return s},e.Intersection.intersectLinePolygon=function(o,r,i){var a=new n,s=i.length,c,l,u,d;for(d=0;d<s;d++)c=i[d],l=i[(d+1)%s],u=n.intersectLineLine(o,r,c,l),a.appendPoints(u.points);return a.points.length>0&&(a.status="Intersection"),a},e.Intersection.intersectPolygonPolygon=function(o,r){var i=new n,a=o.length,s;for(s=0;s<a;s++){var c=o[s],l=o[(s+1)%a],u=n.intersectLinePolygon(c,l,r);i.appendPoints(u.points)}return i.points.length>0&&(i.status="Intersection"),i},e.Intersection.intersectPolygonRectangle=function(o,r,i){var a=r.min(i),s=r.max(i),c=new e.Point(s.x,a.y),l=new e.Point(a.x,s.y),u=n.intersectLinePolygon(a,c,o),d=n.intersectLinePolygon(c,s,o),f=n.intersectLinePolygon(s,l,o),p=n.intersectLinePolygon(l,a,o),m=new n;return m.appendPoints(u.points),m.appendPoints(d.points),m.appendPoints(f.points),m.appendPoints(p.points),m.points.length>0&&(m.status="Intersection"),m}})(ne);(function(t){"use strict";var e=t.fabric||(t.fabric={});if(e.Color){e.warn("fabric.Color is already defined.");return}function n(r){r?this._tryParsingColor(r):this.setSource([0,0,0,1])}e.Color=n,e.Color.prototype={_tryParsingColor:function(r){var i;r in n.colorNameMap&&(r=n.colorNameMap[r]),r==="transparent"&&(i=[255,255,255,0]),i||(i=n.sourceFromHex(r)),i||(i=n.sourceFromRgb(r)),i||(i=n.sourceFromHsl(r)),i||(i=[0,0,0,1]),i&&this.setSource(i)},_rgbToHsl:function(r,i,a){r/=255,i/=255,a/=255;var s,c,l,u=e.util.array.max([r,i,a]),d=e.util.array.min([r,i,a]);if(l=(u+d)/2,u===d)s=c=0;else{var f=u-d;switch(c=l>.5?f/(2-u-d):f/(u+d),u){case r:s=(i-a)/f+(i<a?6:0);break;case i:s=(a-r)/f+2;break;case a:s=(r-i)/f+4;break}s/=6}return[Math.round(s*360),Math.round(c*100),Math.round(l*100)]},getSource:function(){return this._source},setSource:function(r){this._source=r},toRgb:function(){var r=this.getSource();return"rgb("+r[0]+","+r[1]+","+r[2]+")"},toRgba:function(){var r=this.getSource();return"rgba("+r[0]+","+r[1]+","+r[2]+","+r[3]+")"},toHsl:function(){var r=this.getSource(),i=this._rgbToHsl(r[0],r[1],r[2]);return"hsl("+i[0]+","+i[1]+"%,"+i[2]+"%)"},toHsla:function(){var r=this.getSource(),i=this._rgbToHsl(r[0],r[1],r[2]);return"hsla("+i[0]+","+i[1]+"%,"+i[2]+"%,"+r[3]+")"},toHex:function(){var r=this.getSource(),i,a,s;return i=r[0].toString(16),i=i.length===1?"0"+i:i,a=r[1].toString(16),a=a.length===1?"0"+a:a,s=r[2].toString(16),s=s.length===1?"0"+s:s,i.toUpperCase()+a.toUpperCase()+s.toUpperCase()},toHexa:function(){var r=this.getSource(),i;return i=Math.round(r[3]*255),i=i.toString(16),i=i.length===1?"0"+i:i,this.toHex()+i.toUpperCase()},getAlpha:function(){return this.getSource()[3]},setAlpha:function(r){var i=this.getSource();return i[3]=r,this.setSource(i),this},toGrayscale:function(){var r=this.getSource(),i=parseInt((r[0]*.3+r[1]*.59+r[2]*.11).toFixed(0),10),a=r[3];return this.setSource([i,i,i,a]),this},toBlackWhite:function(r){var i=this.getSource(),a=(i[0]*.3+i[1]*.59+i[2]*.11).toFixed(0),s=i[3];return r=r||127,a=Number(a)<Number(r)?0:255,this.setSource([a,a,a,s]),this},overlayWith:function(r){r instanceof n||(r=new n(r));var i=[],a=this.getAlpha(),s=.5,c=this.getSource(),l=r.getSource(),u;for(u=0;u<3;u++)i.push(Math.round(c[u]*(1-s)+l[u]*s));return i[3]=a,this.setSource(i),this}},e.Color.reRGBa=/^rgba?\(\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*(?:\s*,\s*((?:\d*\.?\d+)?)\s*)?\)$/i,e.Color.reHSLa=/^hsla?\(\s*(\d{1,3})\s*,\s*(\d{1,3}\%)\s*,\s*(\d{1,3}\%)\s*(?:\s*,\s*(\d+(?:\.\d+)?)\s*)?\)$/i,e.Color.reHex=/^#?([0-9a-f]{8}|[0-9a-f]{6}|[0-9a-f]{4}|[0-9a-f]{3})$/i,e.Color.colorNameMap={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#00FFFF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000000",blanchedalmond:"#FFEBCD",blue:"#0000FF",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#00FFFF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",darkgreen:"#006400",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#FF00FF",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",lightgreen:"#90EE90",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#00FF00",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#FF00FF",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#663399",red:"#FF0000",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFFFFF",whitesmoke:"#F5F5F5",yellow:"#FFFF00",yellowgreen:"#9ACD32"};function o(r,i,a){return a<0&&(a+=1),a>1&&(a-=1),a<1/6?r+(i-r)*6*a:a<1/2?i:a<2/3?r+(i-r)*(2/3-a)*6:r}e.Color.fromRgb=function(r){return n.fromSource(n.sourceFromRgb(r))},e.Color.sourceFromRgb=function(r){var i=r.match(n.reRGBa);if(i){var a=parseInt(i[1],10)/(/%$/.test(i[1])?100:1)*(/%$/.test(i[1])?255:1),s=parseInt(i[2],10)/(/%$/.test(i[2])?100:1)*(/%$/.test(i[2])?255:1),c=parseInt(i[3],10)/(/%$/.test(i[3])?100:1)*(/%$/.test(i[3])?255:1);return[parseInt(a,10),parseInt(s,10),parseInt(c,10),i[4]?parseFloat(i[4]):1]}},e.Color.fromRgba=n.fromRgb,e.Color.fromHsl=function(r){return n.fromSource(n.sourceFromHsl(r))},e.Color.sourceFromHsl=function(r){var i=r.match(n.reHSLa);if(i){var a=(parseFloat(i[1])%360+360)%360/360,s=parseFloat(i[2])/(/%$/.test(i[2])?100:1),c=parseFloat(i[3])/(/%$/.test(i[3])?100:1),l,u,d;if(s===0)l=u=d=c;else{var f=c<=.5?c*(s+1):c+s-c*s,p=c*2-f;l=o(p,f,a+1/3),u=o(p,f,a),d=o(p,f,a-1/3)}return[Math.round(l*255),Math.round(u*255),Math.round(d*255),i[4]?parseFloat(i[4]):1]}},e.Color.fromHsla=n.fromHsl,e.Color.fromHex=function(r){return n.fromSource(n.sourceFromHex(r))},e.Color.sourceFromHex=function(r){if(r.match(n.reHex)){var i=r.slice(r.indexOf("#")+1),a=i.length===3||i.length===4,s=i.length===8||i.length===4,c=a?i.charAt(0)+i.charAt(0):i.substring(0,2),l=a?i.charAt(1)+i.charAt(1):i.substring(2,4),u=a?i.charAt(2)+i.charAt(2):i.substring(4,6),d=s?a?i.charAt(3)+i.charAt(3):i.substring(6,8):"FF";return[parseInt(c,16),parseInt(l,16),parseInt(u,16),parseFloat((parseInt(d,16)/255).toFixed(2))]}},e.Color.fromSource=function(r){var i=new n;return i.setSource(r),i}})(ne);(function(t){"use strict";var e=t.fabric||(t.fabric={}),n=["e","se","s","sw","w","nw","n","ne","e"],o=["ns","nesw","ew","nwse"],r={},i="left",a="top",s="right",c="bottom",l="center",u={top:c,bottom:a,left:s,right:i,center:l},d=e.util.radiansToDegrees,f=Math.sign||function(B){return(B>0)-(B<0)||+B};function p(B,V){var $=B.angle+d(Math.atan2(V.y,V.x))+360;return Math.round($%360/45)}function m(B,V){var $=V.transform.target,te=$.canvas,L=e.util.object.clone(V);L.target=$,te&&te.fire("object:"+B,L),$.fire(B,V)}function h(B,V){var $=V.canvas,te=$.uniScaleKey,L=B[te];return $.uniformScaling&&!L||!$.uniformScaling&&L}function b(B){return B.originX===l&&B.originY===l}function x(B,V,$){var te=B.lockScalingX,L=B.lockScalingY;return!!(te&&L||!V&&(te||L)&&$||te&&V==="x"||L&&V==="y")}function y(B,V,$){var te="not-allowed",L=h(B,$),Z="";if(V.x!==0&&V.y===0?Z="x":V.x===0&&V.y!==0&&(Z="y"),x($,Z,L))return te;var ce=p($,V);return n[ce]+"-resize"}function M(B,V,$){var te="not-allowed";if(V.x!==0&&$.lockSkewingY||V.y!==0&&$.lockSkewingX)return te;var L=p($,V)%4;return o[L]+"-resize"}function E(B,V,$){return B[$.canvas.altActionKey]?r.skewCursorStyleHandler(B,V,$):r.scaleCursorStyleHandler(B,V,$)}function C(B,V,$){var te=B[$.canvas.altActionKey];if(V.x===0)return te?"skewX":"scaleY";if(V.y===0)return te?"skewY":"scaleX"}function j(B,V,$){return $.lockRotation?"not-allowed":V.cursorStyle}function P(B,V,$,te){return{e:B,transform:V,pointer:{x:$,y:te}}}function D(B){return function(V,$,te,L){var Z=$.target,ce=Z.getCenterPoint(),ke=Z.translateToOriginPoint(ce,$.originX,$.originY),ve=B(V,$,te,L);return Z.setPositionByOrigin(ke,$.originX,$.originY),ve}}function N(B,V){return function($,te,L,Z){var ce=V($,te,L,Z);return ce&&m(B,P($,te,L,Z)),ce}}function S(B,V,$,te,L){var Z=B.target,ce=Z.controls[B.corner],ke=Z.canvas.getZoom(),ve=Z.padding/ke,re=Z.toLocalPoint(new e.Point(te,L),V,$);return re.x>=ve&&(re.x-=ve),re.x<=-ve&&(re.x+=ve),re.y>=ve&&(re.y-=ve),re.y<=ve&&(re.y+=ve),re.x-=ce.offsetX,re.y-=ce.offsetY,re}function G(B){return B.flipX!==B.flipY}function v(B,V,$,te,L){if(B[V]!==0){var Z=B._getTransformedDimensions()[te],ce=L/Z*B[$];B.set($,ce)}}function T(B,V,$,te){var L=V.target,Z=L._getTransformedDimensions(0,L.skewY),ce=S(V,V.originX,V.originY,$,te),ke=Math.abs(ce.x*2)-Z.x,ve=L.skewX,re;ke<2?re=0:(re=d(Math.atan2(ke/L.scaleX,Z.y/L.scaleY)),V.originX===i&&V.originY===c&&(re=-re),V.originX===s&&V.originY===a&&(re=-re),G(L)&&(re=-re));var we=ve!==re;if(we){var Te=L._getTransformedDimensions().y;L.set("skewX",re),v(L,"skewY","scaleY","y",Te)}return we}function R(B,V,$,te){var L=V.target,Z=L._getTransformedDimensions(L.skewX,0),ce=S(V,V.originX,V.originY,$,te),ke=Math.abs(ce.y*2)-Z.y,ve=L.skewY,re;ke<2?re=0:(re=d(Math.atan2(ke/L.scaleY,Z.x/L.scaleX)),V.originX===i&&V.originY===c&&(re=-re),V.originX===s&&V.originY===a&&(re=-re),G(L)&&(re=-re));var we=ve!==re;if(we){var Te=L._getTransformedDimensions().x;L.set("skewY",re),v(L,"skewX","scaleX","x",Te)}return we}function A(B,V,$,te){var L=V.target,Z=L.skewX,ce,ke=V.originY;if(L.lockSkewingX)return!1;if(Z===0){var ve=S(V,l,l,$,te);ve.x>0?ce=i:ce=s}else Z>0&&(ce=ke===a?i:s),Z<0&&(ce=ke===a?s:i),G(L)&&(ce=ce===i?s:i);V.originX=ce;var re=N("skewing",D(T));return re(B,V,$,te)}function U(B,V,$,te){var L=V.target,Z=L.skewY,ce,ke=V.originX;if(L.lockSkewingY)return!1;if(Z===0){var ve=S(V,l,l,$,te);ve.y>0?ce=a:ce=c}else Z>0&&(ce=ke===i?a:c),Z<0&&(ce=ke===i?c:a),G(L)&&(ce=ce===a?c:a);V.originY=ce;var re=N("skewing",D(R));return re(B,V,$,te)}function k(B,V,$,te){var L=V,Z=L.target,ce=Z.translateToOriginPoint(Z.getCenterPoint(),L.originX,L.originY);if(Z.lockRotation)return!1;var ke=Math.atan2(L.ey-ce.y,L.ex-ce.x),ve=Math.atan2(te-ce.y,$-ce.x),re=d(ve-ke+L.theta),we=!0;if(Z.snapAngle>0){var Te=Z.snapAngle,Ae=Z.snapThreshold||Te,je=Math.ceil(re/Te)*Te,Re=Math.floor(re/Te)*Te;Math.abs(re-Re)<Ae?re=Re:Math.abs(re-je)<Ae&&(re=je)}return re<0&&(re=360+re),re%=360,we=Z.angle!==re,Z.angle=re,we}function w(B,V,$,te,L){L=L||{};var Z=V.target,ce=Z.lockScalingX,ke=Z.lockScalingY,ve=L.by,re,we,Te,Ae,je=h(B,Z),Re=x(Z,ve,je),et,Ge,_t=V.gestureScale;if(Re)return!1;if(_t)we=V.scaleX*_t,Te=V.scaleY*_t;else{if(re=S(V,V.originX,V.originY,$,te),et=ve!=="y"?f(re.x):1,Ge=ve!=="x"?f(re.y):1,V.signX||(V.signX=et),V.signY||(V.signY=Ge),Z.lockScalingFlip&&(V.signX!==et||V.signY!==Ge))return!1;if(Ae=Z._getTransformedDimensions(),je&&!ve){var kt=Math.abs(re.x)+Math.abs(re.y),ct=V.original,Ln=Math.abs(Ae.x*ct.scaleX/Z.scaleX)+Math.abs(Ae.y*ct.scaleY/Z.scaleY),xn=kt/Ln;we=ct.scaleX*xn,Te=ct.scaleY*xn}else we=Math.abs(re.x*Z.scaleX/Ae.x),Te=Math.abs(re.y*Z.scaleY/Ae.y);b(V)&&(we*=2,Te*=2),V.signX!==et&&ve!=="y"&&(V.originX=u[V.originX],we*=-1,V.signX=et),V.signY!==Ge&&ve!=="x"&&(V.originY=u[V.originY],Te*=-1,V.signY=Ge)}var tn=Z.scaleX,Er=Z.scaleY;return ve?(ve==="x"&&Z.set("scaleX",we),ve==="y"&&Z.set("scaleY",Te)):(!ce&&Z.set("scaleX",we),!ke&&Z.set("scaleY",Te)),tn!==Z.scaleX||Er!==Z.scaleY}function I(B,V,$,te){return w(B,V,$,te)}function _(B,V,$,te){return w(B,V,$,te,{by:"x"})}function F(B,V,$,te){return w(B,V,$,te,{by:"y"})}function z(B,V,$,te){return B[V.target.canvas.altActionKey]?r.skewHandlerX(B,V,$,te):r.scalingY(B,V,$,te)}function q(B,V,$,te){return B[V.target.canvas.altActionKey]?r.skewHandlerY(B,V,$,te):r.scalingX(B,V,$,te)}function ee(B,V,$,te){var L=V.target,Z=S(V,V.originX,V.originY,$,te),ce=L.strokeWidth/(L.strokeUniform?L.scaleX:1),ke=b(V)?2:1,ve=L.width,re=Math.abs(Z.x*ke/L.scaleX)-ce;return L.set("width",Math.max(re,0)),ve!==re}function O(B,V,$,te){var L=V.target,Z=$-V.offsetX,ce=te-V.offsetY,ke=!L.get("lockMovementX")&&L.left!==Z,ve=!L.get("lockMovementY")&&L.top!==ce;return ke&&L.set("left",Z),ve&&L.set("top",ce),(ke||ve)&&m("moving",P(B,V,$,te)),ke||ve}r.scaleCursorStyleHandler=y,r.skewCursorStyleHandler=M,r.scaleSkewCursorStyleHandler=E,r.rotationWithSnapping=N("rotating",D(k)),r.scalingEqually=N("scaling",D(I)),r.scalingX=N("scaling",D(_)),r.scalingY=N("scaling",D(F)),r.scalingYOrSkewingX=z,r.scalingXOrSkewingY=q,r.changeWidth=N("resizing",D(ee)),r.skewHandlerX=A,r.skewHandlerY=U,r.dragHandler=O,r.scaleOrSkewActionName=C,r.rotationStyleHandler=j,r.fireEvent=m,r.wrapWithFixedAnchor=D,r.wrapWithFireEvent=N,r.getLocalPoint=S,e.controlsUtils=r})(ne);(function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.util.degreesToRadians,o=e.controlsUtils;function r(a,s,c,l,u){l=l||{};var d=this.sizeX||l.cornerSize||u.cornerSize,f=this.sizeY||l.cornerSize||u.cornerSize,p=typeof l.transparentCorners<"u"?l.transparentCorners:u.transparentCorners,m=p?"stroke":"fill",h=!p&&(l.cornerStrokeColor||u.cornerStrokeColor),b=s,x=c,y;a.save(),a.fillStyle=l.cornerColor||u.cornerColor,a.strokeStyle=l.cornerStrokeColor||u.cornerStrokeColor,d>f?(y=d,a.scale(1,f/d),x=c*d/f):f>d?(y=f,a.scale(d/f,1),b=s*f/d):y=d,a.lineWidth=1,a.beginPath(),a.arc(b,x,y/2,0,2*Math.PI,!1),a[m](),h&&a.stroke(),a.restore()}function i(a,s,c,l,u){l=l||{};var d=this.sizeX||l.cornerSize||u.cornerSize,f=this.sizeY||l.cornerSize||u.cornerSize,p=typeof l.transparentCorners<"u"?l.transparentCorners:u.transparentCorners,m=p?"stroke":"fill",h=!p&&(l.cornerStrokeColor||u.cornerStrokeColor),b=d/2,x=f/2;a.save(),a.fillStyle=l.cornerColor||u.cornerColor,a.strokeStyle=l.cornerStrokeColor||u.cornerStrokeColor,a.lineWidth=1,a.translate(s,c),a.rotate(n(u.angle)),a[m+"Rect"](-b,-x,d,f),h&&a.strokeRect(-b,-x,d,f),a.restore()}o.renderCircleControl=r,o.renderSquareControl=i})(ne);(function(t){"use strict";var e=t.fabric||(t.fabric={});function n(o){for(var r in o)this[r]=o[r]}e.Control=n,e.Control.prototype={visible:!0,actionName:"scale",angle:0,x:0,y:0,offsetX:0,offsetY:0,sizeX:null,sizeY:null,touchSizeX:null,touchSizeY:null,cursorStyle:"crosshair",withConnection:!1,actionHandler:function(){},mouseDownHandler:function(){},mouseUpHandler:function(){},getActionHandler:function(){return this.actionHandler},getMouseDownHandler:function(){return this.mouseDownHandler},getMouseUpHandler:function(){return this.mouseUpHandler},cursorStyleHandler:function(o,r){return r.cursorStyle},getActionName:function(o,r){return r.actionName},getVisibility:function(o,r){var i=o._controlsVisibility;return i&&typeof i[r]<"u"?i[r]:this.visible},setVisibility:function(o){this.visible=o},positionHandler:function(o,r){var i=e.util.transformPoint({x:this.x*o.x+this.offsetX,y:this.y*o.y+this.offsetY},r);return i},calcCornerCoords:function(o,r,i,a,s){var c,l,u,d,f=s?this.touchSizeX:this.sizeX,p=s?this.touchSizeY:this.sizeY;if(f&&p&&f!==p){var m=Math.atan2(p,f),h=Math.sqrt(f*f+p*p)/2,b=m-e.util.degreesToRadians(o),x=Math.PI/2-m-e.util.degreesToRadians(o);c=h*e.util.cos(b),l=h*e.util.sin(b),u=h*e.util.cos(x),d=h*e.util.sin(x)}else{var y=f&&p?f:r;h=y*.7071067812;var b=e.util.degreesToRadians(45-o);c=u=h*e.util.cos(b),l=d=h*e.util.sin(b)}return{tl:{x:i-d,y:a-u},tr:{x:i+c,y:a-l},bl:{x:i-c,y:a+l},br:{x:i+d,y:a+u}}},render:function(o,r,i,a,s){switch(a=a||{},a.cornerStyle||s.cornerStyle){case"circle":e.controlsUtils.renderCircleControl.call(this,o,r,i,a,s);break;default:e.controlsUtils.renderSquareControl.call(this,o,r,i,a,s)}}}})(ne);(function(){function t(i,a){var s=i.getAttribute("style"),c=i.getAttribute("offset")||0,l,u,d,f;if(c=parseFloat(c)/(/%$/.test(c)?100:1),c=c<0?0:c>1?1:c,s){var p=s.split(/\s*;\s*/);for(p[p.length-1]===""&&p.pop(),f=p.length;f--;){var m=p[f].split(/\s*:\s*/),h=m[0].trim(),b=m[1].trim();h==="stop-color"?l=b:h==="stop-opacity"&&(d=b)}}return l||(l=i.getAttribute("stop-color")||"rgb(0,0,0)"),d||(d=i.getAttribute("stop-opacity")),l=new g.Color(l),u=l.getAlpha(),d=isNaN(parseFloat(d))?1:parseFloat(d),d*=u*a,{offset:c,color:l.toRgb(),opacity:d}}function e(i){return{x1:i.getAttribute("x1")||0,y1:i.getAttribute("y1")||0,x2:i.getAttribute("x2")||"100%",y2:i.getAttribute("y2")||0}}function n(i){return{x1:i.getAttribute("fx")||i.getAttribute("cx")||"50%",y1:i.getAttribute("fy")||i.getAttribute("cy")||"50%",r1:0,x2:i.getAttribute("cx")||"50%",y2:i.getAttribute("cy")||"50%",r2:i.getAttribute("r")||"50%"}}var o=g.util.object.clone;g.Gradient=g.util.createClass({offsetX:0,offsetY:0,gradientTransform:null,gradientUnits:"pixels",type:"linear",initialize:function(i){i||(i={}),i.coords||(i.coords={});var a,s=this;Object.keys(i).forEach(function(c){s[c]=i[c]}),this.id?this.id+="_"+g.Object.__uid++:this.id=g.Object.__uid++,a={x1:i.coords.x1||0,y1:i.coords.y1||0,x2:i.coords.x2||0,y2:i.coords.y2||0},this.type==="radial"&&(a.r1=i.coords.r1||0,a.r2=i.coords.r2||0),this.coords=a,this.colorStops=i.colorStops.slice()},addColorStop:function(i){for(var a in i){var s=new g.Color(i[a]);this.colorStops.push({offset:parseFloat(a),color:s.toRgb(),opacity:s.getAlpha()})}return this},toObject:function(i){var a={type:this.type,coords:this.coords,colorStops:this.colorStops,offsetX:this.offsetX,offsetY:this.offsetY,gradientUnits:this.gradientUnits,gradientTransform:this.gradientTransform?this.gradientTransform.concat():this.gradientTransform};return g.util.populateWithProperties(this,a,i),a},toSVG:function(i,u){var s=o(this.coords,!0),c,l,u=u||{},d,f,p=o(this.colorStops,!0),m=s.r1>s.r2,h=this.gradientTransform?this.gradientTransform.concat():g.iMatrix.concat(),b=-this.offsetX,x=-this.offsetY,y=!!u.additionalTransform,M=this.gradientUnits==="pixels"?"userSpaceOnUse":"objectBoundingBox";if(p.sort(function(D,N){return D.offset-N.offset}),M==="objectBoundingBox"?(b/=i.width,x/=i.height):(b+=i.width/2,x+=i.height/2),i.type==="path"&&this.gradientUnits!=="percentage"&&(b-=i.pathOffset.x,x-=i.pathOffset.y),h[4]-=b,h[5]-=x,f='id="SVGID_'+this.id+'" gradientUnits="'+M+'"',f+=' gradientTransform="'+(y?u.additionalTransform+" ":"")+g.util.matrixToSVG(h)+'" ',this.type==="linear"?d=["<linearGradient ",f,' x1="',s.x1,'" y1="',s.y1,'" x2="',s.x2,'" y2="',s.y2,`">
`]:this.type==="radial"&&(d=["<radialGradient ",f,' cx="',m?s.x1:s.x2,'" cy="',m?s.y1:s.y2,'" r="',m?s.r1:s.r2,'" fx="',m?s.x2:s.x1,'" fy="',m?s.y2:s.y1,`">
`]),this.type==="radial"){if(m)for(p=p.concat(),p.reverse(),c=0,l=p.length;c<l;c++)p[c].offset=1-p[c].offset;var E=Math.min(s.r1,s.r2);if(E>0){var C=Math.max(s.r1,s.r2),j=E/C;for(c=0,l=p.length;c<l;c++)p[c].offset+=j*(1-p[c].offset)}}for(c=0,l=p.length;c<l;c++){var P=p[c];d.push("<stop ",'offset="',P.offset*100+"%",'" style="stop-color:',P.color,typeof P.opacity<"u"?";stop-opacity: "+P.opacity:";",`"/>
`)}return d.push(this.type==="linear"?`</linearGradient>
`:`</radialGradient>
`),d.join("")},toLive:function(i){var a,s=g.util.object.clone(this.coords),c,l;if(this.type){for(this.type==="linear"?a=i.createLinearGradient(s.x1,s.y1,s.x2,s.y2):this.type==="radial"&&(a=i.createRadialGradient(s.x1,s.y1,s.r1,s.x2,s.y2,s.r2)),c=0,l=this.colorStops.length;c<l;c++){var u=this.colorStops[c].color,d=this.colorStops[c].opacity,f=this.colorStops[c].offset;typeof d<"u"&&(u=new g.Color(u).setAlpha(d).toRgba()),a.addColorStop(f,u)}return a}}}),g.util.object.extend(g.Gradient,{fromElement:function(i,a,s,c){var l=parseFloat(s)/(/%$/.test(s)?100:1);l=l<0?0:l>1?1:l,isNaN(l)&&(l=1);var u=i.getElementsByTagName("stop"),d,f=i.getAttribute("gradientUnits")==="userSpaceOnUse"?"pixels":"percentage",p=i.getAttribute("gradientTransform")||"",m=[],h,b,x=0,y=0,M;for(i.nodeName==="linearGradient"||i.nodeName==="LINEARGRADIENT"?(d="linear",h=e(i)):(d="radial",h=n(i)),b=u.length;b--;)m.push(t(u[b],l));M=g.parseTransformAttribute(p),r(a,h,c,f),f==="pixels"&&(x=-a.left,y=-a.top);var E=new g.Gradient({id:i.getAttribute("id"),type:d,coords:h,colorStops:m,gradientUnits:f,gradientTransform:M,offsetX:x,offsetY:y});return E}});function r(i,a,s,c){var l,u;Object.keys(a).forEach(function(d){l=a[d],l==="Infinity"?u=1:l==="-Infinity"?u=0:(u=parseFloat(a[d],10),typeof l=="string"&&/^(\d+\.\d+)%|(\d+)%$/.test(l)&&(u*=.01,c==="pixels"&&((d==="x1"||d==="x2"||d==="r2")&&(u*=s.viewBoxWidth||s.width),(d==="y1"||d==="y2")&&(u*=s.viewBoxHeight||s.height)))),a[d]=u})}})();(function(){"use strict";var t=g.util.toFixed;g.Pattern=g.util.createClass({repeat:"repeat",offsetX:0,offsetY:0,crossOrigin:"",patternTransform:null,initialize:function(e,n){if(e||(e={}),this.id=g.Object.__uid++,this.setOptions(e),!e.source||e.source&&typeof e.source!="string"){n&&n(this);return}else{var o=this;this.source=g.util.createImage(),g.util.loadImage(e.source,function(r,i){o.source=r,n&&n(o,i)},null,this.crossOrigin)}},toObject:function(e){var n=g.Object.NUM_FRACTION_DIGITS,o,r;return typeof this.source.src=="string"?o=this.source.src:typeof this.source=="object"&&this.source.toDataURL&&(o=this.source.toDataURL()),r={type:"pattern",source:o,repeat:this.repeat,crossOrigin:this.crossOrigin,offsetX:t(this.offsetX,n),offsetY:t(this.offsetY,n),patternTransform:this.patternTransform?this.patternTransform.concat():null},g.util.populateWithProperties(this,r,e),r},toSVG:function(e){var n=typeof this.source=="function"?this.source():this.source,o=n.width/e.width,r=n.height/e.height,i=this.offsetX/e.width,a=this.offsetY/e.height,s="";return(this.repeat==="repeat-x"||this.repeat==="no-repeat")&&(r=1,a&&(r+=Math.abs(a))),(this.repeat==="repeat-y"||this.repeat==="no-repeat")&&(o=1,i&&(o+=Math.abs(i))),n.src?s=n.src:n.toDataURL&&(s=n.toDataURL()),'<pattern id="SVGID_'+this.id+'" x="'+i+'" y="'+a+'" width="'+o+'" height="'+r+`">
<image x="0" y="0" width="`+n.width+'" height="'+n.height+'" xlink:href="'+s+`"></image>
</pattern>
`},setOptions:function(e){for(var n in e)this[n]=e[n]},toLive:function(e){var n=this.source;return!n||typeof n.src<"u"&&(!n.complete||n.naturalWidth===0||n.naturalHeight===0)?"":e.createPattern(n,this.repeat)}})})();(function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.util.toFixed;if(e.Shadow){e.warn("fabric.Shadow is already defined.");return}e.Shadow=e.util.createClass({color:"rgb(0,0,0)",blur:0,offsetX:0,offsetY:0,affectStroke:!1,includeDefaultValues:!0,nonScaling:!1,initialize:function(o){typeof o=="string"&&(o=this._parseShadow(o));for(var r in o)this[r]=o[r];this.id=e.Object.__uid++},_parseShadow:function(o){var r=o.trim(),i=e.Shadow.reOffsetsAndBlur.exec(r)||[],a=r.replace(e.Shadow.reOffsetsAndBlur,"")||"rgb(0,0,0)";return{color:a.trim(),offsetX:parseFloat(i[1],10)||0,offsetY:parseFloat(i[2],10)||0,blur:parseFloat(i[3],10)||0}},toString:function(){return[this.offsetX,this.offsetY,this.blur,this.color].join("px ")},toSVG:function(o){var r=40,i=40,a=e.Object.NUM_FRACTION_DIGITS,s=e.util.rotateVector({x:this.offsetX,y:this.offsetY},e.util.degreesToRadians(-o.angle)),c=20,l=new e.Color(this.color);return o.width&&o.height&&(r=n((Math.abs(s.x)+this.blur)/o.width,a)*100+c,i=n((Math.abs(s.y)+this.blur)/o.height,a)*100+c),o.flipX&&(s.x*=-1),o.flipY&&(s.y*=-1),'<filter id="SVGID_'+this.id+'" y="-'+i+'%" height="'+(100+2*i)+'%" x="-'+r+'%" width="'+(100+2*r)+`%" >
	<feGaussianBlur in="SourceAlpha" stdDeviation="`+n(this.blur?this.blur/2:0,a)+`"></feGaussianBlur>
	<feOffset dx="`+n(s.x,a)+'" dy="'+n(s.y,a)+`" result="oBlur" ></feOffset>
	<feFlood flood-color="`+l.toRgb()+'" flood-opacity="'+l.getAlpha()+`"/>
	<feComposite in2="oBlur" operator="in" />
	<feMerge>
		<feMergeNode></feMergeNode>
		<feMergeNode in="SourceGraphic"></feMergeNode>
	</feMerge>
</filter>
`},toObject:function(){if(this.includeDefaultValues)return{color:this.color,blur:this.blur,offsetX:this.offsetX,offsetY:this.offsetY,affectStroke:this.affectStroke,nonScaling:this.nonScaling};var o={},r=e.Shadow.prototype;return["color","blur","offsetX","offsetY","affectStroke","nonScaling"].forEach(function(i){this[i]!==r[i]&&(o[i]=this[i])},this),o}}),e.Shadow.reOffsetsAndBlur=/(?:\s|^)(-?\d+(?:\.\d*)?(?:px)?(?:\s?|$))?(-?\d+(?:\.\d*)?(?:px)?(?:\s?|$))?(\d+(?:\.\d*)?(?:px)?)?(?:\s?|$)(?:$|\s)/})(ne);(function(){"use strict";if(g.StaticCanvas){g.warn("fabric.StaticCanvas is already defined.");return}var t=g.util.object.extend,e=g.util.getElementOffset,n=g.util.removeFromArray,o=g.util.toFixed,r=g.util.transformPoint,i=g.util.invertTransform,a=g.util.getNodeCanvas,s=g.util.createCanvasElement,c=new Error("Could not initialize `canvas` element");g.StaticCanvas=g.util.createClass(g.CommonMethods,{initialize:function(l,u){u||(u={}),this.renderAndResetBound=this.renderAndReset.bind(this),this.requestRenderAllBound=this.requestRenderAll.bind(this),this._initStatic(l,u)},backgroundColor:"",backgroundImage:null,overlayColor:"",overlayImage:null,includeDefaultValues:!0,stateful:!1,renderOnAddRemove:!0,controlsAboveOverlay:!1,allowTouchScrolling:!1,imageSmoothingEnabled:!0,viewportTransform:g.iMatrix.concat(),backgroundVpt:!0,overlayVpt:!0,enableRetinaScaling:!0,vptCoords:{},skipOffscreen:!0,clipPath:void 0,_initStatic:function(l,u){var d=this.requestRenderAllBound;this._objects=[],this._createLowerCanvas(l),this._initOptions(u),this.interactive||this._initRetinaScaling(),u.overlayImage&&this.setOverlayImage(u.overlayImage,d),u.backgroundImage&&this.setBackgroundImage(u.backgroundImage,d),u.backgroundColor&&this.setBackgroundColor(u.backgroundColor,d),u.overlayColor&&this.setOverlayColor(u.overlayColor,d),this.calcOffset()},_isRetinaScaling:function(){return g.devicePixelRatio>1&&this.enableRetinaScaling},getRetinaScaling:function(){return this._isRetinaScaling()?Math.max(1,g.devicePixelRatio):1},_initRetinaScaling:function(){if(this._isRetinaScaling()){var l=g.devicePixelRatio;this.__initRetinaScaling(l,this.lowerCanvasEl,this.contextContainer),this.upperCanvasEl&&this.__initRetinaScaling(l,this.upperCanvasEl,this.contextTop)}},__initRetinaScaling:function(l,u,d){u.setAttribute("width",this.width*l),u.setAttribute("height",this.height*l),d.scale(l,l)},calcOffset:function(){return this._offset=e(this.lowerCanvasEl),this},setOverlayImage:function(l,u,d){return this.__setBgOverlayImage("overlayImage",l,u,d)},setBackgroundImage:function(l,u,d){return this.__setBgOverlayImage("backgroundImage",l,u,d)},setOverlayColor:function(l,u){return this.__setBgOverlayColor("overlayColor",l,u)},setBackgroundColor:function(l,u){return this.__setBgOverlayColor("backgroundColor",l,u)},__setBgOverlayImage:function(l,u,d,f){return typeof u=="string"?g.util.loadImage(u,function(p,m){if(p){var h=new g.Image(p,f);this[l]=h,h.canvas=this}d&&d(p,m)},this,f&&f.crossOrigin):(f&&u.setOptions(f),this[l]=u,u&&(u.canvas=this),d&&d(u,!1)),this},__setBgOverlayColor:function(l,u,d){return this[l]=u,this._initGradient(u,l),this._initPattern(u,l,d),this},_createCanvasElement:function(){var l=s();if(!l||(l.style||(l.style={}),typeof l.getContext>"u"))throw c;return l},_initOptions:function(l){var u=this.lowerCanvasEl;this._setOptions(l),this.width=this.width||parseInt(u.width,10)||0,this.height=this.height||parseInt(u.height,10)||0,this.lowerCanvasEl.style&&(u.width=this.width,u.height=this.height,u.style.width=this.width+"px",u.style.height=this.height+"px",this.viewportTransform=this.viewportTransform.slice())},_createLowerCanvas:function(l){l&&l.getContext?this.lowerCanvasEl=l:this.lowerCanvasEl=g.util.getById(l)||this._createCanvasElement(),g.util.addClass(this.lowerCanvasEl,"lower-canvas"),this._originalCanvasStyle=this.lowerCanvasEl.style,this.interactive&&this._applyCanvasStyle(this.lowerCanvasEl),this.contextContainer=this.lowerCanvasEl.getContext("2d")},getWidth:function(){return this.width},getHeight:function(){return this.height},setWidth:function(l,u){return this.setDimensions({width:l},u)},setHeight:function(l,u){return this.setDimensions({height:l},u)},setDimensions:function(l,u){var d;u=u||{};for(var f in l)d=l[f],u.cssOnly||(this._setBackstoreDimension(f,l[f]),d+="px",this.hasLostContext=!0),u.backstoreOnly||this._setCssDimension(f,d);return this._isCurrentlyDrawing&&this.freeDrawingBrush&&this.freeDrawingBrush._setBrushStyles(this.contextTop),this._initRetinaScaling(),this.calcOffset(),u.cssOnly||this.requestRenderAll(),this},_setBackstoreDimension:function(l,u){return this.lowerCanvasEl[l]=u,this.upperCanvasEl&&(this.upperCanvasEl[l]=u),this.cacheCanvasEl&&(this.cacheCanvasEl[l]=u),this[l]=u,this},_setCssDimension:function(l,u){return this.lowerCanvasEl.style[l]=u,this.upperCanvasEl&&(this.upperCanvasEl.style[l]=u),this.wrapperEl&&(this.wrapperEl.style[l]=u),this},getZoom:function(){return this.viewportTransform[0]},setViewportTransform:function(l){var u=this._activeObject,d=this.backgroundImage,f=this.overlayImage,p,m,h;for(this.viewportTransform=l,m=0,h=this._objects.length;m<h;m++)p=this._objects[m],p.group||p.setCoords(!0);return u&&u.setCoords(),d&&d.setCoords(!0),f&&f.setCoords(!0),this.calcViewportBoundaries(),this.renderOnAddRemove&&this.requestRenderAll(),this},zoomToPoint:function(l,u){var d=l,f=this.viewportTransform.slice(0);l=r(l,i(this.viewportTransform)),f[0]=u,f[3]=u;var p=r(l,f);return f[4]+=d.x-p.x,f[5]+=d.y-p.y,this.setViewportTransform(f)},setZoom:function(l){return this.zoomToPoint(new g.Point(0,0),l),this},absolutePan:function(l){var u=this.viewportTransform.slice(0);return u[4]=-l.x,u[5]=-l.y,this.setViewportTransform(u)},relativePan:function(l){return this.absolutePan(new g.Point(-l.x-this.viewportTransform[4],-l.y-this.viewportTransform[5]))},getElement:function(){return this.lowerCanvasEl},_onObjectAdded:function(l){this.stateful&&l.setupState(),l._set("canvas",this),l.setCoords(),this.fire("object:added",{target:l}),l.fire("added")},_onObjectRemoved:function(l){this.fire("object:removed",{target:l}),l.fire("removed"),delete l.canvas},clearContext:function(l){return l.clearRect(0,0,this.width,this.height),this},getContext:function(){return this.contextContainer},clear:function(){return this.remove.apply(this,this.getObjects()),this.backgroundImage=null,this.overlayImage=null,this.backgroundColor="",this.overlayColor="",this._hasITextHandlers&&(this.off("mouse:up",this._mouseUpITextHandler),this._iTextInstances=null,this._hasITextHandlers=!1),this.clearContext(this.contextContainer),this.fire("canvas:cleared"),this.renderOnAddRemove&&this.requestRenderAll(),this},renderAll:function(){var l=this.contextContainer;return this.renderCanvas(l,this._objects),this},renderAndReset:function(){this.isRendering=0,this.renderAll()},requestRenderAll:function(){return this.isRendering||(this.isRendering=g.util.requestAnimFrame(this.renderAndResetBound)),this},calcViewportBoundaries:function(){var l={},u=this.width,d=this.height,f=i(this.viewportTransform);return l.tl=r({x:0,y:0},f),l.br=r({x:u,y:d},f),l.tr=new g.Point(l.br.x,l.tl.y),l.bl=new g.Point(l.tl.x,l.br.y),this.vptCoords=l,l},cancelRequestedRender:function(){this.isRendering&&(g.util.cancelAnimFrame(this.isRendering),this.isRendering=0)},renderCanvas:function(l,u){var d=this.viewportTransform,f=this.clipPath;this.cancelRequestedRender(),this.calcViewportBoundaries(),this.clearContext(l),g.util.setImageSmoothing(l,this.imageSmoothingEnabled),this.fire("before:render",{ctx:l}),this._renderBackground(l),l.save(),l.transform(d[0],d[1],d[2],d[3],d[4],d[5]),this._renderObjects(l,u),l.restore(),!this.controlsAboveOverlay&&this.interactive&&this.drawControls(l),f&&(f.canvas=this,f.shouldCache(),f._transformDone=!0,f.renderCache({forClipping:!0}),this.drawClipPathOnCanvas(l)),this._renderOverlay(l),this.controlsAboveOverlay&&this.interactive&&this.drawControls(l),this.fire("after:render",{ctx:l})},drawClipPathOnCanvas:function(l){var u=this.viewportTransform,d=this.clipPath;l.save(),l.transform(u[0],u[1],u[2],u[3],u[4],u[5]),l.globalCompositeOperation="destination-in",d.transform(l),l.scale(1/d.zoomX,1/d.zoomY),l.drawImage(d._cacheCanvas,-d.cacheTranslationX,-d.cacheTranslationY),l.restore()},_renderObjects:function(l,u){var d,f;for(d=0,f=u.length;d<f;++d)u[d]&&u[d].render(l)},_renderBackgroundOrOverlay:function(l,u){var d=this[u+"Color"],f=this[u+"Image"],p=this.viewportTransform,m=this[u+"Vpt"];if(!(!d&&!f)){if(d){l.save(),l.beginPath(),l.moveTo(0,0),l.lineTo(this.width,0),l.lineTo(this.width,this.height),l.lineTo(0,this.height),l.closePath(),l.fillStyle=d.toLive?d.toLive(l,this):d,m&&l.transform(p[0],p[1],p[2],p[3],p[4],p[5]),l.transform(1,0,0,1,d.offsetX||0,d.offsetY||0);var h=d.gradientTransform||d.patternTransform;h&&l.transform(h[0],h[1],h[2],h[3],h[4],h[5]),l.fill(),l.restore()}f&&(l.save(),m&&l.transform(p[0],p[1],p[2],p[3],p[4],p[5]),f.render(l),l.restore())}},_renderBackground:function(l){this._renderBackgroundOrOverlay(l,"background")},_renderOverlay:function(l){this._renderBackgroundOrOverlay(l,"overlay")},getCenter:function(){return{top:this.height/2,left:this.width/2}},getCenterPoint:function(){return new g.Point(this.width/2,this.height/2)},centerObjectH:function(l){return this._centerObject(l,new g.Point(this.getCenterPoint().x,l.getCenterPoint().y))},centerObjectV:function(l){return this._centerObject(l,new g.Point(l.getCenterPoint().x,this.getCenterPoint().y))},centerObject:function(l){var u=this.getCenterPoint();return this._centerObject(l,u)},viewportCenterObject:function(l){var u=this.getVpCenter();return this._centerObject(l,u)},viewportCenterObjectH:function(l){var u=this.getVpCenter();return this._centerObject(l,new g.Point(u.x,l.getCenterPoint().y)),this},viewportCenterObjectV:function(l){var u=this.getVpCenter();return this._centerObject(l,new g.Point(l.getCenterPoint().x,u.y))},getVpCenter:function(){var l=this.getCenterPoint(),u=i(this.viewportTransform);return r(l,u)},_centerObject:function(l,u){return l.setPositionByOrigin(u,"center","center"),l.setCoords(),this.renderOnAddRemove&&this.requestRenderAll(),this},toDatalessJSON:function(l){return this.toDatalessObject(l)},toObject:function(l){return this._toObjectMethod("toObject",l)},toDatalessObject:function(l){return this._toObjectMethod("toDatalessObject",l)},_toObjectMethod:function(l,u){var d=this.clipPath,f={version:g.version,objects:this._toObjects(l,u)};return d&&!d.excludeFromExport&&(f.clipPath=this._toObject(this.clipPath,l,u)),t(f,this.__serializeBgOverlay(l,u)),g.util.populateWithProperties(this,f,u),f},_toObjects:function(l,u){return this._objects.filter(function(d){return!d.excludeFromExport}).map(function(d){return this._toObject(d,l,u)},this)},_toObject:function(l,u,d){var f;this.includeDefaultValues||(f=l.includeDefaultValues,l.includeDefaultValues=!1);var p=l[u](d);return this.includeDefaultValues||(l.includeDefaultValues=f),p},__serializeBgOverlay:function(l,u){var d={},f=this.backgroundImage,p=this.overlayImage,m=this.backgroundColor,h=this.overlayColor;return m&&m.toObject?m.excludeFromExport||(d.background=m.toObject(u)):m&&(d.background=m),h&&h.toObject?h.excludeFromExport||(d.overlay=h.toObject(u)):h&&(d.overlay=h),f&&!f.excludeFromExport&&(d.backgroundImage=this._toObject(f,l,u)),p&&!p.excludeFromExport&&(d.overlayImage=this._toObject(p,l,u)),d},svgViewportTransformation:!0,toSVG:function(l,u){l||(l={}),l.reviver=u;var d=[];return this._setSVGPreamble(d,l),this._setSVGHeader(d,l),this.clipPath&&d.push('<g clip-path="url(#'+this.clipPath.clipPathId+`)" >
`),this._setSVGBgOverlayColor(d,"background"),this._setSVGBgOverlayImage(d,"backgroundImage",u),this._setSVGObjects(d,u),this.clipPath&&d.push(`</g>
`),this._setSVGBgOverlayColor(d,"overlay"),this._setSVGBgOverlayImage(d,"overlayImage",u),d.push("</svg>"),d.join("")},_setSVGPreamble:function(l,u){u.suppressPreamble||l.push('<?xml version="1.0" encoding="',u.encoding||"UTF-8",`" standalone="no" ?>
`,'<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" ',`"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
`)},_setSVGHeader:function(l,u){var d=u.width||this.width,f=u.height||this.height,p,m='viewBox="0 0 '+this.width+" "+this.height+'" ',h=g.Object.NUM_FRACTION_DIGITS;u.viewBox?m='viewBox="'+u.viewBox.x+" "+u.viewBox.y+" "+u.viewBox.width+" "+u.viewBox.height+'" ':this.svgViewportTransformation&&(p=this.viewportTransform,m='viewBox="'+o(-p[4]/p[0],h)+" "+o(-p[5]/p[3],h)+" "+o(this.width/p[0],h)+" "+o(this.height/p[3],h)+'" '),l.push("<svg ",'xmlns="http://www.w3.org/2000/svg" ','xmlns:xlink="http://www.w3.org/1999/xlink" ','version="1.1" ','width="',d,'" ','height="',f,'" ',m,`xml:space="preserve">
`,"<desc>Created with Fabric.js ",g.version,`</desc>
`,`<defs>
`,this.createSVGFontFacesMarkup(),this.createSVGRefElementsMarkup(),this.createSVGClipPathMarkup(u),`</defs>
`)},createSVGClipPathMarkup:function(l){var u=this.clipPath;return u?(u.clipPathId="CLIPPATH_"+g.Object.__uid++,'<clipPath id="'+u.clipPathId+`" >
`+this.clipPath.toClipPathSVG(l.reviver)+`</clipPath>
`):""},createSVGRefElementsMarkup:function(){var l=this,u=["background","overlay"].map(function(d){var f=l[d+"Color"];if(f&&f.toLive){var p=l[d+"Vpt"],m=l.viewportTransform,h={width:l.width/(p?m[0]:1),height:l.height/(p?m[3]:1)};return f.toSVG(h,{additionalTransform:p?g.util.matrixToSVG(m):""})}});return u.join("")},createSVGFontFacesMarkup:function(){var l="",u={},d,f,p,m,h,b,x,y,M,E=g.fontPaths,C=[];for(this._objects.forEach(function P(D){C.push(D),D._objects&&D._objects.forEach(P)}),y=0,M=C.length;y<M;y++)if(d=C[y],f=d.fontFamily,!(d.type.indexOf("text")===-1||u[f]||!E[f])&&(u[f]=!0,!!d.styles)){p=d.styles;for(h in p){m=p[h];for(x in m)b=m[x],f=b.fontFamily,!u[f]&&E[f]&&(u[f]=!0)}}for(var j in u)l+=[`		@font-face {
`,"			font-family: '",j,`';
`,"			src: url('",E[j],`');
`,`		}
`].join("");return l&&(l=['	<style type="text/css">',`<![CDATA[
`,l,"]]>",`</style>
`].join("")),l},_setSVGObjects:function(l,u){var d,f,p,m=this._objects;for(f=0,p=m.length;f<p;f++)d=m[f],!d.excludeFromExport&&this._setSVGObject(l,d,u)},_setSVGObject:function(l,u,d){l.push(u.toSVG(d))},_setSVGBgOverlayImage:function(l,u,d){this[u]&&!this[u].excludeFromExport&&this[u].toSVG&&l.push(this[u].toSVG(d))},_setSVGBgOverlayColor:function(l,u){var d=this[u+"Color"],f=this.viewportTransform,p=this.width,m=this.height;if(d)if(d.toLive){var h=d.repeat,b=g.util.invertTransform(f),x=this[u+"Vpt"],y=x?g.util.matrixToSVG(b):"";l.push('<rect transform="'+y+" translate(",p/2,",",m/2,')"',' x="',d.offsetX-p/2,'" y="',d.offsetY-m/2,'" ','width="',h==="repeat-y"||h==="no-repeat"?d.source.width:p,'" height="',h==="repeat-x"||h==="no-repeat"?d.source.height:m,'" fill="url(#SVGID_'+d.id+')"',`></rect>
`)}else l.push('<rect x="0" y="0" width="100%" height="100%" ','fill="',d,'"',`></rect>
`)},sendToBack:function(l){if(!l)return this;var u=this._activeObject,d,f,p;if(l===u&&l.type==="activeSelection")for(p=u._objects,d=p.length;d--;)f=p[d],n(this._objects,f),this._objects.unshift(f);else n(this._objects,l),this._objects.unshift(l);return this.renderOnAddRemove&&this.requestRenderAll(),this},bringToFront:function(l){if(!l)return this;var u=this._activeObject,d,f,p;if(l===u&&l.type==="activeSelection")for(p=u._objects,d=0;d<p.length;d++)f=p[d],n(this._objects,f),this._objects.push(f);else n(this._objects,l),this._objects.push(l);return this.renderOnAddRemove&&this.requestRenderAll(),this},sendBackwards:function(l,u){if(!l)return this;var d=this._activeObject,f,p,m,h,b,x=0;if(l===d&&l.type==="activeSelection")for(b=d._objects,f=0;f<b.length;f++)p=b[f],m=this._objects.indexOf(p),m>0+x&&(h=m-1,n(this._objects,p),this._objects.splice(h,0,p)),x++;else m=this._objects.indexOf(l),m!==0&&(h=this._findNewLowerIndex(l,m,u),n(this._objects,l),this._objects.splice(h,0,l));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewLowerIndex:function(l,u,d){var f,p;if(d)for(f=u,p=u-1;p>=0;--p){var m=l.intersectsWithObject(this._objects[p])||l.isContainedWithinObject(this._objects[p])||this._objects[p].isContainedWithinObject(l);if(m){f=p;break}}else f=u-1;return f},bringForward:function(l,u){if(!l)return this;var d=this._activeObject,f,p,m,h,b,x=0;if(l===d&&l.type==="activeSelection")for(b=d._objects,f=b.length;f--;)p=b[f],m=this._objects.indexOf(p),m<this._objects.length-1-x&&(h=m+1,n(this._objects,p),this._objects.splice(h,0,p)),x++;else m=this._objects.indexOf(l),m!==this._objects.length-1&&(h=this._findNewUpperIndex(l,m,u),n(this._objects,l),this._objects.splice(h,0,l));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewUpperIndex:function(l,u,d){var f,p,m;if(d)for(f=u,p=u+1,m=this._objects.length;p<m;++p){var h=l.intersectsWithObject(this._objects[p])||l.isContainedWithinObject(this._objects[p])||this._objects[p].isContainedWithinObject(l);if(h){f=p;break}}else f=u+1;return f},moveTo:function(l,u){return n(this._objects,l),this._objects.splice(u,0,l),this.renderOnAddRemove&&this.requestRenderAll()},dispose:function(){return this.isRendering&&(g.util.cancelAnimFrame(this.isRendering),this.isRendering=0),this.forEachObject(function(l){l.dispose&&l.dispose()}),this._objects=[],this.backgroundImage&&this.backgroundImage.dispose&&this.backgroundImage.dispose(),this.backgroundImage=null,this.overlayImage&&this.overlayImage.dispose&&this.overlayImage.dispose(),this.overlayImage=null,this._iTextInstances=null,this.contextContainer=null,this.lowerCanvasEl.classList.remove("lower-canvas"),g.util.setStyle(this.lowerCanvasEl,this._originalCanvasStyle),delete this._originalCanvasStyle,this.lowerCanvasEl.setAttribute("width",this.width),this.lowerCanvasEl.setAttribute("height",this.height),g.util.cleanUpJsdomNode(this.lowerCanvasEl),this.lowerCanvasEl=void 0,this},toString:function(){return"#<fabric.Canvas ("+this.complexity()+"): { objects: "+this._objects.length+" }>"}}),t(g.StaticCanvas.prototype,g.Observable),t(g.StaticCanvas.prototype,g.Collection),t(g.StaticCanvas.prototype,g.DataURLExporter),t(g.StaticCanvas,{EMPTY_JSON:'{"objects": [], "background": "white"}',supports:function(l){var u=s();if(!u||!u.getContext)return null;var d=u.getContext("2d");if(!d)return null;switch(l){case"setLineDash":return typeof d.setLineDash<"u";default:return null}}}),g.StaticCanvas.prototype.toJSON=g.StaticCanvas.prototype.toObject,g.isLikelyNode&&(g.StaticCanvas.prototype.createPNGStream=function(){var l=a(this.lowerCanvasEl);return l&&l.createPNGStream()},g.StaticCanvas.prototype.createJPEGStream=function(l){var u=a(this.lowerCanvasEl);return u&&u.createJPEGStream(l)})})();g.BaseBrush=g.util.createClass({color:"rgb(0, 0, 0)",width:1,shadow:null,strokeLineCap:"round",strokeLineJoin:"round",strokeMiterLimit:10,strokeDashArray:null,limitedToCanvasSize:!1,_setBrushStyles:function(t){t.strokeStyle=this.color,t.lineWidth=this.width,t.lineCap=this.strokeLineCap,t.miterLimit=this.strokeMiterLimit,t.lineJoin=this.strokeLineJoin,t.setLineDash(this.strokeDashArray||[])},_saveAndTransform:function(t){var e=this.canvas.viewportTransform;t.save(),t.transform(e[0],e[1],e[2],e[3],e[4],e[5])},_setShadow:function(){if(this.shadow){var t=this.canvas,e=this.shadow,n=t.contextTop,o=t.getZoom();t&&t._isRetinaScaling()&&(o*=g.devicePixelRatio),n.shadowColor=e.color,n.shadowBlur=e.blur*o,n.shadowOffsetX=e.offsetX*o,n.shadowOffsetY=e.offsetY*o}},needsFullRender:function(){var t=new g.Color(this.color);return t.getAlpha()<1||!!this.shadow},_resetShadow:function(){var t=this.canvas.contextTop;t.shadowColor="",t.shadowBlur=t.shadowOffsetX=t.shadowOffsetY=0},_isOutSideCanvas:function(t){return t.x<0||t.x>this.canvas.getWidth()||t.y<0||t.y>this.canvas.getHeight()}});(function(){g.PencilBrush=g.util.createClass(g.BaseBrush,{decimate:.4,drawStraightLine:!1,straightLineKey:"shiftKey",initialize:function(t){this.canvas=t,this._points=[]},needsFullRender:function(){return this.callSuper("needsFullRender")||this._hasStraightLine},_drawSegment:function(t,e,n){var o=e.midPointFrom(n);return t.quadraticCurveTo(e.x,e.y,o.x,o.y),o},onMouseDown:function(t,e){this.canvas._isMainEvent(e.e)&&(this.drawStraightLine=e.e[this.straightLineKey],this._prepareForDrawing(t),this._captureDrawingPath(t),this._render())},onMouseMove:function(t,e){if(this.canvas._isMainEvent(e.e)&&(this.drawStraightLine=e.e[this.straightLineKey],!(this.limitedToCanvasSize===!0&&this._isOutSideCanvas(t))&&this._captureDrawingPath(t)&&this._points.length>1))if(this.needsFullRender())this.canvas.clearContext(this.canvas.contextTop),this._render();else{var n=this._points,o=n.length,r=this.canvas.contextTop;this._saveAndTransform(r),this.oldEnd&&(r.beginPath(),r.moveTo(this.oldEnd.x,this.oldEnd.y)),this.oldEnd=this._drawSegment(r,n[o-2],n[o-1],!0),r.stroke(),r.restore()}},onMouseUp:function(t){return this.canvas._isMainEvent(t.e)?(this.drawStraightLine=!1,this.oldEnd=void 0,this._finalizeAndAddPath(),!1):!0},_prepareForDrawing:function(t){var e=new g.Point(t.x,t.y);this._reset(),this._addPoint(e),this.canvas.contextTop.moveTo(e.x,e.y)},_addPoint:function(t){return this._points.length>1&&t.eq(this._points[this._points.length-1])?!1:(this.drawStraightLine&&this._points.length>1&&(this._hasStraightLine=!0,this._points.pop()),this._points.push(t),!0)},_reset:function(){this._points=[],this._setBrushStyles(this.canvas.contextTop),this._setShadow(),this._hasStraightLine=!1},_captureDrawingPath:function(t){var e=new g.Point(t.x,t.y);return this._addPoint(e)},_render:function(t){var e,n,o=this._points[0],r=this._points[1];if(t=t||this.canvas.contextTop,this._saveAndTransform(t),t.beginPath(),this._points.length===2&&o.x===r.x&&o.y===r.y){var i=this.width/1e3;o=new g.Point(o.x,o.y),r=new g.Point(r.x,r.y),o.x-=i,r.x+=i}for(t.moveTo(o.x,o.y),e=1,n=this._points.length;e<n;e++)this._drawSegment(t,o,r),o=this._points[e],r=this._points[e+1];t.lineTo(o.x,o.y),t.stroke(),t.restore()},convertPointsToSVGPath:function(t){var e=this.width/1e3;return g.util.getSmoothPathFromPoints(t,e)},_isEmptySVGPath:function(t){var e=g.util.joinPath(t);return e==="M 0 0 Q 0 0 0 0 L 0 0"},createPath:function(t){var e=new g.Path(t,{fill:null,stroke:this.color,strokeWidth:this.width,strokeLineCap:this.strokeLineCap,strokeMiterLimit:this.strokeMiterLimit,strokeLineJoin:this.strokeLineJoin,strokeDashArray:this.strokeDashArray});return this.shadow&&(this.shadow.affectStroke=!0,e.shadow=new g.Shadow(this.shadow)),e},decimatePoints:function(t,e){if(t.length<=2)return t;var n=this.canvas.getZoom(),o=Math.pow(e/n,2),r,i=t.length-1,a=t[0],s=[a],c;for(r=1;r<i-1;r++)c=Math.pow(a.x-t[r].x,2)+Math.pow(a.y-t[r].y,2),c>=o&&(a=t[r],s.push(a));return s.push(t[i]),s},_finalizeAndAddPath:function(){var t=this.canvas.contextTop;t.closePath(),this.decimate&&(this._points=this.decimatePoints(this._points,this.decimate));var e=this.convertPointsToSVGPath(this._points);if(this._isEmptySVGPath(e)){this.canvas.requestRenderAll();return}var n=this.createPath(e);this.canvas.clearContext(this.canvas.contextTop),this.canvas.fire("before:path:created",{path:n}),this.canvas.add(n),this.canvas.requestRenderAll(),n.setCoords(),this._resetShadow(),this.canvas.fire("path:created",{path:n})}})})();g.CircleBrush=g.util.createClass(g.BaseBrush,{width:10,initialize:function(t){this.canvas=t,this.points=[]},drawDot:function(t){var e=this.addPoint(t),n=this.canvas.contextTop;this._saveAndTransform(n),this.dot(n,e),n.restore()},dot:function(t,e){t.fillStyle=e.fill,t.beginPath(),t.arc(e.x,e.y,e.radius,0,Math.PI*2,!1),t.closePath(),t.fill()},onMouseDown:function(t){this.points.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.drawDot(t)},_render:function(){var t=this.canvas.contextTop,e,n,o=this.points;for(this._saveAndTransform(t),e=0,n=o.length;e<n;e++)this.dot(t,o[e]);t.restore()},onMouseMove:function(t){this.limitedToCanvasSize===!0&&this._isOutSideCanvas(t)||(this.needsFullRender()?(this.canvas.clearContext(this.canvas.contextTop),this.addPoint(t),this._render()):this.drawDot(t))},onMouseUp:function(){var t=this.canvas.renderOnAddRemove,e,n;this.canvas.renderOnAddRemove=!1;var o=[];for(e=0,n=this.points.length;e<n;e++){var r=this.points[e],i=new g.Circle({radius:r.radius,left:r.x,top:r.y,originX:"center",originY:"center",fill:r.fill});this.shadow&&(i.shadow=new g.Shadow(this.shadow)),o.push(i)}var a=new g.Group(o);a.canvas=this.canvas,this.canvas.fire("before:path:created",{path:a}),this.canvas.add(a),this.canvas.fire("path:created",{path:a}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=t,this.canvas.requestRenderAll()},addPoint:function(t){var e=new g.Point(t.x,t.y),n=g.util.getRandomInt(Math.max(0,this.width-20),this.width+20)/2,o=new g.Color(this.color).setAlpha(g.util.getRandomInt(0,100)/100).toRgba();return e.radius=n,e.fill=o,this.points.push(e),e}});g.SprayBrush=g.util.createClass(g.BaseBrush,{width:10,density:20,dotWidth:1,dotWidthVariance:1,randomOpacity:!1,optimizeOverlapping:!0,initialize:function(t){this.canvas=t,this.sprayChunks=[]},onMouseDown:function(t){this.sprayChunks.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.addSprayChunk(t),this.render(this.sprayChunkPoints)},onMouseMove:function(t){this.limitedToCanvasSize===!0&&this._isOutSideCanvas(t)||(this.addSprayChunk(t),this.render(this.sprayChunkPoints))},onMouseUp:function(){var t=this.canvas.renderOnAddRemove;this.canvas.renderOnAddRemove=!1;for(var e=[],n=0,o=this.sprayChunks.length;n<o;n++)for(var r=this.sprayChunks[n],i=0,a=r.length;i<a;i++){var s=new g.Rect({width:r[i].width,height:r[i].width,left:r[i].x+1,top:r[i].y+1,originX:"center",originY:"center",fill:this.color});e.push(s)}this.optimizeOverlapping&&(e=this._getOptimizedRects(e));var c=new g.Group(e);this.shadow&&c.set("shadow",new g.Shadow(this.shadow)),this.canvas.fire("before:path:created",{path:c}),this.canvas.add(c),this.canvas.fire("path:created",{path:c}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=t,this.canvas.requestRenderAll()},_getOptimizedRects:function(t){var e={},n,o,r;for(o=0,r=t.length;o<r;o++)n=t[o].left+""+t[o].top,e[n]||(e[n]=t[o]);var i=[];for(n in e)i.push(e[n]);return i},render:function(t){var e=this.canvas.contextTop,n,o;for(e.fillStyle=this.color,this._saveAndTransform(e),n=0,o=t.length;n<o;n++){var r=t[n];typeof r.opacity<"u"&&(e.globalAlpha=r.opacity),e.fillRect(r.x,r.y,r.width,r.width)}e.restore()},_render:function(){var t=this.canvas.contextTop,e,n;for(t.fillStyle=this.color,this._saveAndTransform(t),e=0,n=this.sprayChunks.length;e<n;e++)this.render(this.sprayChunks[e]);t.restore()},addSprayChunk:function(t){this.sprayChunkPoints=[];var e,n,o,r=this.width/2,i;for(i=0;i<this.density;i++){e=g.util.getRandomInt(t.x-r,t.x+r),n=g.util.getRandomInt(t.y-r,t.y+r),this.dotWidthVariance?o=g.util.getRandomInt(Math.max(1,this.dotWidth-this.dotWidthVariance),this.dotWidth+this.dotWidthVariance):o=this.dotWidth;var a=new g.Point(e,n);a.width=o,this.randomOpacity&&(a.opacity=g.util.getRandomInt(0,100)/100),this.sprayChunkPoints.push(a)}this.sprayChunks.push(this.sprayChunkPoints)}});g.PatternBrush=g.util.createClass(g.PencilBrush,{getPatternSrc:function(){var t=20,e=5,n=g.util.createCanvasElement(),o=n.getContext("2d");return n.width=n.height=t+e,o.fillStyle=this.color,o.beginPath(),o.arc(t/2,t/2,t/2,0,Math.PI*2,!1),o.closePath(),o.fill(),n},getPatternSrcFunction:function(){return String(this.getPatternSrc).replace("this.color",'"'+this.color+'"')},getPattern:function(t){return t.createPattern(this.source||this.getPatternSrc(),"repeat")},_setBrushStyles:function(t){this.callSuper("_setBrushStyles",t),t.strokeStyle=this.getPattern(t)},createPath:function(t){var e=this.callSuper("createPath",t),n=e._getLeftTopCoords().scalarAdd(e.strokeWidth/2);return e.stroke=new g.Pattern({source:this.source||this.getPatternSrcFunction(),offsetX:-n.x,offsetY:-n.y}),e}});(function(){var t=g.util.getPointer,e=g.util.degreesToRadians,n=g.util.isTouchEvent;g.Canvas=g.util.createClass(g.StaticCanvas,{initialize:function(r,i){i||(i={}),this.renderAndResetBound=this.renderAndReset.bind(this),this.requestRenderAllBound=this.requestRenderAll.bind(this),this._initStatic(r,i),this._initInteractive(),this._createCacheCanvas()},uniformScaling:!0,uniScaleKey:"shiftKey",centeredScaling:!1,centeredRotation:!1,centeredKey:"altKey",altActionKey:"shiftKey",interactive:!0,selection:!0,selectionKey:"shiftKey",altSelectionKey:null,selectionColor:"rgba(100, 100, 255, 0.3)",selectionDashArray:[],selectionBorderColor:"rgba(255, 255, 255, 0.3)",selectionLineWidth:1,selectionFullyContained:!1,hoverCursor:"move",moveCursor:"move",defaultCursor:"default",freeDrawingCursor:"crosshair",notAllowedCursor:"not-allowed",containerClass:"canvas-container",perPixelTargetFind:!1,targetFindTolerance:0,skipTargetFind:!1,isDrawingMode:!1,preserveObjectStacking:!1,snapAngle:0,snapThreshold:null,stopContextMenu:!1,fireRightClick:!1,fireMiddleClick:!1,targets:[],enablePointerEvents:!1,_hoveredTarget:null,_hoveredTargets:[],_initInteractive:function(){this._currentTransform=null,this._groupSelector=null,this._initWrapperElement(),this._createUpperCanvas(),this._initEventListeners(),this._initRetinaScaling(),this.freeDrawingBrush=g.PencilBrush&&new g.PencilBrush(this),this.calcOffset()},_chooseObjectsToRender:function(){var r=this.getActiveObjects(),i,a,s;if(r.length>0&&!this.preserveObjectStacking){a=[],s=[];for(var c=0,l=this._objects.length;c<l;c++)i=this._objects[c],r.indexOf(i)===-1?a.push(i):s.push(i);r.length>1&&(this._activeObject._objects=s),a.push.apply(a,s)}else a=this._objects;return a},renderAll:function(){this.contextTopDirty&&!this._groupSelector&&!this.isDrawingMode&&(this.clearContext(this.contextTop),this.contextTopDirty=!1),this.hasLostContext&&(this.renderTopLayer(this.contextTop),this.hasLostContext=!1);var r=this.contextContainer;return this.renderCanvas(r,this._chooseObjectsToRender()),this},renderTopLayer:function(r){r.save(),this.isDrawingMode&&this._isCurrentlyDrawing&&(this.freeDrawingBrush&&this.freeDrawingBrush._render(),this.contextTopDirty=!0),this.selection&&this._groupSelector&&(this._drawSelection(r),this.contextTopDirty=!0),r.restore()},renderTop:function(){var r=this.contextTop;return this.clearContext(r),this.renderTopLayer(r),this.fire("after:render"),this},_normalizePointer:function(r,i){var a=r.calcTransformMatrix(),s=g.util.invertTransform(a),c=this.restorePointerVpt(i);return g.util.transformPoint(c,s)},isTargetTransparent:function(r,i,a){if(r.shouldCache()&&r._cacheCanvas&&r!==this._activeObject){var s=this._normalizePointer(r,{x:i,y:a}),c=Math.max(r.cacheTranslationX+s.x*r.zoomX,0),l=Math.max(r.cacheTranslationY+s.y*r.zoomY,0),p=g.util.isTransparent(r._cacheContext,Math.round(c),Math.round(l),this.targetFindTolerance);return p}var u=this.contextCache,d=r.selectionBackgroundColor,f=this.viewportTransform;r.selectionBackgroundColor="",this.clearContext(u),u.save(),u.transform(f[0],f[1],f[2],f[3],f[4],f[5]),r.render(u),u.restore(),r.selectionBackgroundColor=d;var p=g.util.isTransparent(u,i,a,this.targetFindTolerance);return p},_isSelectionKeyPressed:function(r){var i=!1;return Array.isArray(this.selectionKey)?i=!!this.selectionKey.find(function(a){return r[a]===!0}):i=r[this.selectionKey],i},_shouldClearSelection:function(r,i){var a=this.getActiveObjects(),s=this._activeObject;return!i||i&&s&&a.length>1&&a.indexOf(i)===-1&&s!==i&&!this._isSelectionKeyPressed(r)||i&&!i.evented||i&&!i.selectable&&s&&s!==i},_shouldCenterTransform:function(r,i,a){if(r){var s;return i==="scale"||i==="scaleX"||i==="scaleY"||i==="resizing"?s=this.centeredScaling||r.centeredScaling:i==="rotate"&&(s=this.centeredRotation||r.centeredRotation),s?!a:a}},_getOriginFromCorner:function(r,i){var a={x:r.originX,y:r.originY};return i==="ml"||i==="tl"||i==="bl"?a.x="right":(i==="mr"||i==="tr"||i==="br")&&(a.x="left"),i==="tl"||i==="mt"||i==="tr"?a.y="bottom":(i==="bl"||i==="mb"||i==="br")&&(a.y="top"),a},_getActionFromCorner:function(r,i,a,s){if(!i||!r)return"drag";var c=s.controls[i];return c.getActionName(a,c,s)},_setupCurrentTransform:function(r,i,a){if(i){var s=this.getPointer(r),c=i.__corner,l=i.controls[c],u=a&&c?l.getActionHandler(r,i,l):g.controlsUtils.dragHandler,d=this._getActionFromCorner(a,c,r,i),f=this._getOriginFromCorner(i,c),p=r[this.centeredKey],m={target:i,action:d,actionHandler:u,corner:c,scaleX:i.scaleX,scaleY:i.scaleY,skewX:i.skewX,skewY:i.skewY,offsetX:s.x-i.left,offsetY:s.y-i.top,originX:f.x,originY:f.y,ex:s.x,ey:s.y,lastX:s.x,lastY:s.y,theta:e(i.angle),width:i.width*i.scaleX,shiftKey:r.shiftKey,altKey:p,original:g.util.saveObjectTransform(i)};this._shouldCenterTransform(i,d,p)&&(m.originX="center",m.originY="center"),m.original.originX=f.x,m.original.originY=f.y,this._currentTransform=m,this._beforeTransform(r)}},setCursor:function(r){this.upperCanvasEl.style.cursor=r},_drawSelection:function(r){var i=this._groupSelector,a=new g.Point(i.ex,i.ey),s=g.util.transformPoint(a,this.viewportTransform),c=new g.Point(i.ex+i.left,i.ey+i.top),l=g.util.transformPoint(c,this.viewportTransform),u=Math.min(s.x,l.x),d=Math.min(s.y,l.y),f=Math.max(s.x,l.x),p=Math.max(s.y,l.y),m=this.selectionLineWidth/2;this.selectionColor&&(r.fillStyle=this.selectionColor,r.fillRect(u,d,f-u,p-d)),!(!this.selectionLineWidth||!this.selectionBorderColor)&&(r.lineWidth=this.selectionLineWidth,r.strokeStyle=this.selectionBorderColor,u+=m,d+=m,f-=m,p-=m,g.Object.prototype._setLineDash.call(this,r,this.selectionDashArray),r.strokeRect(u,d,f-u,p-d))},findTarget:function(r,i){if(!this.skipTargetFind){var a=!0,s=this.getPointer(r,a),c=this._activeObject,l=this.getActiveObjects(),u,d,f=n(r),p=l.length>1&&!i||l.length===1;if(this.targets=[],p&&c._findTargetCorner(s,f)||l.length>1&&!i&&c===this._searchPossibleTargets([c],s))return c;if(l.length===1&&c===this._searchPossibleTargets([c],s))if(this.preserveObjectStacking)u=c,d=this.targets,this.targets=[];else return c;var m=this._searchPossibleTargets(this._objects,s);return r[this.altSelectionKey]&&m&&u&&m!==u&&(m=u,this.targets=d),m}},_checkTarget:function(r,i,a){if(i&&i.visible&&i.evented&&i.containsPoint(r))if((this.perPixelTargetFind||i.perPixelTargetFind)&&!i.isEditing){var s=this.isTargetTransparent(i,a.x,a.y);if(!s)return!0}else return!0},_searchPossibleTargets:function(r,i){for(var a,s=r.length,c;s--;){var l=r[s],u=l.group?this._normalizePointer(l.group,i):i;if(this._checkTarget(u,l,i)){a=r[s],a.subTargetCheck&&a instanceof g.Group&&(c=this._searchPossibleTargets(a._objects,i),c&&this.targets.push(c));break}}return a},restorePointerVpt:function(r){return g.util.transformPoint(r,g.util.invertTransform(this.viewportTransform))},getPointer:function(r,i){if(this._absolutePointer&&!i)return this._absolutePointer;if(this._pointer&&i)return this._pointer;var a=t(r),s=this.upperCanvasEl,c=s.getBoundingClientRect(),l=c.width||0,u=c.height||0,d;(!l||!u)&&("top"in c&&"bottom"in c&&(u=Math.abs(c.top-c.bottom)),"right"in c&&"left"in c&&(l=Math.abs(c.right-c.left))),this.calcOffset(),a.x=a.x-this._offset.left,a.y=a.y-this._offset.top,i||(a=this.restorePointerVpt(a));var f=this.getRetinaScaling();return f!==1&&(a.x/=f,a.y/=f),l===0||u===0?d={width:1,height:1}:d={width:s.width/l,height:s.height/u},{x:a.x*d.width,y:a.y*d.height}},_createUpperCanvas:function(){var r=this.lowerCanvasEl.className.replace(/\s*lower-canvas\s*/,""),i=this.lowerCanvasEl,a=this.upperCanvasEl;a?a.className="":(a=this._createCanvasElement(),this.upperCanvasEl=a),g.util.addClass(a,"upper-canvas "+r),this.wrapperEl.appendChild(a),this._copyCanvasStyle(i,a),this._applyCanvasStyle(a),this.contextTop=a.getContext("2d")},getTopContext:function(){return this.contextTop},_createCacheCanvas:function(){this.cacheCanvasEl=this._createCanvasElement(),this.cacheCanvasEl.setAttribute("width",this.width),this.cacheCanvasEl.setAttribute("height",this.height),this.contextCache=this.cacheCanvasEl.getContext("2d")},_initWrapperElement:function(){this.wrapperEl=g.util.wrapElement(this.lowerCanvasEl,"div",{class:this.containerClass}),g.util.setStyle(this.wrapperEl,{width:this.width+"px",height:this.height+"px",position:"relative"}),g.util.makeElementUnselectable(this.wrapperEl)},_applyCanvasStyle:function(r){var i=this.width||r.width,a=this.height||r.height;g.util.setStyle(r,{position:"absolute",width:i+"px",height:a+"px",left:0,top:0,"touch-action":this.allowTouchScrolling?"manipulation":"none","-ms-touch-action":this.allowTouchScrolling?"manipulation":"none"}),r.width=i,r.height=a,g.util.makeElementUnselectable(r)},_copyCanvasStyle:function(r,i){i.style.cssText=r.style.cssText},getSelectionContext:function(){return this.contextTop},getSelectionElement:function(){return this.upperCanvasEl},getActiveObject:function(){return this._activeObject},getActiveObjects:function(){var r=this._activeObject;return r?r.type==="activeSelection"&&r._objects?r._objects.slice(0):[r]:[]},_onObjectRemoved:function(r){r===this._activeObject&&(this.fire("before:selection:cleared",{target:r}),this._discardActiveObject(),this.fire("selection:cleared",{target:r}),r.fire("deselected")),r===this._hoveredTarget&&(this._hoveredTarget=null,this._hoveredTargets=[]),this.callSuper("_onObjectRemoved",r)},_fireSelectionEvents:function(r,i){var a=!1,s=this.getActiveObjects(),c=[],l=[];r.forEach(function(u){s.indexOf(u)===-1&&(a=!0,u.fire("deselected",{e:i,target:u}),l.push(u))}),s.forEach(function(u){r.indexOf(u)===-1&&(a=!0,u.fire("selected",{e:i,target:u}),c.push(u))}),r.length>0&&s.length>0?a&&this.fire("selection:updated",{e:i,selected:c,deselected:l}):s.length>0?this.fire("selection:created",{e:i,selected:c}):r.length>0&&this.fire("selection:cleared",{e:i,deselected:l})},setActiveObject:function(r,i){var a=this.getActiveObjects();return this._setActiveObject(r,i),this._fireSelectionEvents(a,i),this},_setActiveObject:function(r,i){return this._activeObject===r||!this._discardActiveObject(i,r)||r.onSelect({e:i})?!1:(this._activeObject=r,!0)},_discardActiveObject:function(r,i){var a=this._activeObject;if(a){if(a.onDeselect({e:r,object:i}))return!1;this._activeObject=null}return!0},discardActiveObject:function(r){var i=this.getActiveObjects(),a=this.getActiveObject();return i.length&&this.fire("before:selection:cleared",{target:a,e:r}),this._discardActiveObject(r),this._fireSelectionEvents(i,r),this},dispose:function(){var r=this.wrapperEl;return this.removeListeners(),r.removeChild(this.upperCanvasEl),r.removeChild(this.lowerCanvasEl),this.contextCache=null,this.contextTop=null,["upperCanvasEl","cacheCanvasEl"].forEach(function(i){g.util.cleanUpJsdomNode(this[i]),this[i]=void 0}.bind(this)),r.parentNode&&r.parentNode.replaceChild(this.lowerCanvasEl,this.wrapperEl),delete this.wrapperEl,g.StaticCanvas.prototype.dispose.call(this),this},clear:function(){return this.discardActiveObject(),this.clearContext(this.contextTop),this.callSuper("clear")},drawControls:function(r){var i=this._activeObject;i&&i._renderControls(r)},_toObject:function(r,i,a){var s=this._realizeGroupTransformOnObject(r),c=this.callSuper("_toObject",r,i,a);return this._unwindGroupTransformOnObject(r,s),c},_realizeGroupTransformOnObject:function(r){if(r.group&&r.group.type==="activeSelection"&&this._activeObject===r.group){var i=["angle","flipX","flipY","left","scaleX","scaleY","skewX","skewY","top"],a={};return i.forEach(function(s){a[s]=r[s]}),g.util.addTransformToObject(r,this._activeObject.calcOwnMatrix()),a}else return null},_unwindGroupTransformOnObject:function(r,i){i&&r.set(i)},_setSVGObject:function(r,i,a){var s=this._realizeGroupTransformOnObject(i);this.callSuper("_setSVGObject",r,i,a),this._unwindGroupTransformOnObject(i,s)},setViewportTransform:function(r){this.renderOnAddRemove&&this._activeObject&&this._activeObject.isEditing&&this._activeObject.clearContextTop(),g.StaticCanvas.prototype.setViewportTransform.call(this,r)}});for(var o in g.StaticCanvas)o!=="prototype"&&(g.Canvas[o]=g.StaticCanvas[o])})();(function(){var t=g.util.addListener,e=g.util.removeListener,n=3,o=2,r=1,i={passive:!1};function a(s,c){return s.button&&s.button===c-1}g.util.object.extend(g.Canvas.prototype,{mainTouchId:null,_initEventListeners:function(){this.removeListeners(),this._bindEvents(),this.addOrRemove(t,"add")},_getEventPrefix:function(){return this.enablePointerEvents?"pointer":"mouse"},addOrRemove:function(s,c){var l=this.upperCanvasEl,u=this._getEventPrefix();s(g.window,"resize",this._onResize),s(l,u+"down",this._onMouseDown),s(l,u+"move",this._onMouseMove,i),s(l,u+"out",this._onMouseOut),s(l,u+"enter",this._onMouseEnter),s(l,"wheel",this._onMouseWheel),s(l,"contextmenu",this._onContextMenu),s(l,"dblclick",this._onDoubleClick),s(l,"dragover",this._onDragOver),s(l,"dragenter",this._onDragEnter),s(l,"dragleave",this._onDragLeave),s(l,"drop",this._onDrop),this.enablePointerEvents||s(l,"touchstart",this._onTouchStart,i),typeof eventjs<"u"&&c in eventjs&&(eventjs[c](l,"gesture",this._onGesture),eventjs[c](l,"drag",this._onDrag),eventjs[c](l,"orientation",this._onOrientationChange),eventjs[c](l,"shake",this._onShake),eventjs[c](l,"longpress",this._onLongPress))},removeListeners:function(){this.addOrRemove(e,"remove");var s=this._getEventPrefix();e(g.document,s+"up",this._onMouseUp),e(g.document,"touchend",this._onTouchEnd,i),e(g.document,s+"move",this._onMouseMove,i),e(g.document,"touchmove",this._onMouseMove,i)},_bindEvents:function(){this.eventsBound||(this._onMouseDown=this._onMouseDown.bind(this),this._onTouchStart=this._onTouchStart.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this._onMouseUp=this._onMouseUp.bind(this),this._onTouchEnd=this._onTouchEnd.bind(this),this._onResize=this._onResize.bind(this),this._onGesture=this._onGesture.bind(this),this._onDrag=this._onDrag.bind(this),this._onShake=this._onShake.bind(this),this._onLongPress=this._onLongPress.bind(this),this._onOrientationChange=this._onOrientationChange.bind(this),this._onMouseWheel=this._onMouseWheel.bind(this),this._onMouseOut=this._onMouseOut.bind(this),this._onMouseEnter=this._onMouseEnter.bind(this),this._onContextMenu=this._onContextMenu.bind(this),this._onDoubleClick=this._onDoubleClick.bind(this),this._onDragOver=this._onDragOver.bind(this),this._onDragEnter=this._simpleEventHandler.bind(this,"dragenter"),this._onDragLeave=this._simpleEventHandler.bind(this,"dragleave"),this._onDrop=this._onDrop.bind(this),this.eventsBound=!0)},_onGesture:function(s,c){this.__onTransformGesture&&this.__onTransformGesture(s,c)},_onDrag:function(s,c){this.__onDrag&&this.__onDrag(s,c)},_onMouseWheel:function(s){this.__onMouseWheel(s)},_onMouseOut:function(s){var c=this._hoveredTarget;this.fire("mouse:out",{target:c,e:s}),this._hoveredTarget=null,c&&c.fire("mouseout",{e:s});var l=this;this._hoveredTargets.forEach(function(u){l.fire("mouse:out",{target:c,e:s}),u&&c.fire("mouseout",{e:s})}),this._hoveredTargets=[]},_onMouseEnter:function(s){!this._currentTransform&&!this.findTarget(s)&&(this.fire("mouse:over",{target:null,e:s}),this._hoveredTarget=null,this._hoveredTargets=[])},_onOrientationChange:function(s,c){this.__onOrientationChange&&this.__onOrientationChange(s,c)},_onShake:function(s,c){this.__onShake&&this.__onShake(s,c)},_onLongPress:function(s,c){this.__onLongPress&&this.__onLongPress(s,c)},_onDragOver:function(s){s.preventDefault();var c=this._simpleEventHandler("dragover",s);this._fireEnterLeaveEvents(c,s)},_onDrop:function(s){return this._simpleEventHandler("drop:before",s),this._simpleEventHandler("drop",s)},_onContextMenu:function(s){return this.stopContextMenu&&(s.stopPropagation(),s.preventDefault()),!1},_onDoubleClick:function(s){this._cacheTransformEventData(s),this._handleEvent(s,"dblclick"),this._resetTransformEventData(s)},getPointerId:function(s){var c=s.changedTouches;return c?c[0]&&c[0].identifier:this.enablePointerEvents?s.pointerId:-1},_isMainEvent:function(s){return s.isPrimary===!0?!0:s.isPrimary===!1?!1:s.type==="touchend"&&s.touches.length===0?!0:s.changedTouches?s.changedTouches[0].identifier===this.mainTouchId:!0},_onTouchStart:function(s){s.preventDefault(),this.mainTouchId===null&&(this.mainTouchId=this.getPointerId(s)),this.__onMouseDown(s),this._resetTransformEventData();var c=this.upperCanvasEl,l=this._getEventPrefix();t(g.document,"touchend",this._onTouchEnd,i),t(g.document,"touchmove",this._onMouseMove,i),e(c,l+"down",this._onMouseDown)},_onMouseDown:function(s){this.__onMouseDown(s),this._resetTransformEventData();var c=this.upperCanvasEl,l=this._getEventPrefix();e(c,l+"move",this._onMouseMove,i),t(g.document,l+"up",this._onMouseUp),t(g.document,l+"move",this._onMouseMove,i)},_onTouchEnd:function(s){if(!(s.touches.length>0)){this.__onMouseUp(s),this._resetTransformEventData(),this.mainTouchId=null;var c=this._getEventPrefix();e(g.document,"touchend",this._onTouchEnd,i),e(g.document,"touchmove",this._onMouseMove,i);var l=this;this._willAddMouseDown&&clearTimeout(this._willAddMouseDown),this._willAddMouseDown=setTimeout(function(){t(l.upperCanvasEl,c+"down",l._onMouseDown),l._willAddMouseDown=0},400)}},_onMouseUp:function(s){this.__onMouseUp(s),this._resetTransformEventData();var c=this.upperCanvasEl,l=this._getEventPrefix();this._isMainEvent(s)&&(e(g.document,l+"up",this._onMouseUp),e(g.document,l+"move",this._onMouseMove,i),t(c,l+"move",this._onMouseMove,i))},_onMouseMove:function(s){!this.allowTouchScrolling&&s.preventDefault&&s.preventDefault(),this.__onMouseMove(s)},_onResize:function(){this.calcOffset()},_shouldRender:function(s){var c=this._activeObject;return!!c!=!!s||c&&s&&c!==s?!0:(c&&c.isEditing,!1)},__onMouseUp:function(s){var c,l=this._currentTransform,u=this._groupSelector,d=!1,f=!u||u.left===0&&u.top===0;if(this._cacheTransformEventData(s),c=this._target,this._handleEvent(s,"up:before"),a(s,n)){this.fireRightClick&&this._handleEvent(s,"up",n,f);return}if(a(s,o)){this.fireMiddleClick&&this._handleEvent(s,"up",o,f),this._resetTransformEventData();return}if(this.isDrawingMode&&this._isCurrentlyDrawing){this._onMouseUpInDrawingMode(s);return}if(this._isMainEvent(s)){if(l&&(this._finalizeCurrentTransform(s),d=l.actionPerformed),!f){var p=c===this._activeObject;this._maybeGroupObjects(s),d||(d=this._shouldRender(c)||!p&&c===this._activeObject)}var m,h;if(c){if(m=c._findTargetCorner(this.getPointer(s,!0),g.util.isTouchEvent(s)),c.selectable&&c!==this._activeObject&&c.activeOn==="up")this.setActiveObject(c,s),d=!0;else{var b=c.controls[m],x=b&&b.getMouseUpHandler(s,c,b);x&&(h=this.getPointer(s),x(s,l,h.x,h.y))}c.isMoving=!1}if(l&&(l.target!==c||l.corner!==m)){var y=l.target&&l.target.controls[l.corner],M=y&&y.getMouseUpHandler(s,c,b);h=h||this.getPointer(s),M&&M(s,l,h.x,h.y)}this._setCursorFromEvent(s,c),this._handleEvent(s,"up",r,f),this._groupSelector=null,this._currentTransform=null,c&&(c.__corner=0),d?this.requestRenderAll():f||this.renderTop()}},_simpleEventHandler:function(s,c){var l=this.findTarget(c),u=this.targets,d={e:c,target:l,subTargets:u};if(this.fire(s,d),l&&l.fire(s,d),!u)return l;for(var f=0;f<u.length;f++)u[f].fire(s,d);return l},_handleEvent:function(s,c,l,u){var d=this._target,f=this.targets||[],p={e:s,target:d,subTargets:f,button:l||r,isClick:u||!1,pointer:this._pointer,absolutePointer:this._absolutePointer,transform:this._currentTransform};c==="up"&&(p.currentTarget=this.findTarget(s),p.currentSubTargets=this.targets),this.fire("mouse:"+c,p),d&&d.fire("mouse"+c,p);for(var m=0;m<f.length;m++)f[m].fire("mouse"+c,p)},_finalizeCurrentTransform:function(s){var c=this._currentTransform,l=c.target,u={e:s,target:l,transform:c,action:c.action};l._scaling&&(l._scaling=!1),l.setCoords(),(c.actionPerformed||this.stateful&&l.hasStateChanged())&&this._fire("modified",u)},_onMouseDownInDrawingMode:function(s){this._isCurrentlyDrawing=!0,this.getActiveObject()&&this.discardActiveObject(s).requestRenderAll();var c=this.getPointer(s);this.freeDrawingBrush.onMouseDown(c,{e:s,pointer:c}),this._handleEvent(s,"down")},_onMouseMoveInDrawingMode:function(s){if(this._isCurrentlyDrawing){var c=this.getPointer(s);this.freeDrawingBrush.onMouseMove(c,{e:s,pointer:c})}this.setCursor(this.freeDrawingCursor),this._handleEvent(s,"move")},_onMouseUpInDrawingMode:function(s){var c=this.getPointer(s);this._isCurrentlyDrawing=this.freeDrawingBrush.onMouseUp({e:s,pointer:c}),this._handleEvent(s,"up")},__onMouseDown:function(s){this._cacheTransformEventData(s),this._handleEvent(s,"down:before");var c=this._target;if(a(s,n)){this.fireRightClick&&this._handleEvent(s,"down",n);return}if(a(s,o)){this.fireMiddleClick&&this._handleEvent(s,"down",o);return}if(this.isDrawingMode){this._onMouseDownInDrawingMode(s);return}if(this._isMainEvent(s)&&!this._currentTransform){var l=this._pointer;this._previousPointer=l;var u=this._shouldRender(c),d=this._shouldGroup(s,c);if(this._shouldClearSelection(s,c)?this.discardActiveObject(s):d&&(this._handleGrouping(s,c),c=this._activeObject),this.selection&&(!c||!c.selectable&&!c.isEditing&&c!==this._activeObject)&&(this._groupSelector={ex:this._absolutePointer.x,ey:this._absolutePointer.y,top:0,left:0}),c){var f=c===this._activeObject;c.selectable&&c.activeOn==="down"&&this.setActiveObject(c,s);var p=c._findTargetCorner(this.getPointer(s,!0),g.util.isTouchEvent(s));if(c.__corner=p,c===this._activeObject&&(p||!d)){this._setupCurrentTransform(s,c,f);var m=c.controls[p],l=this.getPointer(s),h=m&&m.getMouseDownHandler(s,c,m);h&&h(s,this._currentTransform,l.x,l.y)}}this._handleEvent(s,"down"),(u||d)&&this.requestRenderAll()}},_resetTransformEventData:function(){this._target=null,this._pointer=null,this._absolutePointer=null},_cacheTransformEventData:function(s){this._resetTransformEventData(),this._pointer=this.getPointer(s,!0),this._absolutePointer=this.restorePointerVpt(this._pointer),this._target=this._currentTransform?this._currentTransform.target:this.findTarget(s)||null},_beforeTransform:function(s){var c=this._currentTransform;this.stateful&&c.target.saveState(),this.fire("before:transform",{e:s,transform:c})},__onMouseMove:function(s){this._handleEvent(s,"move:before"),this._cacheTransformEventData(s);var c,l;if(this.isDrawingMode){this._onMouseMoveInDrawingMode(s);return}if(this._isMainEvent(s)){var u=this._groupSelector;u?(l=this._absolutePointer,u.left=l.x-u.ex,u.top=l.y-u.ey,this.renderTop()):this._currentTransform?this._transformObject(s):(c=this.findTarget(s)||null,this._setCursorFromEvent(s,c),this._fireOverOutEvents(c,s)),this._handleEvent(s,"move"),this._resetTransformEventData()}},_fireOverOutEvents:function(s,c){var l=this._hoveredTarget,u=this._hoveredTargets,d=this.targets,f=Math.max(u.length,d.length);this.fireSyntheticInOutEvents(s,c,{oldTarget:l,evtOut:"mouseout",canvasEvtOut:"mouse:out",evtIn:"mouseover",canvasEvtIn:"mouse:over"});for(var p=0;p<f;p++)this.fireSyntheticInOutEvents(d[p],c,{oldTarget:u[p],evtOut:"mouseout",evtIn:"mouseover"});this._hoveredTarget=s,this._hoveredTargets=this.targets.concat()},_fireEnterLeaveEvents:function(s,c){var l=this._draggedoverTarget,u=this._hoveredTargets,d=this.targets,f=Math.max(u.length,d.length);this.fireSyntheticInOutEvents(s,c,{oldTarget:l,evtOut:"dragleave",evtIn:"dragenter"});for(var p=0;p<f;p++)this.fireSyntheticInOutEvents(d[p],c,{oldTarget:u[p],evtOut:"dragleave",evtIn:"dragenter"});this._draggedoverTarget=s},fireSyntheticInOutEvents:function(s,c,l){var u,d,f=l.oldTarget,p,m,h=f!==s,b=l.canvasEvtIn,x=l.canvasEvtOut;h&&(u={e:c,target:s,previousTarget:f},d={e:c,target:f,nextTarget:s}),m=s&&h,p=f&&h,p&&(x&&this.fire(x,d),f.fire(l.evtOut,d)),m&&(b&&this.fire(b,u),s.fire(l.evtIn,u))},__onMouseWheel:function(s){this._cacheTransformEventData(s),this._handleEvent(s,"wheel"),this._resetTransformEventData()},_transformObject:function(s){var c=this.getPointer(s),l=this._currentTransform;l.reset=!1,l.shiftKey=s.shiftKey,l.altKey=s[this.centeredKey],this._performTransformAction(s,l,c),l.actionPerformed&&this.requestRenderAll()},_performTransformAction:function(s,c,l){var u=l.x,d=l.y,f=c.action,p=!1,m=c.actionHandler;m&&(p=m(s,c,u,d)),f==="drag"&&p&&(c.target.isMoving=!0,this.setCursor(c.target.moveCursor||this.moveCursor)),c.actionPerformed=c.actionPerformed||p},_fire:g.controlsUtils.fireEvent,_setCursorFromEvent:function(s,c){if(!c)return this.setCursor(this.defaultCursor),!1;var l=c.hoverCursor||this.hoverCursor,u=this._activeObject&&this._activeObject.type==="activeSelection"?this._activeObject:null,d=(!u||!u.contains(c))&&c._findTargetCorner(this.getPointer(s,!0));d?this.setCursor(this.getCornerCursor(d,c,s)):(c.subTargetCheck&&this.targets.concat().reverse().map(function(f){l=f.hoverCursor||l}),this.setCursor(l))},getCornerCursor:function(s,c,l){var u=c.controls[s];return u.cursorStyleHandler(l,u,c)}})})();(function(){var t=Math.min,e=Math.max;g.util.object.extend(g.Canvas.prototype,{_shouldGroup:function(n,o){var r=this._activeObject;return r&&this._isSelectionKeyPressed(n)&&o&&o.selectable&&this.selection&&(r!==o||r.type==="activeSelection")&&!o.onSelect({e:n})},_handleGrouping:function(n,o){var r=this._activeObject;r.__corner||o===r&&(o=this.findTarget(n,!0),!o||!o.selectable)||(r&&r.type==="activeSelection"?this._updateActiveSelection(o,n):this._createActiveSelection(o,n))},_updateActiveSelection:function(n,o){var r=this._activeObject,i=r._objects.slice(0);r.contains(n)?(r.removeWithUpdate(n),this._hoveredTarget=n,this._hoveredTargets=this.targets.concat(),r.size()===1&&this._setActiveObject(r.item(0),o)):(r.addWithUpdate(n),this._hoveredTarget=r,this._hoveredTargets=this.targets.concat()),this._fireSelectionEvents(i,o)},_createActiveSelection:function(n,o){var r=this.getActiveObjects(),i=this._createGroup(n);this._hoveredTarget=i,this._setActiveObject(i,o),this._fireSelectionEvents(r,o)},_createGroup:function(n){var o=this._objects,r=o.indexOf(this._activeObject)<o.indexOf(n),i=r?[this._activeObject,n]:[n,this._activeObject];return this._activeObject.isEditing&&this._activeObject.exitEditing(),new g.ActiveSelection(i,{canvas:this})},_groupSelectedObjects:function(n){var o=this._collectObjects(n),r;o.length===1?this.setActiveObject(o[0],n):o.length>1&&(r=new g.ActiveSelection(o.reverse(),{canvas:this}),this.setActiveObject(r,n))},_collectObjects:function(n){for(var o=[],r,i=this._groupSelector.ex,a=this._groupSelector.ey,s=i+this._groupSelector.left,c=a+this._groupSelector.top,l=new g.Point(t(i,s),t(a,c)),u=new g.Point(e(i,s),e(a,c)),d=!this.selectionFullyContained,f=i===s&&a===c,p=this._objects.length;p--&&(r=this._objects[p],!(!(!r||!r.selectable||!r.visible)&&(d&&r.intersectsWithRect(l,u,!0)||r.isContainedWithinRect(l,u,!0)||d&&r.containsPoint(l,null,!0)||d&&r.containsPoint(u,null,!0))&&(o.push(r),f))););return o.length>1&&(o=o.filter(function(m){return!m.onSelect({e:n})})),o},_maybeGroupObjects:function(n){this.selection&&this._groupSelector&&this._groupSelectedObjects(n),this.setCursor(this.defaultCursor),this._groupSelector=null}})})();(function(){g.util.object.extend(g.StaticCanvas.prototype,{toDataURL:function(t){t||(t={});var e=t.format||"png",n=t.quality||1,o=(t.multiplier||1)*(t.enableRetinaScaling?this.getRetinaScaling():1),r=this.toCanvasElement(o,t);return g.util.toDataURL(r,e,n)},toCanvasElement:function(t,e){t=t||1,e=e||{};var n=(e.width||this.width)*t,o=(e.height||this.height)*t,r=this.getZoom(),i=this.width,a=this.height,s=r*t,c=this.viewportTransform,l=(c[4]-(e.left||0))*t,u=(c[5]-(e.top||0))*t,d=this.interactive,f=[s,0,0,s,l,u],p=this.enableRetinaScaling,m=g.util.createCanvasElement(),h=this.contextTop;return m.width=n,m.height=o,this.contextTop=null,this.enableRetinaScaling=!1,this.interactive=!1,this.viewportTransform=f,this.width=n,this.height=o,this.calcViewportBoundaries(),this.renderCanvas(m.getContext("2d"),this._objects),this.viewportTransform=c,this.width=i,this.height=a,this.calcViewportBoundaries(),this.interactive=d,this.enableRetinaScaling=p,this.contextTop=h,m}})})();g.util.object.extend(g.StaticCanvas.prototype,{loadFromJSON:function(t,e,n){if(t){var o=typeof t=="string"?JSON.parse(t):g.util.object.clone(t),r=this,i=o.clipPath,a=this.renderOnAddRemove;return this.renderOnAddRemove=!1,delete o.clipPath,this._enlivenObjects(o.objects,function(s){r.clear(),r._setBgOverlay(o,function(){i?r._enlivenObjects([i],function(c){r.clipPath=c[0],r.__setupCanvas.call(r,o,s,a,e)}):r.__setupCanvas.call(r,o,s,a,e)})},n),this}},__setupCanvas:function(t,e,n,o){var r=this;e.forEach(function(i,a){r.insertAt(i,a)}),this.renderOnAddRemove=n,delete t.objects,delete t.backgroundImage,delete t.overlayImage,delete t.background,delete t.overlay,this._setOptions(t),this.renderAll(),o&&o()},_setBgOverlay:function(t,e){var n={backgroundColor:!1,overlayColor:!1,backgroundImage:!1,overlayImage:!1};if(!t.backgroundImage&&!t.overlayImage&&!t.background&&!t.overlay){e&&e();return}var o=function(){n.backgroundImage&&n.overlayImage&&n.backgroundColor&&n.overlayColor&&e&&e()};this.__setBgOverlay("backgroundImage",t.backgroundImage,n,o),this.__setBgOverlay("overlayImage",t.overlayImage,n,o),this.__setBgOverlay("backgroundColor",t.background,n,o),this.__setBgOverlay("overlayColor",t.overlay,n,o)},__setBgOverlay:function(t,e,n,o){var r=this;if(!e){n[t]=!0,o&&o();return}t==="backgroundImage"||t==="overlayImage"?g.util.enlivenObjects([e],function(i){r[t]=i[0],n[t]=!0,o&&o()}):this["set"+g.util.string.capitalize(t,!0)](e,function(){n[t]=!0,o&&o()})},_enlivenObjects:function(t,e,n){if(!t||t.length===0){e&&e([]);return}g.util.enlivenObjects(t,function(o){e&&e(o)},null,n)},_toDataURL:function(t,e){this.clone(function(n){e(n.toDataURL(t))})},_toDataURLWithMultiplier:function(t,e,n){this.clone(function(o){n(o.toDataURLWithMultiplier(t,e))})},clone:function(t,e){var n=JSON.stringify(this.toJSON(e));this.cloneWithoutData(function(o){o.loadFromJSON(n,function(){t&&t(o)})})},cloneWithoutData:function(t){var e=g.util.createCanvasElement();e.width=this.width,e.height=this.height;var n=new g.Canvas(e);this.backgroundImage?(n.setBackgroundImage(this.backgroundImage.src,function(){n.renderAll(),t&&t(n)}),n.backgroundImageOpacity=this.backgroundImageOpacity,n.backgroundImageStretch=this.backgroundImageStretch):t&&t(n)}});(function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.util.object.extend,o=e.util.object.clone,r=e.util.toFixed,i=e.util.string.capitalize,a=e.util.degreesToRadians,s=!e.isLikelyNode,c=2;e.Object||(e.Object=e.util.createClass(e.CommonMethods,{type:"object",originX:"left",originY:"top",top:0,left:0,width:0,height:0,scaleX:1,scaleY:1,flipX:!1,flipY:!1,opacity:1,angle:0,skewX:0,skewY:0,cornerSize:13,touchCornerSize:24,transparentCorners:!0,hoverCursor:null,moveCursor:null,padding:0,borderColor:"rgb(178,204,255)",borderDashArray:null,cornerColor:"rgb(178,204,255)",cornerStrokeColor:null,cornerStyle:"rect",cornerDashArray:null,centeredScaling:!1,centeredRotation:!0,fill:"rgb(0,0,0)",fillRule:"nonzero",globalCompositeOperation:"source-over",backgroundColor:"",selectionBackgroundColor:"",stroke:null,strokeWidth:1,strokeDashArray:null,strokeDashOffset:0,strokeLineCap:"butt",strokeLineJoin:"miter",strokeMiterLimit:4,shadow:null,borderOpacityWhenMoving:.4,borderScaleFactor:1,minScaleLimit:0,selectable:!0,evented:!0,visible:!0,hasControls:!0,hasBorders:!0,perPixelTargetFind:!1,includeDefaultValues:!0,lockMovementX:!1,lockMovementY:!1,lockRotation:!1,lockScalingX:!1,lockScalingY:!1,lockSkewingX:!1,lockSkewingY:!1,lockScalingFlip:!1,excludeFromExport:!1,objectCaching:s,statefullCache:!1,noScaleCache:!0,strokeUniform:!1,dirty:!0,__corner:0,paintFirst:"fill",activeOn:"down",stateProperties:"top left width height scaleX scaleY flipX flipY originX originY transformMatrix stroke strokeWidth strokeDashArray strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit angle opacity fill globalCompositeOperation shadow visible backgroundColor skewX skewY fillRule paintFirst clipPath strokeUniform".split(" "),cacheProperties:"fill stroke strokeWidth strokeDashArray width height paintFirst strokeUniform strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit backgroundColor clipPath".split(" "),colorProperties:"fill stroke backgroundColor".split(" "),clipPath:void 0,inverted:!1,absolutePositioned:!1,initialize:function(l){l&&this.setOptions(l)},_createCacheCanvas:function(){this._cacheProperties={},this._cacheCanvas=e.util.createCanvasElement(),this._cacheContext=this._cacheCanvas.getContext("2d"),this._updateCacheCanvas(),this.dirty=!0},_limitCacheSize:function(l){var u=e.perfLimitSizeTotal,d=l.width,f=l.height,p=e.maxCacheSideLimit,m=e.minCacheSideLimit;if(d<=p&&f<=p&&d*f<=u)return d<m&&(l.width=m),f<m&&(l.height=m),l;var h=d/f,b=e.util.limitDimsByArea(h,u),x=e.util.capValue,y=x(m,b.x,p),M=x(m,b.y,p);return d>y&&(l.zoomX/=d/y,l.width=y,l.capped=!0),f>M&&(l.zoomY/=f/M,l.height=M,l.capped=!0),l},_getCacheCanvasDimensions:function(){var l=this.getTotalObjectScaling(),u=this._getTransformedDimensions(0,0),d=u.x*l.scaleX/this.scaleX,f=u.y*l.scaleY/this.scaleY;return{width:d+c,height:f+c,zoomX:l.scaleX,zoomY:l.scaleY,x:d,y:f}},_updateCacheCanvas:function(){var l=this.canvas;if(this.noScaleCache&&l&&l._currentTransform){var u=l._currentTransform.target,d=l._currentTransform.action;if(this===u&&d.slice&&d.slice(0,5)==="scale")return!1}var f=this._cacheCanvas,p=this._limitCacheSize(this._getCacheCanvasDimensions()),m=e.minCacheSideLimit,h=p.width,b=p.height,x,y,M=p.zoomX,E=p.zoomY,C=h!==this.cacheWidth||b!==this.cacheHeight,j=this.zoomX!==M||this.zoomY!==E,P=C||j,D=0,N=0,S=!1;if(C){var G=this._cacheCanvas.width,v=this._cacheCanvas.height,T=h>G||b>v,R=(h<G*.9||b<v*.9)&&G>m&&v>m;S=T||R,T&&!p.capped&&(h>m||b>m)&&(D=h*.1,N=b*.1)}return this instanceof e.Text&&this.path&&(P=!0,S=!0,D+=this.getHeightOfLine(0)*this.zoomX,N+=this.getHeightOfLine(0)*this.zoomY),P?(S?(f.width=Math.ceil(h+D),f.height=Math.ceil(b+N)):(this._cacheContext.setTransform(1,0,0,1,0,0),this._cacheContext.clearRect(0,0,f.width,f.height)),x=p.x/2,y=p.y/2,this.cacheTranslationX=Math.round(f.width/2-x)+x,this.cacheTranslationY=Math.round(f.height/2-y)+y,this.cacheWidth=h,this.cacheHeight=b,this._cacheContext.translate(this.cacheTranslationX,this.cacheTranslationY),this._cacheContext.scale(M,E),this.zoomX=M,this.zoomY=E,!0):!1},setOptions:function(l){this._setOptions(l),this._initGradient(l.fill,"fill"),this._initGradient(l.stroke,"stroke"),this._initPattern(l.fill,"fill"),this._initPattern(l.stroke,"stroke")},transform:function(l){var u=this.group&&!this.group._transformDone||this.group&&this.canvas&&l===this.canvas.contextTop,d=this.calcTransformMatrix(!u);l.transform(d[0],d[1],d[2],d[3],d[4],d[5])},toObject:function(l){var u=e.Object.NUM_FRACTION_DIGITS,d={type:this.type,version:e.version,originX:this.originX,originY:this.originY,left:r(this.left,u),top:r(this.top,u),width:r(this.width,u),height:r(this.height,u),fill:this.fill&&this.fill.toObject?this.fill.toObject():this.fill,stroke:this.stroke&&this.stroke.toObject?this.stroke.toObject():this.stroke,strokeWidth:r(this.strokeWidth,u),strokeDashArray:this.strokeDashArray?this.strokeDashArray.concat():this.strokeDashArray,strokeLineCap:this.strokeLineCap,strokeDashOffset:this.strokeDashOffset,strokeLineJoin:this.strokeLineJoin,strokeUniform:this.strokeUniform,strokeMiterLimit:r(this.strokeMiterLimit,u),scaleX:r(this.scaleX,u),scaleY:r(this.scaleY,u),angle:r(this.angle,u),flipX:this.flipX,flipY:this.flipY,opacity:r(this.opacity,u),shadow:this.shadow&&this.shadow.toObject?this.shadow.toObject():this.shadow,visible:this.visible,backgroundColor:this.backgroundColor,fillRule:this.fillRule,paintFirst:this.paintFirst,globalCompositeOperation:this.globalCompositeOperation,skewX:r(this.skewX,u),skewY:r(this.skewY,u)};return this.clipPath&&!this.clipPath.excludeFromExport&&(d.clipPath=this.clipPath.toObject(l),d.clipPath.inverted=this.clipPath.inverted,d.clipPath.absolutePositioned=this.clipPath.absolutePositioned),e.util.populateWithProperties(this,d,l),this.includeDefaultValues||(d=this._removeDefaultValues(d)),d},toDatalessObject:function(l){return this.toObject(l)},_removeDefaultValues:function(l){var u=e.util.getKlass(l.type).prototype,d=u.stateProperties;return d.forEach(function(f){f==="left"||f==="top"||(l[f]===u[f]&&delete l[f],Array.isArray(l[f])&&Array.isArray(u[f])&&l[f].length===0&&u[f].length===0&&delete l[f])}),l},toString:function(){return"#<fabric."+i(this.type)+">"},getObjectScaling:function(){if(!this.group)return{scaleX:this.scaleX,scaleY:this.scaleY};var l=e.util.qrDecompose(this.calcTransformMatrix());return{scaleX:Math.abs(l.scaleX),scaleY:Math.abs(l.scaleY)}},getTotalObjectScaling:function(){var l=this.getObjectScaling(),u=l.scaleX,d=l.scaleY;if(this.canvas){var f=this.canvas.getZoom(),p=this.canvas.getRetinaScaling();u*=f*p,d*=f*p}return{scaleX:u,scaleY:d}},getObjectOpacity:function(){var l=this.opacity;return this.group&&(l*=this.group.getObjectOpacity()),l},_set:function(l,u){var d=l==="scaleX"||l==="scaleY",f=this[l]!==u,p=!1;return d&&(u=this._constrainScale(u)),l==="scaleX"&&u<0?(this.flipX=!this.flipX,u*=-1):l==="scaleY"&&u<0?(this.flipY=!this.flipY,u*=-1):l==="shadow"&&u&&!(u instanceof e.Shadow)?u=new e.Shadow(u):l==="dirty"&&this.group&&this.group.set("dirty",u),this[l]=u,f&&(p=this.group&&this.group.isOnACache(),this.cacheProperties.indexOf(l)>-1?(this.dirty=!0,p&&this.group.set("dirty",!0)):p&&this.stateProperties.indexOf(l)>-1&&this.group.set("dirty",!0)),this},setOnGroup:function(){},getViewportTransform:function(){return this.canvas&&this.canvas.viewportTransform?this.canvas.viewportTransform:e.iMatrix.concat()},isNotVisible:function(){return this.opacity===0||!this.width&&!this.height&&this.strokeWidth===0||!this.visible},render:function(l){this.isNotVisible()||this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(l.save(),this._setupCompositeOperation(l),this.drawSelectionBackground(l),this.transform(l),this._setOpacity(l),this._setShadow(l,this),this.shouldCache()?(this.renderCache(),this.drawCacheOnCanvas(l)):(this._removeCacheCanvas(),this.dirty=!1,this.drawObject(l),this.objectCaching&&this.statefullCache&&this.saveState({propertySet:"cacheProperties"})),l.restore())},renderCache:function(l){l=l||{},(!this._cacheCanvas||!this._cacheContext)&&this._createCacheCanvas(),this.isCacheDirty()&&(this.statefullCache&&this.saveState({propertySet:"cacheProperties"}),this.drawObject(this._cacheContext,l.forClipping),this.dirty=!1)},_removeCacheCanvas:function(){this._cacheCanvas=null,this._cacheContext=null,this.cacheWidth=0,this.cacheHeight=0},hasStroke:function(){return this.stroke&&this.stroke!=="transparent"&&this.strokeWidth!==0},hasFill:function(){return this.fill&&this.fill!=="transparent"},needsItsOwnCache:function(){return!!(this.paintFirst==="stroke"&&this.hasFill()&&this.hasStroke()&&typeof this.shadow=="object"||this.clipPath)},shouldCache:function(){return this.ownCaching=this.needsItsOwnCache()||this.objectCaching&&(!this.group||!this.group.isOnACache()),this.ownCaching},willDrawShadow:function(){return!!this.shadow&&(this.shadow.offsetX!==0||this.shadow.offsetY!==0)},drawClipPathOnCache:function(l,u){if(l.save(),u.inverted?l.globalCompositeOperation="destination-out":l.globalCompositeOperation="destination-in",u.absolutePositioned){var d=e.util.invertTransform(this.calcTransformMatrix());l.transform(d[0],d[1],d[2],d[3],d[4],d[5])}u.transform(l),l.scale(1/u.zoomX,1/u.zoomY),l.drawImage(u._cacheCanvas,-u.cacheTranslationX,-u.cacheTranslationY),l.restore()},drawObject:function(l,u){var d=this.fill,f=this.stroke;u?(this.fill="black",this.stroke="",this._setClippingProperties(l)):this._renderBackground(l),this._render(l),this._drawClipPath(l,this.clipPath),this.fill=d,this.stroke=f},_drawClipPath:function(l,u){u&&(u.canvas=this.canvas,u.shouldCache(),u._transformDone=!0,u.renderCache({forClipping:!0}),this.drawClipPathOnCache(l,u))},drawCacheOnCanvas:function(l){l.scale(1/this.zoomX,1/this.zoomY),l.drawImage(this._cacheCanvas,-this.cacheTranslationX,-this.cacheTranslationY)},isCacheDirty:function(l){if(this.isNotVisible())return!1;if(this._cacheCanvas&&this._cacheContext&&!l&&this._updateCacheCanvas())return!0;if(this.dirty||this.clipPath&&this.clipPath.absolutePositioned||this.statefullCache&&this.hasStateChanged("cacheProperties")){if(this._cacheCanvas&&this._cacheContext&&!l){var u=this.cacheWidth/this.zoomX,d=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-u/2,-d/2,u,d)}return!0}return!1},_renderBackground:function(l){if(this.backgroundColor){var u=this._getNonTransformedDimensions();l.fillStyle=this.backgroundColor,l.fillRect(-u.x/2,-u.y/2,u.x,u.y),this._removeShadow(l)}},_setOpacity:function(l){this.group&&!this.group._transformDone?l.globalAlpha=this.getObjectOpacity():l.globalAlpha*=this.opacity},_setStrokeStyles:function(l,u){var d=u.stroke;d&&(l.lineWidth=u.strokeWidth,l.lineCap=u.strokeLineCap,l.lineDashOffset=u.strokeDashOffset,l.lineJoin=u.strokeLineJoin,l.miterLimit=u.strokeMiterLimit,d.toLive?d.gradientUnits==="percentage"||d.gradientTransform||d.patternTransform?this._applyPatternForTransformedGradient(l,d):(l.strokeStyle=d.toLive(l,this),this._applyPatternGradientTransform(l,d)):l.strokeStyle=u.stroke)},_setFillStyles:function(l,u){var d=u.fill;d&&(d.toLive?(l.fillStyle=d.toLive(l,this),this._applyPatternGradientTransform(l,u.fill)):l.fillStyle=d)},_setClippingProperties:function(l){l.globalAlpha=1,l.strokeStyle="transparent",l.fillStyle="#000000"},_setLineDash:function(l,u){!u||u.length===0||(1&u.length&&u.push.apply(u,u),l.setLineDash(u))},_renderControls:function(l,u){var d=this.getViewportTransform(),f=this.calcTransformMatrix(),p,m,h;u=u||{},m=typeof u.hasBorders<"u"?u.hasBorders:this.hasBorders,h=typeof u.hasControls<"u"?u.hasControls:this.hasControls,f=e.util.multiplyTransformMatrices(d,f),p=e.util.qrDecompose(f),l.save(),l.translate(p.translateX,p.translateY),l.lineWidth=1*this.borderScaleFactor,this.group||(l.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1),this.flipX&&(p.angle-=180),l.rotate(a(this.group?p.angle:this.angle)),u.forActiveSelection||this.group?m&&this.drawBordersInGroup(l,p,u):m&&this.drawBorders(l,u),h&&this.drawControls(l,u),l.restore()},_setShadow:function(l){if(this.shadow){var u=this.shadow,d=this.canvas,f,p=d&&d.viewportTransform[0]||1,m=d&&d.viewportTransform[3]||1;u.nonScaling?f={scaleX:1,scaleY:1}:f=this.getObjectScaling(),d&&d._isRetinaScaling()&&(p*=e.devicePixelRatio,m*=e.devicePixelRatio),l.shadowColor=u.color,l.shadowBlur=u.blur*e.browserShadowBlurConstant*(p+m)*(f.scaleX+f.scaleY)/4,l.shadowOffsetX=u.offsetX*p*f.scaleX,l.shadowOffsetY=u.offsetY*m*f.scaleY}},_removeShadow:function(l){this.shadow&&(l.shadowColor="",l.shadowBlur=l.shadowOffsetX=l.shadowOffsetY=0)},_applyPatternGradientTransform:function(l,u){if(!u||!u.toLive)return{offsetX:0,offsetY:0};var d=u.gradientTransform||u.patternTransform,f=-this.width/2+u.offsetX||0,p=-this.height/2+u.offsetY||0;return u.gradientUnits==="percentage"?l.transform(this.width,0,0,this.height,f,p):l.transform(1,0,0,1,f,p),d&&l.transform(d[0],d[1],d[2],d[3],d[4],d[5]),{offsetX:f,offsetY:p}},_renderPaintInOrder:function(l){this.paintFirst==="stroke"?(this._renderStroke(l),this._renderFill(l)):(this._renderFill(l),this._renderStroke(l))},_render:function(){},_renderFill:function(l){this.fill&&(l.save(),this._setFillStyles(l,this),this.fillRule==="evenodd"?l.fill("evenodd"):l.fill(),l.restore())},_renderStroke:function(l){if(!(!this.stroke||this.strokeWidth===0)){if(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(l),l.save(),this.strokeUniform&&this.group){var u=this.getObjectScaling();l.scale(1/u.scaleX,1/u.scaleY)}else this.strokeUniform&&l.scale(1/this.scaleX,1/this.scaleY);this._setLineDash(l,this.strokeDashArray),this._setStrokeStyles(l,this),l.stroke(),l.restore()}},_applyPatternForTransformedGradient:function(l,u){var d=this._limitCacheSize(this._getCacheCanvasDimensions()),f=e.util.createCanvasElement(),p,m=this.canvas.getRetinaScaling(),h=d.x/this.scaleX/m,b=d.y/this.scaleY/m;f.width=h,f.height=b,p=f.getContext("2d"),p.beginPath(),p.moveTo(0,0),p.lineTo(h,0),p.lineTo(h,b),p.lineTo(0,b),p.closePath(),p.translate(h/2,b/2),p.scale(d.zoomX/this.scaleX/m,d.zoomY/this.scaleY/m),this._applyPatternGradientTransform(p,u),p.fillStyle=u.toLive(l),p.fill(),l.translate(-this.width/2-this.strokeWidth/2,-this.height/2-this.strokeWidth/2),l.scale(m*this.scaleX/d.zoomX,m*this.scaleY/d.zoomY),l.strokeStyle=p.createPattern(f,"no-repeat")},_findCenterFromElement:function(){return{x:this.left+this.width/2,y:this.top+this.height/2}},_assignTransformMatrixProps:function(){if(this.transformMatrix){var l=e.util.qrDecompose(this.transformMatrix);this.flipX=!1,this.flipY=!1,this.set("scaleX",l.scaleX),this.set("scaleY",l.scaleY),this.angle=l.angle,this.skewX=l.skewX,this.skewY=0}},_removeTransformMatrix:function(l){var u=this._findCenterFromElement();this.transformMatrix&&(this._assignTransformMatrixProps(),u=e.util.transformPoint(u,this.transformMatrix)),this.transformMatrix=null,l&&(this.scaleX*=l.scaleX,this.scaleY*=l.scaleY,this.cropX=l.cropX,this.cropY=l.cropY,u.x+=l.offsetLeft,u.y+=l.offsetTop,this.width=l.width,this.height=l.height),this.setPositionByOrigin(u,"center","center")},clone:function(l,u){var d=this.toObject(u);this.constructor.fromObject?this.constructor.fromObject(d,l):e.Object._fromObject("Object",d,l)},cloneAsImage:function(l,u){var d=this.toCanvasElement(u);return l&&l(new e.Image(d)),this},toCanvasElement:function(l){l||(l={});var u=e.util,d=u.saveObjectTransform(this),f=this.group,p=this.shadow,m=Math.abs,h=(l.multiplier||1)*(l.enableRetinaScaling?e.devicePixelRatio:1);delete this.group,l.withoutTransform&&u.resetObjectTransform(this),l.withoutShadow&&(this.shadow=null);var b=e.util.createCanvasElement(),x=this.getBoundingRect(!0,!0),y=this.shadow,M,E={x:0,y:0},C,j,P;y&&(C=y.blur,y.nonScaling?M={scaleX:1,scaleY:1}:M=this.getObjectScaling(),E.x=2*Math.round(m(y.offsetX)+C)*m(M.scaleX),E.y=2*Math.round(m(y.offsetY)+C)*m(M.scaleY)),j=x.width+E.x,P=x.height+E.y,b.width=Math.ceil(j),b.height=Math.ceil(P);var D=new e.StaticCanvas(b,{enableRetinaScaling:!1,renderOnAddRemove:!1,skipOffscreen:!1});l.format==="jpeg"&&(D.backgroundColor="#fff"),this.setPositionByOrigin(new e.Point(D.width/2,D.height/2),"center","center");var N=this.canvas;D.add(this);var S=D.toCanvasElement(h||1,l);return this.shadow=p,this.set("canvas",N),f&&(this.group=f),this.set(d).setCoords(),D._objects=[],D.dispose(),D=null,S},toDataURL:function(l){return l||(l={}),e.util.toDataURL(this.toCanvasElement(l),l.format||"png",l.quality||1)},isType:function(l){return arguments.length>1?Array.from(arguments).includes(this.type):this.type===l},complexity:function(){return 1},toJSON:function(l){return this.toObject(l)},rotate:function(l){var u=(this.originX!=="center"||this.originY!=="center")&&this.centeredRotation;return u&&this._setOriginToCenter(),this.set("angle",l),u&&this._resetOrigin(),this},centerH:function(){return this.canvas&&this.canvas.centerObjectH(this),this},viewportCenterH:function(){return this.canvas&&this.canvas.viewportCenterObjectH(this),this},centerV:function(){return this.canvas&&this.canvas.centerObjectV(this),this},viewportCenterV:function(){return this.canvas&&this.canvas.viewportCenterObjectV(this),this},center:function(){return this.canvas&&this.canvas.centerObject(this),this},viewportCenter:function(){return this.canvas&&this.canvas.viewportCenterObject(this),this},getLocalPointer:function(l,u){u=u||this.canvas.getPointer(l);var d=new e.Point(u.x,u.y),f=this._getLeftTopCoords();return this.angle&&(d=e.util.rotatePoint(d,f,a(-this.angle))),{x:d.x-f.x,y:d.y-f.y}},_setupCompositeOperation:function(l){this.globalCompositeOperation&&(l.globalCompositeOperation=this.globalCompositeOperation)},dispose:function(){e.runningAnimations&&e.runningAnimations.cancelByTarget(this)}}),e.util.createAccessors&&e.util.createAccessors(e.Object),n(e.Object.prototype,e.Observable),e.Object.NUM_FRACTION_DIGITS=2,e.Object.ENLIVEN_PROPS=["clipPath"],e.Object._fromObject=function(l,u,d,f){var p=e[l];u=o(u,!0),e.util.enlivenPatterns([u.fill,u.stroke],function(m){typeof m[0]<"u"&&(u.fill=m[0]),typeof m[1]<"u"&&(u.stroke=m[1]),e.util.enlivenObjectEnlivables(u,u,function(){var h=f?new p(u[f],u):new p(u);d&&d(h)})})},e.Object.__uid=0)})(ne);(function(){var t=g.util.degreesToRadians,e={left:-.5,center:0,right:.5},n={top:-.5,center:0,bottom:.5};g.util.object.extend(g.Object.prototype,{translateToGivenOrigin:function(o,r,i,a,s){var c=o.x,l=o.y,u,d,f;return typeof r=="string"?r=e[r]:r-=.5,typeof a=="string"?a=e[a]:a-=.5,u=a-r,typeof i=="string"?i=n[i]:i-=.5,typeof s=="string"?s=n[s]:s-=.5,d=s-i,(u||d)&&(f=this._getTransformedDimensions(),c=o.x+u*f.x,l=o.y+d*f.y),new g.Point(c,l)},translateToCenterPoint:function(o,r,i){var a=this.translateToGivenOrigin(o,r,i,"center","center");return this.angle?g.util.rotatePoint(a,o,t(this.angle)):a},translateToOriginPoint:function(o,r,i){var a=this.translateToGivenOrigin(o,"center","center",r,i);return this.angle?g.util.rotatePoint(a,o,t(this.angle)):a},getCenterPoint:function(){var o=new g.Point(this.left,this.top);return this.translateToCenterPoint(o,this.originX,this.originY)},getPointByOrigin:function(o,r){var i=this.getCenterPoint();return this.translateToOriginPoint(i,o,r)},toLocalPoint:function(o,r,i){var a=this.getCenterPoint(),s,c;return typeof r<"u"&&typeof i<"u"?s=this.translateToGivenOrigin(a,"center","center",r,i):s=new g.Point(this.left,this.top),c=new g.Point(o.x,o.y),this.angle&&(c=g.util.rotatePoint(c,a,-t(this.angle))),c.subtractEquals(s)},setPositionByOrigin:function(o,r,i){var a=this.translateToCenterPoint(o,r,i),s=this.translateToOriginPoint(a,this.originX,this.originY);this.set("left",s.x),this.set("top",s.y)},adjustPosition:function(o){var r=t(this.angle),i=this.getScaledWidth(),a=g.util.cos(r)*i,s=g.util.sin(r)*i,c,l;typeof this.originX=="string"?c=e[this.originX]:c=this.originX-.5,typeof o=="string"?l=e[o]:l=o-.5,this.left+=a*(l-c),this.top+=s*(l-c),this.setCoords(),this.originX=o},_setOriginToCenter:function(){this._originalOriginX=this.originX,this._originalOriginY=this.originY;var o=this.getCenterPoint();this.originX="center",this.originY="center",this.left=o.x,this.top=o.y},_resetOrigin:function(){var o=this.translateToOriginPoint(this.getCenterPoint(),this._originalOriginX,this._originalOriginY);this.originX=this._originalOriginX,this.originY=this._originalOriginY,this.left=o.x,this.top=o.y,this._originalOriginX=null,this._originalOriginY=null},_getLeftTopCoords:function(){return this.translateToOriginPoint(this.getCenterPoint(),"left","top")}})})();(function(){function t(i){return[new g.Point(i.tl.x,i.tl.y),new g.Point(i.tr.x,i.tr.y),new g.Point(i.br.x,i.br.y),new g.Point(i.bl.x,i.bl.y)]}var e=g.util,n=e.degreesToRadians,o=e.multiplyTransformMatrices,r=e.transformPoint;e.object.extend(g.Object.prototype,{oCoords:null,aCoords:null,lineCoords:null,ownMatrixCache:null,matrixCache:null,controls:{},_getCoords:function(i,a){return a?i?this.calcACoords():this.calcLineCoords():((!this.aCoords||!this.lineCoords)&&this.setCoords(!0),i?this.aCoords:this.lineCoords)},getCoords:function(i,a){return t(this._getCoords(i,a))},intersectsWithRect:function(i,a,s,c){var l=this.getCoords(s,c),u=g.Intersection.intersectPolygonRectangle(l,i,a);return u.status==="Intersection"},intersectsWithObject:function(i,a,s){var c=g.Intersection.intersectPolygonPolygon(this.getCoords(a,s),i.getCoords(a,s));return c.status==="Intersection"||i.isContainedWithinObject(this,a,s)||this.isContainedWithinObject(i,a,s)},isContainedWithinObject:function(i,a,s){for(var c=this.getCoords(a,s),l=a?i.aCoords:i.lineCoords,u=0,d=i._getImageLines(l);u<4;u++)if(!i.containsPoint(c[u],d))return!1;return!0},isContainedWithinRect:function(i,a,s,c){var l=this.getBoundingRect(s,c);return l.left>=i.x&&l.left+l.width<=a.x&&l.top>=i.y&&l.top+l.height<=a.y},containsPoint:function(i,u,s,c){var l=this._getCoords(s,c),u=u||this._getImageLines(l),d=this._findCrossPoints(i,u);return d!==0&&d%2===1},isOnScreen:function(i){if(!this.canvas)return!1;var a=this.canvas.vptCoords.tl,s=this.canvas.vptCoords.br,c=this.getCoords(!0,i);return c.some(function(l){return l.x<=s.x&&l.x>=a.x&&l.y<=s.y&&l.y>=a.y})||this.intersectsWithRect(a,s,!0,i)?!0:this._containsCenterOfCanvas(a,s,i)},_containsCenterOfCanvas:function(i,a,s){var c={x:(i.x+a.x)/2,y:(i.y+a.y)/2};return!!this.containsPoint(c,null,!0,s)},isPartiallyOnScreen:function(i){if(!this.canvas)return!1;var a=this.canvas.vptCoords.tl,s=this.canvas.vptCoords.br;if(this.intersectsWithRect(a,s,!0,i))return!0;var c=this.getCoords(!0,i).every(function(l){return(l.x>=s.x||l.x<=a.x)&&(l.y>=s.y||l.y<=a.y)});return c&&this._containsCenterOfCanvas(a,s,i)},_getImageLines:function(i){var a={topline:{o:i.tl,d:i.tr},rightline:{o:i.tr,d:i.br},bottomline:{o:i.br,d:i.bl},leftline:{o:i.bl,d:i.tl}};return a},_findCrossPoints:function(i,a){var s,c,l,u,d,f=0,p;for(var m in a)if(p=a[m],!(p.o.y<i.y&&p.d.y<i.y)&&!(p.o.y>=i.y&&p.d.y>=i.y)&&(p.o.x===p.d.x&&p.o.x>=i.x?d=p.o.x:(s=0,c=(p.d.y-p.o.y)/(p.d.x-p.o.x),l=i.y-s*i.x,u=p.o.y-c*p.o.x,d=-(l-u)/(s-c)),d>=i.x&&(f+=1),f===2))break;return f},getBoundingRect:function(i,a){var s=this.getCoords(i,a);return e.makeBoundingBoxFromPoints(s)},getScaledWidth:function(){return this._getTransformedDimensions().x},getScaledHeight:function(){return this._getTransformedDimensions().y},_constrainScale:function(i){return Math.abs(i)<this.minScaleLimit?i<0?-this.minScaleLimit:this.minScaleLimit:i===0?1e-4:i},scale:function(i){return this._set("scaleX",i),this._set("scaleY",i),this.setCoords()},scaleToWidth:function(i,a){var s=this.getBoundingRect(a).width/this.getScaledWidth();return this.scale(i/this.width/s)},scaleToHeight:function(i,a){var s=this.getBoundingRect(a).height/this.getScaledHeight();return this.scale(i/this.height/s)},calcLineCoords:function(){var i=this.getViewportTransform(),a=this.padding,s=n(this.angle),c=e.cos(s),l=e.sin(s),u=c*a,d=l*a,f=u+d,p=u-d,m=this.calcACoords(),h={tl:r(m.tl,i),tr:r(m.tr,i),bl:r(m.bl,i),br:r(m.br,i)};return a&&(h.tl.x-=p,h.tl.y-=f,h.tr.x+=f,h.tr.y-=p,h.bl.x-=f,h.bl.y+=p,h.br.x+=p,h.br.y+=f),h},calcOCoords:function(){var i=this._calcRotateMatrix(),a=this._calcTranslateMatrix(),s=this.getViewportTransform(),c=o(s,a),l=o(c,i),l=o(l,[1/s[0],0,0,1/s[3],0,0]),u=this._calculateCurrentDimensions(),d={};return this.forEachControl(function(f,p,m){d[p]=f.positionHandler(u,l,m)}),d},calcACoords:function(){var i=this._calcRotateMatrix(),a=this._calcTranslateMatrix(),s=o(a,i),c=this._getTransformedDimensions(),l=c.x/2,u=c.y/2;return{tl:r({x:-l,y:-u},s),tr:r({x:l,y:-u},s),bl:r({x:-l,y:u},s),br:r({x:l,y:u},s)}},setCoords:function(i){return this.aCoords=this.calcACoords(),this.lineCoords=this.group?this.aCoords:this.calcLineCoords(),i?this:(this.oCoords=this.calcOCoords(),this._setCornerCoords&&this._setCornerCoords(),this)},_calcRotateMatrix:function(){return e.calcRotateMatrix(this)},_calcTranslateMatrix:function(){var i=this.getCenterPoint();return[1,0,0,1,i.x,i.y]},transformMatrixKey:function(i){var a="_",s="";return!i&&this.group&&(s=this.group.transformMatrixKey(i)+a),s+this.top+a+this.left+a+this.scaleX+a+this.scaleY+a+this.skewX+a+this.skewY+a+this.angle+a+this.originX+a+this.originY+a+this.width+a+this.height+a+this.strokeWidth+this.flipX+this.flipY},calcTransformMatrix:function(i){var a=this.calcOwnMatrix();if(i||!this.group)return a;var s=this.transformMatrixKey(i),c=this.matrixCache||(this.matrixCache={});return c.key===s?c.value:(this.group&&(a=o(this.group.calcTransformMatrix(!1),a)),c.key=s,c.value=a,a)},calcOwnMatrix:function(){var i=this.transformMatrixKey(!0),a=this.ownMatrixCache||(this.ownMatrixCache={});if(a.key===i)return a.value;var s=this._calcTranslateMatrix(),c={angle:this.angle,translateX:s[4],translateY:s[5],scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY};return a.key=i,a.value=e.composeMatrix(c),a.value},_getNonTransformedDimensions:function(){var i=this.strokeWidth,a=this.width+i,s=this.height+i;return{x:a,y:s}},_getTransformedDimensions:function(i,a){typeof i>"u"&&(i=this.skewX),typeof a>"u"&&(a=this.skewY);var s,c,l,u=i===0&&a===0;if(this.strokeUniform?(c=this.width,l=this.height):(s=this._getNonTransformedDimensions(),c=s.x,l=s.y),u)return this._finalizeDimensions(c*this.scaleX,l*this.scaleY);var d=e.sizeAfterTransform(c,l,{scaleX:this.scaleX,scaleY:this.scaleY,skewX:i,skewY:a});return this._finalizeDimensions(d.x,d.y)},_finalizeDimensions:function(i,a){return this.strokeUniform?{x:i+this.strokeWidth,y:a+this.strokeWidth}:{x:i,y:a}},_calculateCurrentDimensions:function(){var i=this.getViewportTransform(),a=this._getTransformedDimensions(),s=r(a,i,!0);return s.scalarAdd(2*this.padding)}})})();g.util.object.extend(g.Object.prototype,{sendToBack:function(){return this.group?g.StaticCanvas.prototype.sendToBack.call(this.group,this):this.canvas&&this.canvas.sendToBack(this),this},bringToFront:function(){return this.group?g.StaticCanvas.prototype.bringToFront.call(this.group,this):this.canvas&&this.canvas.bringToFront(this),this},sendBackwards:function(t){return this.group?g.StaticCanvas.prototype.sendBackwards.call(this.group,this,t):this.canvas&&this.canvas.sendBackwards(this,t),this},bringForward:function(t){return this.group?g.StaticCanvas.prototype.bringForward.call(this.group,this,t):this.canvas&&this.canvas.bringForward(this,t),this},moveTo:function(t){return this.group&&this.group.type!=="activeSelection"?g.StaticCanvas.prototype.moveTo.call(this.group,this,t):this.canvas&&this.canvas.moveTo(this,t),this}});(function(){function t(n,o){if(o){if(o.toLive)return n+": url(#SVGID_"+o.id+"); ";var r=new g.Color(o),i=n+": "+r.toRgb()+"; ",a=r.getAlpha();return a!==1&&(i+=n+"-opacity: "+a.toString()+"; "),i}else return n+": none; "}var e=g.util.toFixed;g.util.object.extend(g.Object.prototype,{getSvgStyles:function(n){var o=this.fillRule?this.fillRule:"nonzero",r=this.strokeWidth?this.strokeWidth:"0",i=this.strokeDashArray?this.strokeDashArray.join(" "):"none",a=this.strokeDashOffset?this.strokeDashOffset:"0",s=this.strokeLineCap?this.strokeLineCap:"butt",c=this.strokeLineJoin?this.strokeLineJoin:"miter",l=this.strokeMiterLimit?this.strokeMiterLimit:"4",u=typeof this.opacity<"u"?this.opacity:"1",d=this.visible?"":" visibility: hidden;",f=n?"":this.getSvgFilter(),p=t("fill",this.fill),m=t("stroke",this.stroke);return[m,"stroke-width: ",r,"; ","stroke-dasharray: ",i,"; ","stroke-linecap: ",s,"; ","stroke-dashoffset: ",a,"; ","stroke-linejoin: ",c,"; ","stroke-miterlimit: ",l,"; ",p,"fill-rule: ",o,"; ","opacity: ",u,";",f,d].join("")},getSvgSpanStyles:function(n,o){var r="; ",a=n.fontFamily?"font-family: "+(n.fontFamily.indexOf("'")===-1&&n.fontFamily.indexOf('"')===-1?"'"+n.fontFamily+"'":n.fontFamily)+r:"",i=n.strokeWidth?"stroke-width: "+n.strokeWidth+r:"",a=a,s=n.fontSize?"font-size: "+n.fontSize+"px"+r:"",c=n.fontStyle?"font-style: "+n.fontStyle+r:"",l=n.fontWeight?"font-weight: "+n.fontWeight+r:"",u=n.fill?t("fill",n.fill):"",d=n.stroke?t("stroke",n.stroke):"",f=this.getSvgTextDecoration(n),p=n.deltaY?"baseline-shift: "+-n.deltaY+"; ":"";return f&&(f="text-decoration: "+f+r),[d,i,a,s,c,l,f,u,p,o?"white-space: pre; ":""].join("")},getSvgTextDecoration:function(n){return["overline","underline","line-through"].filter(function(o){return n[o.replace("-","")]}).join(" ")},getSvgFilter:function(){return this.shadow?"filter: url(#SVGID_"+this.shadow.id+");":""},getSvgCommons:function(){return[this.id?'id="'+this.id+'" ':"",this.clipPath?'clip-path="url(#'+this.clipPath.clipPathId+')" ':""].join("")},getSvgTransform:function(n,o){var r=n?this.calcTransformMatrix():this.calcOwnMatrix(),i='transform="'+g.util.matrixToSVG(r);return i+(o||"")+'" '},_setSVGBg:function(n){if(this.backgroundColor){var o=g.Object.NUM_FRACTION_DIGITS;n.push("		<rect ",this._getFillAttributes(this.backgroundColor),' x="',e(-this.width/2,o),'" y="',e(-this.height/2,o),'" width="',e(this.width,o),'" height="',e(this.height,o),`"></rect>
`)}},toSVG:function(n){return this._createBaseSVGMarkup(this._toSVG(n),{reviver:n})},toClipPathSVG:function(n){return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(n),{reviver:n})},_createBaseClipPathSVGMarkup:function(n,o){o=o||{};var r=o.reviver,i=o.additionalTransform||"",a=[this.getSvgTransform(!0,i),this.getSvgCommons()].join(""),s=n.indexOf("COMMON_PARTS");return n[s]=a,r?r(n.join("")):n.join("")},_createBaseSVGMarkup:function(n,o){o=o||{};var r=o.noStyle,i=o.reviver,a=r?"":'style="'+this.getSvgStyles()+'" ',s=o.withShadow?'style="'+this.getSvgFilter()+'" ':"",c=this.clipPath,l=this.strokeUniform?'vector-effect="non-scaling-stroke" ':"",u=c&&c.absolutePositioned,d=this.stroke,f=this.fill,p=this.shadow,m,h=[],b,x=n.indexOf("COMMON_PARTS"),y=o.additionalTransform;return c&&(c.clipPathId="CLIPPATH_"+g.Object.__uid++,b='<clipPath id="'+c.clipPathId+`" >
`+c.toClipPathSVG(i)+`</clipPath>
`),u&&h.push("<g ",s,this.getSvgCommons(),` >
`),h.push("<g ",this.getSvgTransform(!1),u?"":s+this.getSvgCommons(),` >
`),m=[a,l,r?"":this.addPaintOrder()," ",y?'transform="'+y+'" ':""].join(""),n[x]=m,f&&f.toLive&&h.push(f.toSVG(this)),d&&d.toLive&&h.push(d.toSVG(this)),p&&h.push(p.toSVG(this)),c&&h.push(b),h.push(n.join("")),h.push(`</g>
`),u&&h.push(`</g>
`),i?i(h.join("")):h.join("")},addPaintOrder:function(){return this.paintFirst!=="fill"?' paint-order="'+this.paintFirst+'" ':""}})})();(function(){var t=g.util.object.extend,e="stateProperties";function n(r,i,a){var s={},c=!0;a.forEach(function(l){s[l]=r[l]}),t(r[i],s,c)}function o(r,i,a){if(r===i)return!0;if(Array.isArray(r)){if(!Array.isArray(i)||r.length!==i.length)return!1;for(var s=0,c=r.length;s<c;s++)if(!o(r[s],i[s]))return!1;return!0}else if(r&&typeof r=="object"){var l=Object.keys(r),u;if(!i||typeof i!="object"||!a&&l.length!==Object.keys(i).length)return!1;for(var s=0,c=l.length;s<c;s++)if(u=l[s],!(u==="canvas"||u==="group")&&!o(r[u],i[u]))return!1;return!0}}g.util.object.extend(g.Object.prototype,{hasStateChanged:function(r){r=r||e;var i="_"+r;return Object.keys(this[i]).length<this[r].length?!0:!o(this[i],this,!0)},saveState:function(r){var i=r&&r.propertySet||e,a="_"+i;return this[a]?(n(this,a,this[i]),r&&r.stateProperties&&n(this,a,r.stateProperties),this):this.setupState(r)},setupState:function(r){r=r||{};var i=r.propertySet||e;return r.propertySet=i,this["_"+i]={},this.saveState(r),this}})})();(function(){var t=g.util.degreesToRadians;g.util.object.extend(g.Object.prototype,{_findTargetCorner:function(e,n){if(!this.hasControls||this.group||!this.canvas||this.canvas._activeObject!==this)return!1;var o=e.x,r=e.y,i,a,s=Object.keys(this.oCoords),c=s.length-1,l;for(this.__corner=0;c>=0;c--)if(l=s[c],!!this.isControlVisible(l)&&(a=this._getImageLines(n?this.oCoords[l].touchCorner:this.oCoords[l].corner),i=this._findCrossPoints({x:o,y:r},a),i!==0&&i%2===1))return this.__corner=l,l;return!1},forEachControl:function(e){for(var n in this.controls)e(this.controls[n],n,this)},_setCornerCoords:function(){var e=this.oCoords;for(var n in e){var o=this.controls[n];e[n].corner=o.calcCornerCoords(this.angle,this.cornerSize,e[n].x,e[n].y,!1),e[n].touchCorner=o.calcCornerCoords(this.angle,this.touchCornerSize,e[n].x,e[n].y,!0)}},drawSelectionBackground:function(e){if(!this.selectionBackgroundColor||this.canvas&&!this.canvas.interactive||this.canvas&&this.canvas._activeObject!==this)return this;e.save();var n=this.getCenterPoint(),o=this._calculateCurrentDimensions(),r=this.canvas.viewportTransform;return e.translate(n.x,n.y),e.scale(1/r[0],1/r[3]),e.rotate(t(this.angle)),e.fillStyle=this.selectionBackgroundColor,e.fillRect(-o.x/2,-o.y/2,o.x,o.y),e.restore(),this},drawBorders:function(e,n){n=n||{};var o=this._calculateCurrentDimensions(),r=this.borderScaleFactor,i=o.x+r,a=o.y+r,s=typeof n.hasControls<"u"?n.hasControls:this.hasControls,c=!1;return e.save(),e.strokeStyle=n.borderColor||this.borderColor,this._setLineDash(e,n.borderDashArray||this.borderDashArray),e.strokeRect(-i/2,-a/2,i,a),s&&(e.beginPath(),this.forEachControl(function(l,u,d){l.withConnection&&l.getVisibility(d,u)&&(c=!0,e.moveTo(l.x*i,l.y*a),e.lineTo(l.x*i+l.offsetX,l.y*a+l.offsetY))}),c&&e.stroke()),e.restore(),this},drawBordersInGroup:function(e,n,o){o=o||{};var r=g.util.sizeAfterTransform(this.width,this.height,n),i=this.strokeWidth,a=this.strokeUniform,s=this.borderScaleFactor,c=r.x+i*(a?this.canvas.getZoom():n.scaleX)+s,l=r.y+i*(a?this.canvas.getZoom():n.scaleY)+s;return e.save(),this._setLineDash(e,o.borderDashArray||this.borderDashArray),e.strokeStyle=o.borderColor||this.borderColor,e.strokeRect(-c/2,-l/2,c,l),e.restore(),this},drawControls:function(e,n){n=n||{},e.save();var o=this.canvas.getRetinaScaling(),r,i;return e.setTransform(o,0,0,o,0,0),e.strokeStyle=e.fillStyle=n.cornerColor||this.cornerColor,this.transparentCorners||(e.strokeStyle=n.cornerStrokeColor||this.cornerStrokeColor),this._setLineDash(e,n.cornerDashArray||this.cornerDashArray),this.setCoords(),this.group&&(r=this.group.calcTransformMatrix()),this.forEachControl(function(a,s,c){i=c.oCoords[s],a.getVisibility(c,s)&&(r&&(i=g.util.transformPoint(i,r)),a.render(e,i.x,i.y,n,c))}),e.restore(),this},isControlVisible:function(e){return this.controls[e]&&this.controls[e].getVisibility(this,e)},setControlVisible:function(e,n){return this._controlsVisibility||(this._controlsVisibility={}),this._controlsVisibility[e]=n,this},setControlsVisibility:function(e){e||(e={});for(var n in e)this.setControlVisible(n,e[n]);return this},onDeselect:function(){},onSelect:function(){}})})();g.util.object.extend(g.StaticCanvas.prototype,{FX_DURATION:500,fxCenterObjectH:function(t,e){e=e||{};var n=function(){},o=e.onComplete||n,r=e.onChange||n,i=this;return g.util.animate({target:this,startValue:t.left,endValue:this.getCenterPoint().x,duration:this.FX_DURATION,onChange:function(a){t.set("left",a),i.requestRenderAll(),r()},onComplete:function(){t.setCoords(),o()}})},fxCenterObjectV:function(t,e){e=e||{};var n=function(){},o=e.onComplete||n,r=e.onChange||n,i=this;return g.util.animate({target:this,startValue:t.top,endValue:this.getCenterPoint().y,duration:this.FX_DURATION,onChange:function(a){t.set("top",a),i.requestRenderAll(),r()},onComplete:function(){t.setCoords(),o()}})},fxRemove:function(t,e){e=e||{};var n=function(){},o=e.onComplete||n,r=e.onChange||n,i=this;return g.util.animate({target:this,startValue:t.opacity,endValue:0,duration:this.FX_DURATION,onChange:function(a){t.set("opacity",a),i.requestRenderAll(),r()},onComplete:function(){i.remove(t),o()}})}});g.util.object.extend(g.Object.prototype,{animate:function(){if(arguments[0]&&typeof arguments[0]=="object"){var t=[],e,n,o=[];for(e in arguments[0])t.push(e);for(var r=0,i=t.length;r<i;r++)e=t[r],n=r!==i-1,o.push(this._animate(e,arguments[0][e],arguments[1],n));return o}else return this._animate.apply(this,arguments)},_animate:function(t,e,n,o){var r=this,i;e=e.toString(),n?n=g.util.object.clone(n):n={},~t.indexOf(".")&&(i=t.split("."));var a=r.colorProperties.indexOf(t)>-1||i&&r.colorProperties.indexOf(i[1])>-1,s=i?this.get(i[0])[i[1]]:this.get(t);"from"in n||(n.from=s),a||(~e.indexOf("=")?e=s+parseFloat(e.replace("=","")):e=parseFloat(e));var c={target:this,startValue:n.from,endValue:e,byValue:n.by,easing:n.easing,duration:n.duration,abort:n.abort&&function(l,u,d){return n.abort.call(r,l,u,d)},onChange:function(l,u,d){i?r[i[0]][i[1]]=l:r.set(t,l),!o&&n.onChange&&n.onChange(l,u,d)},onComplete:function(l,u,d){o||(r.setCoords(),n.onComplete&&n.onComplete(l,u,d))}};return a?g.util.animateColor(c.startValue,c.endValue,c.duration,c):g.util.animate(c)}});(function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.util.object.extend,o=e.util.object.clone,r={x1:1,x2:1,y1:1,y2:1};if(e.Line){e.warn("fabric.Line is already defined");return}e.Line=e.util.createClass(e.Object,{type:"line",x1:0,y1:0,x2:0,y2:0,cacheProperties:e.Object.prototype.cacheProperties.concat("x1","x2","y1","y2"),initialize:function(a,s){a||(a=[0,0,0,0]),this.callSuper("initialize",s),this.set("x1",a[0]),this.set("y1",a[1]),this.set("x2",a[2]),this.set("y2",a[3]),this._setWidthHeight(s)},_setWidthHeight:function(a){a||(a={}),this.width=Math.abs(this.x2-this.x1),this.height=Math.abs(this.y2-this.y1),this.left="left"in a?a.left:this._getLeftToOriginX(),this.top="top"in a?a.top:this._getTopToOriginY()},_set:function(a,s){return this.callSuper("_set",a,s),typeof r[a]<"u"&&this._setWidthHeight(),this},_getLeftToOriginX:i({origin:"originX",axis1:"x1",axis2:"x2",dimension:"width"},{nearest:"left",center:"center",farthest:"right"}),_getTopToOriginY:i({origin:"originY",axis1:"y1",axis2:"y2",dimension:"height"},{nearest:"top",center:"center",farthest:"bottom"}),_render:function(a){a.beginPath();var s=this.calcLinePoints();a.moveTo(s.x1,s.y1),a.lineTo(s.x2,s.y2),a.lineWidth=this.strokeWidth;var c=a.strokeStyle;a.strokeStyle=this.stroke||a.fillStyle,this.stroke&&this._renderStroke(a),a.strokeStyle=c},_findCenterFromElement:function(){return{x:(this.x1+this.x2)/2,y:(this.y1+this.y2)/2}},toObject:function(a){return n(this.callSuper("toObject",a),this.calcLinePoints())},_getNonTransformedDimensions:function(){var a=this.callSuper("_getNonTransformedDimensions");return this.strokeLineCap==="butt"&&(this.width===0&&(a.y-=this.strokeWidth),this.height===0&&(a.x-=this.strokeWidth)),a},calcLinePoints:function(){var a=this.x1<=this.x2?-1:1,s=this.y1<=this.y2?-1:1,c=a*this.width*.5,l=s*this.height*.5,u=a*this.width*-.5,d=s*this.height*-.5;return{x1:c,x2:u,y1:l,y2:d}},_toSVG:function(){var a=this.calcLinePoints();return["<line ","COMMON_PARTS",'x1="',a.x1,'" y1="',a.y1,'" x2="',a.x2,'" y2="',a.y2,`" />
`]}}),e.Line.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat("x1 y1 x2 y2".split(" ")),e.Line.fromElement=function(a,s,c){c=c||{};var l=e.parseAttributes(a,e.Line.ATTRIBUTE_NAMES),u=[l.x1||0,l.y1||0,l.x2||0,l.y2||0];s(new e.Line(u,n(l,c)))},e.Line.fromObject=function(a,s){function c(u){delete u.points,s&&s(u)}var l=o(a,!0);l.points=[a.x1,a.y1,a.x2,a.y2],e.Object._fromObject("Line",l,c,"points")};function i(a,s){var c=a.origin,l=a.axis1,u=a.axis2,d=a.dimension,f=s.nearest,p=s.center,m=s.farthest;return function(){switch(this.get(c)){case f:return Math.min(this.get(l),this.get(u));case p:return Math.min(this.get(l),this.get(u))+.5*this.get(d);case m:return Math.max(this.get(l),this.get(u))}}}})(ne);(function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.util.degreesToRadians;if(e.Circle){e.warn("fabric.Circle is already defined.");return}e.Circle=e.util.createClass(e.Object,{type:"circle",radius:0,startAngle:0,endAngle:360,cacheProperties:e.Object.prototype.cacheProperties.concat("radius","startAngle","endAngle"),_set:function(r,i){return this.callSuper("_set",r,i),r==="radius"&&this.setRadius(i),this},toObject:function(r){return this.callSuper("toObject",["radius","startAngle","endAngle"].concat(r))},_toSVG:function(){var r,i=0,a=0,s=(this.endAngle-this.startAngle)%360;if(s===0)r=["<circle ","COMMON_PARTS",'cx="'+i+'" cy="'+a+'" ','r="',this.radius,`" />
`];else{var c=n(this.startAngle),l=n(this.endAngle),u=this.radius,d=e.util.cos(c)*u,f=e.util.sin(c)*u,p=e.util.cos(l)*u,m=e.util.sin(l)*u,h=s>180?"1":"0";r=['<path d="M '+d+" "+f," A "+u+" "+u," 0 ",+h+" 1"," "+p+" "+m,'" ',"COMMON_PARTS",` />
`]}return r},_render:function(r){r.beginPath(),r.arc(0,0,this.radius,n(this.startAngle),n(this.endAngle),!1),this._renderPaintInOrder(r)},getRadiusX:function(){return this.get("radius")*this.get("scaleX")},getRadiusY:function(){return this.get("radius")*this.get("scaleY")},setRadius:function(r){return this.radius=r,this.set("width",r*2).set("height",r*2)}}),e.Circle.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat("cx cy r".split(" ")),e.Circle.fromElement=function(r,i){var a=e.parseAttributes(r,e.Circle.ATTRIBUTE_NAMES);if(!o(a))throw new Error("value of `r` attribute is required and can not be negative");a.left=(a.left||0)-a.radius,a.top=(a.top||0)-a.radius,i(new e.Circle(a))};function o(r){return"radius"in r&&r.radius>=0}e.Circle.fromObject=function(r,i){e.Object._fromObject("Circle",r,i)}})(ne);(function(t){"use strict";var e=t.fabric||(t.fabric={});if(e.Triangle){e.warn("fabric.Triangle is already defined");return}e.Triangle=e.util.createClass(e.Object,{type:"triangle",width:100,height:100,_render:function(n){var o=this.width/2,r=this.height/2;n.beginPath(),n.moveTo(-o,r),n.lineTo(0,-r),n.lineTo(o,r),n.closePath(),this._renderPaintInOrder(n)},_toSVG:function(){var n=this.width/2,o=this.height/2,r=[-n+" "+o,"0 "+-o,n+" "+o].join(",");return["<polygon ","COMMON_PARTS",'points="',r,'" />']}}),e.Triangle.fromObject=function(n,o){return e.Object._fromObject("Triangle",n,o)}})(ne);(function(t){"use strict";var e=t.fabric||(t.fabric={}),n=Math.PI*2;if(e.Ellipse){e.warn("fabric.Ellipse is already defined.");return}e.Ellipse=e.util.createClass(e.Object,{type:"ellipse",rx:0,ry:0,cacheProperties:e.Object.prototype.cacheProperties.concat("rx","ry"),initialize:function(o){this.callSuper("initialize",o),this.set("rx",o&&o.rx||0),this.set("ry",o&&o.ry||0)},_set:function(o,r){switch(this.callSuper("_set",o,r),o){case"rx":this.rx=r,this.set("width",r*2);break;case"ry":this.ry=r,this.set("height",r*2);break}return this},getRx:function(){return this.get("rx")*this.get("scaleX")},getRy:function(){return this.get("ry")*this.get("scaleY")},toObject:function(o){return this.callSuper("toObject",["rx","ry"].concat(o))},_toSVG:function(){return["<ellipse ","COMMON_PARTS",'cx="0" cy="0" ','rx="',this.rx,'" ry="',this.ry,`" />
`]},_render:function(o){o.beginPath(),o.save(),o.transform(1,0,0,this.ry/this.rx,0,0),o.arc(0,0,this.rx,0,n,!1),o.restore(),this._renderPaintInOrder(o)}}),e.Ellipse.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat("cx cy rx ry".split(" ")),e.Ellipse.fromElement=function(o,r){var i=e.parseAttributes(o,e.Ellipse.ATTRIBUTE_NAMES);i.left=(i.left||0)-i.rx,i.top=(i.top||0)-i.ry,r(new e.Ellipse(i))},e.Ellipse.fromObject=function(o,r){e.Object._fromObject("Ellipse",o,r)}})(ne);(function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.util.object.extend;if(e.Rect){e.warn("fabric.Rect is already defined");return}e.Rect=e.util.createClass(e.Object,{stateProperties:e.Object.prototype.stateProperties.concat("rx","ry"),type:"rect",rx:0,ry:0,cacheProperties:e.Object.prototype.cacheProperties.concat("rx","ry"),initialize:function(o){this.callSuper("initialize",o),this._initRxRy()},_initRxRy:function(){this.rx&&!this.ry?this.ry=this.rx:this.ry&&!this.rx&&(this.rx=this.ry)},_render:function(o){var r=this.rx?Math.min(this.rx,this.width/2):0,i=this.ry?Math.min(this.ry,this.height/2):0,a=this.width,s=this.height,c=-this.width/2,l=-this.height/2,u=r!==0||i!==0,d=1-.5522847498;o.beginPath(),o.moveTo(c+r,l),o.lineTo(c+a-r,l),u&&o.bezierCurveTo(c+a-d*r,l,c+a,l+d*i,c+a,l+i),o.lineTo(c+a,l+s-i),u&&o.bezierCurveTo(c+a,l+s-d*i,c+a-d*r,l+s,c+a-r,l+s),o.lineTo(c+r,l+s),u&&o.bezierCurveTo(c+d*r,l+s,c,l+s-d*i,c,l+s-i),o.lineTo(c,l+i),u&&o.bezierCurveTo(c,l+d*i,c+d*r,l,c+r,l),o.closePath(),this._renderPaintInOrder(o)},toObject:function(o){return this.callSuper("toObject",["rx","ry"].concat(o))},_toSVG:function(){var o=-this.width/2,r=-this.height/2;return["<rect ","COMMON_PARTS",'x="',o,'" y="',r,'" rx="',this.rx,'" ry="',this.ry,'" width="',this.width,'" height="',this.height,`" />
`]}}),e.Rect.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat("x y rx ry width height".split(" ")),e.Rect.fromElement=function(o,r,i){if(!o)return r(null);i=i||{};var a=e.parseAttributes(o,e.Rect.ATTRIBUTE_NAMES);a.left=a.left||0,a.top=a.top||0,a.height=a.height||0,a.width=a.width||0;var s=new e.Rect(n(i?e.util.object.clone(i):{},a));s.visible=s.visible&&s.width>0&&s.height>0,r(s)},e.Rect.fromObject=function(o,r){return e.Object._fromObject("Rect",o,r)}})(ne);(function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.util.object.extend,o=e.util.array.min,r=e.util.array.max,i=e.util.toFixed,a=e.util.projectStrokeOnPoints;if(e.Polyline){e.warn("fabric.Polyline is already defined");return}e.Polyline=e.util.createClass(e.Object,{type:"polyline",points:null,exactBoundingBox:!1,cacheProperties:e.Object.prototype.cacheProperties.concat("points"),initialize:function(s,c){c=c||{},this.points=s||[],this.callSuper("initialize",c),this._setPositionDimensions(c)},_projectStrokeOnPoints:function(){return a(this.points,this,!0)},_setPositionDimensions:function(s){var c=this._calcDimensions(s),l,u=this.exactBoundingBox?this.strokeWidth:0;this.width=c.width-u,this.height=c.height-u,s.fromSVG||(l=this.translateToGivenOrigin({x:c.left-this.strokeWidth/2+u/2,y:c.top-this.strokeWidth/2+u/2},"left","top",this.originX,this.originY)),typeof s.left>"u"&&(this.left=s.fromSVG?c.left:l.x),typeof s.top>"u"&&(this.top=s.fromSVG?c.top:l.y),this.pathOffset={x:c.left+this.width/2+u/2,y:c.top+this.height/2+u/2}},_calcDimensions:function(){var s=this.exactBoundingBox?this._projectStrokeOnPoints():this.points,c=o(s,"x")||0,l=o(s,"y")||0,u=r(s,"x")||0,d=r(s,"y")||0,f=u-c,p=d-l;return{left:c,top:l,width:f,height:p}},toObject:function(s){return n(this.callSuper("toObject",s),{points:this.points.concat()})},_toSVG:function(){for(var s=[],c=this.pathOffset.x,l=this.pathOffset.y,u=e.Object.NUM_FRACTION_DIGITS,d=0,f=this.points.length;d<f;d++)s.push(i(this.points[d].x-c,u),",",i(this.points[d].y-l,u)," ");return["<"+this.type+" ","COMMON_PARTS",'points="',s.join(""),`" />
`]},commonRender:function(s){var c,l=this.points.length,u=this.pathOffset.x,d=this.pathOffset.y;if(!l||isNaN(this.points[l-1].y))return!1;s.beginPath(),s.moveTo(this.points[0].x-u,this.points[0].y-d);for(var f=0;f<l;f++)c=this.points[f],s.lineTo(c.x-u,c.y-d);return!0},_render:function(s){this.commonRender(s)&&this._renderPaintInOrder(s)},complexity:function(){return this.get("points").length}}),e.Polyline.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat(),e.Polyline.fromElementGenerator=function(s){return function(c,l,u){if(!c)return l(null);u||(u={});var d=e.parsePointsAttribute(c.getAttribute("points")),f=e.parseAttributes(c,e[s].ATTRIBUTE_NAMES);f.fromSVG=!0,l(new e[s](d,n(f,u)))}},e.Polyline.fromElement=e.Polyline.fromElementGenerator("Polyline"),e.Polyline.fromObject=function(s,c){return e.Object._fromObject("Polyline",s,c,"points")}})(ne);(function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.util.projectStrokeOnPoints;if(e.Polygon){e.warn("fabric.Polygon is already defined");return}e.Polygon=e.util.createClass(e.Polyline,{type:"polygon",_projectStrokeOnPoints:function(){return n(this.points,this)},_render:function(o){this.commonRender(o)&&(o.closePath(),this._renderPaintInOrder(o))}}),e.Polygon.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat(),e.Polygon.fromElement=e.Polyline.fromElementGenerator("Polygon"),e.Polygon.fromObject=function(o,r){e.Object._fromObject("Polygon",o,r,"points")}})(ne);(function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.util.array.min,o=e.util.array.max,r=e.util.object.extend,i=e.util.object.clone,a=e.util.toFixed;if(e.Path){e.warn("fabric.Path is already defined");return}e.Path=e.util.createClass(e.Object,{type:"path",path:null,cacheProperties:e.Object.prototype.cacheProperties.concat("path","fillRule"),stateProperties:e.Object.prototype.stateProperties.concat("path"),initialize:function(s,c){c=i(c||{}),delete c.path,this.callSuper("initialize",c),this._setPath(s||[],c)},_setPath:function(s,c){this.path=e.util.makePathSimpler(Array.isArray(s)?s:e.util.parsePath(s)),e.Polyline.prototype._setPositionDimensions.call(this,c||{})},_renderPathCommands:function(s){var c,l=0,u=0,d=0,f=0,p=0,m=0,h=-this.pathOffset.x,b=-this.pathOffset.y;s.beginPath();for(var x=0,y=this.path.length;x<y;++x)switch(c=this.path[x],c[0]){case"L":d=c[1],f=c[2],s.lineTo(d+h,f+b);break;case"M":d=c[1],f=c[2],l=d,u=f,s.moveTo(d+h,f+b);break;case"C":d=c[5],f=c[6],p=c[3],m=c[4],s.bezierCurveTo(c[1]+h,c[2]+b,p+h,m+b,d+h,f+b);break;case"Q":s.quadraticCurveTo(c[1]+h,c[2]+b,c[3]+h,c[4]+b),d=c[3],f=c[4],p=c[1],m=c[2];break;case"z":case"Z":d=l,f=u,s.closePath();break}},_render:function(s){this._renderPathCommands(s),this._renderPaintInOrder(s)},toString:function(){return"#<fabric.Path ("+this.complexity()+'): { "top": '+this.top+', "left": '+this.left+" }>"},toObject:function(s){return r(this.callSuper("toObject",s),{path:this.path.map(function(c){return c.slice()})})},toDatalessObject:function(s){var c=this.toObject(["sourcePath"].concat(s));return c.sourcePath&&delete c.path,c},_toSVG:function(){var s=e.util.joinPath(this.path);return["<path ","COMMON_PARTS",'d="',s,'" stroke-linecap="round" ',`/>
`]},_getOffsetTransform:function(){var s=e.Object.NUM_FRACTION_DIGITS;return" translate("+a(-this.pathOffset.x,s)+", "+a(-this.pathOffset.y,s)+")"},toClipPathSVG:function(s){var c=this._getOffsetTransform();return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(),{reviver:s,additionalTransform:c})},toSVG:function(s){var c=this._getOffsetTransform();return this._createBaseSVGMarkup(this._toSVG(),{reviver:s,additionalTransform:c})},complexity:function(){return this.path.length},_calcDimensions:function(){for(var s=[],c=[],l,u=0,d=0,f=0,p=0,m,h=0,b=this.path.length;h<b;++h){switch(l=this.path[h],l[0]){case"L":f=l[1],p=l[2],m=[];break;case"M":f=l[1],p=l[2],u=f,d=p,m=[];break;case"C":m=e.util.getBoundsOfCurve(f,p,l[1],l[2],l[3],l[4],l[5],l[6]),f=l[5],p=l[6];break;case"Q":m=e.util.getBoundsOfCurve(f,p,l[1],l[2],l[1],l[2],l[3],l[4]),f=l[3],p=l[4];break;case"z":case"Z":f=u,p=d;break}m.forEach(function(P){s.push(P.x),c.push(P.y)}),s.push(f),c.push(p)}var x=n(s)||0,y=n(c)||0,M=o(s)||0,E=o(c)||0,C=M-x,j=E-y;return{left:x,top:y,width:C,height:j}}}),e.Path.fromObject=function(s,c){if(typeof s.sourcePath=="string"){var l=s.sourcePath;e.loadSVGFromURL(l,function(u){var d=u[0];d.setOptions(s),s.clipPath?e.util.enlivenObjects([s.clipPath],function(f){d.clipPath=f[0],c&&c(d)}):c&&c(d)})}else e.Object._fromObject("Path",s,c,"path")},e.Path.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat(["d"]),e.Path.fromElement=function(s,c,l){var u=e.parseAttributes(s,e.Path.ATTRIBUTE_NAMES);u.fromSVG=!0,c(new e.Path(u.d,r(u,l)))}})(ne);(function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.util.array.min,o=e.util.array.max;e.Group||(e.Group=e.util.createClass(e.Object,e.Collection,{type:"group",strokeWidth:0,subTargetCheck:!1,cacheProperties:[],useSetOnGroup:!1,initialize:function(r,i,a){i=i||{},this._objects=[],a&&this.callSuper("initialize",i),this._objects=r||[];for(var s=this._objects.length;s--;)this._objects[s].group=this;if(a)this._updateObjectsACoords();else{var c=i&&i.centerPoint;i.originX!==void 0&&(this.originX=i.originX),i.originY!==void 0&&(this.originY=i.originY),c||this._calcBounds(),this._updateObjectsCoords(c),delete i.centerPoint,this.callSuper("initialize",i)}this.setCoords()},_updateObjectsACoords:function(){for(var r=!0,i=this._objects.length;i--;)this._objects[i].setCoords(r)},_updateObjectsCoords:function(i){for(var i=i||this.getCenterPoint(),a=this._objects.length;a--;)this._updateObjectCoords(this._objects[a],i)},_updateObjectCoords:function(r,i){var a=r.left,s=r.top,c=!0;r.set({left:a-i.x,top:s-i.y}),r.group=this,r.setCoords(c)},toString:function(){return"#<fabric.Group: ("+this.complexity()+")>"},addWithUpdate:function(r){var i=!!this.group;return this._restoreObjectsState(),e.util.resetObjectTransform(this),r&&(i&&e.util.removeTransformFromObject(r,this.group.calcTransformMatrix()),this._objects.push(r),r.group=this,r._set("canvas",this.canvas)),this._calcBounds(),this._updateObjectsCoords(),this.dirty=!0,i?this.group.addWithUpdate():this.setCoords(),this},removeWithUpdate:function(r){return this._restoreObjectsState(),e.util.resetObjectTransform(this),this.remove(r),this._calcBounds(),this._updateObjectsCoords(),this.setCoords(),this.dirty=!0,this},_onObjectAdded:function(r){this.dirty=!0,r.group=this,r._set("canvas",this.canvas)},_onObjectRemoved:function(r){this.dirty=!0,delete r.group},_set:function(r,i){var a=this._objects.length;if(this.useSetOnGroup)for(;a--;)this._objects[a].setOnGroup(r,i);if(r==="canvas")for(;a--;)this._objects[a]._set(r,i);e.Object.prototype._set.call(this,r,i)},toObject:function(r){var i=this.includeDefaultValues,a=this._objects.filter(function(c){return!c.excludeFromExport}).map(function(c){var l=c.includeDefaultValues;c.includeDefaultValues=i;var u=c.toObject(r);return c.includeDefaultValues=l,u}),s=e.Object.prototype.toObject.call(this,r);return s.objects=a,s},toDatalessObject:function(r){var i,a=this.sourcePath;if(a)i=a;else{var s=this.includeDefaultValues;i=this._objects.map(function(l){var u=l.includeDefaultValues;l.includeDefaultValues=s;var d=l.toDatalessObject(r);return l.includeDefaultValues=u,d})}var c=e.Object.prototype.toDatalessObject.call(this,r);return c.objects=i,c},render:function(r){this._transformDone=!0,this.callSuper("render",r),this._transformDone=!1},shouldCache:function(){var r=e.Object.prototype.shouldCache.call(this);if(r){for(var i=0,a=this._objects.length;i<a;i++)if(this._objects[i].willDrawShadow())return this.ownCaching=!1,!1}return r},willDrawShadow:function(){if(e.Object.prototype.willDrawShadow.call(this))return!0;for(var r=0,i=this._objects.length;r<i;r++)if(this._objects[r].willDrawShadow())return!0;return!1},isOnACache:function(){return this.ownCaching||this.group&&this.group.isOnACache()},drawObject:function(r){for(var i=0,a=this._objects.length;i<a;i++)this._objects[i].render(r);this._drawClipPath(r,this.clipPath)},isCacheDirty:function(r){if(this.callSuper("isCacheDirty",r))return!0;if(!this.statefullCache)return!1;for(var i=0,a=this._objects.length;i<a;i++)if(this._objects[i].isCacheDirty(!0)){if(this._cacheCanvas){var s=this.cacheWidth/this.zoomX,c=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-s/2,-c/2,s,c)}return!0}return!1},_restoreObjectsState:function(){var r=this.calcOwnMatrix();return this._objects.forEach(function(i){e.util.addTransformToObject(i,r),delete i.group,i.setCoords()}),this},destroy:function(){return this._objects.forEach(function(r){r.set("dirty",!0)}),this._restoreObjectsState()},dispose:function(){this.callSuper("dispose"),this.forEachObject(function(r){r.dispose&&r.dispose()}),this._objects=[]},toActiveSelection:function(){if(this.canvas){var r=this._objects,i=this.canvas;this._objects=[];var a=this.toObject();delete a.objects;var s=new e.ActiveSelection([]);return s.set(a),s.type="activeSelection",i.remove(this),r.forEach(function(c){c.group=s,c.dirty=!0,i.add(c)}),s.canvas=i,s._objects=r,i._activeObject=s,s.setCoords(),s}},ungroupOnCanvas:function(){return this._restoreObjectsState()},setObjectsCoords:function(){var r=!0;return this.forEachObject(function(i){i.setCoords(r)}),this},_calcBounds:function(r){for(var i=[],a=[],s,c,l,u=["tr","br","bl","tl"],d=0,f=this._objects.length,p,m=u.length;d<f;++d){for(s=this._objects[d],l=s.calcACoords(),p=0;p<m;p++)c=u[p],i.push(l[c].x),a.push(l[c].y);s.aCoords=l}this._getBounds(i,a,r)},_getBounds:function(r,i,a){var s=new e.Point(n(r),n(i)),c=new e.Point(o(r),o(i)),l=s.y||0,u=s.x||0,d=c.x-s.x||0,f=c.y-s.y||0;this.width=d,this.height=f,a||this.setPositionByOrigin({x:u,y:l},"left","top")},_toSVG:function(r){for(var i=["<g ","COMMON_PARTS",` >
`],a=0,s=this._objects.length;a<s;a++)i.push("		",this._objects[a].toSVG(r));return i.push(`</g>
`),i},getSvgStyles:function(){var r=typeof this.opacity<"u"&&this.opacity!==1?"opacity: "+this.opacity+";":"",i=this.visible?"":" visibility: hidden;";return[r,this.getSvgFilter(),i].join("")},toClipPathSVG:function(r){for(var i=[],a=0,s=this._objects.length;a<s;a++)i.push("	",this._objects[a].toClipPathSVG(r));return this._createBaseClipPathSVGMarkup(i,{reviver:r})}}),e.Group.fromObject=function(r,i){var a=r.objects,s=e.util.object.clone(r,!0);if(delete s.objects,typeof a=="string"){e.loadSVGFromURL(a,function(c){var l=e.util.groupSVGElements(c,r,a),u=s.clipPath;delete s.clipPath,l.set(s),u?e.util.enlivenObjects([u],function(d){l.clipPath=d[0],i&&i(l)}):i&&i(l)});return}e.util.enlivenObjects(a,function(c){e.util.enlivenObjectEnlivables(r,s,function(){i&&i(new e.Group(c,s,!0))})})})})(ne);(function(t){"use strict";var e=t.fabric||(t.fabric={});e.ActiveSelection||(e.ActiveSelection=e.util.createClass(e.Group,{type:"activeSelection",initialize:function(n,o){o=o||{},this._objects=n||[];for(var r=this._objects.length;r--;)this._objects[r].group=this;o.originX&&(this.originX=o.originX),o.originY&&(this.originY=o.originY),this._calcBounds(),this._updateObjectsCoords(),e.Object.prototype.initialize.call(this,o),this.setCoords()},toGroup:function(){var n=this._objects.concat();this._objects=[];var o=e.Object.prototype.toObject.call(this),r=new e.Group([]);if(delete o.type,r.set(o),n.forEach(function(a){a.canvas.remove(a),a.group=r}),r._objects=n,!this.canvas)return r;var i=this.canvas;return i.add(r),i._activeObject=r,r.setCoords(),r},onDeselect:function(){return this.destroy(),!1},toString:function(){return"#<fabric.ActiveSelection: ("+this.complexity()+")>"},shouldCache:function(){return!1},isOnACache:function(){return!1},_renderControls:function(n,o,r){n.save(),n.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1,this.callSuper("_renderControls",n,o),r=r||{},typeof r.hasControls>"u"&&(r.hasControls=!1),r.forActiveSelection=!0;for(var i=0,a=this._objects.length;i<a;i++)this._objects[i]._renderControls(n,r);n.restore()}}),e.ActiveSelection.fromObject=function(n,o){e.util.enlivenObjects(n.objects,function(r){delete n.objects,o&&o(new e.ActiveSelection(r,n,!0))})})})(ne);(function(t){"use strict";var e=g.util.object.extend;if(t.fabric||(t.fabric={}),t.fabric.Image){g.warn("fabric.Image is already defined.");return}g.Image=g.util.createClass(g.Object,{type:"image",strokeWidth:0,srcFromAttribute:!1,_lastScaleX:1,_lastScaleY:1,_filterScalingX:1,_filterScalingY:1,minimumScaleTrigger:.5,stateProperties:g.Object.prototype.stateProperties.concat("cropX","cropY"),cacheProperties:g.Object.prototype.cacheProperties.concat("cropX","cropY"),cacheKey:"",cropX:0,cropY:0,imageSmoothing:!0,initialize:function(n,o){o||(o={}),this.filters=[],this.cacheKey="texture"+g.Object.__uid++,this.callSuper("initialize",o),this._initElement(n,o)},getElement:function(){return this._element||{}},setElement:function(n,o){return this.removeTexture(this.cacheKey),this.removeTexture(this.cacheKey+"_filtered"),this._element=n,this._originalElement=n,this._initConfig(o),this.filters.length!==0&&this.applyFilters(),this.resizeFilter&&this.applyResizeFilters(),this},removeTexture:function(n){var o=g.filterBackend;o&&o.evictCachesForKey&&o.evictCachesForKey(n)},dispose:function(){this.callSuper("dispose"),this.removeTexture(this.cacheKey),this.removeTexture(this.cacheKey+"_filtered"),this._cacheContext=void 0,["_originalElement","_element","_filteredEl","_cacheCanvas"].forEach(function(n){g.util.cleanUpJsdomNode(this[n]),this[n]=void 0}.bind(this))},getCrossOrigin:function(){return this._originalElement&&(this._originalElement.crossOrigin||null)},getOriginalSize:function(){var n=this.getElement();return{width:n.naturalWidth||n.width,height:n.naturalHeight||n.height}},_stroke:function(n){if(!(!this.stroke||this.strokeWidth===0)){var o=this.width/2,r=this.height/2;n.beginPath(),n.moveTo(-o,-r),n.lineTo(o,-r),n.lineTo(o,r),n.lineTo(-o,r),n.lineTo(-o,-r),n.closePath()}},toObject:function(n){var o=[];this.filters.forEach(function(i){i&&o.push(i.toObject())});var r=e(this.callSuper("toObject",["cropX","cropY"].concat(n)),{src:this.getSrc(),crossOrigin:this.getCrossOrigin(),filters:o});return this.resizeFilter&&(r.resizeFilter=this.resizeFilter.toObject()),r},hasCrop:function(){return this.cropX||this.cropY||this.width<this._element.width||this.height<this._element.height},_toSVG:function(){var n=[],o=[],r,i=this._element,a=-this.width/2,s=-this.height/2,c="",l="";if(!i)return[];if(this.hasCrop()){var u=g.Object.__uid++;n.push('<clipPath id="imageCrop_'+u+`">
`,'	<rect x="'+a+'" y="'+s+'" width="'+this.width+'" height="'+this.height+`" />
`,`</clipPath>
`),c=' clip-path="url(#imageCrop_'+u+')" '}if(this.imageSmoothing||(l='" image-rendering="optimizeSpeed'),o.push("	<image ","COMMON_PARTS",'xlink:href="',this.getSvgSrc(!0),'" x="',a-this.cropX,'" y="',s-this.cropY,'" width="',i.width||i.naturalWidth,'" height="',i.height||i.height,l,'"',c,`></image>
`),this.stroke||this.strokeDashArray){var d=this.fill;this.fill=null,r=["	<rect ",'x="',a,'" y="',s,'" width="',this.width,'" height="',this.height,'" style="',this.getSvgStyles(),`"/>
`],this.fill=d}return this.paintFirst!=="fill"?n=n.concat(r,o):n=n.concat(o,r),n},getSrc:function(n){var o=n?this._element:this._originalElement;return o?o.toDataURL?o.toDataURL():this.srcFromAttribute?o.getAttribute("src"):o.src:this.src||""},setSrc:function(n,o,r){return g.util.loadImage(n,function(i,a){this.setElement(i,r),this._setWidthHeight(),o&&o(this,a)},this,r&&r.crossOrigin),this},toString:function(){return'#<fabric.Image: { src: "'+this.getSrc()+'" }>'},applyResizeFilters:function(){var n=this.resizeFilter,o=this.minimumScaleTrigger,r=this.getTotalObjectScaling(),i=r.scaleX,a=r.scaleY,s=this._filteredEl||this._originalElement;if(this.group&&this.set("dirty",!0),!n||i>o&&a>o){this._element=s,this._filterScalingX=1,this._filterScalingY=1,this._lastScaleX=i,this._lastScaleY=a;return}g.filterBackend||(g.filterBackend=g.initFilterBackend());var c=g.util.createCanvasElement(),l=this._filteredEl?this.cacheKey+"_filtered":this.cacheKey,u=s.width,d=s.height;c.width=u,c.height=d,this._element=c,this._lastScaleX=n.scaleX=i,this._lastScaleY=n.scaleY=a,g.filterBackend.applyFilters([n],s,u,d,this._element,l),this._filterScalingX=c.width/this._originalElement.width,this._filterScalingY=c.height/this._originalElement.height},applyFilters:function(n){if(n=n||this.filters||[],n=n.filter(function(s){return s&&!s.isNeutralState()}),this.set("dirty",!0),this.removeTexture(this.cacheKey+"_filtered"),n.length===0)return this._element=this._originalElement,this._filteredEl=null,this._filterScalingX=1,this._filterScalingY=1,this;var o=this._originalElement,r=o.naturalWidth||o.width,i=o.naturalHeight||o.height;if(this._element===this._originalElement){var a=g.util.createCanvasElement();a.width=r,a.height=i,this._element=a,this._filteredEl=a}else this._element=this._filteredEl,this._filteredEl.getContext("2d").clearRect(0,0,r,i),this._lastScaleX=1,this._lastScaleY=1;return g.filterBackend||(g.filterBackend=g.initFilterBackend()),g.filterBackend.applyFilters(n,this._originalElement,r,i,this._element,this.cacheKey),(this._originalElement.width!==this._element.width||this._originalElement.height!==this._element.height)&&(this._filterScalingX=this._element.width/this._originalElement.width,this._filterScalingY=this._element.height/this._originalElement.height),this},_render:function(n){g.util.setImageSmoothing(n,this.imageSmoothing),this.isMoving!==!0&&this.resizeFilter&&this._needsResize()&&this.applyResizeFilters(),this._stroke(n),this._renderPaintInOrder(n)},drawCacheOnCanvas:function(n){g.util.setImageSmoothing(n,this.imageSmoothing),g.Object.prototype.drawCacheOnCanvas.call(this,n)},shouldCache:function(){return this.needsItsOwnCache()},_renderFill:function(n){var o=this._element;if(o){var r=this._filterScalingX,i=this._filterScalingY,a=this.width,s=this.height,c=Math.min,l=Math.max,u=l(this.cropX,0),d=l(this.cropY,0),f=o.naturalWidth||o.width,p=o.naturalHeight||o.height,m=u*r,h=d*i,b=c(a*r,f-m),x=c(s*i,p-h),y=-a/2,M=-s/2,E=c(a,f/r-u),C=c(s,p/i-d);o&&n.drawImage(o,m,h,b,x,y,M,E,C)}},_needsResize:function(){var n=this.getTotalObjectScaling();return n.scaleX!==this._lastScaleX||n.scaleY!==this._lastScaleY},_resetWidthHeight:function(){this.set(this.getOriginalSize())},_initElement:function(n,o){this.setElement(g.util.getById(n),o),g.util.addClass(this.getElement(),g.Image.CSS_CANVAS)},_initConfig:function(n){n||(n={}),this.setOptions(n),this._setWidthHeight(n)},_initFilters:function(n,o){n&&n.length?g.util.enlivenObjects(n,function(r){o&&o(r)},"fabric.Image.filters"):o&&o()},_setWidthHeight:function(n){n||(n={});var o=this.getElement();this.width=n.width||o.naturalWidth||o.width||0,this.height=n.height||o.naturalHeight||o.height||0},parsePreserveAspectRatioAttribute:function(){var n=g.util.parsePreserveAspectRatioAttribute(this.preserveAspectRatio||""),o=this._element.width,r=this._element.height,i=1,a=1,s=0,c=0,l=0,u=0,d,f=this.width,p=this.height,m={width:f,height:p};return n&&(n.alignX!=="none"||n.alignY!=="none")?(n.meetOrSlice==="meet"&&(i=a=g.util.findScaleToFit(this._element,m),d=(f-o*i)/2,n.alignX==="Min"&&(s=-d),n.alignX==="Max"&&(s=d),d=(p-r*a)/2,n.alignY==="Min"&&(c=-d),n.alignY==="Max"&&(c=d)),n.meetOrSlice==="slice"&&(i=a=g.util.findScaleToCover(this._element,m),d=o-f/i,n.alignX==="Mid"&&(l=d/2),n.alignX==="Max"&&(l=d),d=r-p/a,n.alignY==="Mid"&&(u=d/2),n.alignY==="Max"&&(u=d),o=f/i,r=p/a)):(i=f/o,a=p/r),{width:o,height:r,scaleX:i,scaleY:a,offsetLeft:s,offsetTop:c,cropX:l,cropY:u}}}),g.Image.CSS_CANVAS="canvas-img",g.Image.prototype.getSvgSrc=g.Image.prototype.getSrc,g.Image.fromObject=function(n,o){var r=g.util.object.clone(n);g.util.loadImage(r.src,function(i,a){if(a){o&&o(null,!0);return}g.Image.prototype._initFilters.call(r,r.filters,function(s){r.filters=s||[],g.Image.prototype._initFilters.call(r,[r.resizeFilter],function(c){r.resizeFilter=c[0],g.util.enlivenObjectEnlivables(r,r,function(){var l=new g.Image(i,r);o(l,!1)})})})},null,r.crossOrigin)},g.Image.fromURL=function(n,o,r){g.util.loadImage(n,function(i,a){o&&o(new g.Image(i,r),a)},null,r&&r.crossOrigin)},g.Image.ATTRIBUTE_NAMES=g.SHARED_ATTRIBUTES.concat("x y width height preserveAspectRatio xlink:href crossOrigin image-rendering".split(" ")),g.Image.fromElement=function(n,o,r){var i=g.parseAttributes(n,g.Image.ATTRIBUTE_NAMES);g.Image.fromURL(i["xlink:href"],o,e(r?g.util.object.clone(r):{},i))}})(ne);g.util.object.extend(g.Object.prototype,{_getAngleValueForStraighten:function(){var t=this.angle%360;return t>0?Math.round((t-1)/90)*90:Math.round(t/90)*90},straighten:function(){return this.rotate(this._getAngleValueForStraighten())},fxStraighten:function(t){t=t||{};var e=function(){},n=t.onComplete||e,o=t.onChange||e,r=this;return g.util.animate({target:this,startValue:this.get("angle"),endValue:this._getAngleValueForStraighten(),duration:this.FX_DURATION,onChange:function(i){r.rotate(i),o()},onComplete:function(){r.setCoords(),n()}})}});g.util.object.extend(g.StaticCanvas.prototype,{straightenObject:function(t){return t.straighten(),this.requestRenderAll(),this},fxStraightenObject:function(t){return t.fxStraighten({onChange:this.requestRenderAllBound})}});(function(){"use strict";function t(n,o){var r="precision "+o+` float;
void main(){}`,i=n.createShader(n.FRAGMENT_SHADER);return n.shaderSource(i,r),n.compileShader(i),!!n.getShaderParameter(i,n.COMPILE_STATUS)}g.isWebglSupported=function(n){if(g.isLikelyNode)return!1;n=n||g.WebglFilterBackend.prototype.tileSize;var o=document.createElement("canvas"),r=o.getContext("webgl")||o.getContext("experimental-webgl"),i=!1;if(r){g.maxTextureSize=r.getParameter(r.MAX_TEXTURE_SIZE),i=g.maxTextureSize>=n;for(var a=["highp","mediump","lowp"],s=0;s<3;s++)if(t(r,a[s])){g.webGlPrecision=a[s];break}}return this.isSupported=i,i},g.WebglFilterBackend=e;function e(n){n&&n.tileSize&&(this.tileSize=n.tileSize),this.setupGLContext(this.tileSize,this.tileSize),this.captureGPUInfo()}e.prototype={tileSize:2048,resources:{},setupGLContext:function(n,o){this.dispose(),this.createWebGLCanvas(n,o),this.aPosition=new Float32Array([0,0,0,1,1,0,1,1]),this.chooseFastestCopyGLTo2DMethod(n,o)},chooseFastestCopyGLTo2DMethod:function(n,o){var r=typeof window.performance<"u",i;try{new ImageData(1,1),i=!0}catch{i=!1}var a=typeof ArrayBuffer<"u",s=typeof Uint8ClampedArray<"u";if(r&&i&&a&&s){var c=g.util.createCanvasElement(),l=new ArrayBuffer(n*o*4);if(g.forceGLPutImageData){this.imageBuffer=l,this.copyGLTo2D=Gs;return}var u={imageBuffer:l,destinationWidth:n,destinationHeight:o,targetCanvas:c},d,f,p;c.width=n,c.height=o,d=window.performance.now(),Hs.call(u,this.gl,u),f=window.performance.now()-d,d=window.performance.now(),Gs.call(u,this.gl,u),p=window.performance.now()-d,f>p?(this.imageBuffer=l,this.copyGLTo2D=Gs):this.copyGLTo2D=Hs}},createWebGLCanvas:function(n,o){var r=g.util.createCanvasElement();r.width=n,r.height=o;var i={alpha:!0,premultipliedAlpha:!1,depth:!1,stencil:!1,antialias:!1},a=r.getContext("webgl",i);a||(a=r.getContext("experimental-webgl",i)),a&&(a.clearColor(0,0,0,0),this.canvas=r,this.gl=a)},applyFilters:function(n,o,r,i,a,s){var c=this.gl,l;s&&(l=this.getCachedTexture(s,o));var u={originalWidth:o.width||o.originalWidth,originalHeight:o.height||o.originalHeight,sourceWidth:r,sourceHeight:i,destinationWidth:r,destinationHeight:i,context:c,sourceTexture:this.createTexture(c,r,i,!l&&o),targetTexture:this.createTexture(c,r,i),originalTexture:l||this.createTexture(c,r,i,!l&&o),passes:n.length,webgl:!0,aPosition:this.aPosition,programCache:this.programCache,pass:0,filterBackend:this,targetCanvas:a},d=c.createFramebuffer();return c.bindFramebuffer(c.FRAMEBUFFER,d),n.forEach(function(f){f&&f.applyTo(u)}),M1(u),this.copyGLTo2D(c,u),c.bindTexture(c.TEXTURE_2D,null),c.deleteTexture(u.sourceTexture),c.deleteTexture(u.targetTexture),c.deleteFramebuffer(d),a.getContext("2d").setTransform(1,0,0,1,0,0),u},dispose:function(){this.canvas&&(this.canvas=null,this.gl=null),this.clearWebGLCaches()},clearWebGLCaches:function(){this.programCache={},this.textureCache={}},createTexture:function(n,o,r,i,a){var s=n.createTexture();return n.bindTexture(n.TEXTURE_2D,s),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,a||n.NEAREST),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,a||n.NEAREST),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),i?n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,i):n.texImage2D(n.TEXTURE_2D,0,n.RGBA,o,r,0,n.RGBA,n.UNSIGNED_BYTE,null),s},getCachedTexture:function(n,o){if(this.textureCache[n])return this.textureCache[n];var r=this.createTexture(this.gl,o.width,o.height,o);return this.textureCache[n]=r,r},evictCachesForKey:function(n){this.textureCache[n]&&(this.gl.deleteTexture(this.textureCache[n]),delete this.textureCache[n])},copyGLTo2D:Hs,captureGPUInfo:function(){if(this.gpuInfo)return this.gpuInfo;var n=this.gl,o={renderer:"",vendor:""};if(!n)return o;var r=n.getExtension("WEBGL_debug_renderer_info");if(r){var i=n.getParameter(r.UNMASKED_RENDERER_WEBGL),a=n.getParameter(r.UNMASKED_VENDOR_WEBGL);i&&(o.renderer=i.toLowerCase()),a&&(o.vendor=a.toLowerCase())}return this.gpuInfo=o,o}}})();function M1(t){var e=t.targetCanvas,n=e.width,o=e.height,r=t.destinationWidth,i=t.destinationHeight;(n!==r||o!==i)&&(e.width=r,e.height=i)}function Hs(t,e){var n=t.canvas,o=e.targetCanvas,r=o.getContext("2d");r.translate(0,o.height),r.scale(1,-1);var i=n.height-o.height;r.drawImage(n,0,i,o.width,o.height,0,0,o.width,o.height)}function Gs(t,e){var n=e.targetCanvas,o=n.getContext("2d"),r=e.destinationWidth,i=e.destinationHeight,a=r*i*4,s=new Uint8Array(this.imageBuffer,0,a),c=new Uint8ClampedArray(this.imageBuffer,0,a);t.readPixels(0,0,r,i,t.RGBA,t.UNSIGNED_BYTE,s);var l=new ImageData(c,r,i);o.putImageData(l,0,0)}(function(){"use strict";var t=function(){};g.Canvas2dFilterBackend=e;function e(){}e.prototype={evictCachesForKey:t,dispose:t,clearWebGLCaches:t,resources:{},applyFilters:function(n,o,r,i,a){var s=a.getContext("2d");s.drawImage(o,0,0,r,i);var c=s.getImageData(0,0,r,i),l=s.getImageData(0,0,r,i),u={sourceWidth:r,sourceHeight:i,imageData:c,originalEl:o,originalImageData:l,canvasEl:a,ctx:s,filterBackend:this};return n.forEach(function(d){d.applyTo(u)}),(u.imageData.width!==r||u.imageData.height!==i)&&(a.width=u.imageData.width,a.height=u.imageData.height),s.putImageData(u.imageData,0,0),u}}})();g.Image=g.Image||{};g.Image.filters=g.Image.filters||{};g.Image.filters.BaseFilter=g.util.createClass({type:"BaseFilter",vertexSource:`attribute vec2 aPosition;
varying vec2 vTexCoord;
void main() {
vTexCoord = aPosition;
gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
}`,fragmentSource:`precision highp float;
varying vec2 vTexCoord;
uniform sampler2D uTexture;
void main() {
gl_FragColor = texture2D(uTexture, vTexCoord);
}`,initialize:function(t){t&&this.setOptions(t)},setOptions:function(t){for(var e in t)this[e]=t[e]},createProgram:function(t,e,n){e=e||this.fragmentSource,n=n||this.vertexSource,g.webGlPrecision!=="highp"&&(e=e.replace(/precision highp float/g,"precision "+g.webGlPrecision+" float"));var o=t.createShader(t.VERTEX_SHADER);if(t.shaderSource(o,n),t.compileShader(o),!t.getShaderParameter(o,t.COMPILE_STATUS))throw new Error("Vertex shader compile error for "+this.type+": "+t.getShaderInfoLog(o));var r=t.createShader(t.FRAGMENT_SHADER);if(t.shaderSource(r,e),t.compileShader(r),!t.getShaderParameter(r,t.COMPILE_STATUS))throw new Error("Fragment shader compile error for "+this.type+": "+t.getShaderInfoLog(r));var i=t.createProgram();if(t.attachShader(i,o),t.attachShader(i,r),t.linkProgram(i),!t.getProgramParameter(i,t.LINK_STATUS))throw new Error('Shader link error for "${this.type}" '+t.getProgramInfoLog(i));var a=this.getAttributeLocations(t,i),s=this.getUniformLocations(t,i)||{};return s.uStepW=t.getUniformLocation(i,"uStepW"),s.uStepH=t.getUniformLocation(i,"uStepH"),{program:i,attributeLocations:a,uniformLocations:s}},getAttributeLocations:function(t,e){return{aPosition:t.getAttribLocation(e,"aPosition")}},getUniformLocations:function(){return{}},sendAttributeData:function(t,e,n){var o=e.aPosition,r=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,r),t.enableVertexAttribArray(o),t.vertexAttribPointer(o,2,t.FLOAT,!1,0,0),t.bufferData(t.ARRAY_BUFFER,n,t.STATIC_DRAW)},_setupFrameBuffer:function(t){var e=t.context,n,o;t.passes>1?(n=t.destinationWidth,o=t.destinationHeight,(t.sourceWidth!==n||t.sourceHeight!==o)&&(e.deleteTexture(t.targetTexture),t.targetTexture=t.filterBackend.createTexture(e,n,o)),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t.targetTexture,0)):(e.bindFramebuffer(e.FRAMEBUFFER,null),e.finish())},_swapTextures:function(t){t.passes--,t.pass++;var e=t.targetTexture;t.targetTexture=t.sourceTexture,t.sourceTexture=e},isNeutralState:function(){var t=this.mainParameter,e=g.Image.filters[this.type].prototype;if(t)if(Array.isArray(e[t])){for(var n=e[t].length;n--;)if(this[t][n]!==e[t][n])return!1;return!0}else return e[t]===this[t];else return!1},applyTo:function(t){t.webgl?(this._setupFrameBuffer(t),this.applyToWebGL(t),this._swapTextures(t)):this.applyTo2d(t)},retrieveShader:function(t){return t.programCache.hasOwnProperty(this.type)||(t.programCache[this.type]=this.createProgram(t.context)),t.programCache[this.type]},applyToWebGL:function(t){var e=t.context,n=this.retrieveShader(t);t.pass===0&&t.originalTexture?e.bindTexture(e.TEXTURE_2D,t.originalTexture):e.bindTexture(e.TEXTURE_2D,t.sourceTexture),e.useProgram(n.program),this.sendAttributeData(e,n.attributeLocations,t.aPosition),e.uniform1f(n.uniformLocations.uStepW,1/t.sourceWidth),e.uniform1f(n.uniformLocations.uStepH,1/t.sourceHeight),this.sendUniformData(e,n.uniformLocations),e.viewport(0,0,t.destinationWidth,t.destinationHeight),e.drawArrays(e.TRIANGLE_STRIP,0,4)},bindAdditionalTexture:function(t,e,n){t.activeTexture(n),t.bindTexture(t.TEXTURE_2D,e),t.activeTexture(t.TEXTURE0)},unbindAdditionalTexture:function(t,e){t.activeTexture(e),t.bindTexture(t.TEXTURE_2D,null),t.activeTexture(t.TEXTURE0)},getMainParameter:function(){return this[this.mainParameter]},setMainParameter:function(t){this[this.mainParameter]=t},sendUniformData:function(){},createHelpLayer:function(t){if(!t.helpLayer){var e=document.createElement("canvas");e.width=t.sourceWidth,e.height=t.sourceHeight,t.helpLayer=e}},toObject:function(){var t={type:this.type},e=this.mainParameter;return e&&(t[e]=this[e]),t},toJSON:function(){return this.toObject()}});g.Image.filters.BaseFilter.fromObject=function(t,e){var n=new g.Image.filters[t.type](t);return e&&e(n),n};(function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.Image.filters,o=e.util.createClass;n.ColorMatrix=o(n.BaseFilter,{type:"ColorMatrix",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
varying vec2 vTexCoord;
uniform mat4 uColorMatrix;
uniform vec4 uConstants;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color *= uColorMatrix;
color += uConstants;
gl_FragColor = color;
}`,matrix:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],mainParameter:"matrix",colorsOnly:!0,initialize:function(r){this.callSuper("initialize",r),this.matrix=this.matrix.slice(0)},applyTo2d:function(r){var i=r.imageData,a=i.data,s=a.length,c=this.matrix,l,u,d,f,p,m=this.colorsOnly;for(p=0;p<s;p+=4)l=a[p],u=a[p+1],d=a[p+2],m?(a[p]=l*c[0]+u*c[1]+d*c[2]+c[4]*255,a[p+1]=l*c[5]+u*c[6]+d*c[7]+c[9]*255,a[p+2]=l*c[10]+u*c[11]+d*c[12]+c[14]*255):(f=a[p+3],a[p]=l*c[0]+u*c[1]+d*c[2]+f*c[3]+c[4]*255,a[p+1]=l*c[5]+u*c[6]+d*c[7]+f*c[8]+c[9]*255,a[p+2]=l*c[10]+u*c[11]+d*c[12]+f*c[13]+c[14]*255,a[p+3]=l*c[15]+u*c[16]+d*c[17]+f*c[18]+c[19]*255)},getUniformLocations:function(r,i){return{uColorMatrix:r.getUniformLocation(i,"uColorMatrix"),uConstants:r.getUniformLocation(i,"uConstants")}},sendUniformData:function(r,i){var a=this.matrix,s=[a[0],a[1],a[2],a[3],a[5],a[6],a[7],a[8],a[10],a[11],a[12],a[13],a[15],a[16],a[17],a[18]],c=[a[4],a[9],a[14],a[19]];r.uniformMatrix4fv(i.uColorMatrix,!1,s),r.uniform4fv(i.uConstants,c)}}),e.Image.filters.ColorMatrix.fromObject=e.Image.filters.BaseFilter.fromObject})(ne);(function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.Image.filters,o=e.util.createClass;n.Brightness=o(n.BaseFilter,{type:"Brightness",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uBrightness;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color.rgb += uBrightness;
gl_FragColor = color;
}`,brightness:0,mainParameter:"brightness",applyTo2d:function(r){if(this.brightness!==0){var i=r.imageData,a=i.data,s,c=a.length,l=Math.round(this.brightness*255);for(s=0;s<c;s+=4)a[s]=a[s]+l,a[s+1]=a[s+1]+l,a[s+2]=a[s+2]+l}},getUniformLocations:function(r,i){return{uBrightness:r.getUniformLocation(i,"uBrightness")}},sendUniformData:function(r,i){r.uniform1f(i.uBrightness,this.brightness)}}),e.Image.filters.Brightness.fromObject=e.Image.filters.BaseFilter.fromObject})(ne);(function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.util.object.extend,o=e.Image.filters,r=e.util.createClass;o.Convolute=r(o.BaseFilter,{type:"Convolute",opaque:!1,matrix:[0,0,0,0,1,0,0,0,0],fragmentSource:{Convolute_3_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[9];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 3.0; h+=1.0) {
for (float w = 0.0; w < 3.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 1), uStepH * (h - 1));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 3.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_3_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[9];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 3.0; h+=1.0) {
for (float w = 0.0; w < 3.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 1.0), uStepH * (h - 1.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 3.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_5_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[25];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 5.0; h+=1.0) {
for (float w = 0.0; w < 5.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 5.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_5_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[25];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 5.0; h+=1.0) {
for (float w = 0.0; w < 5.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 5.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_7_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[49];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 7.0; h+=1.0) {
for (float w = 0.0; w < 7.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 7.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_7_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[49];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 7.0; h+=1.0) {
for (float w = 0.0; w < 7.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 7.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_9_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[81];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 9.0; h+=1.0) {
for (float w = 0.0; w < 9.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 9.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_9_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[81];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 9.0; h+=1.0) {
for (float w = 0.0; w < 9.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 9.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`},retrieveShader:function(i){var a=Math.sqrt(this.matrix.length),s=this.type+"_"+a+"_"+(this.opaque?1:0),c=this.fragmentSource[s];return i.programCache.hasOwnProperty(s)||(i.programCache[s]=this.createProgram(i.context,c)),i.programCache[s]},applyTo2d:function(i){var a=i.imageData,s=a.data,c=this.matrix,l=Math.round(Math.sqrt(c.length)),u=Math.floor(l/2),d=a.width,f=a.height,p=i.ctx.createImageData(d,f),m=p.data,h=this.opaque?1:0,b,x,y,M,E,C,j,P,D,N,S,G,v;for(S=0;S<f;S++)for(N=0;N<d;N++){for(E=(S*d+N)*4,b=0,x=0,y=0,M=0,v=0;v<l;v++)for(G=0;G<l;G++)j=S+v-u,C=N+G-u,!(j<0||j>=f||C<0||C>=d)&&(P=(j*d+C)*4,D=c[v*l+G],b+=s[P]*D,x+=s[P+1]*D,y+=s[P+2]*D,h||(M+=s[P+3]*D));m[E]=b,m[E+1]=x,m[E+2]=y,h?m[E+3]=s[E+3]:m[E+3]=M}i.imageData=p},getUniformLocations:function(i,a){return{uMatrix:i.getUniformLocation(a,"uMatrix"),uOpaque:i.getUniformLocation(a,"uOpaque"),uHalfSize:i.getUniformLocation(a,"uHalfSize"),uSize:i.getUniformLocation(a,"uSize")}},sendUniformData:function(i,a){i.uniform1fv(a.uMatrix,this.matrix)},toObject:function(){return n(this.callSuper("toObject"),{opaque:this.opaque,matrix:this.matrix})}}),e.Image.filters.Convolute.fromObject=e.Image.filters.BaseFilter.fromObject})(ne);(function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.Image.filters,o=e.util.createClass;n.Grayscale=o(n.BaseFilter,{type:"Grayscale",fragmentSource:{average:`precision highp float;
uniform sampler2D uTexture;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float average = (color.r + color.b + color.g) / 3.0;
gl_FragColor = vec4(average, average, average, color.a);
}`,lightness:`precision highp float;
uniform sampler2D uTexture;
uniform int uMode;
varying vec2 vTexCoord;
void main() {
vec4 col = texture2D(uTexture, vTexCoord);
float average = (max(max(col.r, col.g),col.b) + min(min(col.r, col.g),col.b)) / 2.0;
gl_FragColor = vec4(average, average, average, col.a);
}`,luminosity:`precision highp float;
uniform sampler2D uTexture;
uniform int uMode;
varying vec2 vTexCoord;
void main() {
vec4 col = texture2D(uTexture, vTexCoord);
float average = 0.21 * col.r + 0.72 * col.g + 0.07 * col.b;
gl_FragColor = vec4(average, average, average, col.a);
}`},mode:"average",mainParameter:"mode",applyTo2d:function(r){var i=r.imageData,a=i.data,s,c=a.length,l,u=this.mode;for(s=0;s<c;s+=4)u==="average"?l=(a[s]+a[s+1]+a[s+2])/3:u==="lightness"?l=(Math.min(a[s],a[s+1],a[s+2])+Math.max(a[s],a[s+1],a[s+2]))/2:u==="luminosity"&&(l=.21*a[s]+.72*a[s+1]+.07*a[s+2]),a[s]=l,a[s+1]=l,a[s+2]=l},retrieveShader:function(r){var i=this.type+"_"+this.mode;if(!r.programCache.hasOwnProperty(i)){var a=this.fragmentSource[this.mode];r.programCache[i]=this.createProgram(r.context,a)}return r.programCache[i]},getUniformLocations:function(r,i){return{uMode:r.getUniformLocation(i,"uMode")}},sendUniformData:function(r,i){var a=1;r.uniform1i(i.uMode,a)},isNeutralState:function(){return!1}}),e.Image.filters.Grayscale.fromObject=e.Image.filters.BaseFilter.fromObject})(ne);(function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.Image.filters,o=e.util.createClass;n.Invert=o(n.BaseFilter,{type:"Invert",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform int uInvert;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
if (uInvert == 1) {
gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,color.a);
} else {
gl_FragColor = color;
}
}`,invert:!0,mainParameter:"invert",applyTo2d:function(r){var i=r.imageData,a=i.data,s,c=a.length;for(s=0;s<c;s+=4)a[s]=255-a[s],a[s+1]=255-a[s+1],a[s+2]=255-a[s+2]},isNeutralState:function(){return!this.invert},getUniformLocations:function(r,i){return{uInvert:r.getUniformLocation(i,"uInvert")}},sendUniformData:function(r,i){r.uniform1i(i.uInvert,this.invert)}}),e.Image.filters.Invert.fromObject=e.Image.filters.BaseFilter.fromObject})(ne);(function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.util.object.extend,o=e.Image.filters,r=e.util.createClass;o.Noise=r(o.BaseFilter,{type:"Noise",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uStepH;
uniform float uNoise;
uniform float uSeed;
varying vec2 vTexCoord;
float rand(vec2 co, float seed, float vScale) {
return fract(sin(dot(co.xy * vScale ,vec2(12.9898 , 78.233))) * 43758.5453 * (seed + 0.01) / 2.0);
}
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color.rgb += (0.5 - rand(vTexCoord, uSeed, 0.1 / uStepH)) * uNoise;
gl_FragColor = color;
}`,mainParameter:"noise",noise:0,applyTo2d:function(i){if(this.noise!==0){var a=i.imageData,s=a.data,c,l=s.length,u=this.noise,d;for(c=0,l=s.length;c<l;c+=4)d=(.5-Math.random())*u,s[c]+=d,s[c+1]+=d,s[c+2]+=d}},getUniformLocations:function(i,a){return{uNoise:i.getUniformLocation(a,"uNoise"),uSeed:i.getUniformLocation(a,"uSeed")}},sendUniformData:function(i,a){i.uniform1f(a.uNoise,this.noise/255),i.uniform1f(a.uSeed,Math.random())},toObject:function(){return n(this.callSuper("toObject"),{noise:this.noise})}}),e.Image.filters.Noise.fromObject=e.Image.filters.BaseFilter.fromObject})(ne);(function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.Image.filters,o=e.util.createClass;n.Pixelate=o(n.BaseFilter,{type:"Pixelate",blocksize:4,mainParameter:"blocksize",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uBlocksize;
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
float blockW = uBlocksize * uStepW;
float blockH = uBlocksize * uStepW;
int posX = int(vTexCoord.x / blockW);
int posY = int(vTexCoord.y / blockH);
float fposX = float(posX);
float fposY = float(posY);
vec2 squareCoords = vec2(fposX * blockW, fposY * blockH);
vec4 color = texture2D(uTexture, squareCoords);
gl_FragColor = color;
}`,applyTo2d:function(r){var i=r.imageData,a=i.data,s=i.height,c=i.width,l,u,d,f,p,m,h,b,x,y,M;for(u=0;u<s;u+=this.blocksize)for(d=0;d<c;d+=this.blocksize)for(l=u*4*c+d*4,f=a[l],p=a[l+1],m=a[l+2],h=a[l+3],y=Math.min(u+this.blocksize,s),M=Math.min(d+this.blocksize,c),b=u;b<y;b++)for(x=d;x<M;x++)l=b*4*c+x*4,a[l]=f,a[l+1]=p,a[l+2]=m,a[l+3]=h},isNeutralState:function(){return this.blocksize===1},getUniformLocations:function(r,i){return{uBlocksize:r.getUniformLocation(i,"uBlocksize"),uStepW:r.getUniformLocation(i,"uStepW"),uStepH:r.getUniformLocation(i,"uStepH")}},sendUniformData:function(r,i){r.uniform1f(i.uBlocksize,this.blocksize)}}),e.Image.filters.Pixelate.fromObject=e.Image.filters.BaseFilter.fromObject})(ne);(function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.util.object.extend,o=e.Image.filters,r=e.util.createClass;o.RemoveColor=r(o.BaseFilter,{type:"RemoveColor",color:"#FFFFFF",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec4 uLow;
uniform vec4 uHigh;
varying vec2 vTexCoord;
void main() {
gl_FragColor = texture2D(uTexture, vTexCoord);
if(all(greaterThan(gl_FragColor.rgb,uLow.rgb)) && all(greaterThan(uHigh.rgb,gl_FragColor.rgb))) {
gl_FragColor.a = 0.0;
}
}`,distance:.02,useAlpha:!1,applyTo2d:function(i){var a=i.imageData,s=a.data,c,l=this.distance*255,u,d,f,p=new e.Color(this.color).getSource(),m=[p[0]-l,p[1]-l,p[2]-l],h=[p[0]+l,p[1]+l,p[2]+l];for(c=0;c<s.length;c+=4)u=s[c],d=s[c+1],f=s[c+2],u>m[0]&&d>m[1]&&f>m[2]&&u<h[0]&&d<h[1]&&f<h[2]&&(s[c+3]=0)},getUniformLocations:function(i,a){return{uLow:i.getUniformLocation(a,"uLow"),uHigh:i.getUniformLocation(a,"uHigh")}},sendUniformData:function(i,a){var s=new e.Color(this.color).getSource(),c=parseFloat(this.distance),l=[0+s[0]/255-c,0+s[1]/255-c,0+s[2]/255-c,1],u=[s[0]/255+c,s[1]/255+c,s[2]/255+c,1];i.uniform4fv(a.uLow,l),i.uniform4fv(a.uHigh,u)},toObject:function(){return n(this.callSuper("toObject"),{color:this.color,distance:this.distance})}}),e.Image.filters.RemoveColor.fromObject=e.Image.filters.BaseFilter.fromObject})(ne);(function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.Image.filters,o=e.util.createClass,r={Brownie:[.5997,.34553,-.27082,0,.186,-.0377,.86095,.15059,0,-.1449,.24113,-.07441,.44972,0,-.02965,0,0,0,1,0],Vintage:[.62793,.32021,-.03965,0,.03784,.02578,.64411,.03259,0,.02926,.0466,-.08512,.52416,0,.02023,0,0,0,1,0],Kodachrome:[1.12855,-.39673,-.03992,0,.24991,-.16404,1.08352,-.05498,0,.09698,-.16786,-.56034,1.60148,0,.13972,0,0,0,1,0],Technicolor:[1.91252,-.85453,-.09155,0,.04624,-.30878,1.76589,-.10601,0,-.27589,-.2311,-.75018,1.84759,0,.12137,0,0,0,1,0],Polaroid:[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],Sepia:[.393,.769,.189,0,0,.349,.686,.168,0,0,.272,.534,.131,0,0,0,0,0,1,0],BlackWhite:[1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,0,0,0,1,0]};for(var i in r)n[i]=o(n.ColorMatrix,{type:i,matrix:r[i],mainParameter:!1,colorsOnly:!0}),e.Image.filters[i].fromObject=e.Image.filters.BaseFilter.fromObject})(ne);(function(t){"use strict";var e=t.fabric,n=e.Image.filters,o=e.util.createClass;n.BlendColor=o(n.BaseFilter,{type:"BlendColor",color:"#F95C63",mode:"multiply",alpha:1,fragmentSource:{multiply:`gl_FragColor.rgb *= uColor.rgb;
`,screen:`gl_FragColor.rgb = 1.0 - (1.0 - gl_FragColor.rgb) * (1.0 - uColor.rgb);
`,add:`gl_FragColor.rgb += uColor.rgb;
`,diff:`gl_FragColor.rgb = abs(gl_FragColor.rgb - uColor.rgb);
`,subtract:`gl_FragColor.rgb -= uColor.rgb;
`,lighten:`gl_FragColor.rgb = max(gl_FragColor.rgb, uColor.rgb);
`,darken:`gl_FragColor.rgb = min(gl_FragColor.rgb, uColor.rgb);
`,exclusion:`gl_FragColor.rgb += uColor.rgb - 2.0 * (uColor.rgb * gl_FragColor.rgb);
`,overlay:`if (uColor.r < 0.5) {
gl_FragColor.r *= 2.0 * uColor.r;
} else {
gl_FragColor.r = 1.0 - 2.0 * (1.0 - gl_FragColor.r) * (1.0 - uColor.r);
}
if (uColor.g < 0.5) {
gl_FragColor.g *= 2.0 * uColor.g;
} else {
gl_FragColor.g = 1.0 - 2.0 * (1.0 - gl_FragColor.g) * (1.0 - uColor.g);
}
if (uColor.b < 0.5) {
gl_FragColor.b *= 2.0 * uColor.b;
} else {
gl_FragColor.b = 1.0 - 2.0 * (1.0 - gl_FragColor.b) * (1.0 - uColor.b);
}
`,tint:`gl_FragColor.rgb *= (1.0 - uColor.a);
gl_FragColor.rgb += uColor.rgb;
`},buildSource:function(r){return`precision highp float;
uniform sampler2D uTexture;
uniform vec4 uColor;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
gl_FragColor = color;
if (color.a > 0.0) {
`+this.fragmentSource[r]+`}
}`},retrieveShader:function(r){var i=this.type+"_"+this.mode,a;return r.programCache.hasOwnProperty(i)||(a=this.buildSource(this.mode),r.programCache[i]=this.createProgram(r.context,a)),r.programCache[i]},applyTo2d:function(r){var i=r.imageData,a=i.data,s=a.length,c,l,u,d,f,p,m,h=1-this.alpha;m=new e.Color(this.color).getSource(),c=m[0]*this.alpha,l=m[1]*this.alpha,u=m[2]*this.alpha;for(var b=0;b<s;b+=4)switch(d=a[b],f=a[b+1],p=a[b+2],this.mode){case"multiply":a[b]=d*c/255,a[b+1]=f*l/255,a[b+2]=p*u/255;break;case"screen":a[b]=255-(255-d)*(255-c)/255,a[b+1]=255-(255-f)*(255-l)/255,a[b+2]=255-(255-p)*(255-u)/255;break;case"add":a[b]=d+c,a[b+1]=f+l,a[b+2]=p+u;break;case"diff":case"difference":a[b]=Math.abs(d-c),a[b+1]=Math.abs(f-l),a[b+2]=Math.abs(p-u);break;case"subtract":a[b]=d-c,a[b+1]=f-l,a[b+2]=p-u;break;case"darken":a[b]=Math.min(d,c),a[b+1]=Math.min(f,l),a[b+2]=Math.min(p,u);break;case"lighten":a[b]=Math.max(d,c),a[b+1]=Math.max(f,l),a[b+2]=Math.max(p,u);break;case"overlay":a[b]=c<128?2*d*c/255:255-2*(255-d)*(255-c)/255,a[b+1]=l<128?2*f*l/255:255-2*(255-f)*(255-l)/255,a[b+2]=u<128?2*p*u/255:255-2*(255-p)*(255-u)/255;break;case"exclusion":a[b]=c+d-2*c*d/255,a[b+1]=l+f-2*l*f/255,a[b+2]=u+p-2*u*p/255;break;case"tint":a[b]=c+d*h,a[b+1]=l+f*h,a[b+2]=u+p*h}},getUniformLocations:function(r,i){return{uColor:r.getUniformLocation(i,"uColor")}},sendUniformData:function(r,i){var a=new e.Color(this.color).getSource();a[0]=this.alpha*a[0]/255,a[1]=this.alpha*a[1]/255,a[2]=this.alpha*a[2]/255,a[3]=this.alpha,r.uniform4fv(i.uColor,a)},toObject:function(){return{type:this.type,color:this.color,mode:this.mode,alpha:this.alpha}}}),e.Image.filters.BlendColor.fromObject=e.Image.filters.BaseFilter.fromObject})(ne);(function(t){"use strict";var e=t.fabric,n=e.Image.filters,o=e.util.createClass;n.BlendImage=o(n.BaseFilter,{type:"BlendImage",image:null,mode:"multiply",alpha:1,vertexSource:`attribute vec2 aPosition;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
uniform mat3 uTransformMatrix;
void main() {
vTexCoord = aPosition;
vTexCoord2 = (uTransformMatrix * vec3(aPosition, 1.0)).xy;
gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
}`,fragmentSource:{multiply:`precision highp float;
uniform sampler2D uTexture;
uniform sampler2D uImage;
uniform vec4 uColor;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec4 color2 = texture2D(uImage, vTexCoord2);
color.rgba *= color2.rgba;
gl_FragColor = color;
}`,mask:`precision highp float;
uniform sampler2D uTexture;
uniform sampler2D uImage;
uniform vec4 uColor;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec4 color2 = texture2D(uImage, vTexCoord2);
color.a = color2.a;
gl_FragColor = color;
}`},retrieveShader:function(r){var i=this.type+"_"+this.mode,a=this.fragmentSource[this.mode];return r.programCache.hasOwnProperty(i)||(r.programCache[i]=this.createProgram(r.context,a)),r.programCache[i]},applyToWebGL:function(r){var i=r.context,a=this.createTexture(r.filterBackend,this.image);this.bindAdditionalTexture(i,a,i.TEXTURE1),this.callSuper("applyToWebGL",r),this.unbindAdditionalTexture(i,i.TEXTURE1)},createTexture:function(r,i){return r.getCachedTexture(i.cacheKey,i._element)},calculateMatrix:function(){var r=this.image,i=r._element.width,a=r._element.height;return[1/r.scaleX,0,0,0,1/r.scaleY,0,-r.left/i,-r.top/a,1]},applyTo2d:function(r){var i=r.imageData,a=r.filterBackend.resources,s=i.data,c=s.length,l=i.width,u=i.height,d,f,p,m,h,b,x,y,M,E,C=this.image,j;a.blendImage||(a.blendImage=e.util.createCanvasElement()),M=a.blendImage,E=M.getContext("2d"),M.width!==l||M.height!==u?(M.width=l,M.height=u):E.clearRect(0,0,l,u),E.setTransform(C.scaleX,0,0,C.scaleY,C.left,C.top),E.drawImage(C._element,0,0,l,u),j=E.getImageData(0,0,l,u).data;for(var P=0;P<c;P+=4)switch(h=s[P],b=s[P+1],x=s[P+2],y=s[P+3],d=j[P],f=j[P+1],p=j[P+2],m=j[P+3],this.mode){case"multiply":s[P]=h*d/255,s[P+1]=b*f/255,s[P+2]=x*p/255,s[P+3]=y*m/255;break;case"mask":s[P+3]=m;break}},getUniformLocations:function(r,i){return{uTransformMatrix:r.getUniformLocation(i,"uTransformMatrix"),uImage:r.getUniformLocation(i,"uImage")}},sendUniformData:function(r,i){var a=this.calculateMatrix();r.uniform1i(i.uImage,1),r.uniformMatrix3fv(i.uTransformMatrix,!1,a)},toObject:function(){return{type:this.type,image:this.image&&this.image.toObject(),mode:this.mode,alpha:this.alpha}}}),e.Image.filters.BlendImage.fromObject=function(r,i){e.Image.fromObject(r.image,function(a){var s=e.util.object.clone(r);s.image=a,i(new e.Image.filters.BlendImage(s))})}})(ne);(function(t){"use strict";var e=t.fabric||(t.fabric={}),n=Math.pow,o=Math.floor,r=Math.sqrt,i=Math.abs,a=Math.round,s=Math.sin,c=Math.ceil,l=e.Image.filters,u=e.util.createClass;l.Resize=u(l.BaseFilter,{type:"Resize",resizeType:"hermite",scaleX:1,scaleY:1,lanczosLobes:3,getUniformLocations:function(d,f){return{uDelta:d.getUniformLocation(f,"uDelta"),uTaps:d.getUniformLocation(f,"uTaps")}},sendUniformData:function(d,f){d.uniform2fv(f.uDelta,this.horizontal?[1/this.width,0]:[0,1/this.height]),d.uniform1fv(f.uTaps,this.taps)},retrieveShader:function(d){var f=this.getFilterWindow(),p=this.type+"_"+f;if(!d.programCache.hasOwnProperty(p)){var m=this.generateShader(f);d.programCache[p]=this.createProgram(d.context,m)}return d.programCache[p]},getFilterWindow:function(){var d=this.tempScale;return Math.ceil(this.lanczosLobes/d)},getTaps:function(){for(var d=this.lanczosCreate(this.lanczosLobes),f=this.tempScale,p=this.getFilterWindow(),m=new Array(p),h=1;h<=p;h++)m[h-1]=d(h*f);return m},generateShader:function(m){for(var f=new Array(m),p=this.fragmentSourceTOP,m,h=1;h<=m;h++)f[h-1]=h+".0 * uDelta";return p+="uniform float uTaps["+m+`];
`,p+=`void main() {
`,p+=`  vec4 color = texture2D(uTexture, vTexCoord);
`,p+=`  float sum = 1.0;
`,f.forEach(function(b,x){p+="  color += texture2D(uTexture, vTexCoord + "+b+") * uTaps["+x+`];
`,p+="  color += texture2D(uTexture, vTexCoord - "+b+") * uTaps["+x+`];
`,p+="  sum += 2.0 * uTaps["+x+`];
`}),p+=`  gl_FragColor = color / sum;
`,p+="}",p},fragmentSourceTOP:`precision highp float;
uniform sampler2D uTexture;
uniform vec2 uDelta;
varying vec2 vTexCoord;
`,applyTo:function(d){d.webgl?(d.passes++,this.width=d.sourceWidth,this.horizontal=!0,this.dW=Math.round(this.width*this.scaleX),this.dH=d.sourceHeight,this.tempScale=this.dW/this.width,this.taps=this.getTaps(),d.destinationWidth=this.dW,this._setupFrameBuffer(d),this.applyToWebGL(d),this._swapTextures(d),d.sourceWidth=d.destinationWidth,this.height=d.sourceHeight,this.horizontal=!1,this.dH=Math.round(this.height*this.scaleY),this.tempScale=this.dH/this.height,this.taps=this.getTaps(),d.destinationHeight=this.dH,this._setupFrameBuffer(d),this.applyToWebGL(d),this._swapTextures(d),d.sourceHeight=d.destinationHeight):this.applyTo2d(d)},isNeutralState:function(){return this.scaleX===1&&this.scaleY===1},lanczosCreate:function(d){return function(f){if(f>=d||f<=-d)return 0;if(f<11920929e-14&&f>-11920929e-14)return 1;f*=Math.PI;var p=f/d;return s(f)/f*s(p)/p}},applyTo2d:function(d){var f=d.imageData,p=this.scaleX,m=this.scaleY;this.rcpScaleX=1/p,this.rcpScaleY=1/m;var h=f.width,b=f.height,x=a(h*p),y=a(b*m),M;this.resizeType==="sliceHack"?M=this.sliceByTwo(d,h,b,x,y):this.resizeType==="hermite"?M=this.hermiteFastResize(d,h,b,x,y):this.resizeType==="bilinear"?M=this.bilinearFiltering(d,h,b,x,y):this.resizeType==="lanczos"&&(M=this.lanczosResize(d,h,b,x,y)),d.imageData=M},sliceByTwo:function(d,f,p,m,h){var b=d.imageData,x=.5,y=!1,M=!1,E=f*x,C=p*x,j=e.filterBackend.resources,P,D,N=0,S=0,G=f,v=0;for(j.sliceByTwo||(j.sliceByTwo=document.createElement("canvas")),P=j.sliceByTwo,(P.width<f*1.5||P.height<p)&&(P.width=f*1.5,P.height=p),D=P.getContext("2d"),D.clearRect(0,0,f*1.5,p),D.putImageData(b,0,0),m=o(m),h=o(h);!y||!M;)f=E,p=C,m<o(E*x)?E=o(E*x):(E=m,y=!0),h<o(C*x)?C=o(C*x):(C=h,M=!0),D.drawImage(P,N,S,f,p,G,v,E,C),N=G,S=v,v+=C;return D.getImageData(N,S,m,h)},lanczosResize:function(d,f,p,m,h){function b(R){var A,U,k,w,I,_,F,z,q,ee,O;for(v.x=(R+.5)*C,T.x=o(v.x),A=0;A<h;A++){for(v.y=(A+.5)*j,T.y=o(v.y),I=0,_=0,F=0,z=0,q=0,U=T.x-N;U<=T.x+N;U++)if(!(U<0||U>=f)){ee=o(1e3*i(U-v.x)),G[ee]||(G[ee]={});for(var B=T.y-S;B<=T.y+S;B++)B<0||B>=p||(O=o(1e3*i(B-v.y)),G[ee][O]||(G[ee][O]=E(r(n(ee*P,2)+n(O*D,2))/1e3)),k=G[ee][O],k>0&&(w=(B*f+U)*4,I+=k,_+=k*x[w],F+=k*x[w+1],z+=k*x[w+2],q+=k*x[w+3]))}w=(A*m+R)*4,M[w]=_/I,M[w+1]=F/I,M[w+2]=z/I,M[w+3]=q/I}return++R<m?b(R):y}var x=d.imageData.data,y=d.ctx.createImageData(m,h),M=y.data,E=this.lanczosCreate(this.lanczosLobes),C=this.rcpScaleX,j=this.rcpScaleY,P=2/this.rcpScaleX,D=2/this.rcpScaleY,N=c(C*this.lanczosLobes/2),S=c(j*this.lanczosLobes/2),G={},v={},T={};return b(0)},bilinearFiltering:function(d,f,p,m,h){var b,x,y,M,E,C,j,P,D,N,S,G,v=0,T,R=this.rcpScaleX,A=this.rcpScaleY,U=4*(f-1),k=d.imageData,w=k.data,I=d.ctx.createImageData(m,h),_=I.data;for(j=0;j<h;j++)for(P=0;P<m;P++)for(E=o(R*P),C=o(A*j),D=R*P-E,N=A*j-C,T=4*(C*f+E),S=0;S<4;S++)b=w[T+S],x=w[T+4+S],y=w[T+U+S],M=w[T+U+4+S],G=b*(1-D)*(1-N)+x*D*(1-N)+y*N*(1-D)+M*D*N,_[v++]=G;return I},hermiteFastResize:function(d,f,p,m,h){for(var b=this.rcpScaleX,x=this.rcpScaleY,y=c(b/2),M=c(x/2),E=d.imageData,C=E.data,j=d.ctx.createImageData(m,h),P=j.data,D=0;D<h;D++)for(var N=0;N<m;N++){for(var S=(N+D*m)*4,G=0,v=0,T=0,R=0,A=0,U=0,k=0,w=(D+.5)*x,I=o(D*x);I<(D+1)*x;I++)for(var _=i(w-(I+.5))/M,F=(N+.5)*b,z=_*_,q=o(N*b);q<(N+1)*b;q++){var ee=i(F-(q+.5))/y,O=r(z+ee*ee);O>1&&O<-1||(G=2*O*O*O-3*O*O+1,G>0&&(ee=4*(q+I*f),k+=G*C[ee+3],T+=G,C[ee+3]<255&&(G=G*C[ee+3]/250),R+=G*C[ee],A+=G*C[ee+1],U+=G*C[ee+2],v+=G))}P[S]=R/v,P[S+1]=A/v,P[S+2]=U/v,P[S+3]=k/T}return j},toObject:function(){return{type:this.type,scaleX:this.scaleX,scaleY:this.scaleY,resizeType:this.resizeType,lanczosLobes:this.lanczosLobes}}}),e.Image.filters.Resize.fromObject=e.Image.filters.BaseFilter.fromObject})(ne);(function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.Image.filters,o=e.util.createClass;n.Contrast=o(n.BaseFilter,{type:"Contrast",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uContrast;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float contrastF = 1.015 * (uContrast + 1.0) / (1.0 * (1.015 - uContrast));
color.rgb = contrastF * (color.rgb - 0.5) + 0.5;
gl_FragColor = color;
}`,contrast:0,mainParameter:"contrast",applyTo2d:function(r){if(this.contrast!==0){var i=r.imageData,a,c,s=i.data,c=s.length,l=Math.floor(this.contrast*255),u=259*(l+255)/(255*(259-l));for(a=0;a<c;a+=4)s[a]=u*(s[a]-128)+128,s[a+1]=u*(s[a+1]-128)+128,s[a+2]=u*(s[a+2]-128)+128}},getUniformLocations:function(r,i){return{uContrast:r.getUniformLocation(i,"uContrast")}},sendUniformData:function(r,i){r.uniform1f(i.uContrast,this.contrast)}}),e.Image.filters.Contrast.fromObject=e.Image.filters.BaseFilter.fromObject})(ne);(function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.Image.filters,o=e.util.createClass;n.Saturation=o(n.BaseFilter,{type:"Saturation",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uSaturation;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float rgMax = max(color.r, color.g);
float rgbMax = max(rgMax, color.b);
color.r += rgbMax != color.r ? (rgbMax - color.r) * uSaturation : 0.00;
color.g += rgbMax != color.g ? (rgbMax - color.g) * uSaturation : 0.00;
color.b += rgbMax != color.b ? (rgbMax - color.b) * uSaturation : 0.00;
gl_FragColor = color;
}`,saturation:0,mainParameter:"saturation",applyTo2d:function(r){if(this.saturation!==0){var i=r.imageData,a=i.data,s=a.length,c=-this.saturation,l,u;for(l=0;l<s;l+=4)u=Math.max(a[l],a[l+1],a[l+2]),a[l]+=u!==a[l]?(u-a[l])*c:0,a[l+1]+=u!==a[l+1]?(u-a[l+1])*c:0,a[l+2]+=u!==a[l+2]?(u-a[l+2])*c:0}},getUniformLocations:function(r,i){return{uSaturation:r.getUniformLocation(i,"uSaturation")}},sendUniformData:function(r,i){r.uniform1f(i.uSaturation,-this.saturation)}}),e.Image.filters.Saturation.fromObject=e.Image.filters.BaseFilter.fromObject})(ne);(function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.Image.filters,o=e.util.createClass;n.Vibrance=o(n.BaseFilter,{type:"Vibrance",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uVibrance;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float max = max(color.r, max(color.g, color.b));
float avg = (color.r + color.g + color.b) / 3.0;
float amt = (abs(max - avg) * 2.0) * uVibrance;
color.r += max != color.r ? (max - color.r) * amt : 0.00;
color.g += max != color.g ? (max - color.g) * amt : 0.00;
color.b += max != color.b ? (max - color.b) * amt : 0.00;
gl_FragColor = color;
}`,vibrance:0,mainParameter:"vibrance",applyTo2d:function(r){if(this.vibrance!==0){var i=r.imageData,a=i.data,s=a.length,c=-this.vibrance,l,u,d,f;for(l=0;l<s;l+=4)u=Math.max(a[l],a[l+1],a[l+2]),d=(a[l]+a[l+1]+a[l+2])/3,f=Math.abs(u-d)*2/255*c,a[l]+=u!==a[l]?(u-a[l])*f:0,a[l+1]+=u!==a[l+1]?(u-a[l+1])*f:0,a[l+2]+=u!==a[l+2]?(u-a[l+2])*f:0}},getUniformLocations:function(r,i){return{uVibrance:r.getUniformLocation(i,"uVibrance")}},sendUniformData:function(r,i){r.uniform1f(i.uVibrance,-this.vibrance)}}),e.Image.filters.Vibrance.fromObject=e.Image.filters.BaseFilter.fromObject})(ne);(function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.Image.filters,o=e.util.createClass;n.Blur=o(n.BaseFilter,{type:"Blur",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec2 uDelta;
varying vec2 vTexCoord;
const float nSamples = 15.0;
vec3 v3offset = vec3(12.9898, 78.233, 151.7182);
float random(vec3 scale) {
return fract(sin(dot(gl_FragCoord.xyz, scale)) * 43758.5453);
}
void main() {
vec4 color = vec4(0.0);
float total = 0.0;
float offset = random(v3offset);
for (float t = -nSamples; t <= nSamples; t++) {
float percent = (t + offset - 0.5) / nSamples;
float weight = 1.0 - abs(percent);
color += texture2D(uTexture, vTexCoord + uDelta * percent) * weight;
total += weight;
}
gl_FragColor = color / total;
}`,blur:0,mainParameter:"blur",applyTo:function(r){r.webgl?(this.aspectRatio=r.sourceWidth/r.sourceHeight,r.passes++,this._setupFrameBuffer(r),this.horizontal=!0,this.applyToWebGL(r),this._swapTextures(r),this._setupFrameBuffer(r),this.horizontal=!1,this.applyToWebGL(r),this._swapTextures(r)):this.applyTo2d(r)},applyTo2d:function(r){r.imageData=this.simpleBlur(r)},simpleBlur:function(r){var i=r.filterBackend.resources,a,s,c=r.imageData.width,l=r.imageData.height;i.blurLayer1||(i.blurLayer1=e.util.createCanvasElement(),i.blurLayer2=e.util.createCanvasElement()),a=i.blurLayer1,s=i.blurLayer2,(a.width!==c||a.height!==l)&&(s.width=a.width=c,s.height=a.height=l);var u=a.getContext("2d"),d=s.getContext("2d"),f=15,p,m,h,b,x=this.blur*.06*.5;for(u.putImageData(r.imageData,0,0),d.clearRect(0,0,c,l),b=-f;b<=f;b++)p=(Math.random()-.5)/4,m=b/f,h=x*m*c+p,d.globalAlpha=1-Math.abs(m),d.drawImage(a,h,p),u.drawImage(s,0,0),d.globalAlpha=1,d.clearRect(0,0,s.width,s.height);for(b=-f;b<=f;b++)p=(Math.random()-.5)/4,m=b/f,h=x*m*l+p,d.globalAlpha=1-Math.abs(m),d.drawImage(a,p,h),u.drawImage(s,0,0),d.globalAlpha=1,d.clearRect(0,0,s.width,s.height);r.ctx.drawImage(a,0,0);var y=r.ctx.getImageData(0,0,a.width,a.height);return u.globalAlpha=1,u.clearRect(0,0,a.width,a.height),y},getUniformLocations:function(r,i){return{delta:r.getUniformLocation(i,"uDelta")}},sendUniformData:function(r,i){var a=this.chooseRightDelta();r.uniform2fv(i.delta,a)},chooseRightDelta:function(){var r=1,i=[0,0],a;return this.horizontal?this.aspectRatio>1&&(r=1/this.aspectRatio):this.aspectRatio<1&&(r=this.aspectRatio),a=r*this.blur*.12,this.horizontal?i[0]=a:i[1]=a,i}}),n.Blur.fromObject=e.Image.filters.BaseFilter.fromObject})(ne);(function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.Image.filters,o=e.util.createClass;n.Gamma=o(n.BaseFilter,{type:"Gamma",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec3 uGamma;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec3 correction = (1.0 / uGamma);
color.r = pow(color.r, correction.r);
color.g = pow(color.g, correction.g);
color.b = pow(color.b, correction.b);
gl_FragColor = color;
gl_FragColor.rgb *= color.a;
}`,gamma:[1,1,1],mainParameter:"gamma",initialize:function(r){this.gamma=[1,1,1],n.BaseFilter.prototype.initialize.call(this,r)},applyTo2d:function(r){var i=r.imageData,a=i.data,s=this.gamma,c=a.length,l=1/s[0],u=1/s[1],d=1/s[2],f;for(this.rVals||(this.rVals=new Uint8Array(256),this.gVals=new Uint8Array(256),this.bVals=new Uint8Array(256)),f=0,c=256;f<c;f++)this.rVals[f]=Math.pow(f/255,l)*255,this.gVals[f]=Math.pow(f/255,u)*255,this.bVals[f]=Math.pow(f/255,d)*255;for(f=0,c=a.length;f<c;f+=4)a[f]=this.rVals[a[f]],a[f+1]=this.gVals[a[f+1]],a[f+2]=this.bVals[a[f+2]]},getUniformLocations:function(r,i){return{uGamma:r.getUniformLocation(i,"uGamma")}},sendUniformData:function(r,i){r.uniform3fv(i.uGamma,this.gamma)}}),e.Image.filters.Gamma.fromObject=e.Image.filters.BaseFilter.fromObject})(ne);(function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.Image.filters,o=e.util.createClass;n.Composed=o(n.BaseFilter,{type:"Composed",subFilters:[],initialize:function(r){this.callSuper("initialize",r),this.subFilters=this.subFilters.slice(0)},applyTo:function(r){r.passes+=this.subFilters.length-1,this.subFilters.forEach(function(i){i.applyTo(r)})},toObject:function(){return e.util.object.extend(this.callSuper("toObject"),{subFilters:this.subFilters.map(function(r){return r.toObject()})})},isNeutralState:function(){return!this.subFilters.some(function(r){return!r.isNeutralState()})}}),e.Image.filters.Composed.fromObject=function(r,i){var a=r.subFilters||[],s=a.map(function(l){return new e.Image.filters[l.type](l)}),c=new e.Image.filters.Composed({subFilters:s});return i&&i(c),c}})(ne);(function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.Image.filters,o=e.util.createClass;n.HueRotation=o(n.ColorMatrix,{type:"HueRotation",rotation:0,mainParameter:"rotation",calculateMatrix:function(){var r=this.rotation*Math.PI,i=e.util.cos(r),a=e.util.sin(r),s=1/3,c=Math.sqrt(s)*a,l=1-i;this.matrix=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],this.matrix[0]=i+l/3,this.matrix[1]=s*l-c,this.matrix[2]=s*l+c,this.matrix[5]=s*l+c,this.matrix[6]=i+s*l,this.matrix[7]=s*l-c,this.matrix[10]=s*l-c,this.matrix[11]=s*l+c,this.matrix[12]=i+s*l},isNeutralState:function(r){return this.calculateMatrix(),n.BaseFilter.prototype.isNeutralState.call(this,r)},applyTo:function(r){this.calculateMatrix(),n.BaseFilter.prototype.applyTo.call(this,r)}}),e.Image.filters.HueRotation.fromObject=e.Image.filters.BaseFilter.fromObject})(ne);(function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.util.object.clone;if(e.Text){e.warn("fabric.Text is already defined");return}var o="fontFamily fontWeight fontSize text underline overline linethrough textAlign fontStyle lineHeight textBackgroundColor charSpacing styles direction path pathStartOffset pathSide pathAlign".split(" ");e.Text=e.util.createClass(e.Object,{_dimensionAffectingProps:["fontSize","fontWeight","fontFamily","fontStyle","lineHeight","text","charSpacing","textAlign","styles","path","pathStartOffset","pathSide","pathAlign"],_reNewline:/\r?\n/,_reSpacesAndTabs:/[ \t\r]/g,_reSpaceAndTab:/[ \t\r]/,_reWords:/\S+/g,type:"text",fontSize:40,fontWeight:"normal",fontFamily:"Times New Roman",underline:!1,overline:!1,linethrough:!1,textAlign:"left",fontStyle:"normal",lineHeight:1.16,superscript:{size:.6,baseline:-.35},subscript:{size:.6,baseline:.11},textBackgroundColor:"",stateProperties:e.Object.prototype.stateProperties.concat(o),cacheProperties:e.Object.prototype.cacheProperties.concat(o),stroke:null,shadow:null,path:null,pathStartOffset:0,pathSide:"left",pathAlign:"baseline",_fontSizeFraction:.222,offsets:{underline:.1,linethrough:-.315,overline:-.88},_fontSizeMult:1.13,charSpacing:0,styles:null,_measuringContext:null,deltaY:0,direction:"ltr",_styleProperties:["stroke","strokeWidth","fill","fontFamily","fontSize","fontWeight","fontStyle","underline","overline","linethrough","deltaY","textBackgroundColor"],__charBounds:[],CACHE_FONT_SIZE:400,MIN_TEXT_WIDTH:2,initialize:function(r,i){this.styles=i?i.styles||{}:{},this.text=r,this.__skipDimension=!0,this.callSuper("initialize",i),this.path&&this.setPathInfo(),this.__skipDimension=!1,this.initDimensions(),this.setCoords(),this.setupState({propertySet:"_dimensionAffectingProps"})},setPathInfo:function(){var r=this.path;r&&(r.segmentsInfo=e.util.getPathSegmentsInfo(r.path))},getMeasuringContext:function(){return e._measuringContext||(e._measuringContext=this.canvas&&this.canvas.contextCache||e.util.createCanvasElement().getContext("2d")),e._measuringContext},_splitText:function(){var r=this._splitTextIntoLines(this.text);return this.textLines=r.lines,this._textLines=r.graphemeLines,this._unwrappedTextLines=r._unwrappedLines,this._text=r.graphemeText,r},initDimensions:function(){this.__skipDimension||(this._splitText(),this._clearCache(),this.path?(this.width=this.path.width,this.height=this.path.height):(this.width=this.calcTextWidth()||this.cursorWidth||this.MIN_TEXT_WIDTH,this.height=this.calcTextHeight()),this.textAlign.indexOf("justify")!==-1&&this.enlargeSpaces(),this.saveState({propertySet:"_dimensionAffectingProps"}))},enlargeSpaces:function(){for(var r,i,a,s,c,l,u,d=0,f=this._textLines.length;d<f;d++)if(!(this.textAlign!=="justify"&&(d===f-1||this.isEndOfWrapping(d)))&&(s=0,c=this._textLines[d],i=this.getLineWidth(d),i<this.width&&(u=this.textLines[d].match(this._reSpacesAndTabs)))){a=u.length,r=(this.width-i)/a;for(var p=0,m=c.length;p<=m;p++)l=this.__charBounds[d][p],this._reSpaceAndTab.test(c[p])?(l.width+=r,l.kernedWidth+=r,l.left+=s,s+=r):l.left+=s}},isEndOfWrapping:function(r){return r===this._textLines.length-1},missingNewlineOffset:function(){return 1},toString:function(){return"#<fabric.Text ("+this.complexity()+'): { "text": "'+this.text+'", "fontFamily": "'+this.fontFamily+'" }>'},_getCacheCanvasDimensions:function(){var r=this.callSuper("_getCacheCanvasDimensions"),i=this.fontSize;return r.width+=i*r.zoomX,r.height+=i*r.zoomY,r},_render:function(r){var i=this.path;i&&!i.isNotVisible()&&i._render(r),this._setTextStyles(r),this._renderTextLinesBackground(r),this._renderTextDecoration(r,"underline"),this._renderText(r),this._renderTextDecoration(r,"overline"),this._renderTextDecoration(r,"linethrough")},_renderText:function(r){this.paintFirst==="stroke"?(this._renderTextStroke(r),this._renderTextFill(r)):(this._renderTextFill(r),this._renderTextStroke(r))},_setTextStyles:function(r,i,a){if(r.textBaseline="alphabetical",this.path)switch(this.pathAlign){case"center":r.textBaseline="middle";break;case"ascender":r.textBaseline="top";break;case"descender":r.textBaseline="bottom";break}r.font=this._getFontDeclaration(i,a)},calcTextWidth:function(){for(var r=this.getLineWidth(0),i=1,a=this._textLines.length;i<a;i++){var s=this.getLineWidth(i);s>r&&(r=s)}return r},_renderTextLine:function(r,i,a,s,c,l){this._renderChars(r,i,a,s,c,l)},_renderTextLinesBackground:function(r){if(!(!this.textBackgroundColor&&!this.styleHas("textBackgroundColor"))){for(var i,a,s=r.fillStyle,c,l,u=this._getLeftOffset(),d=this._getTopOffset(),f=0,p=0,m,h,b=this.path,x,y=0,M=this._textLines.length;y<M;y++){if(i=this.getHeightOfLine(y),!this.textBackgroundColor&&!this.styleHas("textBackgroundColor",y)){d+=i;continue}c=this._textLines[y],a=this._getLineLeftOffset(y),p=0,f=0,l=this.getValueOfPropertyAt(y,0,"textBackgroundColor");for(var E=0,C=c.length;E<C;E++)m=this.__charBounds[y][E],h=this.getValueOfPropertyAt(y,E,"textBackgroundColor"),b?(r.save(),r.translate(m.renderLeft,m.renderTop),r.rotate(m.angle),r.fillStyle=h,h&&r.fillRect(-m.width/2,-i/this.lineHeight*(1-this._fontSizeFraction),m.width,i/this.lineHeight),r.restore()):h!==l?(x=u+a+f,this.direction==="rtl"&&(x=this.width-x-p),r.fillStyle=l,l&&r.fillRect(x,d,p,i/this.lineHeight),f=m.left,p=m.width,l=h):p+=m.kernedWidth;h&&!b&&(x=u+a+f,this.direction==="rtl"&&(x=this.width-x-p),r.fillStyle=h,r.fillRect(x,d,p,i/this.lineHeight)),d+=i}r.fillStyle=s,this._removeShadow(r)}},getFontCache:function(r){var i=r.fontFamily.toLowerCase();e.charWidthsCache[i]||(e.charWidthsCache[i]={});var a=e.charWidthsCache[i],s=r.fontStyle.toLowerCase()+"_"+(r.fontWeight+"").toLowerCase();return a[s]||(a[s]={}),a[s]},_measureChar:function(r,i,a,s){var c=this.getFontCache(i),l=this._getFontDeclaration(i),u=this._getFontDeclaration(s),d=a+r,f=l===u,p,m,h,b=i.fontSize/this.CACHE_FONT_SIZE,x;if(a&&c[a]!==void 0&&(h=c[a]),c[r]!==void 0&&(x=p=c[r]),f&&c[d]!==void 0&&(m=c[d],x=m-h),p===void 0||h===void 0||m===void 0){var y=this.getMeasuringContext();this._setTextStyles(y,i,!0)}return p===void 0&&(x=p=y.measureText(r).width,c[r]=p),h===void 0&&f&&a&&(h=y.measureText(a).width,c[a]=h),f&&m===void 0&&(m=y.measureText(d).width,c[d]=m,x=m-h),{width:p*b,kernedWidth:x*b}},getHeightOfChar:function(r,i){return this.getValueOfPropertyAt(r,i,"fontSize")},measureLine:function(r){var i=this._measureLine(r);return this.charSpacing!==0&&(i.width-=this._getWidthOfCharSpacing()),i.width<0&&(i.width=0),i},_measureLine:function(r){var i=0,a,s,c=this._textLines[r],l,u,d=0,f=new Array(c.length),p=0,m,h,b=this.path,x=this.pathSide==="right";for(this.__charBounds[r]=f,a=0;a<c.length;a++)s=c[a],u=this._getGraphemeBox(s,r,a,l),f[a]=u,i+=u.kernedWidth,l=s;if(f[a]={left:u?u.left+u.width:0,width:0,kernedWidth:0,height:this.fontSize},b){switch(h=b.segmentsInfo[b.segmentsInfo.length-1].length,m=e.util.getPointOnPath(b.path,0,b.segmentsInfo),m.x+=b.pathOffset.x,m.y+=b.pathOffset.y,this.textAlign){case"left":p=x?h-i:0;break;case"center":p=(h-i)/2;break;case"right":p=x?0:h-i;break}for(p+=this.pathStartOffset*(x?-1:1),a=x?c.length-1:0;x?a>=0:a<c.length;x?a--:a++)u=f[a],p>h?p%=h:p<0&&(p+=h),this._setGraphemeOnPath(p,u,m),p+=u.kernedWidth}return{width:i,numOfSpaces:d}},_setGraphemeOnPath:function(r,i,a){var s=r+i.kernedWidth/2,c=this.path,l=e.util.getPointOnPath(c.path,s,c.segmentsInfo);i.renderLeft=l.x-a.x,i.renderTop=l.y-a.y,i.angle=l.angle+(this.pathSide==="right"?Math.PI:0)},_getGraphemeBox:function(r,i,a,s,c){var l=this.getCompleteStyleDeclaration(i,a),u=s?this.getCompleteStyleDeclaration(i,a-1):{},d=this._measureChar(r,l,s,u),f=d.kernedWidth,p=d.width,m;this.charSpacing!==0&&(m=this._getWidthOfCharSpacing(),p+=m,f+=m);var h={width:p,left:0,height:l.fontSize,kernedWidth:f,deltaY:l.deltaY};if(a>0&&!c){var b=this.__charBounds[i][a-1];h.left=b.left+b.width+d.kernedWidth-d.width}return h},getHeightOfLine:function(r){if(this.__lineHeights[r])return this.__lineHeights[r];for(var i=this._textLines[r],a=this.getHeightOfChar(r,0),s=1,c=i.length;s<c;s++)a=Math.max(this.getHeightOfChar(r,s),a);return this.__lineHeights[r]=a*this.lineHeight*this._fontSizeMult},calcTextHeight:function(){for(var r,i=0,a=0,s=this._textLines.length;a<s;a++)r=this.getHeightOfLine(a),i+=a===s-1?r/this.lineHeight:r;return i},_getLeftOffset:function(){return this.direction==="ltr"?-this.width/2:this.width/2},_getTopOffset:function(){return-this.height/2},_renderTextCommon:function(r,i){r.save();for(var a=0,s=this._getLeftOffset(),c=this._getTopOffset(),l=0,u=this._textLines.length;l<u;l++){var d=this.getHeightOfLine(l),f=d/this.lineHeight,p=this._getLineLeftOffset(l);this._renderTextLine(i,r,this._textLines[l],s+p,c+a+f,l),a+=d}r.restore()},_renderTextFill:function(r){!this.fill&&!this.styleHas("fill")||this._renderTextCommon(r,"fillText")},_renderTextStroke:function(r){(!this.stroke||this.strokeWidth===0)&&this.isEmptyStyles()||(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(r),r.save(),this._setLineDash(r,this.strokeDashArray),r.beginPath(),this._renderTextCommon(r,"strokeText"),r.closePath(),r.restore())},_renderChars:function(r,i,a,s,c,l){var u=this.getHeightOfLine(l),d=this.textAlign.indexOf("justify")!==-1,f,p,m="",h,b=0,x,y=this.path,M=!d&&this.charSpacing===0&&this.isEmptyStyles(l)&&!y,E=this.direction==="ltr",C=this.direction==="ltr"?1:-1,j,P=i.canvas.getAttribute("dir");if(i.save(),P!==this.direction&&(i.canvas.setAttribute("dir",E?"ltr":"rtl"),i.direction=E?"ltr":"rtl",i.textAlign=E?"left":"right"),c-=u*this._fontSizeFraction/this.lineHeight,M){this._renderChar(r,i,l,0,a.join(""),s,c,u),i.restore();return}for(var D=0,N=a.length-1;D<=N;D++)x=D===N||this.charSpacing||y,m+=a[D],h=this.__charBounds[l][D],b===0?(s+=C*(h.kernedWidth-h.width),b+=h.width):b+=h.kernedWidth,d&&!x&&this._reSpaceAndTab.test(a[D])&&(x=!0),x||(f=f||this.getCompleteStyleDeclaration(l,D),p=this.getCompleteStyleDeclaration(l,D+1),x=e.util.hasStyleChanged(f,p,!1)),x&&(y?(i.save(),i.translate(h.renderLeft,h.renderTop),i.rotate(h.angle),this._renderChar(r,i,l,D,m,-b/2,0,u),i.restore()):(j=s,this._renderChar(r,i,l,D,m,j,c,u)),m="",f=p,s+=C*b,b=0);i.restore()},_applyPatternGradientTransformText:function(r){var i=e.util.createCanvasElement(),a,s=this.width+this.strokeWidth,c=this.height+this.strokeWidth;return i.width=s,i.height=c,a=i.getContext("2d"),a.beginPath(),a.moveTo(0,0),a.lineTo(s,0),a.lineTo(s,c),a.lineTo(0,c),a.closePath(),a.translate(s/2,c/2),a.fillStyle=r.toLive(a),this._applyPatternGradientTransform(a,r),a.fill(),a.createPattern(i,"no-repeat")},handleFiller:function(r,i,a){var s,c;return a.toLive?a.gradientUnits==="percentage"||a.gradientTransform||a.patternTransform?(s=-this.width/2,c=-this.height/2,r.translate(s,c),r[i]=this._applyPatternGradientTransformText(a),{offsetX:s,offsetY:c}):(r[i]=a.toLive(r,this),this._applyPatternGradientTransform(r,a)):(r[i]=a,{offsetX:0,offsetY:0})},_setStrokeStyles:function(r,i){return r.lineWidth=i.strokeWidth,r.lineCap=this.strokeLineCap,r.lineDashOffset=this.strokeDashOffset,r.lineJoin=this.strokeLineJoin,r.miterLimit=this.strokeMiterLimit,this.handleFiller(r,"strokeStyle",i.stroke)},_setFillStyles:function(r,i){return this.handleFiller(r,"fillStyle",i.fill)},_renderChar:function(r,i,a,s,c,l,u){var d=this._getStyleDeclaration(a,s),f=this.getCompleteStyleDeclaration(a,s),p=r==="fillText"&&f.fill,m=r==="strokeText"&&f.stroke&&f.strokeWidth,h,b;!m&&!p||(i.save(),p&&(h=this._setFillStyles(i,f)),m&&(b=this._setStrokeStyles(i,f)),i.font=this._getFontDeclaration(f),d&&d.textBackgroundColor&&this._removeShadow(i),d&&d.deltaY&&(u+=d.deltaY),p&&i.fillText(c,l-h.offsetX,u-h.offsetY),m&&i.strokeText(c,l-b.offsetX,u-b.offsetY),i.restore())},setSuperscript:function(r,i){return this._setScript(r,i,this.superscript)},setSubscript:function(r,i){return this._setScript(r,i,this.subscript)},_setScript:function(r,i,a){var s=this.get2DCursorLocation(r,!0),c=this.getValueOfPropertyAt(s.lineIndex,s.charIndex,"fontSize"),l=this.getValueOfPropertyAt(s.lineIndex,s.charIndex,"deltaY"),u={fontSize:c*a.size,deltaY:l+c*a.baseline};return this.setSelectionStyles(u,r,i),this},_getLineLeftOffset:function(r){var i=this.getLineWidth(r),a=this.width-i,s=this.textAlign,c=this.direction,u,l=0,u=this.isEndOfWrapping(r);return s==="justify"||s==="justify-center"&&!u||s==="justify-right"&&!u||s==="justify-left"&&!u?0:(s==="center"&&(l=a/2),s==="right"&&(l=a),s==="justify-center"&&(l=a/2),s==="justify-right"&&(l=a),c==="rtl"&&(l-=a),l)},_clearCache:function(){this.__lineWidths=[],this.__lineHeights=[],this.__charBounds=[]},_shouldClearDimensionCache:function(){var r=this._forceClearCache;return r||(r=this.hasStateChanged("_dimensionAffectingProps")),r&&(this.dirty=!0,this._forceClearCache=!1),r},getLineWidth:function(r){if(this.__lineWidths[r]!==void 0)return this.__lineWidths[r];var i=this.measureLine(r),a=i.width;return this.__lineWidths[r]=a,a},_getWidthOfCharSpacing:function(){return this.charSpacing!==0?this.fontSize*this.charSpacing/1e3:0},getValueOfPropertyAt:function(r,i,a){var s=this._getStyleDeclaration(r,i);return s&&typeof s[a]<"u"?s[a]:this[a]},_renderTextDecoration:function(r,i){if(!(!this[i]&&!this.styleHas(i))){for(var a,s,c,l,u,d,f,p,m=this._getLeftOffset(),h=this._getTopOffset(),b,x,y,M,E,C,j,P,D=this.path,N=this._getWidthOfCharSpacing(),S=this.offsets[i],G=0,v=this._textLines.length;G<v;G++){if(a=this.getHeightOfLine(G),!this[i]&&!this.styleHas(i,G)){h+=a;continue}f=this._textLines[G],C=a/this.lineHeight,l=this._getLineLeftOffset(G),x=0,y=0,p=this.getValueOfPropertyAt(G,0,i),P=this.getValueOfPropertyAt(G,0,"fill"),b=h+C*(1-this._fontSizeFraction),s=this.getHeightOfChar(G,0),u=this.getValueOfPropertyAt(G,0,"deltaY");for(var T=0,R=f.length;T<R;T++)if(M=this.__charBounds[G][T],E=this.getValueOfPropertyAt(G,T,i),j=this.getValueOfPropertyAt(G,T,"fill"),c=this.getHeightOfChar(G,T),d=this.getValueOfPropertyAt(G,T,"deltaY"),D&&E&&j)r.save(),r.fillStyle=P,r.translate(M.renderLeft,M.renderTop),r.rotate(M.angle),r.fillRect(-M.kernedWidth/2,S*c+d,M.kernedWidth,this.fontSize/15),r.restore();else if((E!==p||j!==P||c!==s||d!==u)&&y>0){var A=m+l+x;this.direction==="rtl"&&(A=this.width-A-y),p&&P&&(r.fillStyle=P,r.fillRect(A,b+S*s+u,y,this.fontSize/15)),x=M.left,y=M.width,p=E,P=j,s=c,u=d}else y+=M.kernedWidth;var A=m+l+x;this.direction==="rtl"&&(A=this.width-A-y),r.fillStyle=j,E&&j&&r.fillRect(A,b+S*s+u,y-N,this.fontSize/15),h+=a}this._removeShadow(r)}},_getFontDeclaration:function(r,i){var a=r||this,s=this.fontFamily,c=e.Text.genericFonts.indexOf(s.toLowerCase())>-1,l=s===void 0||s.indexOf("'")>-1||s.indexOf(",")>-1||s.indexOf('"')>-1||c?a.fontFamily:'"'+a.fontFamily+'"';return[e.isLikelyNode?a.fontWeight:a.fontStyle,e.isLikelyNode?a.fontStyle:a.fontWeight,i?this.CACHE_FONT_SIZE+"px":a.fontSize+"px",l].join(" ")},render:function(r){this.visible&&(this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(this._shouldClearDimensionCache()&&this.initDimensions(),this.callSuper("render",r)))},_splitTextIntoLines:function(r){for(var i=r.split(this._reNewline),a=new Array(i.length),s=[`
`],c=[],l=0;l<i.length;l++)a[l]=e.util.string.graphemeSplit(i[l]),c=c.concat(a[l],s);return c.pop(),{_unwrappedLines:a,lines:i,graphemeText:c,graphemeLines:a}},toObject:function(r){var i=o.concat(r),a=this.callSuper("toObject",i);return a.styles=e.util.stylesToArray(this.styles,this.text),a.path&&(a.path=this.path.toObject()),a},set:function(r,i){this.callSuper("set",r,i);var a=!1,s=!1;if(typeof r=="object")for(var c in r)c==="path"&&this.setPathInfo(),a=a||this._dimensionAffectingProps.indexOf(c)!==-1,s=s||c==="path";else a=this._dimensionAffectingProps.indexOf(r)!==-1,s=r==="path";return s&&this.setPathInfo(),a&&(this.initDimensions(),this.setCoords()),this},complexity:function(){return 1}}),e.Text.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat("x y dx dy font-family font-style font-weight font-size letter-spacing text-decoration text-anchor".split(" ")),e.Text.DEFAULT_SVG_FONT_SIZE=16,e.Text.fromElement=function(r,i,a){if(!r)return i(null);var s=e.parseAttributes(r,e.Text.ATTRIBUTE_NAMES),c=s.textAnchor||"left";if(a=e.util.object.extend(a?n(a):{},s),a.top=a.top||0,a.left=a.left||0,s.textDecoration){var l=s.textDecoration;l.indexOf("underline")!==-1&&(a.underline=!0),l.indexOf("overline")!==-1&&(a.overline=!0),l.indexOf("line-through")!==-1&&(a.linethrough=!0),delete a.textDecoration}"dx"in s&&(a.left+=s.dx),"dy"in s&&(a.top+=s.dy),"fontSize"in a||(a.fontSize=e.Text.DEFAULT_SVG_FONT_SIZE);var u="";"textContent"in r?u=r.textContent:"firstChild"in r&&r.firstChild!==null&&"data"in r.firstChild&&r.firstChild.data!==null&&(u=r.firstChild.data),u=u.replace(/^\s+|\s+$|\n+/g,"").replace(/\s+/g," ");var d=a.strokeWidth;a.strokeWidth=0;var f=new e.Text(u,a),p=f.getScaledHeight()/f.height,m=(f.height+f.strokeWidth)*f.lineHeight-f.height,h=m*p,b=f.getScaledHeight()+h,x=0;c==="center"&&(x=f.getScaledWidth()/2),c==="right"&&(x=f.getScaledWidth()),f.set({left:f.left-x,top:f.top-(b-f.fontSize*(.07+f._fontSizeFraction))/f.lineHeight,strokeWidth:typeof d<"u"?d:1}),i(f)},e.Text.fromObject=function(r,i){var a=n(r),s=r.path;return delete a.path,e.Object._fromObject("Text",a,function(c){c.styles=e.util.stylesFromArray(r.styles,r.text),s?e.Object._fromObject("Path",s,function(l){c.set("path",l),i(c)},"path"):i(c)},"text")},e.Text.genericFonts=["sans-serif","serif","cursive","fantasy","monospace"],e.util.createAccessors&&e.util.createAccessors(e.Text)})(ne);(function(){g.util.object.extend(g.Text.prototype,{isEmptyStyles:function(t){if(!this.styles||typeof t<"u"&&!this.styles[t])return!0;var e=typeof t>"u"?this.styles:{line:this.styles[t]};for(var n in e)for(var o in e[n])for(var r in e[n][o])return!1;return!0},styleHas:function(t,e){if(!this.styles||!t||t===""||typeof e<"u"&&!this.styles[e])return!1;var n=typeof e>"u"?this.styles:{0:this.styles[e]};for(var o in n)for(var r in n[o])if(typeof n[o][r][t]<"u")return!0;return!1},cleanStyle:function(t){if(!this.styles||!t||t==="")return!1;var e=this.styles,n=0,o,r,i=!0,a=0,s;for(var c in e){o=0;for(var l in e[c]){var s=e[c][l],u=s.hasOwnProperty(t);n++,u?(r?s[t]!==r&&(i=!1):r=s[t],s[t]===this[t]&&delete s[t]):i=!1,Object.keys(s).length!==0?o++:delete e[c][l]}o===0&&delete e[c]}for(var d=0;d<this._textLines.length;d++)a+=this._textLines[d].length;i&&n===a&&(this[t]=r,this.removeStyle(t))},removeStyle:function(t){if(!(!this.styles||!t||t==="")){var e=this.styles,n,o,r;for(o in e){n=e[o];for(r in n)delete n[r][t],Object.keys(n[r]).length===0&&delete n[r];Object.keys(n).length===0&&delete e[o]}}},_extendStyles:function(t,e){var n=this.get2DCursorLocation(t);this._getLineStyle(n.lineIndex)||this._setLineStyle(n.lineIndex),this._getStyleDeclaration(n.lineIndex,n.charIndex)||this._setStyleDeclaration(n.lineIndex,n.charIndex,{}),g.util.object.extend(this._getStyleDeclaration(n.lineIndex,n.charIndex),e)},get2DCursorLocation:function(t,e){typeof t>"u"&&(t=this.selectionStart);for(var n=e?this._unwrappedTextLines:this._textLines,o=n.length,r=0;r<o;r++){if(t<=n[r].length)return{lineIndex:r,charIndex:t};t-=n[r].length+this.missingNewlineOffset(r)}return{lineIndex:r-1,charIndex:n[r-1].length<t?n[r-1].length:t}},getSelectionStyles:function(t,e,n){typeof t>"u"&&(t=this.selectionStart||0),typeof e>"u"&&(e=this.selectionEnd||t);for(var o=[],r=t;r<e;r++)o.push(this.getStyleAtPosition(r,n));return o},getStyleAtPosition:function(t,e){var n=this.get2DCursorLocation(t),o=e?this.getCompleteStyleDeclaration(n.lineIndex,n.charIndex):this._getStyleDeclaration(n.lineIndex,n.charIndex);return o||{}},setSelectionStyles:function(t,e,n){typeof e>"u"&&(e=this.selectionStart||0),typeof n>"u"&&(n=this.selectionEnd||e);for(var o=e;o<n;o++)this._extendStyles(o,t);return this._forceClearCache=!0,this},_getStyleDeclaration:function(t,e){var n=this.styles&&this.styles[t];return n?n[e]:null},getCompleteStyleDeclaration:function(t,e){for(var n=this._getStyleDeclaration(t,e)||{},o={},r,i=0;i<this._styleProperties.length;i++)r=this._styleProperties[i],o[r]=typeof n[r]>"u"?this[r]:n[r];return o},_setStyleDeclaration:function(t,e,n){this.styles[t][e]=n},_deleteStyleDeclaration:function(t,e){delete this.styles[t][e]},_getLineStyle:function(t){return!!this.styles[t]},_setLineStyle:function(t){this.styles[t]={}},_deleteLineStyle:function(t){delete this.styles[t]}})})();(function(){function t(e){e.textDecoration&&(e.textDecoration.indexOf("underline")>-1&&(e.underline=!0),e.textDecoration.indexOf("line-through")>-1&&(e.linethrough=!0),e.textDecoration.indexOf("overline")>-1&&(e.overline=!0),delete e.textDecoration)}g.IText=g.util.createClass(g.Text,g.Observable,{type:"i-text",selectionStart:0,selectionEnd:0,selectionColor:"rgba(17,119,255,0.3)",isEditing:!1,editable:!0,editingBorderColor:"rgba(102,153,255,0.25)",cursorWidth:2,cursorColor:"",cursorDelay:1e3,cursorDuration:600,caching:!0,hiddenTextareaContainer:null,_reSpace:/\s|\n/,_currentCursorOpacity:0,_selectionDirection:null,_abortCursorAnimation:!1,__widthOfSpace:[],inCompositionMode:!1,initialize:function(e,n){this.callSuper("initialize",e,n),this.initBehavior()},setSelectionStart:function(e){e=Math.max(e,0),this._updateAndFire("selectionStart",e)},setSelectionEnd:function(e){e=Math.min(e,this.text.length),this._updateAndFire("selectionEnd",e)},_updateAndFire:function(e,n){this[e]!==n&&(this._fireSelectionChanged(),this[e]=n),this._updateTextarea()},_fireSelectionChanged:function(){this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this})},initDimensions:function(){this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this.callSuper("initDimensions")},render:function(e){this.clearContextTop(),this.callSuper("render",e),this.cursorOffsetCache={},this.renderCursorOrSelection()},_render:function(e){this.callSuper("_render",e)},clearContextTop:function(e){if(!(!this.isEditing||!this.canvas||!this.canvas.contextTop)){var n=this.canvas.contextTop,o=this.canvas.viewportTransform;n.save(),n.transform(o[0],o[1],o[2],o[3],o[4],o[5]),this.transform(n),this._clearTextArea(n),e||n.restore()}},renderCursorOrSelection:function(){if(!(!this.isEditing||!this.canvas||!this.canvas.contextTop)){var e=this._getCursorBoundaries(),n=this.canvas.contextTop;this.clearContextTop(!0),this.selectionStart===this.selectionEnd?this.renderCursor(e,n):this.renderSelection(e,n),n.restore()}},_clearTextArea:function(e){var n=this.width+4,o=this.height+4;e.clearRect(-n/2,-o/2,n,o)},_getCursorBoundaries:function(e){typeof e>"u"&&(e=this.selectionStart);var n=this._getLeftOffset(),o=this._getTopOffset(),r=this._getCursorBoundariesOffsets(e);return{left:n,top:o,leftOffset:r.left,topOffset:r.top}},_getCursorBoundariesOffsets:function(e){if(this.cursorOffsetCache&&"top"in this.cursorOffsetCache)return this.cursorOffsetCache;var n,o,r,i=0,a=0,s,c=this.get2DCursorLocation(e);r=c.charIndex,o=c.lineIndex;for(var l=0;l<o;l++)i+=this.getHeightOfLine(l);n=this._getLineLeftOffset(o);var u=this.__charBounds[o][r];return u&&(a=u.left),this.charSpacing!==0&&r===this._textLines[o].length&&(a-=this._getWidthOfCharSpacing()),s={top:i,left:n+(a>0?a:0)},this.direction==="rtl"&&(s.left*=-1),this.cursorOffsetCache=s,this.cursorOffsetCache},renderCursor:function(e,n){var o=this.get2DCursorLocation(),r=o.lineIndex,i=o.charIndex>0?o.charIndex-1:0,a=this.getValueOfPropertyAt(r,i,"fontSize"),s=this.scaleX*this.canvas.getZoom(),c=this.cursorWidth/s,l=e.topOffset,u=this.getValueOfPropertyAt(r,i,"deltaY");l+=(1-this._fontSizeFraction)*this.getHeightOfLine(r)/this.lineHeight-a*(1-this._fontSizeFraction),this.inCompositionMode&&this.renderSelection(e,n),n.fillStyle=this.cursorColor||this.getValueOfPropertyAt(r,i,"fill"),n.globalAlpha=this.__isMousedown?1:this._currentCursorOpacity,n.fillRect(e.left+e.leftOffset-c/2,l+e.top+u,c,a)},renderSelection:function(e,n){for(var o=this.inCompositionMode?this.hiddenTextarea.selectionStart:this.selectionStart,r=this.inCompositionMode?this.hiddenTextarea.selectionEnd:this.selectionEnd,i=this.textAlign.indexOf("justify")!==-1,a=this.get2DCursorLocation(o),s=this.get2DCursorLocation(r),c=a.lineIndex,l=s.lineIndex,u=a.charIndex<0?0:a.charIndex,d=s.charIndex<0?0:s.charIndex,f=c;f<=l;f++){var p=this._getLineLeftOffset(f)||0,m=this.getHeightOfLine(f),h=0,b=0,x=0;if(f===c&&(b=this.__charBounds[c][u].left),f>=c&&f<l)x=i&&!this.isEndOfWrapping(f)?this.width:this.getLineWidth(f)||5;else if(f===l)if(d===0)x=this.__charBounds[l][d].left;else{var y=this._getWidthOfCharSpacing();x=this.__charBounds[l][d-1].left+this.__charBounds[l][d-1].width-y}h=m,(this.lineHeight<1||f===l&&this.lineHeight>1)&&(m/=this.lineHeight);var M=e.left+p+b,E=x-b,C=m,j=0;this.inCompositionMode?(n.fillStyle=this.compositionColor||"black",C=1,j=m):n.fillStyle=this.selectionColor,this.direction==="rtl"&&(M=this.width-M-E),n.fillRect(M,e.top+e.topOffset+j,E,C),e.topOffset+=h}},getCurrentCharFontSize:function(){var e=this._getCurrentCharIndex();return this.getValueOfPropertyAt(e.l,e.c,"fontSize")},getCurrentCharColor:function(){var e=this._getCurrentCharIndex();return this.getValueOfPropertyAt(e.l,e.c,"fill")},_getCurrentCharIndex:function(){var e=this.get2DCursorLocation(this.selectionStart,!0),n=e.charIndex>0?e.charIndex-1:0;return{l:e.lineIndex,c:n}}}),g.IText.fromObject=function(e,n){var o=g.util.stylesFromArray(e.styles,e.text),r=Object.assign({},e,{styles:o});if(t(r),r.styles)for(var i in r.styles)for(var a in r.styles[i])t(r.styles[i][a]);g.Object._fromObject("IText",r,n,"text")}})();(function(){var t=g.util.object.clone;g.util.object.extend(g.IText.prototype,{initBehavior:function(){this.initAddedHandler(),this.initRemovedHandler(),this.initCursorSelectionHandlers(),this.initDoubleClickSimulation(),this.mouseMoveHandler=this.mouseMoveHandler.bind(this)},onDeselect:function(){this.isEditing&&this.exitEditing(),this.selected=!1},initAddedHandler:function(){var e=this;this.on("added",function(){var n=e.canvas;n&&(n._hasITextHandlers||(n._hasITextHandlers=!0,e._initCanvasHandlers(n)),n._iTextInstances=n._iTextInstances||[],n._iTextInstances.push(e))})},initRemovedHandler:function(){var e=this;this.on("removed",function(){var n=e.canvas;n&&(n._iTextInstances=n._iTextInstances||[],g.util.removeFromArray(n._iTextInstances,e),n._iTextInstances.length===0&&(n._hasITextHandlers=!1,e._removeCanvasHandlers(n)))})},_initCanvasHandlers:function(e){e._mouseUpITextHandler=function(){e._iTextInstances&&e._iTextInstances.forEach(function(n){n.__isMousedown=!1})},e.on("mouse:up",e._mouseUpITextHandler)},_removeCanvasHandlers:function(e){e.off("mouse:up",e._mouseUpITextHandler)},_tick:function(){this._currentTickState=this._animateCursor(this,1,this.cursorDuration,"_onTickComplete")},_animateCursor:function(e,n,o,r){var i;return i={isAborted:!1,abort:function(){this.isAborted=!0}},e.animate("_currentCursorOpacity",n,{duration:o,onComplete:function(){i.isAborted||e[r]()},onChange:function(){e.canvas&&e.selectionStart===e.selectionEnd&&e.renderCursorOrSelection()},abort:function(){return i.isAborted}}),i},_onTickComplete:function(){var e=this;this._cursorTimeout1&&clearTimeout(this._cursorTimeout1),this._cursorTimeout1=setTimeout(function(){e._currentTickCompleteState=e._animateCursor(e,0,this.cursorDuration/2,"_tick")},100)},initDelayedCursor:function(e){var n=this,o=e?0:this.cursorDelay;this.abortCursorAnimation(),this._currentCursorOpacity=1,this._cursorTimeout2=setTimeout(function(){n._tick()},o)},abortCursorAnimation:function(){var e=this._currentTickState||this._currentTickCompleteState,n=this.canvas;this._currentTickState&&this._currentTickState.abort(),this._currentTickCompleteState&&this._currentTickCompleteState.abort(),clearTimeout(this._cursorTimeout1),clearTimeout(this._cursorTimeout2),this._currentCursorOpacity=0,e&&n&&n.clearContext(n.contextTop||n.contextContainer)},selectAll:function(){return this.selectionStart=0,this.selectionEnd=this._text.length,this._fireSelectionChanged(),this._updateTextarea(),this},getSelectedText:function(){return this._text.slice(this.selectionStart,this.selectionEnd).join("")},findWordBoundaryLeft:function(e){var n=0,o=e-1;if(this._reSpace.test(this._text[o]))for(;this._reSpace.test(this._text[o]);)n++,o--;for(;/\S/.test(this._text[o])&&o>-1;)n++,o--;return e-n},findWordBoundaryRight:function(e){var n=0,o=e;if(this._reSpace.test(this._text[o]))for(;this._reSpace.test(this._text[o]);)n++,o++;for(;/\S/.test(this._text[o])&&o<this._text.length;)n++,o++;return e+n},findLineBoundaryLeft:function(e){for(var n=0,o=e-1;!/\n/.test(this._text[o])&&o>-1;)n++,o--;return e-n},findLineBoundaryRight:function(e){for(var n=0,o=e;!/\n/.test(this._text[o])&&o<this._text.length;)n++,o++;return e+n},searchWordBoundary:function(e,n){for(var o=this._text,r=this._reSpace.test(o[e])?e-1:e,i=o[r],a=g.reNonWord;!a.test(i)&&r>0&&r<o.length;)r+=n,i=o[r];return a.test(i)&&(r+=n===1?0:1),r},selectWord:function(e){e=e||this.selectionStart;var n=this.searchWordBoundary(e,-1),o=this.searchWordBoundary(e,1);this.selectionStart=n,this.selectionEnd=o,this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()},selectLine:function(e){e=e||this.selectionStart;var n=this.findLineBoundaryLeft(e),o=this.findLineBoundaryRight(e);return this.selectionStart=n,this.selectionEnd=o,this._fireSelectionChanged(),this._updateTextarea(),this},enterEditing:function(e){if(!(this.isEditing||!this.editable))return this.canvas&&(this.canvas.calcOffset(),this.exitEditingOnOthers(this.canvas)),this.isEditing=!0,this.initHiddenTextarea(e),this.hiddenTextarea.focus(),this.hiddenTextarea.value=this.text,this._updateTextarea(),this._saveEditingProps(),this._setEditingProps(),this._textBeforeEdit=this.text,this._tick(),this.fire("editing:entered"),this._fireSelectionChanged(),this.canvas?(this.canvas.fire("text:editing:entered",{target:this}),this.initMouseMoveHandler(),this.canvas.requestRenderAll(),this):this},exitEditingOnOthers:function(e){e._iTextInstances&&e._iTextInstances.forEach(function(n){n.selected=!1,n.isEditing&&n.exitEditing()})},initMouseMoveHandler:function(){this.canvas.on("mouse:move",this.mouseMoveHandler)},mouseMoveHandler:function(e){if(!(!this.__isMousedown||!this.isEditing)){document.activeElement!==this.hiddenTextarea&&this.hiddenTextarea.focus();var n=this.getSelectionStartFromPointer(e.e),o=this.selectionStart,r=this.selectionEnd;(n!==this.__selectionStartOnMouseDown||o===r)&&(o===n||r===n)||(n>this.__selectionStartOnMouseDown?(this.selectionStart=this.__selectionStartOnMouseDown,this.selectionEnd=n):(this.selectionStart=n,this.selectionEnd=this.__selectionStartOnMouseDown),(this.selectionStart!==o||this.selectionEnd!==r)&&(this.restartCursorIfNeeded(),this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()))}},_setEditingProps:function(){this.hoverCursor="text",this.canvas&&(this.canvas.defaultCursor=this.canvas.moveCursor="text"),this.borderColor=this.editingBorderColor,this.hasControls=this.selectable=!1,this.lockMovementX=this.lockMovementY=!0},fromStringToGraphemeSelection:function(e,n,o){var r=o.slice(0,e),i=g.util.string.graphemeSplit(r).length;if(e===n)return{selectionStart:i,selectionEnd:i};var a=o.slice(e,n),s=g.util.string.graphemeSplit(a).length;return{selectionStart:i,selectionEnd:i+s}},fromGraphemeToStringSelection:function(e,n,o){var r=o.slice(0,e),i=r.join("").length;if(e===n)return{selectionStart:i,selectionEnd:i};var a=o.slice(e,n),s=a.join("").length;return{selectionStart:i,selectionEnd:i+s}},_updateTextarea:function(){if(this.cursorOffsetCache={},!!this.hiddenTextarea){if(!this.inCompositionMode){var e=this.fromGraphemeToStringSelection(this.selectionStart,this.selectionEnd,this._text);this.hiddenTextarea.selectionStart=e.selectionStart,this.hiddenTextarea.selectionEnd=e.selectionEnd}this.updateTextareaPosition()}},updateFromTextArea:function(){if(this.hiddenTextarea){this.cursorOffsetCache={},this.text=this.hiddenTextarea.value,this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords());var e=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value);this.selectionEnd=this.selectionStart=e.selectionEnd,this.inCompositionMode||(this.selectionStart=e.selectionStart),this.updateTextareaPosition()}},updateTextareaPosition:function(){if(this.selectionStart===this.selectionEnd){var e=this._calcTextareaPosition();this.hiddenTextarea.style.left=e.left,this.hiddenTextarea.style.top=e.top}},_calcTextareaPosition:function(){if(!this.canvas)return{x:1,y:1};var e=this.inCompositionMode?this.compositionStart:this.selectionStart,n=this._getCursorBoundaries(e),o=this.get2DCursorLocation(e),r=o.lineIndex,i=o.charIndex,a=this.getValueOfPropertyAt(r,i,"fontSize")*this.lineHeight,s=n.leftOffset,c=this.calcTransformMatrix(),l={x:n.left+s,y:n.top+n.topOffset+a},u=this.canvas.getRetinaScaling(),d=this.canvas.upperCanvasEl,f=d.width/u,p=d.height/u,m=f-a,h=p-a,b=d.clientWidth/f,x=d.clientHeight/p;return l=g.util.transformPoint(l,c),l=g.util.transformPoint(l,this.canvas.viewportTransform),l.x*=b,l.y*=x,l.x<0&&(l.x=0),l.x>m&&(l.x=m),l.y<0&&(l.y=0),l.y>h&&(l.y=h),l.x+=this.canvas._offset.left,l.y+=this.canvas._offset.top,{left:l.x+"px",top:l.y+"px",fontSize:a+"px",charHeight:a}},_saveEditingProps:function(){this._savedProps={hasControls:this.hasControls,borderColor:this.borderColor,lockMovementX:this.lockMovementX,lockMovementY:this.lockMovementY,hoverCursor:this.hoverCursor,selectable:this.selectable,defaultCursor:this.canvas&&this.canvas.defaultCursor,moveCursor:this.canvas&&this.canvas.moveCursor}},_restoreEditingProps:function(){this._savedProps&&(this.hoverCursor=this._savedProps.hoverCursor,this.hasControls=this._savedProps.hasControls,this.borderColor=this._savedProps.borderColor,this.selectable=this._savedProps.selectable,this.lockMovementX=this._savedProps.lockMovementX,this.lockMovementY=this._savedProps.lockMovementY,this.canvas&&(this.canvas.defaultCursor=this._savedProps.defaultCursor,this.canvas.moveCursor=this._savedProps.moveCursor))},exitEditing:function(){var e=this._textBeforeEdit!==this.text,n=this.hiddenTextarea;return this.selected=!1,this.isEditing=!1,this.selectionEnd=this.selectionStart,n&&(n.blur&&n.blur(),n.parentNode&&n.parentNode.removeChild(n)),this.hiddenTextarea=null,this.abortCursorAnimation(),this._restoreEditingProps(),this._currentCursorOpacity=0,this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this.fire("editing:exited"),e&&this.fire("modified"),this.canvas&&(this.canvas.off("mouse:move",this.mouseMoveHandler),this.canvas.fire("text:editing:exited",{target:this}),e&&this.canvas.fire("object:modified",{target:this})),this},_removeExtraneousStyles:function(){for(var e in this.styles)this._textLines[e]||delete this.styles[e]},removeStyleFromTo:function(e,n){var o=this.get2DCursorLocation(e,!0),r=this.get2DCursorLocation(n,!0),i=o.lineIndex,a=o.charIndex,s=r.lineIndex,c=r.charIndex,l,u;if(i!==s){if(this.styles[i])for(l=a;l<this._unwrappedTextLines[i].length;l++)delete this.styles[i][l];if(this.styles[s])for(l=c;l<this._unwrappedTextLines[s].length;l++)u=this.styles[s][l],u&&(this.styles[i]||(this.styles[i]={}),this.styles[i][a+l-c]=u);for(l=i+1;l<=s;l++)delete this.styles[l];this.shiftLineStyles(s,i-s)}else if(this.styles[i]){u=this.styles[i];var d=c-a,f,p;for(l=a;l<c;l++)delete u[l];for(p in this.styles[i])f=parseInt(p,10),f>=c&&(u[f-d]=u[p],delete u[p])}},shiftLineStyles:function(e,n){var o=t(this.styles);for(var r in this.styles){var i=parseInt(r,10);i>e&&(this.styles[i+n]=o[i],o[i-n]||delete this.styles[i])}},restartCursorIfNeeded:function(){(!this._currentTickState||this._currentTickState.isAborted||!this._currentTickCompleteState||this._currentTickCompleteState.isAborted)&&this.initDelayedCursor()},insertNewlineStyleObject:function(e,n,o,r){var i,a={},s=!1,c=this._unwrappedTextLines[e].length===n;o||(o=1),this.shiftLineStyles(e,o),this.styles[e]&&(i=this.styles[e][n===0?n:n-1]);for(var l in this.styles[e]){var u=parseInt(l,10);u>=n&&(s=!0,a[u-n]=this.styles[e][l],c&&n===0||delete this.styles[e][l])}var d=!1;for(s&&!c&&(this.styles[e+o]=a,d=!0),d&&o--;o>0;)r&&r[o-1]?this.styles[e+o]={0:t(r[o-1])}:i?this.styles[e+o]={0:t(i)}:delete this.styles[e+o],o--;this._forceClearCache=!0},insertCharStyleObject:function(e,n,o,r){this.styles||(this.styles={});var i=this.styles[e],a=i?t(i):{};o||(o=1);for(var s in a){var c=parseInt(s,10);c>=n&&(i[c+o]=a[c],a[c-o]||delete i[c])}if(this._forceClearCache=!0,r){for(;o--;)Object.keys(r[o]).length&&(this.styles[e]||(this.styles[e]={}),this.styles[e][n+o]=t(r[o]));return}if(i)for(var l=i[n?n-1:1];l&&o--;)this.styles[e][n+o]=t(l)},insertNewStyleBlock:function(e,n,o){for(var r=this.get2DCursorLocation(n,!0),i=[0],a=0,s=0;s<e.length;s++)e[s]===`
`?(a++,i[a]=0):i[a]++;i[0]>0&&(this.insertCharStyleObject(r.lineIndex,r.charIndex,i[0],o),o=o&&o.slice(i[0]+1)),a&&this.insertNewlineStyleObject(r.lineIndex,r.charIndex+i[0],a);for(var s=1;s<a;s++)i[s]>0?this.insertCharStyleObject(r.lineIndex+s,0,i[s],o):o&&this.styles[r.lineIndex+s]&&o[0]&&(this.styles[r.lineIndex+s][0]=o[0]),o=o&&o.slice(i[s]+1);i[s]>0&&this.insertCharStyleObject(r.lineIndex+s,0,i[s],o)},setSelectionStartEndWithShift:function(e,n,o){o<=e?(n===e?this._selectionDirection="left":this._selectionDirection==="right"&&(this._selectionDirection="left",this.selectionEnd=e),this.selectionStart=o):o>e&&o<n?this._selectionDirection==="right"?this.selectionEnd=o:this.selectionStart=o:(n===e?this._selectionDirection="right":this._selectionDirection==="left"&&(this._selectionDirection="right",this.selectionStart=n),this.selectionEnd=o)},setSelectionInBoundaries:function(){var e=this.text.length;this.selectionStart>e?this.selectionStart=e:this.selectionStart<0&&(this.selectionStart=0),this.selectionEnd>e?this.selectionEnd=e:this.selectionEnd<0&&(this.selectionEnd=0)}})})();g.util.object.extend(g.IText.prototype,{initDoubleClickSimulation:function(){this.__lastClickTime=+new Date,this.__lastLastClickTime=+new Date,this.__lastPointer={},this.on("mousedown",this.onMouseDown)},onMouseDown:function(t){if(this.canvas){this.__newClickTime=+new Date;var e=t.pointer;this.isTripleClick(e)&&(this.fire("tripleclick",t),this._stopEvent(t.e)),this.__lastLastClickTime=this.__lastClickTime,this.__lastClickTime=this.__newClickTime,this.__lastPointer=e,this.__lastIsEditing=this.isEditing,this.__lastSelected=this.selected}},isTripleClick:function(t){return this.__newClickTime-this.__lastClickTime<500&&this.__lastClickTime-this.__lastLastClickTime<500&&this.__lastPointer.x===t.x&&this.__lastPointer.y===t.y},_stopEvent:function(t){t.preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation()},initCursorSelectionHandlers:function(){this.initMousedownHandler(),this.initMouseupHandler(),this.initClicks()},doubleClickHandler:function(t){this.isEditing&&this.selectWord(this.getSelectionStartFromPointer(t.e))},tripleClickHandler:function(t){this.isEditing&&this.selectLine(this.getSelectionStartFromPointer(t.e))},initClicks:function(){this.on("mousedblclick",this.doubleClickHandler),this.on("tripleclick",this.tripleClickHandler)},_mouseDownHandler:function(t){!this.canvas||!this.editable||t.e.button&&t.e.button!==1||(this.__isMousedown=!0,this.selected&&(this.inCompositionMode=!1,this.setCursorByClick(t.e)),this.isEditing&&(this.__selectionStartOnMouseDown=this.selectionStart,this.selectionStart===this.selectionEnd&&this.abortCursorAnimation(),this.renderCursorOrSelection()))},_mouseDownHandlerBefore:function(t){!this.canvas||!this.editable||t.e.button&&t.e.button!==1||(this.selected=this===this.canvas._activeObject)},initMousedownHandler:function(){this.on("mousedown",this._mouseDownHandler),this.on("mousedown:before",this._mouseDownHandlerBefore)},initMouseupHandler:function(){this.on("mouseup",this.mouseUpHandler)},mouseUpHandler:function(t){if(this.__isMousedown=!1,!(!this.editable||this.group||t.transform&&t.transform.actionPerformed||t.e.button&&t.e.button!==1)){if(this.canvas){var e=this.canvas._activeObject;if(e&&e!==this)return}this.__lastSelected&&!this.__corner?(this.selected=!1,this.__lastSelected=!1,this.enterEditing(t.e),this.selectionStart===this.selectionEnd?this.initDelayedCursor(!0):this.renderCursorOrSelection()):this.selected=!0}},setCursorByClick:function(t){var e=this.getSelectionStartFromPointer(t),n=this.selectionStart,o=this.selectionEnd;t.shiftKey?this.setSelectionStartEndWithShift(n,o,e):(this.selectionStart=e,this.selectionEnd=e),this.isEditing&&(this._fireSelectionChanged(),this._updateTextarea())},getSelectionStartFromPointer:function(t){for(var e=this.getLocalPointer(t),n=0,o=0,r=0,i=0,a=0,s,c,l=0,u=this._textLines.length;l<u&&r<=e.y;l++)r+=this.getHeightOfLine(l)*this.scaleY,a=l,l>0&&(i+=this._textLines[l-1].length+this.missingNewlineOffset(l-1));s=this._getLineLeftOffset(a),o=s*this.scaleX,c=this._textLines[a],this.direction==="rtl"&&(e.x=this.width*this.scaleX-e.x+o);for(var d=0,f=c.length;d<f&&(n=o,o+=this.__charBounds[a][d].kernedWidth*this.scaleX,o<=e.x);d++)i++;return this._getNewSelectionStartFromOffset(e,n,o,i,f)},_getNewSelectionStartFromOffset:function(t,e,n,o,r){var i=t.x-e,a=n-t.x,s=a>i||a<0?0:1,c=o+s;return this.flipX&&(c=r-c),c>this._text.length&&(c=this._text.length),c}});g.util.object.extend(g.IText.prototype,{initHiddenTextarea:function(){this.hiddenTextarea=g.document.createElement("textarea"),this.hiddenTextarea.setAttribute("autocapitalize","off"),this.hiddenTextarea.setAttribute("autocorrect","off"),this.hiddenTextarea.setAttribute("autocomplete","off"),this.hiddenTextarea.setAttribute("spellcheck","false"),this.hiddenTextarea.setAttribute("data-fabric-hiddentextarea",""),this.hiddenTextarea.setAttribute("wrap","off");var t=this._calcTextareaPosition();this.hiddenTextarea.style.cssText="position: absolute; top: "+t.top+"; left: "+t.left+"; z-index: -999; opacity: 0; width: 1px; height: 1px; font-size: 1px; padding-top: "+t.fontSize+";",this.hiddenTextareaContainer?this.hiddenTextareaContainer.appendChild(this.hiddenTextarea):g.document.body.appendChild(this.hiddenTextarea),g.util.addListener(this.hiddenTextarea,"keydown",this.onKeyDown.bind(this)),g.util.addListener(this.hiddenTextarea,"keyup",this.onKeyUp.bind(this)),g.util.addListener(this.hiddenTextarea,"input",this.onInput.bind(this)),g.util.addListener(this.hiddenTextarea,"copy",this.copy.bind(this)),g.util.addListener(this.hiddenTextarea,"cut",this.copy.bind(this)),g.util.addListener(this.hiddenTextarea,"paste",this.paste.bind(this)),g.util.addListener(this.hiddenTextarea,"compositionstart",this.onCompositionStart.bind(this)),g.util.addListener(this.hiddenTextarea,"compositionupdate",this.onCompositionUpdate.bind(this)),g.util.addListener(this.hiddenTextarea,"compositionend",this.onCompositionEnd.bind(this)),!this._clickHandlerInitialized&&this.canvas&&(g.util.addListener(this.canvas.upperCanvasEl,"click",this.onClick.bind(this)),this._clickHandlerInitialized=!0)},keysMap:{9:"exitEditing",27:"exitEditing",33:"moveCursorUp",34:"moveCursorDown",35:"moveCursorRight",36:"moveCursorLeft",37:"moveCursorLeft",38:"moveCursorUp",39:"moveCursorRight",40:"moveCursorDown"},keysMapRtl:{9:"exitEditing",27:"exitEditing",33:"moveCursorUp",34:"moveCursorDown",35:"moveCursorLeft",36:"moveCursorRight",37:"moveCursorRight",38:"moveCursorUp",39:"moveCursorLeft",40:"moveCursorDown"},ctrlKeysMapUp:{67:"copy",88:"cut"},ctrlKeysMapDown:{65:"selectAll"},onClick:function(){this.hiddenTextarea&&this.hiddenTextarea.focus()},onKeyDown:function(t){if(this.isEditing){var e=this.direction==="rtl"?this.keysMapRtl:this.keysMap;if(t.keyCode in e)this[e[t.keyCode]](t);else if(t.keyCode in this.ctrlKeysMapDown&&(t.ctrlKey||t.metaKey))this[this.ctrlKeysMapDown[t.keyCode]](t);else return;t.stopImmediatePropagation(),t.preventDefault(),t.keyCode>=33&&t.keyCode<=40?(this.inCompositionMode=!1,this.clearContextTop(),this.renderCursorOrSelection()):this.canvas&&this.canvas.requestRenderAll()}},onKeyUp:function(t){if(!this.isEditing||this._copyDone||this.inCompositionMode){this._copyDone=!1;return}if(t.keyCode in this.ctrlKeysMapUp&&(t.ctrlKey||t.metaKey))this[this.ctrlKeysMapUp[t.keyCode]](t);else return;t.stopImmediatePropagation(),t.preventDefault(),this.canvas&&this.canvas.requestRenderAll()},onInput:function(t){var e=this.fromPaste;if(this.fromPaste=!1,t&&t.stopPropagation(),!!this.isEditing){var n=this._splitTextIntoLines(this.hiddenTextarea.value).graphemeText,o=this._text.length,r=n.length,i,a,s=r-o,c=this.selectionStart,l=this.selectionEnd,u=c!==l,d,f,p;if(this.hiddenTextarea.value===""){this.styles={},this.updateFromTextArea(),this.fire("changed"),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll());return}var m=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value),h=c>m.selectionStart;u?(i=this._text.slice(c,l),s+=l-c):r<o&&(h?i=this._text.slice(l+s,l):i=this._text.slice(c,c-s)),a=n.slice(m.selectionEnd-s,m.selectionEnd),i&&i.length&&(a.length&&(d=this.getSelectionStyles(c,c+1,!1),d=a.map(function(){return d[0]})),u?(f=c,p=l):h?(f=l-i.length,p=l):(f=l,p=l+i.length),this.removeStyleFromTo(f,p)),a.length&&(e&&a.join("")===g.copiedText&&!g.disableStyleCopyPaste&&(d=g.copiedTextStyle),this.insertNewStyleBlock(a,c,d)),this.updateFromTextArea(),this.fire("changed"),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll())}},onCompositionStart:function(){this.inCompositionMode=!0},onCompositionEnd:function(){this.inCompositionMode=!1},onCompositionUpdate:function(t){this.compositionStart=t.target.selectionStart,this.compositionEnd=t.target.selectionEnd,this.updateTextareaPosition()},copy:function(){this.selectionStart!==this.selectionEnd&&(g.copiedText=this.getSelectedText(),g.disableStyleCopyPaste?g.copiedTextStyle=null:g.copiedTextStyle=this.getSelectionStyles(this.selectionStart,this.selectionEnd,!0),this._copyDone=!0)},paste:function(){this.fromPaste=!0},_getClipboardData:function(t){return t&&t.clipboardData||g.window.clipboardData},_getWidthBeforeCursor:function(t,e){var n=this._getLineLeftOffset(t),o;return e>0&&(o=this.__charBounds[t][e-1],n+=o.left+o.width),n},getDownCursorOffset:function(t,e){var n=this._getSelectionForOffset(t,e),o=this.get2DCursorLocation(n),r=o.lineIndex;if(r===this._textLines.length-1||t.metaKey||t.keyCode===34)return this._text.length-n;var i=o.charIndex,a=this._getWidthBeforeCursor(r,i),s=this._getIndexOnLine(r+1,a),c=this._textLines[r].slice(i);return c.length+s+1+this.missingNewlineOffset(r)},_getSelectionForOffset:function(t,e){return t.shiftKey&&this.selectionStart!==this.selectionEnd&&e?this.selectionEnd:this.selectionStart},getUpCursorOffset:function(t,e){var n=this._getSelectionForOffset(t,e),o=this.get2DCursorLocation(n),r=o.lineIndex;if(r===0||t.metaKey||t.keyCode===33)return-n;var i=o.charIndex,a=this._getWidthBeforeCursor(r,i),s=this._getIndexOnLine(r-1,a),c=this._textLines[r].slice(0,i),l=this.missingNewlineOffset(r-1);return-this._textLines[r-1].length+s-c.length+(1-l)},_getIndexOnLine:function(t,e){for(var n=this._textLines[t],o=this._getLineLeftOffset(t),r=o,i=0,a,s,c=0,l=n.length;c<l;c++)if(a=this.__charBounds[t][c].width,r+=a,r>e){s=!0;var u=r-a,d=r,f=Math.abs(u-e),p=Math.abs(d-e);i=p<f?c:c-1;break}return s||(i=n.length-1),i},moveCursorDown:function(t){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorUpOrDown("Down",t)},moveCursorUp:function(t){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorUpOrDown("Up",t)},_moveCursorUpOrDown:function(t,e){var n="get"+t+"CursorOffset",o=this[n](e,this._selectionDirection==="right");e.shiftKey?this.moveCursorWithShift(o):this.moveCursorWithoutShift(o),o!==0&&(this.setSelectionInBoundaries(),this.abortCursorAnimation(),this._currentCursorOpacity=1,this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorWithShift:function(t){var e=this._selectionDirection==="left"?this.selectionStart+t:this.selectionEnd+t;return this.setSelectionStartEndWithShift(this.selectionStart,this.selectionEnd,e),t!==0},moveCursorWithoutShift:function(t){return t<0?(this.selectionStart+=t,this.selectionEnd=this.selectionStart):(this.selectionEnd+=t,this.selectionStart=this.selectionEnd),t!==0},moveCursorLeft:function(t){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorLeftOrRight("Left",t)},_move:function(t,e,n){var o;if(t.altKey)o=this["findWordBoundary"+n](this[e]);else if(t.metaKey||t.keyCode===35||t.keyCode===36)o=this["findLineBoundary"+n](this[e]);else return this[e]+=n==="Left"?-1:1,!0;if(typeof o<"u"&&this[e]!==o)return this[e]=o,!0},_moveLeft:function(t,e){return this._move(t,e,"Left")},_moveRight:function(t,e){return this._move(t,e,"Right")},moveCursorLeftWithoutShift:function(t){var e=!0;return this._selectionDirection="left",this.selectionEnd===this.selectionStart&&this.selectionStart!==0&&(e=this._moveLeft(t,"selectionStart")),this.selectionEnd=this.selectionStart,e},moveCursorLeftWithShift:function(t){if(this._selectionDirection==="right"&&this.selectionStart!==this.selectionEnd)return this._moveLeft(t,"selectionEnd");if(this.selectionStart!==0)return this._selectionDirection="left",this._moveLeft(t,"selectionStart")},moveCursorRight:function(t){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorLeftOrRight("Right",t)},_moveCursorLeftOrRight:function(t,e){var n="moveCursor"+t+"With";this._currentCursorOpacity=1,e.shiftKey?n+="Shift":n+="outShift",this[n](e)&&(this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorRightWithShift:function(t){if(this._selectionDirection==="left"&&this.selectionStart!==this.selectionEnd)return this._moveRight(t,"selectionStart");if(this.selectionEnd!==this._text.length)return this._selectionDirection="right",this._moveRight(t,"selectionEnd")},moveCursorRightWithoutShift:function(t){var e=!0;return this._selectionDirection="right",this.selectionStart===this.selectionEnd?(e=this._moveRight(t,"selectionStart"),this.selectionEnd=this.selectionStart):this.selectionStart=this.selectionEnd,e},removeChars:function(t,e){typeof e>"u"&&(e=t+1),this.removeStyleFromTo(t,e),this._text.splice(t,e-t),this.text=this._text.join(""),this.set("dirty",!0),this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this._removeExtraneousStyles()},insertChars:function(t,e,n,o){typeof o>"u"&&(o=n),o>n&&this.removeStyleFromTo(n,o);var r=g.util.string.graphemeSplit(t);this.insertNewStyleBlock(r,n,e),this._text=[].concat(this._text.slice(0,n),r,this._text.slice(o)),this.text=this._text.join(""),this.set("dirty",!0),this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this._removeExtraneousStyles()}});(function(){var t=g.util.toFixed,e=/  +/g;g.util.object.extend(g.Text.prototype,{_toSVG:function(){var n=this._getSVGLeftTopOffsets(),o=this._getSVGTextAndBg(n.textTop,n.textLeft);return this._wrapSVGTextAndBg(o)},toSVG:function(n){return this._createBaseSVGMarkup(this._toSVG(),{reviver:n,noStyle:!0,withShadow:!0})},_getSVGLeftTopOffsets:function(){return{textLeft:-this.width/2,textTop:-this.height/2,lineTop:this.getHeightOfLine(0)}},_wrapSVGTextAndBg:function(n){var o=!0,r=this.getSvgTextDecoration(this);return[n.textBgRects.join(""),'		<text xml:space="preserve" ',this.fontFamily?'font-family="'+this.fontFamily.replace(/"/g,"'")+'" ':"",this.fontSize?'font-size="'+this.fontSize+'" ':"",this.fontStyle?'font-style="'+this.fontStyle+'" ':"",this.fontWeight?'font-weight="'+this.fontWeight+'" ':"",r?'text-decoration="'+r+'" ':"",'style="',this.getSvgStyles(o),'"',this.addPaintOrder()," >",n.textSpans.join(""),`</text>
`]},_getSVGTextAndBg:function(n,o){var r=[],i=[],a=n,s;this._setSVGBg(i);for(var c=0,l=this._textLines.length;c<l;c++)s=this._getLineLeftOffset(c),(this.textBackgroundColor||this.styleHas("textBackgroundColor",c))&&this._setSVGTextLineBg(i,c,o+s,a),this._setSVGTextLineText(r,c,o+s,a),a+=this.getHeightOfLine(c);return{textSpans:r,textBgRects:i}},_createTextCharSpan:function(n,o,r,i){var a=n!==n.trim()||n.match(e),s=this.getSvgSpanStyles(o,a),c=s?'style="'+s+'"':"",l=o.deltaY,u="",d=g.Object.NUM_FRACTION_DIGITS;return l&&(u=' dy="'+t(l,d)+'" '),['<tspan x="',t(r,d),'" y="',t(i,d),'" ',u,c,">",g.util.string.escapeXml(n),"</tspan>"].join("")},_setSVGTextLineText:function(n,o,r,i){var a=this.getHeightOfLine(o),s=this.textAlign.indexOf("justify")!==-1,c,l,u="",d,f,p=0,m=this._textLines[o],h;i+=a*(1-this._fontSizeFraction)/this.lineHeight;for(var b=0,x=m.length-1;b<=x;b++)h=b===x||this.charSpacing,u+=m[b],d=this.__charBounds[o][b],p===0?(r+=d.kernedWidth-d.width,p+=d.width):p+=d.kernedWidth,s&&!h&&this._reSpaceAndTab.test(m[b])&&(h=!0),h||(c=c||this.getCompleteStyleDeclaration(o,b),l=this.getCompleteStyleDeclaration(o,b+1),h=g.util.hasStyleChanged(c,l,!0)),h&&(f=this._getStyleDeclaration(o,b)||{},n.push(this._createTextCharSpan(u,f,r,i)),u="",c=l,r+=p,p=0)},_pushTextBgRect:function(n,o,r,i,a,s){var c=g.Object.NUM_FRACTION_DIGITS;n.push("		<rect ",this._getFillAttributes(o),' x="',t(r,c),'" y="',t(i,c),'" width="',t(a,c),'" height="',t(s,c),`"></rect>
`)},_setSVGTextLineBg:function(n,o,r,i){for(var a=this._textLines[o],s=this.getHeightOfLine(o)/this.lineHeight,c=0,l=0,u,d,f=this.getValueOfPropertyAt(o,0,"textBackgroundColor"),p=0,m=a.length;p<m;p++)u=this.__charBounds[o][p],d=this.getValueOfPropertyAt(o,p,"textBackgroundColor"),d!==f?(f&&this._pushTextBgRect(n,f,r+l,i,c,s),l=u.left,c=u.width,f=d):c+=u.kernedWidth;d&&this._pushTextBgRect(n,d,r+l,i,c,s)},_getFillAttributes:function(n){var o=n&&typeof n=="string"?new g.Color(n):"";return!o||!o.getSource()||o.getAlpha()===1?'fill="'+n+'"':'opacity="'+o.getAlpha()+'" fill="'+o.setAlpha(1).toRgb()+'"'},_getSVGLineTopOffset:function(n){for(var o=0,r=0,i=0;i<n;i++)o+=this.getHeightOfLine(i);return r=this.getHeightOfLine(i),{lineTop:o,offset:(this._fontSizeMult-this._fontSizeFraction)*r/(this.lineHeight*this._fontSizeMult)}},getSvgStyles:function(n){var o=g.Object.prototype.getSvgStyles.call(this,n);return o+" white-space: pre;"}})})();(function(t){"use strict";var e=t.fabric||(t.fabric={});e.Textbox=e.util.createClass(e.IText,e.Observable,{type:"textbox",minWidth:20,dynamicMinWidth:2,__cachedLines:null,lockScalingFlip:!0,noScaleCache:!1,_dimensionAffectingProps:e.Text.prototype._dimensionAffectingProps.concat("width"),_wordJoiners:/[ \t\r]/,splitByGrapheme:!1,initDimensions:function(){this.__skipDimension||(this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this._clearCache(),this.dynamicMinWidth=0,this._styleMap=this._generateStyleMap(this._splitText()),this.dynamicMinWidth>this.width&&this._set("width",this.dynamicMinWidth),this.textAlign.indexOf("justify")!==-1&&this.enlargeSpaces(),this.height=this.calcTextHeight(),this.saveState({propertySet:"_dimensionAffectingProps"}))},_generateStyleMap:function(n){for(var o=0,r=0,i=0,a={},s=0;s<n.graphemeLines.length;s++)n.graphemeText[i]===`
`&&s>0?(r=0,i++,o++):!this.splitByGrapheme&&this._reSpaceAndTab.test(n.graphemeText[i])&&s>0&&(r++,i++),a[s]={line:o,offset:r},i+=n.graphemeLines[s].length,r+=n.graphemeLines[s].length;return a},styleHas:function(n,o){if(this._styleMap&&!this.isWrapping){var r=this._styleMap[o];r&&(o=r.line)}return e.Text.prototype.styleHas.call(this,n,o)},isEmptyStyles:function(n){if(!this.styles)return!0;var o=0,r=n+1,i,a,s=!1,c=this._styleMap[n],l=this._styleMap[n+1];c&&(n=c.line,o=c.offset),l&&(r=l.line,s=r===n,i=l.offset),a=typeof n>"u"?this.styles:{line:this.styles[n]};for(var u in a)for(var d in a[u])if(d>=o&&(!s||d<i))for(var f in a[u][d])return!1;return!0},_getStyleDeclaration:function(n,o){if(this._styleMap&&!this.isWrapping){var r=this._styleMap[n];if(!r)return null;n=r.line,o=r.offset+o}return this.callSuper("_getStyleDeclaration",n,o)},_setStyleDeclaration:function(n,o,r){var i=this._styleMap[n];n=i.line,o=i.offset+o,this.styles[n][o]=r},_deleteStyleDeclaration:function(n,o){var r=this._styleMap[n];n=r.line,o=r.offset+o,delete this.styles[n][o]},_getLineStyle:function(n){var o=this._styleMap[n];return!!this.styles[o.line]},_setLineStyle:function(n){var o=this._styleMap[n];this.styles[o.line]={}},_wrapText:function(n,o){var r=[],i;for(this.isWrapping=!0,i=0;i<n.length;i++)r=r.concat(this._wrapLine(n[i],i,o));return this.isWrapping=!1,r},_measureWord:function(n,o,r){var i=0,a,s=!0;r=r||0;for(var c=0,l=n.length;c<l;c++){var u=this._getGraphemeBox(n[c],o,c+r,a,s);i+=u.kernedWidth,a=n[c]}return i},_wrapLine:function(n,o,r,M){var a=0,s=this.splitByGrapheme,c=[],l=[],u=s?e.util.string.graphemeSplit(n):n.split(this._wordJoiners),d="",f=0,p=s?"":" ",m=0,h=0,b=0,x=!0,y=this._getWidthOfCharSpacing(),M=M||0;u.length===0&&u.push([]),r-=M;for(var E=0;E<u.length;E++)d=s?u[E]:e.util.string.graphemeSplit(u[E]),m=this._measureWord(d,o,f),f+=d.length,a+=h+m-y,a>r&&!x?(c.push(l),l=[],a=m,x=!0):a+=y,!x&&!s&&l.push(p),l=l.concat(d),h=s?0:this._measureWord([p],o,f),f++,x=!1,m>b&&(b=m);return E&&c.push(l),b+M>this.dynamicMinWidth&&(this.dynamicMinWidth=b-y+M),c},isEndOfWrapping:function(n){return!this._styleMap[n+1]||this._styleMap[n+1].line!==this._styleMap[n].line},missingNewlineOffset:function(n){return this.splitByGrapheme?this.isEndOfWrapping(n)?1:0:1},_splitTextIntoLines:function(n){for(var o=e.Text.prototype._splitTextIntoLines.call(this,n),r=this._wrapText(o.lines,this.width),i=new Array(r.length),a=0;a<r.length;a++)i[a]=r[a].join("");return o.lines=i,o.graphemeLines=r,o},getMinWidth:function(){return Math.max(this.minWidth,this.dynamicMinWidth)},_removeExtraneousStyles:function(){var n={};for(var o in this._styleMap)this._textLines[o]&&(n[this._styleMap[o].line]=1);for(var o in this.styles)n[o]||delete this.styles[o]},toObject:function(n){return this.callSuper("toObject",["minWidth","splitByGrapheme"].concat(n))}}),e.Textbox.fromObject=function(n,o){var r=e.util.stylesFromArray(n.styles,n.text),i=Object.assign({},n,{styles:r});return e.Object._fromObject("Textbox",i,o,"text")}})(ne);(function(){var t=g.controlsUtils,e=t.scaleSkewCursorStyleHandler,n=t.scaleCursorStyleHandler,o=t.scalingEqually,r=t.scalingYOrSkewingX,i=t.scalingXOrSkewingY,a=t.scaleOrSkewActionName,s=g.Object.prototype.controls;if(s.ml=new g.Control({x:-.5,y:0,cursorStyleHandler:e,actionHandler:i,getActionName:a}),s.mr=new g.Control({x:.5,y:0,cursorStyleHandler:e,actionHandler:i,getActionName:a}),s.mb=new g.Control({x:0,y:.5,cursorStyleHandler:e,actionHandler:r,getActionName:a}),s.mt=new g.Control({x:0,y:-.5,cursorStyleHandler:e,actionHandler:r,getActionName:a}),s.tl=new g.Control({x:-.5,y:-.5,cursorStyleHandler:n,actionHandler:o}),s.tr=new g.Control({x:.5,y:-.5,cursorStyleHandler:n,actionHandler:o}),s.bl=new g.Control({x:-.5,y:.5,cursorStyleHandler:n,actionHandler:o}),s.br=new g.Control({x:.5,y:.5,cursorStyleHandler:n,actionHandler:o}),s.mtr=new g.Control({x:0,y:-.5,actionHandler:t.rotationWithSnapping,cursorStyleHandler:t.rotationStyleHandler,offsetY:-40,withConnection:!0,actionName:"rotate"}),g.Textbox){var c=g.Textbox.prototype.controls={};c.mtr=s.mtr,c.tr=s.tr,c.br=s.br,c.tl=s.tl,c.bl=s.bl,c.mt=s.mt,c.mb=s.mb,c.mr=new g.Control({x:.5,y:0,actionHandler:t.changeWidth,cursorStyleHandler:e,actionName:"resizing"}),c.ml=new g.Control({x:-.5,y:0,actionHandler:t.changeWidth,cursorStyleHandler:e,actionName:"resizing"})}})()});var Fh=Xe((Nz,wa)=>{wa.exports=Ih;wa.exports.addWheelListener=Ih;wa.exports.removeWheelListener=HC;function Ih(t,e,n){t.addEventListener("wheel",e,n)}function HC(t,e,n){t.removeEventListener("wheel",e,n)}});var jh=Xe((Iz,Bh)=>{var GC=4,qC=.001,XC=1e-7,YC=10,Uo=11,_a=1/(Uo-1),QC=typeof Float32Array=="function";function Dh(t,e){return 1-3*e+3*t}function Mh(t,e){return 3*e-6*t}function Lh(t){return 3*t}function ka(t,e,n){return((Dh(e,n)*t+Mh(e,n))*t+Lh(e))*t}function Ph(t,e,n){return 3*Dh(e,n)*t*t+2*Mh(e,n)*t+Lh(e)}function KC(t,e,n,o,r){var i,a,s=0;do a=e+(n-e)/2,i=ka(a,o,r)-t,i>0?n=a:e=a;while(Math.abs(i)>XC&&++s<YC);return a}function JC(t,e,n,o){for(var r=0;r<GC;++r){var i=Ph(e,n,o);if(i===0)return e;var a=ka(e,n,o)-t;e-=a/i}return e}function $C(t){return t}Bh.exports=function(e,n,o,r){if(!(0<=e&&e<=1&&0<=o&&o<=1))throw new Error("bezier x values must be in [0, 1] range");if(e===n&&o===r)return $C;for(var i=QC?new Float32Array(Uo):new Array(Uo),a=0;a<Uo;++a)i[a]=ka(a*_a,e,o);function s(c){for(var l=0,u=1,d=Uo-1;u!==d&&i[u]<=c;++u)l+=_a;--u;var f=(c-i[u])/(i[u+1]-i[u]),p=l+f*_a,m=Ph(p,e,o);return m>=qC?JC(c,p,e,o):m===0?p:KC(c,l,l+_a,e,o)}return function(l){return l===0?0:l===1?1:ka(s(l),n,r)}}});var Wh=Xe((Fz,Ta)=>{var zo=jh(),Uh={ease:zo(.25,.1,.25,1),easeIn:zo(.42,0,1,1),easeOut:zo(0,0,.58,1),easeInOut:zo(.42,0,.58,1),linear:zo(0,0,1,1)};Ta.exports=ZC;Ta.exports.makeAggregateRaf=Vh;Ta.exports.sharedScheduler=Vh();function ZC(t,e,n){var o=Object.create(null),r=Object.create(null);n=n||{};var i=typeof n.easing=="function"?n.easing:Uh[n.easing];i||(n.easing&&console.warn("Unknown easing function in amator: "+n.easing),i=Uh.ease);var a=typeof n.step=="function"?n.step:zh,s=typeof n.done=="function"?n.done:zh,c=e2(n.scheduler),l=Object.keys(e);l.forEach(function(x){o[x]=t[x],r[x]=e[x]-t[x]});var u=typeof n.duration=="number"?n.duration:400,d=Math.max(1,u*.06),f,p=0;return f=c.next(h),{cancel:m};function m(){c.cancel(f),f=0}function h(){var x=i(p/d);p+=1,b(x),p<=d?(f=c.next(h),a(t)):(f=0,setTimeout(function(){s(t)},0))}function b(x){l.forEach(function(y){t[y]=r[y]*x+o[y]})}}function zh(){}function e2(t){if(!t){var e=typeof window<"u"&&window.requestAnimationFrame;return e?t2():n2()}if(typeof t.next!="function")throw new Error("Scheduler is supposed to have next(cb) function");if(typeof t.cancel!="function")throw new Error("Scheduler is supposed to have cancel(handle) function");return t}function t2(){return{next:window.requestAnimationFrame.bind(window),cancel:window.cancelAnimationFrame.bind(window)}}function n2(){return{next:function(t){return setTimeout(t,1e3/60)},cancel:function(t){return clearTimeout(t)}}}function Vh(){var t=new Set,e=new Set,n=0;return{next:r,cancel:r,clearAll:o};function o(){t.clear(),e.clear(),cancelAnimationFrame(n),n=0}function r(c){e.add(c),i()}function i(){n||(n=requestAnimationFrame(a))}function a(){n=0;var c=e;e=t,t=c,t.forEach(function(l){l()}),t.clear()}function s(c){e.delete(c)}}});var Gh=Xe((Dz,Hh)=>{Hh.exports=function(e){o2(e);var n=r2(e);return e.on=n.on,e.off=n.off,e.fire=n.fire,e};function r2(t){var e=Object.create(null);return{on:function(n,o,r){if(typeof o!="function")throw new Error("callback is expected to be a function");var i=e[n];return i||(i=e[n]=[]),i.push({callback:o,ctx:r}),t},off:function(n,o){var r=typeof n>"u";if(r)return e=Object.create(null),t;if(e[n]){var i=typeof o!="function";if(i)delete e[n];else for(var a=e[n],s=0;s<a.length;++s)a[s].callback===o&&a.splice(s,1)}return t},fire:function(n){var o=e[n];if(!o)return t;var r;arguments.length>1&&(r=Array.prototype.splice.call(arguments,1));for(var i=0;i<o.length;++i){var a=o[i];a.callback.apply(a.ctx,r)}return t}}}function o2(t){if(!t)throw new Error("Eventify cannot use falsy object as events subject");for(var e=["on","fire","off"],n=0;n<e.length;++n)if(t.hasOwnProperty(e[n]))throw new Error("Subject cannot be eventified, since it already has property '"+e[n]+"'")}});var Xh=Xe((Mz,qh)=>{qh.exports=i2;function i2(t,e,n){typeof n!="object"&&(n={});var o=typeof n.minVelocity=="number"?n.minVelocity:5,r=typeof n.amplitude=="number"?n.amplitude:.25,i=typeof n.cancelAnimationFrame=="function"?n.cancelAnimationFrame:a2(),a=typeof n.requestAnimationFrame=="function"?n.requestAnimationFrame:s2(),s,c,l=342,u,d,f,p,m,h,b,x;return{start:M,stop:C,cancel:y};function y(){i(u),i(x)}function M(){s=t(),p=b=d=m=0,c=new Date,i(u),i(x),u=a(E)}function E(){var P=Date.now(),D=P-c;c=P;var N=t(),S=N.x-s.x,G=N.y-s.y;s=N;var v=1e3/(1+D);d=.8*S*v+.2*d,m=.8*G*v+.2*m,u=a(E)}function C(){i(u),i(x);var P=t();f=P.x,h=P.y,c=Date.now(),(d<-o||d>o)&&(p=r*d,f+=p),(m<-o||m>o)&&(b=r*m,h+=b),x=a(j)}function j(){var P=Date.now()-c,D=!1,N=0,S=0;p&&(N=-p*Math.exp(-P/l),N>.5||N<-.5?D=!0:N=p=0),b&&(S=-b*Math.exp(-P/l),S>.5||S<-.5?D=!0:S=b=0),D&&(e(f+N,h+S),x=a(j))}}function a2(){return typeof cancelAnimationFrame=="function"?cancelAnimationFrame:clearTimeout}function s2(){return typeof requestAnimationFrame=="function"?requestAnimationFrame:function(t){return setTimeout(t,16)}}});var Jh=Xe((Lz,Kh)=>{Kh.exports=l2;function l2(t){if(t)return{capture:Qh,release:Qh};var e,n,o,r=!1;return{capture:i,release:a};function i(s){r=!0,n=window.document.onselectstart,o=window.document.ondragstart,window.document.onselectstart=Yh,e=s,e.ondragstart=Yh}function a(){r&&(r=!1,window.document.onselectstart=n,e&&(e.ondragstart=o))}}function Yh(t){return t.stopPropagation(),!1}function Qh(){}});var Zh=Xe((Pz,$h)=>{$h.exports=c2;function c2(){this.x=0,this.y=0,this.scale=1}});var tg=Xe((Bz,Dl)=>{Dl.exports=u2;Dl.exports.canAttach=eg;function u2(t,e){if(!eg(t))throw new Error("svg element is required for svg.panzoom to work");var n=t.ownerSVGElement;if(!n)throw new Error("Do not apply panzoom to the root <svg> element. Use its child instead (e.g. <g></g>). As of March 2016 only FireFox supported transform on the root element");e.disableKeyboardInteraction||n.setAttribute("tabindex",0);var o={getBBox:i,getScreenCTM:a,getOwner:r,applyTransform:c,initTransform:s};return o;function r(){return n}function i(){var l=t.getBBox();return{left:l.x,top:l.y,width:l.width,height:l.height}}function a(){var l=n.getCTM();return l||n.getScreenCTM()}function s(l){var u=t.getCTM();u===null&&(u=document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGMatrix()),l.x=u.e,l.y=u.f,l.scale=u.a,n.removeAttributeNS(null,"viewBox")}function c(l){t.setAttribute("transform","matrix("+l.scale+" 0 0 "+l.scale+" "+l.x+" "+l.y+")")}}function eg(t){return t&&t.ownerSVGElement&&t.getCTM}});var rg=Xe((jz,Ml)=>{Ml.exports=d2;Ml.exports.canAttach=ng;function d2(t,e){var n=ng(t);if(!n)throw new Error("panzoom requires DOM element to be attached to the DOM tree");var o=t.parentElement;t.scrollTop=0,e.disableKeyboardInteraction||o.setAttribute("tabindex",0);var r={getBBox:a,getOwner:i,applyTransform:s};return r;function i(){return o}function a(){return{left:0,top:0,width:t.clientWidth,height:t.clientHeight}}function s(c){t.style.transformOrigin="0 0 0",t.style.transform="matrix("+c.scale+", 0, 0, "+c.scale+", "+c.x+", "+c.y+")"}}function ng(t){return t&&t.parentElement&&t.style}});var mg=Xe((Uz,pg)=>{"use strict";var og=Fh(),Ll=Wh(),f2=Gh(),p2=Xh(),dg=Jh(),m2=dg(),h2=dg(!0),g2=Zh(),ig=tg(),ag=rg(),b2=1,x2=1.75,sg=300,lg=200;pg.exports=fg;function fg(t,e){e=e||{};var n=e.controller;if(n||(ig.canAttach(t)?n=ig(t,e):ag.canAttach(t)&&(n=ag(t,e))),!n)throw new Error("Cannot create panzoom for the current type of dom element");var o=n.getOwner(),r={x:0,y:0},i=!1,a=new g2;n.initTransform&&n.initTransform(a);var s=typeof e.filterKey=="function"?e.filterKey:io,c=typeof e.pinchSpeed=="number"?e.pinchSpeed:1,l=e.bounds,u=typeof e.maxZoom=="number"?e.maxZoom:Number.POSITIVE_INFINITY,d=typeof e.minZoom=="number"?e.minZoom:0,f=typeof e.boundsPadding=="number"?e.boundsPadding:.05,p=typeof e.zoomDoubleClickSpeed=="number"?e.zoomDoubleClickSpeed:x2,m=e.beforeWheel||io,h=e.beforeMouseDown||io,b=typeof e.zoomSpeed=="number"?e.zoomSpeed:b2,x=cg(e.transformOrigin),y=e.enableTextSelection?h2:m2;v2(l),e.autocenter&&Z();var M,E=0,C=0,j=0,P=null,D=new Date,N,S=!1,G=!1,v,T,R,A,U,k;"smoothScroll"in e&&!e.smoothScroll?k=y2():k=p2(et,Za,e.smoothScroll);var w,I,_,F=!1;di();var z={dispose:es,moveBy:Pn,moveTo:Ge,smoothMoveTo:$a,centerOn:Ja,zoomTo:bi,zoomAbs:Or,smoothZoom:gi,smoothZoomAbs:uy,showRectangle:te,pause:B,resume:V,isPaused:$,getTransform:ce,getMinZoom:ke,setMinZoom:ve,getMaxZoom:re,setMaxZoom:we,getTransformOrigin:Te,setTransformOrigin:Ae,getZoomSpeed:je,setZoomSpeed:Re};f2(z);var q=typeof e.initialX=="number"?e.initialX:a.x,ee=typeof e.initialY=="number"?e.initialY:a.y,O=typeof e.initialZoom=="number"?e.initialZoom:a.scale;return(q!=a.x||ee!=a.y||O!=a.scale)&&Or(q,ee,O),z;function B(){fi(),F=!0}function V(){F&&(di(),F=!1)}function $(){return F}function te(K){var ue=o.getBoundingClientRect(),fe=L(ue.width,ue.height),ge=K.right-K.left,Be=K.bottom-K.top;if(!Number.isFinite(ge)||!Number.isFinite(Be))throw new Error("Invalid rectangle");var Ye=fe.x/ge,Qe=fe.y/Be,ft=Math.min(Ye,Qe);a.x=-(K.left+ge/2)*ft+fe.x/2,a.y=-(K.top+Be/2)*ft+fe.y/2,a.scale=ft}function L(K,ue){if(n.getScreenCTM){var fe=n.getScreenCTM(),ge=fe.a,Be=fe.d,Ye=fe.e,Qe=fe.f;r.x=K*ge-Ye,r.y=ue*Be-Qe}else r.x=K,r.y=ue;return r}function Z(){var K,ue,fe=0,ge=0,Be=ct();if(Be)fe=Be.left,ge=Be.top,K=Be.right-Be.left,ue=Be.bottom-Be.top;else{var Ye=o.getBoundingClientRect();K=Ye.width,ue=Ye.height}var Qe=n.getBBox();if(!(Qe.width===0||Qe.height===0)){var ft=ue/Qe.height,Rr=K/Qe.width,lr=Math.min(Rr,ft);a.x=-(Qe.left+Qe.width/2)*lr+K/2+fe,a.y=-(Qe.top+Qe.height/2)*lr+ue/2+ge,a.scale=lr}}function ce(){return a}function ke(){return d}function ve(K){d=K}function re(){return u}function we(K){u=K}function Te(){return x}function Ae(K){x=cg(K)}function je(){return b}function Re(K){if(!Number.isFinite(K))throw new Error("Zoom speed should be a number");b=K}function et(){return{x:a.x,y:a.y}}function Ge(K,ue){a.x=K,a.y=ue,kt(),Ar("pan"),tn()}function _t(K,ue){Ge(a.x+K,a.y+ue)}function kt(){var K=ct();if(K){var ue=!1,fe=Ln(),ge=K.left-fe.right;return ge>0&&(a.x+=ge,ue=!0),ge=K.right-fe.left,ge<0&&(a.x+=ge,ue=!0),ge=K.top-fe.bottom,ge>0&&(a.y+=ge,ue=!0),ge=K.bottom-fe.top,ge<0&&(a.y+=ge,ue=!0),ue}}function ct(){if(l){if(typeof l=="boolean"){var K=o.getBoundingClientRect(),ue=K.width,fe=K.height;return{left:ue*f,top:fe*f,right:ue*(1-f),bottom:fe*(1-f)}}return l}}function Ln(){var K=n.getBBox(),ue=xn(K.left,K.top);return{left:ue.x,top:ue.y,right:K.width*a.scale+ue.x,bottom:K.height*a.scale+ue.y}}function xn(K,ue){return{x:K*a.scale+a.x,y:ue*a.scale+a.y}}function tn(){i=!0,M=window.requestAnimationFrame(ts)}function Er(K,ue,fe){if(Pl(K)||Pl(ue)||Pl(fe))throw new Error("zoom requires valid numbers");var ge=a.scale*fe;if(ge<d){if(a.scale===d)return;fe=d/a.scale}if(ge>u){if(a.scale===u)return;fe=u/a.scale}var Be=L(K,ue);if(a.x=Be.x-fe*(Be.x-a.x),a.y=Be.y-fe*(Be.y-a.y),l&&f===1&&d===1)a.scale*=fe,kt();else{var Ye=kt();Ye||(a.scale*=fe)}Ar("zoom"),tn()}function Or(K,ue,fe){var ge=fe/a.scale;Er(K,ue,ge)}function Ja(K){var ue=K.ownerSVGElement;if(!ue)throw new Error("ui element is required to be within the scene");var fe=K.getBoundingClientRect(),ge=fe.left+fe.width/2,Be=fe.top+fe.height/2,Ye=ue.getBoundingClientRect(),Qe=Ye.width/2-ge,ft=Ye.height/2-Be;Pn(Qe,ft,!0)}function $a(K,ue){Pn(K-a.x,ue-a.y,!0)}function Pn(K,ue,fe){if(!fe)return _t(K,ue);w&&w.cancel();var ge={x:0,y:0},Be={x:K,y:ue},Ye=0,Qe=0;w=Ll(ge,Be,{step:function(ft){_t(ft.x-Ye,ft.y-Qe),Ye=ft.x,Qe=ft.y}})}function Za(K,ue){xi(),Ge(K,ue)}function es(){fi()}function di(){o.addEventListener("mousedown",Uu,{passive:!1}),o.addEventListener("dblclick",ju,{passive:!1}),o.addEventListener("touchstart",mi,{passive:!1}),o.addEventListener("keydown",pi,{passive:!1}),og.addWheelListener(o,Gu,{passive:!1}),tn()}function fi(){og.removeWheelListener(o,Gu),o.removeEventListener("mousedown",Uu),o.removeEventListener("keydown",pi),o.removeEventListener("dblclick",ju),o.removeEventListener("touchstart",mi),M&&(window.cancelAnimationFrame(M),M=0),k.cancel(),Wu(),Hu(),y.release(),is()}function ts(){i&&ns()}function ns(){i=!1,n.applyTransform(a),Ar("transform"),M=0}function pi(K){var ue=0,fe=0,ge=0;if(K.keyCode===38?fe=1:K.keyCode===40?fe=-1:K.keyCode===37?ue=1:K.keyCode===39?ue=-1:K.keyCode===189||K.keyCode===109?ge=1:(K.keyCode===187||K.keyCode===107)&&(ge=-1),!s(K,ue,fe,ge)){if(ue||fe){K.preventDefault(),K.stopPropagation();var Be=o.getBoundingClientRect(),Ye=Math.min(Be.width,Be.height),Qe=.05,ft=Ye*Qe*ue,Rr=Ye*Qe*fe;Pn(ft,Rr)}if(ge){var lr=qu(ge*100),Ye=x?_o():rs();bi(Ye.x,Ye.y,lr)}}}function rs(){var K=o.getBoundingClientRect();return{x:K.width/2,y:K.height/2}}function mi(K){if(os(K),rn(),K.touches.length===1)return be(K,K.touches[0]);K.touches.length===2&&(U=Bu(K.touches[0],K.touches[1]),_=!0,ut())}function os(K){e.onTouch&&!e.onTouch(K)||(K.stopPropagation(),K.preventDefault())}function J(K){rn(),!(e.onDoubleClick&&!e.onDoubleClick(K))&&(K.preventDefault(),K.stopPropagation())}function be(K){C=new Date;var ue=K.touches[0],fe=vn(ue);N=fe;var ge=L(fe.x,fe.y);v=ge.x,T=ge.y,R=v,A=T,k.cancel(),ut()}function ut(){S||(S=!0,document.addEventListener("touchmove",nn),document.addEventListener("touchend",hi),document.addEventListener("touchcancel",hi))}function nn(K){if(K.touches.length===1){K.stopPropagation();var ue=K.touches[0],fe=vn(ue),ge=L(fe.x,fe.y),Be=ge.x-v,Ye=ge.y-T;Be!==0&&Ye!==0&&Xu(),v=ge.x,T=ge.y,Pn(Be,Ye)}else if(K.touches.length===2){_=!0;var Qe=K.touches[0],ft=K.touches[1],Rr=Bu(Qe,ft),lr=1+(Rr/U-1)*c,Yu=vn(Qe),Qu=vn(ft);if(v=(Yu.x+Qu.x)/2,T=(Yu.y+Qu.y)/2,x){var fe=_o();v=fe.x,T=fe.y}bi(v,T,lr),U=Rr,K.stopPropagation(),K.preventDefault()}}function rn(){j&&(clearTimeout(j),j=0)}function Pu(K){if(e.onClick){rn();var ue=v-R,fe=T-A,ge=Math.sqrt(ue*ue+fe*fe);ge>5||(j=setTimeout(function(){j=0,e.onClick(K)},sg))}}function hi(K){if(rn(),K.touches.length>0){var ue=vn(K.touches[0]),fe=L(ue.x,ue.y);v=fe.x,T=fe.y}else{var ge=new Date;if(ge-E<sg)if(x){var ue=_o();gi(ue.x,ue.y,p)}else gi(N.x,N.y,p);else ge-C<lg&&Pu(K);E=ge,is(),Hu()}}function Bu(K,ue){var fe=K.clientX-ue.clientX,ge=K.clientY-ue.clientY;return Math.sqrt(fe*fe+ge*ge)}function ju(K){J(K);var ue=vn(K);x&&(ue=_o()),gi(ue.x,ue.y,p)}function Uu(K){if(rn(),!h(K)){if(P=K,D=new Date,S)return K.stopPropagation(),!1;var ue=K.button===1&&window.event!==null||K.button===0;if(ue){k.cancel();var fe=vn(K),ge=L(fe.x,fe.y);return R=v=ge.x,A=T=ge.y,document.addEventListener("mousemove",zu),document.addEventListener("mouseup",Vu),y.capture(K.target||K.srcElement),!1}}}function zu(K){if(!S){Xu();var ue=vn(K),fe=L(ue.x,ue.y),ge=fe.x-v,Be=fe.y-T;v=fe.x,T=fe.y,Pn(ge,Be)}}function Vu(){var K=new Date;K-D<lg&&Pu(P),y.release(),is(),Wu()}function Wu(){document.removeEventListener("mousemove",zu),document.removeEventListener("mouseup",Vu),G=!1}function Hu(){document.removeEventListener("touchmove",nn),document.removeEventListener("touchend",hi),document.removeEventListener("touchcancel",hi),G=!1,_=!1,S=!1}function Gu(K){if(!m(K)){k.cancel();var ue=K.deltaY;K.deltaMode>0&&(ue*=100);var fe=qu(ue);if(fe!==1){var ge=x?_o():vn(K);bi(ge.x,ge.y,fe),K.preventDefault()}}}function vn(K){var ue,fe,ge=o.getBoundingClientRect();return ue=K.clientX-ge.left,fe=K.clientY-ge.top,{x:ue,y:fe}}function gi(K,ue,fe){var ge=a.scale,Be={scale:ge},Ye={scale:fe*ge};k.cancel(),xi(),I=Ll(Be,Ye,{step:function(Qe){Or(K,ue,Qe.scale)},done:dy})}function uy(K,ue,fe){var ge=a.scale,Be={scale:ge},Ye={scale:fe};k.cancel(),xi(),I=Ll(Be,Ye,{step:function(Qe){Or(K,ue,Qe.scale)}})}function _o(){var K=o.getBoundingClientRect();return{x:K.width*x.x,y:K.height*x.y}}function bi(K,ue,fe){return k.cancel(),xi(),Er(K,ue,fe)}function xi(){I&&(I.cancel(),I=null)}function qu(K){var ue=Math.sign(K),fe=Math.min(.25,Math.abs(b*K/128));return 1-ue*fe}function Xu(){G||(Ar("panstart"),G=!0,k.start())}function is(){G&&(_||k.stop(),Ar("panend"))}function dy(){Ar("zoomend")}function Ar(K){z.fire(K,z)}}function cg(t){if(t){if(typeof t=="object")return(!oo(t.x)||!oo(t.y))&&ug(t),t;ug()}}function ug(t){throw console.error(t),new Error(["Cannot parse transform origin.","Some good examples:",'  "center center" can be achieved with {x: 0.5, y: 0.5}','  "top center" can be achieved with {x: 0.5, y: 0}','  "bottom right" can be achieved with {x: 1, y: 1}'].join(`
`))}function io(){}function v2(t){var e=typeof t;if(!(e==="undefined"||e==="boolean")){var n=oo(t.left)&&oo(t.top)&&oo(t.bottom)&&oo(t.right);if(!n)throw new Error("Bounds object is not valid. It can be: undefined, boolean (true|false) or an object {left, top, right, bottom}")}}function oo(t){return Number.isFinite(t)}function Pl(t){return Number.isNaN?Number.isNaN(t):t!==t}function y2(){return{start:io,stop:io,cancel:io}}function w2(){if(typeof document>"u")return;var t=document.getElementsByTagName("script");if(!t)return;for(var e,n=0;n<t.length;++n){var o=t[n];if(o.src&&o.src.match(/\bpanzoom(\.min)?\.js/)){e=o;break}}if(!e)return;var r=e.getAttribute("query");if(!r)return;var i=e.getAttribute("name")||"pz",a=Date.now();s();function s(){var u=document.querySelector(r);if(!u){var d=Date.now(),f=d-a;if(f<2e3){setTimeout(s,100);return}console.error("Cannot find the panzoom element",i);return}var p=c(e);console.log(p),window[i]=fg(u,p)}function c(u){for(var d=u.attributes,f={},p=0;p<d.length;++p){var m=d[p],h=l(m);h&&(f[h.name]=h.value)}return f}function l(u){if(u.name){var d=u.name[0]==="p"&&u.name[1]==="z"&&u.name[2]==="-";if(d){var f=u.name.substr(3),p=JSON.parse(u.value);return{name:f,value:p}}}}}w2()});var wv=Xe(wt=>{"use strict";Object.defineProperty(wt,"__esModule",{value:!0});function zt(t){if(t==null)return window;if(t.toString()!=="[object Window]"){var e=t.ownerDocument;return e&&e.defaultView||window}return t}function Cr(t){var e=zt(t).Element;return t instanceof e||t instanceof Element}function Ht(t){var e=zt(t).HTMLElement;return t instanceof e||t instanceof HTMLElement}function Vc(t){if(typeof ShadowRoot>"u")return!1;var e=zt(t).ShadowRoot;return t instanceof e||t instanceof ShadowRoot}var Tr=Math.max,Ga=Math.min,bo=Math.round;function Uc(){var t=navigator.userAgentData;return t!=null&&t.brands&&Array.isArray(t.brands)?t.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function av(){return!/^((?!chrome|android).)*safari/i.test(Uc())}function xo(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!1);var o=t.getBoundingClientRect(),r=1,i=1;e&&Ht(t)&&(r=t.offsetWidth>0&&bo(o.width)/t.offsetWidth||1,i=t.offsetHeight>0&&bo(o.height)/t.offsetHeight||1);var a=Cr(t)?zt(t):window,s=a.visualViewport,c=!av()&&n,l=(o.left+(c&&s?s.offsetLeft:0))/r,u=(o.top+(c&&s?s.offsetTop:0))/i,d=o.width/r,f=o.height/i;return{width:d,height:f,top:u,right:l+d,bottom:u+f,left:l,x:l,y:u}}function Wc(t){var e=zt(t),n=e.pageXOffset,o=e.pageYOffset;return{scrollLeft:n,scrollTop:o}}function o3(t){return{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}}function i3(t){return t===zt(t)||!Ht(t)?Wc(t):o3(t)}function bn(t){return t?(t.nodeName||"").toLowerCase():null}function sr(t){return((Cr(t)?t.ownerDocument:t.document)||window.document).documentElement}function Hc(t){return xo(sr(t)).left+Wc(t).scrollLeft}function Mn(t){return zt(t).getComputedStyle(t)}function Gc(t){var e=Mn(t),n=e.overflow,o=e.overflowX,r=e.overflowY;return/auto|scroll|overlay|hidden/.test(n+r+o)}function a3(t){var e=t.getBoundingClientRect(),n=bo(e.width)/t.offsetWidth||1,o=bo(e.height)/t.offsetHeight||1;return n!==1||o!==1}function s3(t,e,n){n===void 0&&(n=!1);var o=Ht(e),r=Ht(e)&&a3(e),i=sr(e),a=xo(t,r,n),s={scrollLeft:0,scrollTop:0},c={x:0,y:0};return(o||!o&&!n)&&((bn(e)!=="body"||Gc(i))&&(s=i3(e)),Ht(e)?(c=xo(e,!0),c.x+=e.clientLeft,c.y+=e.clientTop):i&&(c.x=Hc(i))),{x:a.left+s.scrollLeft-c.x,y:a.top+s.scrollTop-c.y,width:a.width,height:a.height}}function qc(t){var e=xo(t),n=t.offsetWidth,o=t.offsetHeight;return Math.abs(e.width-n)<=1&&(n=e.width),Math.abs(e.height-o)<=1&&(o=e.height),{x:t.offsetLeft,y:t.offsetTop,width:n,height:o}}function qa(t){return bn(t)==="html"?t:t.assignedSlot||t.parentNode||(Vc(t)?t.host:null)||sr(t)}function sv(t){return["html","body","#document"].indexOf(bn(t))>=0?t.ownerDocument.body:Ht(t)&&Gc(t)?t:sv(qa(t))}function ai(t,e){var n;e===void 0&&(e=[]);var o=sv(t),r=o===((n=t.ownerDocument)==null?void 0:n.body),i=zt(o),a=r?[i].concat(i.visualViewport||[],Gc(o)?o:[]):o,s=e.concat(a);return r?s:s.concat(ai(qa(a)))}function l3(t){return["table","td","th"].indexOf(bn(t))>=0}function Jx(t){return!Ht(t)||Mn(t).position==="fixed"?null:t.offsetParent}function c3(t){var e=/firefox/i.test(Uc()),n=/Trident/i.test(Uc());if(n&&Ht(t)){var o=Mn(t);if(o.position==="fixed")return null}var r=qa(t);for(Vc(r)&&(r=r.host);Ht(r)&&["html","body"].indexOf(bn(r))<0;){var i=Mn(r);if(i.transform!=="none"||i.perspective!=="none"||i.contain==="paint"||["transform","perspective"].indexOf(i.willChange)!==-1||e&&i.willChange==="filter"||e&&i.filter&&i.filter!=="none")return r;r=r.parentNode}return null}function ci(t){for(var e=zt(t),n=Jx(t);n&&l3(n)&&Mn(n).position==="static";)n=Jx(n);return n&&(bn(n)==="html"||bn(n)==="body"&&Mn(n).position==="static")?e:n||c3(t)||e}var Rt="top",Gt="bottom",qt="right",Nt="left",Xc="auto",ui=[Rt,Gt,qt,Nt],vo="start",li="end",u3="clippingParents",lv="viewport",ii="popper",d3="reference",$x=ui.reduce(function(t,e){return t.concat([e+"-"+vo,e+"-"+li])},[]),cv=[].concat(ui,[Xc]).reduce(function(t,e){return t.concat([e,e+"-"+vo,e+"-"+li])},[]),f3="beforeRead",p3="read",m3="afterRead",h3="beforeMain",g3="main",b3="afterMain",x3="beforeWrite",v3="write",y3="afterWrite",w3=[f3,p3,m3,h3,g3,b3,x3,v3,y3];function _3(t){var e=new Map,n=new Set,o=[];t.forEach(function(i){e.set(i.name,i)});function r(i){n.add(i.name);var a=[].concat(i.requires||[],i.requiresIfExists||[]);a.forEach(function(s){if(!n.has(s)){var c=e.get(s);c&&r(c)}}),o.push(i)}return t.forEach(function(i){n.has(i.name)||r(i)}),o}function k3(t){var e=_3(t);return w3.reduce(function(n,o){return n.concat(e.filter(function(r){return r.phase===o}))},[])}function T3(t){var e;return function(){return e||(e=new Promise(function(n){Promise.resolve().then(function(){e=void 0,n(t())})})),e}}function C3(t){var e=t.reduce(function(n,o){var r=n[o.name];return n[o.name]=r?Object.assign({},r,o,{options:Object.assign({},r.options,o.options),data:Object.assign({},r.data,o.data)}):o,n},{});return Object.keys(e).map(function(n){return e[n]})}function S3(t,e){var n=zt(t),o=sr(t),r=n.visualViewport,i=o.clientWidth,a=o.clientHeight,s=0,c=0;if(r){i=r.width,a=r.height;var l=av();(l||!l&&e==="fixed")&&(s=r.offsetLeft,c=r.offsetTop)}return{width:i,height:a,x:s+Hc(t),y:c}}function E3(t){var e,n=sr(t),o=Wc(t),r=(e=t.ownerDocument)==null?void 0:e.body,i=Tr(n.scrollWidth,n.clientWidth,r?r.scrollWidth:0,r?r.clientWidth:0),a=Tr(n.scrollHeight,n.clientHeight,r?r.scrollHeight:0,r?r.clientHeight:0),s=-o.scrollLeft+Hc(t),c=-o.scrollTop;return Mn(r||n).direction==="rtl"&&(s+=Tr(n.clientWidth,r?r.clientWidth:0)-i),{width:i,height:a,x:s,y:c}}function uv(t,e){var n=e.getRootNode&&e.getRootNode();if(t.contains(e))return!0;if(n&&Vc(n)){var o=e;do{if(o&&t.isSameNode(o))return!0;o=o.parentNode||o.host}while(o)}return!1}function zc(t){return Object.assign({},t,{left:t.x,top:t.y,right:t.x+t.width,bottom:t.y+t.height})}function O3(t,e){var n=xo(t,!1,e==="fixed");return n.top=n.top+t.clientTop,n.left=n.left+t.clientLeft,n.bottom=n.top+t.clientHeight,n.right=n.left+t.clientWidth,n.width=t.clientWidth,n.height=t.clientHeight,n.x=n.left,n.y=n.top,n}function Zx(t,e,n){return e===lv?zc(S3(t,n)):Cr(e)?O3(e,n):zc(E3(sr(t)))}function A3(t){var e=ai(qa(t)),n=["absolute","fixed"].indexOf(Mn(t).position)>=0,o=n&&Ht(t)?ci(t):t;return Cr(o)?e.filter(function(r){return Cr(r)&&uv(r,o)&&bn(r)!=="body"}):[]}function R3(t,e,n,o){var r=e==="clippingParents"?A3(t):[].concat(e),i=[].concat(r,[n]),a=i[0],s=i.reduce(function(c,l){var u=Zx(t,l,o);return c.top=Tr(u.top,c.top),c.right=Ga(u.right,c.right),c.bottom=Ga(u.bottom,c.bottom),c.left=Tr(u.left,c.left),c},Zx(t,a,o));return s.width=s.right-s.left,s.height=s.bottom-s.top,s.x=s.left,s.y=s.top,s}function gn(t){return t.split("-")[0]}function yo(t){return t.split("-")[1]}function Yc(t){return["top","bottom"].indexOf(t)>=0?"x":"y"}function dv(t){var e=t.reference,n=t.element,o=t.placement,r=o?gn(o):null,i=o?yo(o):null,a=e.x+e.width/2-n.width/2,s=e.y+e.height/2-n.height/2,c;switch(r){case Rt:c={x:a,y:e.y-n.height};break;case Gt:c={x:a,y:e.y+e.height};break;case qt:c={x:e.x+e.width,y:s};break;case Nt:c={x:e.x-n.width,y:s};break;default:c={x:e.x,y:e.y}}var l=r?Yc(r):null;if(l!=null){var u=l==="y"?"height":"width";switch(i){case vo:c[l]=c[l]-(e[u]/2-n[u]/2);break;case li:c[l]=c[l]+(e[u]/2-n[u]/2);break}}return c}function fv(){return{top:0,right:0,bottom:0,left:0}}function pv(t){return Object.assign({},fv(),t)}function mv(t,e){return e.reduce(function(n,o){return n[o]=t,n},{})}function wo(t,e){e===void 0&&(e={});var n=e,o=n.placement,r=o===void 0?t.placement:o,i=n.strategy,a=i===void 0?t.strategy:i,s=n.boundary,c=s===void 0?u3:s,l=n.rootBoundary,u=l===void 0?lv:l,d=n.elementContext,f=d===void 0?ii:d,p=n.altBoundary,m=p===void 0?!1:p,h=n.padding,b=h===void 0?0:h,x=pv(typeof b!="number"?b:mv(b,ui)),y=f===ii?d3:ii,M=t.rects.popper,E=t.elements[m?y:f],C=R3(Cr(E)?E:E.contextElement||sr(t.elements.popper),c,u,a),j=xo(t.elements.reference),P=dv({reference:j,element:M,strategy:"absolute",placement:r}),D=zc(Object.assign({},M,P)),N=f===ii?D:j,S={top:C.top-N.top+x.top,bottom:N.bottom-C.bottom+x.bottom,left:C.left-N.left+x.left,right:N.right-C.right+x.right},G=t.modifiersData.offset;if(f===ii&&G){var v=G[r];Object.keys(S).forEach(function(T){var R=[qt,Gt].indexOf(T)>=0?1:-1,A=[Rt,Gt].indexOf(T)>=0?"y":"x";S[T]+=v[A]*R})}return S}var ev={placement:"bottom",modifiers:[],strategy:"absolute"};function tv(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return!e.some(function(o){return!(o&&typeof o.getBoundingClientRect=="function")})}function Qc(t){t===void 0&&(t={});var e=t,n=e.defaultModifiers,o=n===void 0?[]:n,r=e.defaultOptions,i=r===void 0?ev:r;return function(s,c,l){l===void 0&&(l=i);var u={placement:"bottom",orderedModifiers:[],options:Object.assign({},ev,i),modifiersData:{},elements:{reference:s,popper:c},attributes:{},styles:{}},d=[],f=!1,p={state:u,setOptions:function(x){var y=typeof x=="function"?x(u.options):x;h(),u.options=Object.assign({},i,u.options,y),u.scrollParents={reference:Cr(s)?ai(s):s.contextElement?ai(s.contextElement):[],popper:ai(c)};var M=k3(C3([].concat(o,u.options.modifiers)));return u.orderedModifiers=M.filter(function(E){return E.enabled}),m(),p.update()},forceUpdate:function(){if(!f){var x=u.elements,y=x.reference,M=x.popper;if(tv(y,M)){u.rects={reference:s3(y,ci(M),u.options.strategy==="fixed"),popper:qc(M)},u.reset=!1,u.placement=u.options.placement,u.orderedModifiers.forEach(function(S){return u.modifiersData[S.name]=Object.assign({},S.data)});for(var E=0;E<u.orderedModifiers.length;E++){if(u.reset===!0){u.reset=!1,E=-1;continue}var C=u.orderedModifiers[E],j=C.fn,P=C.options,D=P===void 0?{}:P,N=C.name;typeof j=="function"&&(u=j({state:u,options:D,name:N,instance:p})||u)}}}},update:T3(function(){return new Promise(function(b){p.forceUpdate(),b(u)})}),destroy:function(){h(),f=!0}};if(!tv(s,c))return p;p.setOptions(l).then(function(b){!f&&l.onFirstUpdate&&l.onFirstUpdate(b)});function m(){u.orderedModifiers.forEach(function(b){var x=b.name,y=b.options,M=y===void 0?{}:y,E=b.effect;if(typeof E=="function"){var C=E({state:u,name:x,instance:p,options:M}),j=function(){};d.push(C||j)}})}function h(){d.forEach(function(b){return b()}),d=[]}return p}}var Wa={passive:!0};function N3(t){var e=t.state,n=t.instance,o=t.options,r=o.scroll,i=r===void 0?!0:r,a=o.resize,s=a===void 0?!0:a,c=zt(e.elements.popper),l=[].concat(e.scrollParents.reference,e.scrollParents.popper);return i&&l.forEach(function(u){u.addEventListener("scroll",n.update,Wa)}),s&&c.addEventListener("resize",n.update,Wa),function(){i&&l.forEach(function(u){u.removeEventListener("scroll",n.update,Wa)}),s&&c.removeEventListener("resize",n.update,Wa)}}var Kc={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:N3,data:{}};function I3(t){var e=t.state,n=t.name;e.modifiersData[n]=dv({reference:e.rects.reference,element:e.rects.popper,strategy:"absolute",placement:e.placement})}var Jc={name:"popperOffsets",enabled:!0,phase:"read",fn:I3,data:{}},F3={top:"auto",right:"auto",bottom:"auto",left:"auto"};function D3(t,e){var n=t.x,o=t.y,r=e.devicePixelRatio||1;return{x:bo(n*r)/r||0,y:bo(o*r)/r||0}}function nv(t){var e,n=t.popper,o=t.popperRect,r=t.placement,i=t.variation,a=t.offsets,s=t.position,c=t.gpuAcceleration,l=t.adaptive,u=t.roundOffsets,d=t.isFixed,f=a.x,p=f===void 0?0:f,m=a.y,h=m===void 0?0:m,b=typeof u=="function"?u({x:p,y:h}):{x:p,y:h};p=b.x,h=b.y;var x=a.hasOwnProperty("x"),y=a.hasOwnProperty("y"),M=Nt,E=Rt,C=window;if(l){var j=ci(n),P="clientHeight",D="clientWidth";if(j===zt(n)&&(j=sr(n),Mn(j).position!=="static"&&s==="absolute"&&(P="scrollHeight",D="scrollWidth")),j=j,r===Rt||(r===Nt||r===qt)&&i===li){E=Gt;var N=d&&j===C&&C.visualViewport?C.visualViewport.height:j[P];h-=N-o.height,h*=c?1:-1}if(r===Nt||(r===Rt||r===Gt)&&i===li){M=qt;var S=d&&j===C&&C.visualViewport?C.visualViewport.width:j[D];p-=S-o.width,p*=c?1:-1}}var G=Object.assign({position:s},l&&F3),v=u===!0?D3({x:p,y:h},zt(n)):{x:p,y:h};if(p=v.x,h=v.y,c){var T;return Object.assign({},G,(T={},T[E]=y?"0":"",T[M]=x?"0":"",T.transform=(C.devicePixelRatio||1)<=1?"translate("+p+"px, "+h+"px)":"translate3d("+p+"px, "+h+"px, 0)",T))}return Object.assign({},G,(e={},e[E]=y?h+"px":"",e[M]=x?p+"px":"",e.transform="",e))}function M3(t){var e=t.state,n=t.options,o=n.gpuAcceleration,r=o===void 0?!0:o,i=n.adaptive,a=i===void 0?!0:i,s=n.roundOffsets,c=s===void 0?!0:s,l={placement:gn(e.placement),variation:yo(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:r,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,nv(Object.assign({},l,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:a,roundOffsets:c})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,nv(Object.assign({},l,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:c})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}var $c={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:M3,data:{}};function L3(t){var e=t.state;Object.keys(e.elements).forEach(function(n){var o=e.styles[n]||{},r=e.attributes[n]||{},i=e.elements[n];!Ht(i)||!bn(i)||(Object.assign(i.style,o),Object.keys(r).forEach(function(a){var s=r[a];s===!1?i.removeAttribute(a):i.setAttribute(a,s===!0?"":s)}))})}function P3(t){var e=t.state,n={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,n.popper),e.styles=n,e.elements.arrow&&Object.assign(e.elements.arrow.style,n.arrow),function(){Object.keys(e.elements).forEach(function(o){var r=e.elements[o],i=e.attributes[o]||{},a=Object.keys(e.styles.hasOwnProperty(o)?e.styles[o]:n[o]),s=a.reduce(function(c,l){return c[l]="",c},{});!Ht(r)||!bn(r)||(Object.assign(r.style,s),Object.keys(i).forEach(function(c){r.removeAttribute(c)}))})}}var Zc={name:"applyStyles",enabled:!0,phase:"write",fn:L3,effect:P3,requires:["computeStyles"]};function B3(t,e,n){var o=gn(t),r=[Nt,Rt].indexOf(o)>=0?-1:1,i=typeof n=="function"?n(Object.assign({},e,{placement:t})):n,a=i[0],s=i[1];return a=a||0,s=(s||0)*r,[Nt,qt].indexOf(o)>=0?{x:s,y:a}:{x:a,y:s}}function j3(t){var e=t.state,n=t.options,o=t.name,r=n.offset,i=r===void 0?[0,0]:r,a=cv.reduce(function(u,d){return u[d]=B3(d,e.rects,i),u},{}),s=a[e.placement],c=s.x,l=s.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=c,e.modifiersData.popperOffsets.y+=l),e.modifiersData[o]=a}var hv={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:j3},U3={left:"right",right:"left",bottom:"top",top:"bottom"};function Ha(t){return t.replace(/left|right|bottom|top/g,function(e){return U3[e]})}var z3={start:"end",end:"start"};function rv(t){return t.replace(/start|end/g,function(e){return z3[e]})}function V3(t,e){e===void 0&&(e={});var n=e,o=n.placement,r=n.boundary,i=n.rootBoundary,a=n.padding,s=n.flipVariations,c=n.allowedAutoPlacements,l=c===void 0?cv:c,u=yo(o),d=u?s?$x:$x.filter(function(m){return yo(m)===u}):ui,f=d.filter(function(m){return l.indexOf(m)>=0});f.length===0&&(f=d);var p=f.reduce(function(m,h){return m[h]=wo(t,{placement:h,boundary:r,rootBoundary:i,padding:a})[gn(h)],m},{});return Object.keys(p).sort(function(m,h){return p[m]-p[h]})}function W3(t){if(gn(t)===Xc)return[];var e=Ha(t);return[rv(t),e,rv(e)]}function H3(t){var e=t.state,n=t.options,o=t.name;if(!e.modifiersData[o]._skip){for(var r=n.mainAxis,i=r===void 0?!0:r,a=n.altAxis,s=a===void 0?!0:a,c=n.fallbackPlacements,l=n.padding,u=n.boundary,d=n.rootBoundary,f=n.altBoundary,p=n.flipVariations,m=p===void 0?!0:p,h=n.allowedAutoPlacements,b=e.options.placement,x=gn(b),y=x===b,M=c||(y||!m?[Ha(b)]:W3(b)),E=[b].concat(M).reduce(function(ee,O){return ee.concat(gn(O)===Xc?V3(e,{placement:O,boundary:u,rootBoundary:d,padding:l,flipVariations:m,allowedAutoPlacements:h}):O)},[]),C=e.rects.reference,j=e.rects.popper,P=new Map,D=!0,N=E[0],S=0;S<E.length;S++){var G=E[S],v=gn(G),T=yo(G)===vo,R=[Rt,Gt].indexOf(v)>=0,A=R?"width":"height",U=wo(e,{placement:G,boundary:u,rootBoundary:d,altBoundary:f,padding:l}),k=R?T?qt:Nt:T?Gt:Rt;C[A]>j[A]&&(k=Ha(k));var w=Ha(k),I=[];if(i&&I.push(U[v]<=0),s&&I.push(U[k]<=0,U[w]<=0),I.every(function(ee){return ee})){N=G,D=!1;break}P.set(G,I)}if(D)for(var _=m?3:1,F=function(O){var B=E.find(function(V){var $=P.get(V);if($)return $.slice(0,O).every(function(te){return te})});if(B)return N=B,"break"},z=_;z>0;z--){var q=F(z);if(q==="break")break}e.placement!==N&&(e.modifiersData[o]._skip=!0,e.placement=N,e.reset=!0)}}var gv={name:"flip",enabled:!0,phase:"main",fn:H3,requiresIfExists:["offset"],data:{_skip:!1}};function G3(t){return t==="x"?"y":"x"}function si(t,e,n){return Tr(t,Ga(e,n))}function q3(t,e,n){var o=si(t,e,n);return o>n?n:o}function X3(t){var e=t.state,n=t.options,o=t.name,r=n.mainAxis,i=r===void 0?!0:r,a=n.altAxis,s=a===void 0?!1:a,c=n.boundary,l=n.rootBoundary,u=n.altBoundary,d=n.padding,f=n.tether,p=f===void 0?!0:f,m=n.tetherOffset,h=m===void 0?0:m,b=wo(e,{boundary:c,rootBoundary:l,padding:d,altBoundary:u}),x=gn(e.placement),y=yo(e.placement),M=!y,E=Yc(x),C=G3(E),j=e.modifiersData.popperOffsets,P=e.rects.reference,D=e.rects.popper,N=typeof h=="function"?h(Object.assign({},e.rects,{placement:e.placement})):h,S=typeof N=="number"?{mainAxis:N,altAxis:N}:Object.assign({mainAxis:0,altAxis:0},N),G=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,v={x:0,y:0};if(j){if(i){var T,R=E==="y"?Rt:Nt,A=E==="y"?Gt:qt,U=E==="y"?"height":"width",k=j[E],w=k+b[R],I=k-b[A],_=p?-D[U]/2:0,F=y===vo?P[U]:D[U],z=y===vo?-D[U]:-P[U],q=e.elements.arrow,ee=p&&q?qc(q):{width:0,height:0},O=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:fv(),B=O[R],V=O[A],$=si(0,P[U],ee[U]),te=M?P[U]/2-_-$-B-S.mainAxis:F-$-B-S.mainAxis,L=M?-P[U]/2+_+$+V+S.mainAxis:z+$+V+S.mainAxis,Z=e.elements.arrow&&ci(e.elements.arrow),ce=Z?E==="y"?Z.clientTop||0:Z.clientLeft||0:0,ke=(T=G==null?void 0:G[E])!=null?T:0,ve=k+te-ke-ce,re=k+L-ke,we=si(p?Ga(w,ve):w,k,p?Tr(I,re):I);j[E]=we,v[E]=we-k}if(s){var Te,Ae=E==="x"?Rt:Nt,je=E==="x"?Gt:qt,Re=j[C],et=C==="y"?"height":"width",Ge=Re+b[Ae],_t=Re-b[je],kt=[Rt,Nt].indexOf(x)!==-1,ct=(Te=G==null?void 0:G[C])!=null?Te:0,Ln=kt?Ge:Re-P[et]-D[et]-ct+S.altAxis,xn=kt?Re+P[et]+D[et]-ct-S.altAxis:_t,tn=p&&kt?q3(Ln,Re,xn):si(p?Ln:Ge,Re,p?xn:_t);j[C]=tn,v[C]=tn-Re}e.modifiersData[o]=v}}var bv={name:"preventOverflow",enabled:!0,phase:"main",fn:X3,requiresIfExists:["offset"]},Y3=function(e,n){return e=typeof e=="function"?e(Object.assign({},n.rects,{placement:n.placement})):e,pv(typeof e!="number"?e:mv(e,ui))};function Q3(t){var e,n=t.state,o=t.name,r=t.options,i=n.elements.arrow,a=n.modifiersData.popperOffsets,s=gn(n.placement),c=Yc(s),l=[Nt,qt].indexOf(s)>=0,u=l?"height":"width";if(!(!i||!a)){var d=Y3(r.padding,n),f=qc(i),p=c==="y"?Rt:Nt,m=c==="y"?Gt:qt,h=n.rects.reference[u]+n.rects.reference[c]-a[c]-n.rects.popper[u],b=a[c]-n.rects.reference[c],x=ci(i),y=x?c==="y"?x.clientHeight||0:x.clientWidth||0:0,M=h/2-b/2,E=d[p],C=y-f[u]-d[m],j=y/2-f[u]/2+M,P=si(E,j,C),D=c;n.modifiersData[o]=(e={},e[D]=P,e.centerOffset=P-j,e)}}function K3(t){var e=t.state,n=t.options,o=n.element,r=o===void 0?"[data-popper-arrow]":o;r!=null&&(typeof r=="string"&&(r=e.elements.popper.querySelector(r),!r)||uv(e.elements.popper,r)&&(e.elements.arrow=r))}var xv={name:"arrow",enabled:!0,phase:"main",fn:Q3,effect:K3,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function ov(t,e,n){return n===void 0&&(n={x:0,y:0}),{top:t.top-e.height-n.y,right:t.right-e.width+n.x,bottom:t.bottom-e.height+n.y,left:t.left-e.width-n.x}}function iv(t){return[Rt,qt,Gt,Nt].some(function(e){return t[e]>=0})}function J3(t){var e=t.state,n=t.name,o=e.rects.reference,r=e.rects.popper,i=e.modifiersData.preventOverflow,a=wo(e,{elementContext:"reference"}),s=wo(e,{altBoundary:!0}),c=ov(a,o),l=ov(s,r,i),u=iv(c),d=iv(l);e.modifiersData[n]={referenceClippingOffsets:c,popperEscapeOffsets:l,isReferenceHidden:u,hasPopperEscaped:d},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":u,"data-popper-escaped":d})}var vv={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:J3},$3=[Kc,Jc,$c,Zc],Z3=Qc({defaultModifiers:$3}),yv=[Kc,Jc,$c,Zc,hv,gv,bv,xv,vv],e5=Qc({defaultModifiers:yv});wt.applyStyles=Zc;wt.arrow=xv;wt.computeStyles=$c;wt.createPopper=e5;wt.createPopperLite=Z3;wt.defaultModifiers=yv;wt.detectOverflow=wo;wt.eventListeners=Kc;wt.flip=gv;wt.hide=vv;wt.offset=hv;wt.popperGenerator=Qc;wt.popperOffsets=Jc;wt.preventOverflow=bv});var _v=Xe((eu,tu)=>{(function(t,e){typeof eu=="object"&&typeof tu<"u"?tu.exports=e():typeof define=="function"&&define.amd?define(e):(t=typeof globalThis<"u"?globalThis:t||self,t.Data=e())})(eu,function(){"use strict";let t=new Map;return{set(n,o,r){t.has(n)||t.set(n,new Map);let i=t.get(n);if(!i.has(o)&&i.size!==0){console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(i.keys())[0]}.`);return}i.set(o,r)},get(n,o){return t.has(n)&&t.get(n).get(o)||null},remove(n,o){if(!t.has(n))return;let r=t.get(n);r.delete(o),r.size===0&&t.delete(n)}}})});var Sr=Xe((Xa,kv)=>{(function(t,e){typeof Xa=="object"&&typeof kv<"u"?e(Xa):typeof define=="function"&&define.amd?define(["exports"],e):(t=typeof globalThis<"u"?globalThis:t||self,e(t.Index={}))})(Xa,function(t){"use strict";let o="transitionend",r=D=>(D&&window.CSS&&window.CSS.escape&&(D=D.replace(/#([^\s"#']+)/g,(N,S)=>`#${CSS.escape(S)}`)),D),i=D=>D==null?`${D}`:Object.prototype.toString.call(D).match(/\s([a-z]+)/i)[1].toLowerCase(),a=D=>{do D+=Math.floor(Math.random()*1e6);while(document.getElementById(D));return D},s=D=>{if(!D)return 0;let{transitionDuration:N,transitionDelay:S}=window.getComputedStyle(D),G=Number.parseFloat(N),v=Number.parseFloat(S);return!G&&!v?0:(N=N.split(",")[0],S=S.split(",")[0],(Number.parseFloat(N)+Number.parseFloat(S))*1e3)},c=D=>{D.dispatchEvent(new Event(o))},l=D=>!D||typeof D!="object"?!1:(typeof D.jquery<"u"&&(D=D[0]),typeof D.nodeType<"u"),u=D=>l(D)?D.jquery?D[0]:D:typeof D=="string"&&D.length>0?document.querySelector(r(D)):null,d=D=>{if(!l(D)||D.getClientRects().length===0)return!1;let N=getComputedStyle(D).getPropertyValue("visibility")==="visible",S=D.closest("details:not([open])");if(!S)return N;if(S!==D){let G=D.closest("summary");if(G&&G.parentNode!==S||G===null)return!1}return N},f=D=>!D||D.nodeType!==Node.ELEMENT_NODE||D.classList.contains("disabled")?!0:typeof D.disabled<"u"?D.disabled:D.hasAttribute("disabled")&&D.getAttribute("disabled")!=="false",p=D=>{if(!document.documentElement.attachShadow)return null;if(typeof D.getRootNode=="function"){let N=D.getRootNode();return N instanceof ShadowRoot?N:null}return D instanceof ShadowRoot?D:D.parentNode?p(D.parentNode):null},m=()=>{},h=D=>{D.offsetHeight},b=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,x=[],y=D=>{document.readyState==="loading"?(x.length||document.addEventListener("DOMContentLoaded",()=>{for(let N of x)N()}),x.push(D)):D()},M=()=>document.documentElement.dir==="rtl",E=D=>{y(()=>{let N=b();if(N){let S=D.NAME,G=N.fn[S];N.fn[S]=D.jQueryInterface,N.fn[S].Constructor=D,N.fn[S].noConflict=()=>(N.fn[S]=G,D.jQueryInterface)}})},C=(D,N=[],S=D)=>typeof D=="function"?D(...N):S,j=(D,N,S=!0)=>{if(!S){C(D);return}let G=5,v=s(N)+G,T=!1,R=({target:A})=>{A===N&&(T=!0,N.removeEventListener(o,R),C(D))};N.addEventListener(o,R),setTimeout(()=>{T||c(N)},v)},P=(D,N,S,G)=>{let v=D.length,T=D.indexOf(N);return T===-1?!S&&G?D[v-1]:D[0]:(T+=S?1:-1,G&&(T=(T+v)%v),D[Math.max(0,Math.min(T,v-1))])};t.defineJQueryPlugin=E,t.execute=C,t.executeAfterTransition=j,t.findShadowRoot=p,t.getElement=u,t.getNextActiveElement=P,t.getTransitionDurationFromElement=s,t.getUID=a,t.getjQuery=b,t.isDisabled=f,t.isElement=l,t.isRTL=M,t.isVisible=d,t.noop=m,t.onDOMContentLoaded=y,t.parseSelector=r,t.reflow=h,t.toType=i,t.triggerTransitionEnd=c,Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})})});var ou=Xe((nu,ru)=>{(function(t,e){typeof nu=="object"&&typeof ru<"u"?ru.exports=e(Sr()):typeof define=="function"&&define.amd?define(["../util/index"],e):(t=typeof globalThis<"u"?globalThis:t||self,t.EventHandler=e(t.Index))})(nu,function(t){"use strict";let e=/[^.]*(?=\..*)\.|.*/,n=/\..*/,o=/::\d+$/,r={},i=1,a={mouseenter:"mouseover",mouseleave:"mouseout"},s=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function c(E,C){return C&&`${C}::${i++}`||E.uidEvent||i++}function l(E){let C=c(E);return E.uidEvent=C,r[C]=r[C]||{},r[C]}function u(E,C){return function j(P){return M(P,{delegateTarget:E}),j.oneOff&&y.off(E,P.type,C),C.apply(E,[P])}}function d(E,C,j){return function P(D){let N=E.querySelectorAll(C);for(let{target:S}=D;S&&S!==this;S=S.parentNode)for(let G of N)if(G===S)return M(D,{delegateTarget:S}),P.oneOff&&y.off(E,D.type,C,j),j.apply(S,[D])}}function f(E,C,j=null){return Object.values(E).find(P=>P.callable===C&&P.delegationSelector===j)}function p(E,C,j){let P=typeof C=="string",D=P?j:C||j,N=x(E);return s.has(N)||(N=E),[P,D,N]}function m(E,C,j,P,D){if(typeof C!="string"||!E)return;let[N,S,G]=p(C,j,P);C in a&&(S=(w=>function(I){if(!I.relatedTarget||I.relatedTarget!==I.delegateTarget&&!I.delegateTarget.contains(I.relatedTarget))return w.call(this,I)})(S));let v=l(E),T=v[G]||(v[G]={}),R=f(T,S,N?j:null);if(R){R.oneOff=R.oneOff&&D;return}let A=c(S,C.replace(e,"")),U=N?d(E,j,S):u(E,S);U.delegationSelector=N?j:null,U.callable=S,U.oneOff=D,U.uidEvent=A,T[A]=U,E.addEventListener(G,U,N)}function h(E,C,j,P,D){let N=f(C[j],P,D);N&&(E.removeEventListener(j,N,!!D),delete C[j][N.uidEvent])}function b(E,C,j,P){let D=C[j]||{};for(let[N,S]of Object.entries(D))N.includes(P)&&h(E,C,j,S.callable,S.delegationSelector)}function x(E){return E=E.replace(n,""),a[E]||E}let y={on(E,C,j,P){m(E,C,j,P,!1)},one(E,C,j,P){m(E,C,j,P,!0)},off(E,C,j,P){if(typeof C!="string"||!E)return;let[D,N,S]=p(C,j,P),G=S!==C,v=l(E),T=v[S]||{},R=C.startsWith(".");if(typeof N<"u"){if(!Object.keys(T).length)return;h(E,v,S,N,D?j:null);return}if(R)for(let A of Object.keys(v))b(E,v,A,C.slice(1));for(let[A,U]of Object.entries(T)){let k=A.replace(o,"");(!G||C.includes(k))&&h(E,v,S,U.callable,U.delegationSelector)}},trigger(E,C,j){if(typeof C!="string"||!E)return null;let P=t.getjQuery(),D=x(C),N=C!==D,S=null,G=!0,v=!0,T=!1;N&&P&&(S=P.Event(C,j),P(E).trigger(S),G=!S.isPropagationStopped(),v=!S.isImmediatePropagationStopped(),T=S.isDefaultPrevented());let R=M(new Event(C,{bubbles:G,cancelable:!0}),j);return T&&R.preventDefault(),v&&E.dispatchEvent(R),R.defaultPrevented&&S&&S.preventDefault(),R}};function M(E,C={}){for(let[j,P]of Object.entries(C))try{E[j]=P}catch{Object.defineProperty(E,j,{configurable:!0,get(){return P}})}return E}return y})});var su=Xe((iu,au)=>{(function(t,e){typeof iu=="object"&&typeof au<"u"?au.exports=e():typeof define=="function"&&define.amd?define(e):(t=typeof globalThis<"u"?globalThis:t||self,t.Manipulator=e())})(iu,function(){"use strict";function t(o){if(o==="true")return!0;if(o==="false")return!1;if(o===Number(o).toString())return Number(o);if(o===""||o==="null")return null;if(typeof o!="string")return o;try{return JSON.parse(decodeURIComponent(o))}catch{return o}}function e(o){return o.replace(/[A-Z]/g,r=>`-${r.toLowerCase()}`)}return{setDataAttribute(o,r,i){o.setAttribute(`data-bs-${e(r)}`,i)},removeDataAttribute(o,r){o.removeAttribute(`data-bs-${e(r)}`)},getDataAttributes(o){if(!o)return{};let r={},i=Object.keys(o.dataset).filter(a=>a.startsWith("bs")&&!a.startsWith("bsConfig"));for(let a of i){let s=a.replace(/^bs/,"");s=s.charAt(0).toLowerCase()+s.slice(1,s.length),r[s]=t(o.dataset[a])}return r},getDataAttribute(o,r){return t(o.getAttribute(`data-bs-${e(r)}`))}}})});var uu=Xe((lu,cu)=>{(function(t,e){typeof lu=="object"&&typeof cu<"u"?cu.exports=e(su(),Sr()):typeof define=="function"&&define.amd?define(["../dom/manipulator","./index"],e):(t=typeof globalThis<"u"?globalThis:t||self,t.Config=e(t.Manipulator,t.Index))})(lu,function(t,e){"use strict";class n{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(r){return r=this._mergeConfigObj(r),r=this._configAfterMerge(r),this._typeCheckConfig(r),r}_configAfterMerge(r){return r}_mergeConfigObj(r,i){let a=e.isElement(i)?t.getDataAttribute(i,"config"):{};return{...this.constructor.Default,...typeof a=="object"?a:{},...e.isElement(i)?t.getDataAttributes(i):{},...typeof r=="object"?r:{}}}_typeCheckConfig(r,i=this.constructor.DefaultType){for(let[a,s]of Object.entries(i)){let c=r[a],l=e.isElement(c)?"element":e.toType(c);if(!new RegExp(s).test(l))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${a}" provided type "${l}" but expected type "${s}".`)}}}return n})});var Tv=Xe((du,fu)=>{(function(t,e){typeof du=="object"&&typeof fu<"u"?fu.exports=e(_v(),ou(),uu(),Sr()):typeof define=="function"&&define.amd?define(["./dom/data","./dom/event-handler","./util/config","./util/index"],e):(t=typeof globalThis<"u"?globalThis:t||self,t.BaseComponent=e(t.Data,t.EventHandler,t.Config,t.Index))})(du,function(t,e,n,o){"use strict";let r="5.3.2";class i extends n{constructor(s,c){super(),s=o.getElement(s),s&&(this._element=s,this._config=this._getConfig(c),t.set(this._element,this.constructor.DATA_KEY,this))}dispose(){t.remove(this._element,this.constructor.DATA_KEY),e.off(this._element,this.constructor.EVENT_KEY);for(let s of Object.getOwnPropertyNames(this))this[s]=null}_queueCallback(s,c,l=!0){o.executeAfterTransition(s,c,l)}_getConfig(s){return s=this._mergeConfigObj(s,this._element),s=this._configAfterMerge(s),this._typeCheckConfig(s),s}static getInstance(s){return t.get(o.getElement(s),this.DATA_KEY)}static getOrCreateInstance(s,c={}){return this.getInstance(s)||new this(s,typeof c=="object"?c:null)}static get VERSION(){return r}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(s){return`${s}${this.EVENT_KEY}`}}return i})});var pu=Xe((Ya,Cv)=>{(function(t,e){typeof Ya=="object"&&typeof Cv<"u"?e(Ya):typeof define=="function"&&define.amd?define(["exports"],e):(t=typeof globalThis<"u"?globalThis:t||self,e(t.Sanitizer={}))})(Ya,function(t){"use strict";let n={"*":["class","dir","id","lang","role",/^aria-[\w-]*$/i],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],div:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},o=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),r=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:/?#]*(?:[/?#]|$))/i,i=(s,c)=>{let l=s.nodeName.toLowerCase();return c.includes(l)?o.has(l)?!!r.test(s.nodeValue):!0:c.filter(u=>u instanceof RegExp).some(u=>u.test(l))};function a(s,c,l){if(!s.length)return s;if(l&&typeof l=="function")return l(s);let d=new window.DOMParser().parseFromString(s,"text/html"),f=[].concat(...d.body.querySelectorAll("*"));for(let p of f){let m=p.nodeName.toLowerCase();if(!Object.keys(c).includes(m)){p.remove();continue}let h=[].concat(...p.attributes),b=[].concat(c["*"]||[],c[m]||[]);for(let x of h)i(x,b)||p.removeAttribute(x.nodeName)}return d.body.innerHTML}t.DefaultAllowlist=n,t.sanitizeHtml=a,Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})})});var Sv=Xe((mu,hu)=>{(function(t,e){typeof mu=="object"&&typeof hu<"u"?hu.exports=e(Sr()):typeof define=="function"&&define.amd?define(["../util/index"],e):(t=typeof globalThis<"u"?globalThis:t||self,t.SelectorEngine=e(t.Index))})(mu,function(t){"use strict";let e=o=>{let r=o.getAttribute("data-bs-target");if(!r||r==="#"){let i=o.getAttribute("href");if(!i||!i.includes("#")&&!i.startsWith("."))return null;i.includes("#")&&!i.startsWith("#")&&(i=`#${i.split("#")[1]}`),r=i&&i!=="#"?t.parseSelector(i.trim()):null}return r},n={find(o,r=document.documentElement){return[].concat(...Element.prototype.querySelectorAll.call(r,o))},findOne(o,r=document.documentElement){return Element.prototype.querySelector.call(r,o)},children(o,r){return[].concat(...o.children).filter(i=>i.matches(r))},parents(o,r){let i=[],a=o.parentNode.closest(r);for(;a;)i.push(a),a=a.parentNode.closest(r);return i},prev(o,r){let i=o.previousElementSibling;for(;i;){if(i.matches(r))return[i];i=i.previousElementSibling}return[]},next(o,r){let i=o.nextElementSibling;for(;i;){if(i.matches(r))return[i];i=i.nextElementSibling}return[]},focusableChildren(o){let r=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map(i=>`${i}:not([tabindex^="-"])`).join(",");return this.find(r,o).filter(i=>!t.isDisabled(i)&&t.isVisible(i))},getSelectorFromElement(o){let r=e(o);return r&&n.findOne(r)?r:null},getElementFromSelector(o){let r=e(o);return r?n.findOne(r):null},getMultipleElementsFromSelector(o){let r=e(o);return r?n.find(r):[]}};return n})});var Ev=Xe((gu,bu)=>{(function(t,e){typeof gu=="object"&&typeof bu<"u"?bu.exports=e(Sv(),uu(),pu(),Sr()):typeof define=="function"&&define.amd?define(["../dom/selector-engine","./config","./sanitizer","./index"],e):(t=typeof globalThis<"u"?globalThis:t||self,t.TemplateFactory=e(t.SelectorEngine,t.Config,t.Sanitizer,t.Index))})(gu,function(t,e,n,o){"use strict";let r="TemplateFactory",i={allowList:n.DefaultAllowlist,content:{},extraClass:"",html:!1,sanitize:!0,sanitizeFn:null,template:"<div></div>"},a={allowList:"object",content:"object",extraClass:"(string|function)",html:"boolean",sanitize:"boolean",sanitizeFn:"(null|function)",template:"string"},s={entry:"(string|element|function|null)",selector:"(string|element)"};class c extends e{constructor(u){super(),this._config=this._getConfig(u)}static get Default(){return i}static get DefaultType(){return a}static get NAME(){return r}getContent(){return Object.values(this._config.content).map(u=>this._resolvePossibleFunction(u)).filter(Boolean)}hasContent(){return this.getContent().length>0}changeContent(u){return this._checkContent(u),this._config.content={...this._config.content,...u},this}toHtml(){let u=document.createElement("div");u.innerHTML=this._maybeSanitize(this._config.template);for(let[p,m]of Object.entries(this._config.content))this._setContent(u,m,p);let d=u.children[0],f=this._resolvePossibleFunction(this._config.extraClass);return f&&d.classList.add(...f.split(" ")),d}_typeCheckConfig(u){super._typeCheckConfig(u),this._checkContent(u.content)}_checkContent(u){for(let[d,f]of Object.entries(u))super._typeCheckConfig({selector:d,entry:f},s)}_setContent(u,d,f){let p=t.findOne(f,u);if(p){if(d=this._resolvePossibleFunction(d),!d){p.remove();return}if(o.isElement(d)){this._putElementInTemplate(o.getElement(d),p);return}if(this._config.html){p.innerHTML=this._maybeSanitize(d);return}p.textContent=d}}_maybeSanitize(u){return this._config.sanitize?n.sanitizeHtml(u,this._config.allowList,this._config.sanitizeFn):u}_resolvePossibleFunction(u){return o.execute(u,[this])}_putElementInTemplate(u,d){if(this._config.html){d.innerHTML="",d.append(u);return}d.textContent=u.textContent}}return c})});var Ov=Xe((xu,vu)=>{(function(t,e){typeof xu=="object"&&typeof vu<"u"?vu.exports=e(wv(),Tv(),ou(),su(),Sr(),pu(),Ev()):typeof define=="function"&&define.amd?define(["@popperjs/core","./base-component","./dom/event-handler","./dom/manipulator","./util/index","./util/sanitizer","./util/template-factory"],e):(t=typeof globalThis<"u"?globalThis:t||self,t.Tooltip=e(t["@popperjs/core"],t.BaseComponent,t.EventHandler,t.Manipulator,t.Index,t.Sanitizer,t.TemplateFactory))})(xu,function(t,e,n,o,r,i,a){"use strict";function s(I){let _=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(I){for(let F in I)if(F!=="default"){let z=Object.getOwnPropertyDescriptor(I,F);Object.defineProperty(_,F,z.get?z:{enumerable:!0,get:()=>I[F]})}}return _.default=I,Object.freeze(_)}let c=s(t),l="tooltip",u=new Set(["sanitize","allowList","sanitizeFn"]),d="fade",f="modal",p="show",m=".tooltip-inner",h=`.${f}`,b="hide.bs.modal",x="hover",y="focus",M="click",E="manual",C="hide",j="hidden",P="show",D="shown",N="inserted",S="click",G="focusin",v="focusout",T="mouseenter",R="mouseleave",A={AUTO:"auto",TOP:"top",RIGHT:r.isRTL()?"left":"right",BOTTOM:"bottom",LEFT:r.isRTL()?"right":"left"},U={allowList:i.DefaultAllowlist,animation:!0,boundary:"clippingParents",container:!1,customClass:"",delay:0,fallbackPlacements:["top","right","bottom","left"],html:!1,offset:[0,6],placement:"top",popperConfig:null,sanitize:!0,sanitizeFn:null,selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',title:"",trigger:"hover focus"},k={allowList:"object",animation:"boolean",boundary:"(string|element)",container:"(string|element|boolean)",customClass:"(string|function)",delay:"(number|object)",fallbackPlacements:"array",html:"boolean",offset:"(array|string|function)",placement:"(string|function)",popperConfig:"(null|object|function)",sanitize:"boolean",sanitizeFn:"(null|function)",selector:"(string|boolean)",template:"string",title:"(string|element|function)",trigger:"string"};class w extends e{constructor(_,F){if(typeof c>"u")throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org)");super(_,F),this._isEnabled=!0,this._timeout=0,this._isHovered=null,this._activeTrigger={},this._popper=null,this._templateFactory=null,this._newContent=null,this.tip=null,this._setListeners(),this._config.selector||this._fixTitle()}static get Default(){return U}static get DefaultType(){return k}static get NAME(){return l}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(){if(this._isEnabled){if(this._activeTrigger.click=!this._activeTrigger.click,this._isShown()){this._leave();return}this._enter()}}dispose(){clearTimeout(this._timeout),n.off(this._element.closest(h),b,this._hideModalHandler),this._element.getAttribute("data-bs-original-title")&&this._element.setAttribute("title",this._element.getAttribute("data-bs-original-title")),this._disposePopper(),super.dispose()}show(){if(this._element.style.display==="none")throw new Error("Please use show on visible elements");if(!(this._isWithContent()&&this._isEnabled))return;let _=n.trigger(this._element,this.constructor.eventName(P)),z=(r.findShadowRoot(this._element)||this._element.ownerDocument.documentElement).contains(this._element);if(_.defaultPrevented||!z)return;this._disposePopper();let q=this._getTipElement();this._element.setAttribute("aria-describedby",q.getAttribute("id"));let{container:ee}=this._config;if(this._element.ownerDocument.documentElement.contains(this.tip)||(ee.append(q),n.trigger(this._element,this.constructor.eventName(N))),this._popper=this._createPopper(q),q.classList.add(p),"ontouchstart"in document.documentElement)for(let B of[].concat(...document.body.children))n.on(B,"mouseover",r.noop);let O=()=>{n.trigger(this._element,this.constructor.eventName(D)),this._isHovered===!1&&this._leave(),this._isHovered=!1};this._queueCallback(O,this.tip,this._isAnimated())}hide(){if(!this._isShown()||n.trigger(this._element,this.constructor.eventName(C)).defaultPrevented)return;if(this._getTipElement().classList.remove(p),"ontouchstart"in document.documentElement)for(let q of[].concat(...document.body.children))n.off(q,"mouseover",r.noop);this._activeTrigger[M]=!1,this._activeTrigger[y]=!1,this._activeTrigger[x]=!1,this._isHovered=null;let z=()=>{this._isWithActiveTrigger()||(this._isHovered||this._disposePopper(),this._element.removeAttribute("aria-describedby"),n.trigger(this._element,this.constructor.eventName(j)))};this._queueCallback(z,this.tip,this._isAnimated())}update(){this._popper&&this._popper.update()}_isWithContent(){return!!this._getTitle()}_getTipElement(){return this.tip||(this.tip=this._createTipElement(this._newContent||this._getContentForTemplate())),this.tip}_createTipElement(_){let F=this._getTemplateFactory(_).toHtml();if(!F)return null;F.classList.remove(d,p),F.classList.add(`bs-${this.constructor.NAME}-auto`);let z=r.getUID(this.constructor.NAME).toString();return F.setAttribute("id",z),this._isAnimated()&&F.classList.add(d),F}setContent(_){this._newContent=_,this._isShown()&&(this._disposePopper(),this.show())}_getTemplateFactory(_){return this._templateFactory?this._templateFactory.changeContent(_):this._templateFactory=new a({...this._config,content:_,extraClass:this._resolvePossibleFunction(this._config.customClass)}),this._templateFactory}_getContentForTemplate(){return{[m]:this._getTitle()}}_getTitle(){return this._resolvePossibleFunction(this._config.title)||this._element.getAttribute("data-bs-original-title")}_initializeOnDelegatedTarget(_){return this.constructor.getOrCreateInstance(_.delegateTarget,this._getDelegateConfig())}_isAnimated(){return this._config.animation||this.tip&&this.tip.classList.contains(d)}_isShown(){return this.tip&&this.tip.classList.contains(p)}_createPopper(_){let F=r.execute(this._config.placement,[this,_,this._element]),z=A[F.toUpperCase()];return c.createPopper(this._element,_,this._getPopperConfig(z))}_getOffset(){let{offset:_}=this._config;return typeof _=="string"?_.split(",").map(F=>Number.parseInt(F,10)):typeof _=="function"?F=>_(F,this._element):_}_resolvePossibleFunction(_){return r.execute(_,[this._element])}_getPopperConfig(_){let F={placement:_,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"preSetPlacement",enabled:!0,phase:"beforeMain",fn:z=>{this._getTipElement().setAttribute("data-popper-placement",z.state.placement)}}]};return{...F,...r.execute(this._config.popperConfig,[F])}}_setListeners(){let _=this._config.trigger.split(" ");for(let F of _)if(F==="click")n.on(this._element,this.constructor.eventName(S),this._config.selector,z=>{this._initializeOnDelegatedTarget(z).toggle()});else if(F!==E){let z=F===x?this.constructor.eventName(T):this.constructor.eventName(G),q=F===x?this.constructor.eventName(R):this.constructor.eventName(v);n.on(this._element,z,this._config.selector,ee=>{let O=this._initializeOnDelegatedTarget(ee);O._activeTrigger[ee.type==="focusin"?y:x]=!0,O._enter()}),n.on(this._element,q,this._config.selector,ee=>{let O=this._initializeOnDelegatedTarget(ee);O._activeTrigger[ee.type==="focusout"?y:x]=O._element.contains(ee.relatedTarget),O._leave()})}this._hideModalHandler=()=>{this._element&&this.hide()},n.on(this._element.closest(h),b,this._hideModalHandler)}_fixTitle(){let _=this._element.getAttribute("title");_&&(!this._element.getAttribute("aria-label")&&!this._element.textContent.trim()&&this._element.setAttribute("aria-label",_),this._element.setAttribute("data-bs-original-title",_),this._element.removeAttribute("title"))}_enter(){if(this._isShown()||this._isHovered){this._isHovered=!0;return}this._isHovered=!0,this._setTimeout(()=>{this._isHovered&&this.show()},this._config.delay.show)}_leave(){this._isWithActiveTrigger()||(this._isHovered=!1,this._setTimeout(()=>{this._isHovered||this.hide()},this._config.delay.hide))}_setTimeout(_,F){clearTimeout(this._timeout),this._timeout=setTimeout(_,F)}_isWithActiveTrigger(){return Object.values(this._activeTrigger).includes(!0)}_getConfig(_){let F=o.getDataAttributes(this._element);for(let z of Object.keys(F))u.has(z)&&delete F[z];return _={...F,...typeof _=="object"&&_?_:{}},_=this._mergeConfigObj(_),_=this._configAfterMerge(_),this._typeCheckConfig(_),_}_configAfterMerge(_){return _.container=_.container===!1?document.body:r.getElement(_.container),typeof _.delay=="number"&&(_.delay={show:_.delay,hide:_.delay}),typeof _.title=="number"&&(_.title=_.title.toString()),typeof _.content=="number"&&(_.content=_.content.toString()),_}_getDelegateConfig(){let _={};for(let[F,z]of Object.entries(this._config))this.constructor.Default[F]!==z&&(_[F]=z);return _.selector=!1,_.trigger="manual",_}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null),this.tip&&(this.tip.remove(),this.tip=null)}static jQueryInterface(_){return this.each(function(){let F=w.getOrCreateInstance(this,_);if(typeof _=="string"){if(typeof F[_]>"u")throw new TypeError(`No method named "${_}"`);F[_]()}})}}return r.defineJQueryPlugin(w),w})});var iO={};Ku(iO,{setupImageOcclusion:()=>Lu});var as={};function Se(t,e={}){var n;return(n=as.getMessage(t,e))!=null?n:`missing key: ${t}`}var Ee={};Ee.ABOUT="about";Ee.ACTIONS="actions";Ee.ADDING="adding";Ee.ADDONS="addons";Ee.BROWSING="browsing";Ee.CARD_STATS="card_stats";Ee.CARD_TEMPLATE_RENDERING="card_template_rendering";Ee.CARD_TEMPLATES="card_templates";Ee.CHANGE_NOTETYPE="change_notetype";Ee.CUSTOM_STUDY="custom_study";Ee.DATABASE_CHECK="database_check";Ee.DECK_CONFIG="deck_config";Ee.DECKS="decks";Ee.EDITING="editing";Ee.EMPTY_CARDS="empty_cards";Ee.ERRORS="errors";Ee.EXPORTING="exporting";Ee.FIELDS="fields";Ee.FINDREPLACE="findreplace";Ee.HELP="help";Ee.IMPORTING="importing";Ee.KEYBOARD="keyboard";Ee.MEDIA="media";Ee.MEDIA_CHECK="media_check";Ee.NETWORK="network";Ee.NOTETYPES="notetypes";Ee.PREFERENCES="preferences";Ee.PROFILES="profiles";Ee.QT_ACCEL="qt_accel";Ee.QT_MISC="qt_misc";Ee.SCHEDULING="scheduling";Ee.SEARCH="search";Ee.STATISTICS="statistics";Ee.STUDYING="studying";Ee.SYNC="sync";Ee.UNDO="undo";function ss(){return Se("actions-add")}function Zu(t){return Se("browsing-cards-updated",t)}function ed(){return Se("editing-bold-text")}function td(){return Se("editing-image-occlusion-align-bottom")}function nd(){return Se("editing-image-occlusion-align-h-center")}function rd(){return Se("editing-image-occlusion-align-left")}function od(){return Se("editing-image-occlusion-align-right")}function id(){return Se("editing-image-occlusion-align-top")}function ad(){return Se("editing-image-occlusion-align-v-center")}function sd(){return Se("editing-image-occlusion-alignment")}function ld(){return Se("editing-image-occlusion-delete")}function cd(){return Se("editing-image-occlusion-duplicate")}function ud(){return Se("editing-image-occlusion-ellipse-tool")}function dd(){return Se("editing-image-occlusion-group")}function fd(){return Se("editing-image-occlusion-mode")}function pd(){return Se("editing-image-occlusion-polygon-tool")}function md(){return Se("editing-image-occlusion-rectangle-tool")}function hd(){return Se("editing-image-occlusion-select-tool")}function gd(){return Se("editing-image-occlusion-text-tool")}function bd(){return Se("editing-image-occlusion-toggle-translucent")}function xd(){return Se("editing-image-occlusion-ungroup")}function vd(){return Se("editing-image-occlusion-zoom-in")}function yd(){return Se("editing-image-occlusion-zoom-out")}function wd(){return Se("editing-image-occlusion-zoom-reset")}function _d(){return Se("editing-image-occlusion-zoom-tool")}function kd(){return Se("editing-italic-text")}function ls(){return Se("editing-tags-add")}function Td(){return Se("editing-tags-copy")}function Cd(){return Se("editing-tags-remove")}function Sd(){return Se("editing-tags-select-all")}function Ed(){return Se("editing-underline-text")}function Od(t){return Se("importing-cards-added",t)}function cs(){return Se("importing-update")}function Ad(){return Se("keyboard-ctrl")}function Rd(){return Se("keyboard-shift")}function Nd(){return Se("notetypes-back-extra-field")}function Id(){return Se("notetypes-error-generating-cloze")}function Fd(){return Se("notetypes-error-getting-imagecloze")}function Dd(){return Se("notetypes-header")}function Md(){return Se("notetypes-hide-all-guess-one")}function Ld(){return Se("notetypes-hide-one-guess-one")}function Pd(){return Se("notetypes-occlusion-mask")}function Bd(){return Se("notetypes-occlusion-note")}function jd(){return Se("undo-redo")}function Ud(){return Se("undo-undo")}var Bn=class{constructor(e){this.value=e}valueOf(){return this.value}},Ke=class extends Bn{constructor(e="???"){super(e)}toString(e){return`{${this.value}}`}},bt=class extends Bn{constructor(e,n={}){super(e),this.opts=n}toString(e){try{return e.memoizeIntlObject(Intl.NumberFormat,this.opts).format(this.value)}catch(n){return e.reportError(n),this.value.toString(10)}}},on=class extends Bn{constructor(e,n={}){super(e),this.opts=n}toString(e){try{return e.memoizeIntlObject(Intl.DateTimeFormat,this.opts).format(this.value)}catch(n){return e.reportError(n),new Date(this.value).toISOString()}}};var zd=100,vy="\u2068",yy="\u2069";function wy(t,e,n){if(n===e||n instanceof bt&&e instanceof bt&&n.value===e.value)return!0;if(e instanceof bt&&typeof n=="string"){let o=t.memoizeIntlObject(Intl.PluralRules,e.opts).select(e.value);if(n===o)return!0}return!1}function Vd(t,e,n){return e[n]?Nr(t,e[n].value):(t.reportError(new RangeError("No default")),new Ke)}function us(t,e){let n=[],o=Object.create(null);for(let r of e)r.type==="narg"?o[r.name]=To(t,r.value):n.push(To(t,r));return{positional:n,named:o}}function To(t,e){switch(e.type){case"str":return e.value;case"num":return new bt(e.value,{minimumFractionDigits:e.precision});case"var":return _y(t,e);case"mesg":return ky(t,e);case"term":return Ty(t,e);case"func":return Cy(t,e);case"select":return Sy(t,e);default:return new Ke}}function _y(t,{name:e}){let n;if(t.params)if(Object.prototype.hasOwnProperty.call(t.params,e))n=t.params[e];else return new Ke(`$${e}`);else if(t.args&&Object.prototype.hasOwnProperty.call(t.args,e))n=t.args[e];else return t.reportError(new ReferenceError(`Unknown variable: $${e}`)),new Ke(`$${e}`);if(n instanceof Bn)return n;switch(typeof n){case"string":return n;case"number":return new bt(n);case"object":if(n instanceof Date)return new on(n.getTime());default:return t.reportError(new TypeError(`Variable type not supported: $${e}, ${typeof n}`)),new Ke(`$${e}`)}}function ky(t,{name:e,attr:n}){let o=t.bundle._messages.get(e);if(!o)return t.reportError(new ReferenceError(`Unknown message: ${e}`)),new Ke(e);if(n){let r=o.attributes[n];return r?Nr(t,r):(t.reportError(new ReferenceError(`Unknown attribute: ${n}`)),new Ke(`${e}.${n}`))}return o.value?Nr(t,o.value):(t.reportError(new ReferenceError(`No value: ${e}`)),new Ke(e))}function Ty(t,{name:e,attr:n,args:o}){let r=`-${e}`,i=t.bundle._terms.get(r);if(!i)return t.reportError(new ReferenceError(`Unknown term: ${r}`)),new Ke(r);if(n){let s=i.attributes[n];if(s){t.params=us(t,o).named;let c=Nr(t,s);return t.params=null,c}return t.reportError(new ReferenceError(`Unknown attribute: ${n}`)),new Ke(`${r}.${n}`)}t.params=us(t,o).named;let a=Nr(t,i.value);return t.params=null,a}function Cy(t,{name:e,args:n}){let o=t.bundle._functions[e];if(!o)return t.reportError(new ReferenceError(`Unknown function: ${e}()`)),new Ke(`${e}()`);if(typeof o!="function")return t.reportError(new TypeError(`Function ${e}() is not callable`)),new Ke(`${e}()`);try{let r=us(t,n);return o(r.positional,r.named)}catch(r){return t.reportError(r),new Ke(`${e}()`)}}function Sy(t,{selector:e,variants:n,star:o}){let r=To(t,e);if(r instanceof Ke)return Vd(t,n,o);for(let i of n){let a=To(t,i.key);if(wy(t,r,a))return Nr(t,i.value)}return Vd(t,n,o)}function ds(t,e){if(t.dirty.has(e))return t.reportError(new RangeError("Cyclic reference")),new Ke;t.dirty.add(e);let n=[],o=t.bundle._useIsolating&&e.length>1;for(let r of e){if(typeof r=="string"){n.push(t.bundle._transform(r));continue}if(t.placeables++,t.placeables>zd)throw t.dirty.delete(e),new RangeError(`Too many placeables expanded: ${t.placeables}, max allowed is ${zd}`);o&&n.push(vy),n.push(To(t,r).toString(t)),o&&n.push(yy)}return t.dirty.delete(e),n.join("")}function Nr(t,e){return typeof e=="string"?t.bundle._transform(e):ds(t,e)}var vi=class{constructor(e,n,o){this.dirty=new WeakSet,this.params=null,this.placeables=0,this.bundle=e,this.errors=n,this.args=o}reportError(e){if(!this.errors||!(e instanceof Error))throw e;this.errors.push(e)}memoizeIntlObject(e,n){let o=this.bundle._intls.get(e);o||(o={},this.bundle._intls.set(e,o));let r=JSON.stringify(n);return o[r]||(o[r]=new e(this.bundle.locales,n)),o[r]}};function yi(t,e){let n=Object.create(null);for(let[o,r]of Object.entries(t))e.includes(o)&&(n[o]=r.valueOf());return n}var Wd=["unitDisplay","currencyDisplay","useGrouping","minimumIntegerDigits","minimumFractionDigits","maximumFractionDigits","minimumSignificantDigits","maximumSignificantDigits"];function Gd(t,e){let n=t[0];if(n instanceof Ke)return new Ke(`NUMBER(${n.valueOf()})`);if(n instanceof bt)return new bt(n.valueOf(),{...n.opts,...yi(e,Wd)});if(n instanceof on)return new bt(n.valueOf(),{...yi(e,Wd)});throw new TypeError("Invalid argument to NUMBER")}var Hd=["dateStyle","timeStyle","fractionalSecondDigits","dayPeriod","hour12","weekday","era","year","month","day","hour","minute","second","timeZoneName"];function qd(t,e){let n=t[0];if(n instanceof Ke)return new Ke(`DATETIME(${n.valueOf()})`);if(n instanceof on)return new on(n.valueOf(),{...n.opts,...yi(e,Hd)});if(n instanceof bt)return new on(n.valueOf(),{...yi(e,Hd)});throw new TypeError("Invalid argument to DATETIME")}var Xd=new Map;function Yd(t){let e=Array.isArray(t)?t.join(" "):t,n=Xd.get(e);return n===void 0&&(n=new Map,Xd.set(e,n)),n}var Co=class{constructor(e,{functions:n,useIsolating:o=!0,transform:r=i=>i}={}){this._terms=new Map,this._messages=new Map,this.locales=Array.isArray(e)?e:[e],this._functions={NUMBER:Gd,DATETIME:qd,...n},this._useIsolating=o,this._transform=r,this._intls=Yd(e)}hasMessage(e){return this._messages.has(e)}getMessage(e){return this._messages.get(e)}addResource(e,{allowOverrides:n=!1}={}){let o=[];for(let r=0;r<e.body.length;r++){let i=e.body[r];if(i.id.startsWith("-")){if(n===!1&&this._terms.has(i.id)){o.push(new Error(`Attempt to override an existing term: "${i.id}"`));continue}this._terms.set(i.id,i)}else{if(n===!1&&this._messages.has(i.id)){o.push(new Error(`Attempt to override an existing message: "${i.id}"`));continue}this._messages.set(i.id,i)}}return o}formatPattern(e,n=null,o=null){if(typeof e=="string")return this._transform(e);let r=new vi(this,o,n);try{return ds(r,e).toString(r)}catch(i){if(r.errors&&i instanceof Error)return r.errors.push(i),new Ke().toString(r);throw i}}};var fs=/^(-?[a-zA-Z][\w-]*) *= */gm,Qd=/\.([a-zA-Z][\w-]*) *= */y,Ey=/\*?\[/y,ps=/(-?[0-9]+(?:\.([0-9]+))?)/y,Oy=/([a-zA-Z][\w-]*)/y,Kd=/([$-])?([a-zA-Z][\w-]*)(?:\.([a-zA-Z][\w-]*))?/y,Ay=/^[A-Z][A-Z0-9_-]*$/,wi=/([^{}\n\r]+)/y,Ry=/([^\\"\n\r]*)/y,Jd=/\\([\\"])/y,$d=/\\u([a-fA-F0-9]{4})|\\U([a-fA-F0-9]{6})/y,Ny=/^\n+/,Zd=/ +$/,Iy=/ *\r?\n/g,Fy=/( *)$/,Dy=/{\s*/y,ef=/\s*}/y,My=/\[\s*/y,Ly=/\s*] */y,Py=/\s*\(\s*/y,By=/\s*->\s*/y,jy=/\s*:\s*/y,Uy=/\s*,?\s*/y,zy=/\s+/y,So=class{constructor(e){this.body=[],fs.lastIndex=0;let n=0;for(;;){let N=fs.exec(e);if(N===null)break;n=fs.lastIndex;try{this.body.push(c(N[1]))}catch(S){if(S instanceof SyntaxError)continue;throw S}}function o(N){return N.lastIndex=n,N.test(e)}function r(N,S){if(e[n]===N)return n++,!0;if(S)throw new S(`Expected ${N}`);return!1}function i(N,S){if(o(N))return n=N.lastIndex,!0;if(S)throw new S(`Expected ${N.toString()}`);return!1}function a(N){N.lastIndex=n;let S=N.exec(e);if(S===null)throw new SyntaxError(`Expected ${N.toString()}`);return n=N.lastIndex,S}function s(N){return a(N)[1]}function c(N){let S=u(),G=l();if(S===null&&Object.keys(G).length===0)throw new SyntaxError("Expected message value or attributes");return{id:N,value:S,attributes:G}}function l(){let N=Object.create(null);for(;o(Qd);){let S=s(Qd),G=u();if(G===null)throw new SyntaxError("Expected attribute value");N[S]=G}return N}function u(){let N;if(o(wi)&&(N=s(wi)),e[n]==="{"||e[n]==="}")return d(N?[N]:[],1/0);let S=j();return S?N?d([N,S],S.length):(S.value=P(S.value,Ny),d([S],S.length)):N?P(N,Zd):null}function d(N=[],S){for(;;){if(o(wi)){N.push(s(wi));continue}if(e[n]==="{"){N.push(f());continue}if(e[n]==="}")throw new SyntaxError("Unbalanced closing brace");let R=j();if(R){N.push(R),S=Math.min(S,R.length);continue}break}let G=N.length-1,v=N[G];typeof v=="string"&&(N[G]=P(v,Zd));let T=[];for(let R of N)R instanceof _i&&(R=R.value.slice(0,R.value.length-S)),R&&T.push(R);return T}function f(){i(Dy,SyntaxError);let N=p();if(i(ef))return N;if(i(By)){let S=b();return i(ef,SyntaxError),{type:"select",selector:N,...S}}throw new SyntaxError("Unclosed placeable")}function p(){if(e[n]==="{")return f();if(o(Kd)){let[,N,S,G=null]=a(Kd);if(N==="$")return{type:"var",name:S};if(i(Py)){let v=m();if(N==="-")return{type:"term",name:S,attr:G,args:v};if(Ay.test(S))return{type:"func",name:S,args:v};throw new SyntaxError("Function names must be all upper-case")}return N==="-"?{type:"term",name:S,attr:G,args:[]}:{type:"mesg",name:S,attr:G}}return y()}function m(){let N=[];for(;;){switch(e[n]){case")":return n++,N;case void 0:throw new SyntaxError("Unclosed argument list")}N.push(h()),i(Uy)}}function h(){let N=p();return N.type!=="mesg"?N:i(jy)?{type:"narg",name:N.name,value:y()}:N}function b(){let N=[],S=0,G;for(;o(Ey);){r("*")&&(G=S);let v=x(),T=u();if(T===null)throw new SyntaxError("Expected variant value");N[S++]={key:v,value:T}}if(S===0)return null;if(G===void 0)throw new SyntaxError("Expected default variant");return{variants:N,star:G}}function x(){i(My,SyntaxError);let N;return o(ps)?N=M():N={type:"str",value:s(Oy)},i(Ly,SyntaxError),N}function y(){if(o(ps))return M();if(e[n]==='"')return E();throw new SyntaxError("Invalid expression")}function M(){let[,N,S=""]=a(ps),G=S.length;return{type:"num",value:parseFloat(N),precision:G}}function E(){r('"',SyntaxError);let N="";for(;;){if(N+=s(Ry),e[n]==="\\"){N+=C();continue}if(r('"'))return{type:"str",value:N};throw new SyntaxError("Unclosed string literal")}}function C(){if(o(Jd))return s(Jd);if(o($d)){let[,N,S]=a($d),G=parseInt(N||S,16);return G<=55295||57344<=G?String.fromCodePoint(G):"\uFFFD"}throw new SyntaxError("Unknown escape sequence")}function j(){let N=n;switch(i(zy),e[n]){case".":case"[":case"*":case"}":case void 0:return!1;case"{":return D(e.slice(N,n))}return e[n-1]===" "?D(e.slice(N,n)):!1}function P(N,S){return N.replace(S,"")}function D(N){let S=N.replace(Iy,`
`),G=Fy.exec(N)[1].length;return new _i(S,G)}}},_i=class{constructor(e,n){this.value=e,this.length=n}};var ms=[];function tf(t){ms=t}function nf(){return ms[0].locales[0]}function Vy(t){return new bt(t,{maximumFractionDigits:2})}function Wy(t){let e=Object.entries(t).map(([o,r])=>[o,typeof r=="number"?Vy(r):r]),n={};for(let[o,r]of e)n[o]=r;return n}function rf(t,e={}){for(let n of ms){let o=n.getMessage(t);if(o&&o.value)return n.formatPattern(o.value,Wy(e))}return null}var MF=gt(xf());var cr=gt(wf());function st(t,e){if(!t)throw new Error(e)}var g0=34028234663852886e22,b0=-34028234663852886e22,x0=4294967295,v0=2147483647,y0=-2147483648;function Ir(t){if(typeof t!="number")throw new Error("invalid int 32: "+typeof t);if(!Number.isInteger(t)||t>v0||t<y0)throw new Error("invalid int 32: "+t)}function Ao(t){if(typeof t!="number")throw new Error("invalid uint 32: "+typeof t);if(!Number.isInteger(t)||t>x0||t<0)throw new Error("invalid uint 32: "+t)}function Ti(t){if(typeof t!="number")throw new Error("invalid float 32: "+typeof t);if(Number.isFinite(t)&&(t>g0||t<b0))throw new Error("invalid float 32: "+t)}var _f=Symbol("@bufbuild/protobuf/enum-type");function kf(t){let e=t[_f];return st(e,"missing enum type on enum object"),e}function ks(t,e,n,o){t[_f]=Ts(e,n.map(r=>({no:r.no,name:r.name,localName:t[r.no]})),o)}function Ts(t,e,n){let o=Object.create(null),r=Object.create(null),i=[];for(let a of e){let s=Cf(a);i.push(s),o[a.name]=s,r[a.no]=s}return{typeName:t,values:i,findName(a){return o[a]},findNumber(a){return r[a]}}}function Tf(t,e,n){let o={};for(let r of e){let i=Cf(r);o[i.localName]=i.no,o[i.no]=i.localName}return ks(o,t,e,n),o}function Cf(t){return"localName"in t?t:Object.assign(Object.assign({},t),{localName:t.name})}var Vt=class{equals(e){return this.getType().runtime.util.equals(this.getType(),this,e)}clone(){return this.getType().runtime.util.clone(this)}fromBinary(e,n){let o=this.getType(),r=o.runtime.bin,i=r.makeReadOptions(n);return r.readMessage(this,i.readerFactory(e),e.byteLength,i),this}fromJson(e,n){let o=this.getType(),r=o.runtime.json,i=r.makeReadOptions(n);return r.readMessage(o,e,i,this),this}fromJsonString(e,n){let o;try{o=JSON.parse(e)}catch(r){throw new Error(`cannot decode ${this.getType().typeName} from JSON: ${r instanceof Error?r.message:String(r)}`)}return this.fromJson(o,n)}toBinary(e){let n=this.getType(),o=n.runtime.bin,r=o.makeWriteOptions(e),i=r.writerFactory();return o.writeMessage(this,i,r),i.finish()}toJson(e){let n=this.getType(),o=n.runtime.json,r=o.makeWriteOptions(e);return o.writeMessage(this,r)}toJsonString(e){var n;let o=this.toJson(e);return JSON.stringify(o,null,(n=e==null?void 0:e.prettySpaces)!==null&&n!==void 0?n:0)}toJSON(){return this.toJson({emitDefaultValues:!0})}getType(){return Object.getPrototypeOf(this).constructor}};function Sf(t,e,n,o){var r;let i=(r=o==null?void 0:o.localName)!==null&&r!==void 0?r:e.substring(e.lastIndexOf(".")+1),a={[i]:function(s){t.util.initFields(this),t.util.initPartial(s,this)}}[i];return Object.setPrototypeOf(a.prototype,new Vt),Object.assign(a,{runtime:t,typeName:e,fields:t.util.newFieldList(n),fromBinary(s,c){return new a().fromBinary(s,c)},fromJson(s,c){return new a().fromJson(s,c)},fromJsonString(s,c){return new a().fromJsonString(s,c)},equals(s,c){return t.util.equals(a,s,c)}}),a}function Ef(t,e,n,o){return{syntax:t,json:e,bin:n,util:o,makeMessageType(r,i,a){return Sf(this,r,i,a)},makeEnum:Tf,makeEnumType:Ts,getEnumType:kf}}var oe;(function(t){t[t.DOUBLE=1]="DOUBLE",t[t.FLOAT=2]="FLOAT",t[t.INT64=3]="INT64",t[t.UINT64=4]="UINT64",t[t.INT32=5]="INT32",t[t.FIXED64=6]="FIXED64",t[t.FIXED32=7]="FIXED32",t[t.BOOL=8]="BOOL",t[t.STRING=9]="STRING",t[t.BYTES=12]="BYTES",t[t.UINT32=13]="UINT32",t[t.SFIXED32=15]="SFIXED32",t[t.SFIXED64=16]="SFIXED64",t[t.SINT32=17]="SINT32",t[t.SINT64=18]="SINT64"})(oe||(oe={}));var an;(function(t){t[t.BIGINT=0]="BIGINT",t[t.STRING=1]="STRING"})(an||(an={}));function Af(){let t=0,e=0;for(let o=0;o<28;o+=7){let r=this.buf[this.pos++];if(t|=(r&127)<<o,!(r&128))return this.assertBounds(),[t,e]}let n=this.buf[this.pos++];if(t|=(n&15)<<28,e=(n&112)>>4,!(n&128))return this.assertBounds(),[t,e];for(let o=3;o<=31;o+=7){let r=this.buf[this.pos++];if(e|=(r&127)<<o,!(r&128))return this.assertBounds(),[t,e]}throw new Error("invalid varint")}function Si(t,e,n){for(let i=0;i<28;i=i+7){let a=t>>>i,s=!(!(a>>>7)&&e==0),c=(s?a|128:a)&255;if(n.push(c),!s)return}let o=t>>>28&15|(e&7)<<4,r=!!(e>>3);if(n.push((r?o|128:o)&255),!!r){for(let i=3;i<31;i=i+7){let a=e>>>i,s=!!(a>>>7),c=(s?a|128:a)&255;if(n.push(c),!s)return}n.push(e>>>31&1)}}var Ci=4294967296;function Cs(t){let e=t[0]==="-";e&&(t=t.slice(1));let n=1e6,o=0,r=0;function i(a,s){let c=Number(t.slice(a,s));r*=n,o=o*n+c,o>=Ci&&(r=r+(o/Ci|0),o=o%Ci)}return i(-24,-18),i(-18,-12),i(-12,-6),i(-6),e?Nf(o,r):Es(o,r)}function Rf(t,e){let n=Es(t,e),o=n.hi&2147483648;o&&(n=Nf(n.lo,n.hi));let r=Ss(n.lo,n.hi);return o?"-"+r:r}function Ss(t,e){if({lo:t,hi:e}=w0(t,e),e<=2097151)return String(Ci*e+t);let n=t&16777215,o=(t>>>24|e<<8)&16777215,r=e>>16&65535,i=n+o*6777216+r*6710656,a=o+r*8147497,s=r*2,c=1e7;return i>=c&&(a+=Math.floor(i/c),i%=c),a>=c&&(s+=Math.floor(a/c),a%=c),s.toString()+Of(a)+Of(i)}function w0(t,e){return{lo:t>>>0,hi:e>>>0}}function Es(t,e){return{lo:t|0,hi:e|0}}function Nf(t,e){return e=~e,t?t=~t+1:e+=1,Es(t,e)}var Of=t=>{let e=String(t);return"0000000".slice(e.length)+e};function Os(t,e){if(t>=0){for(;t>127;)e.push(t&127|128),t=t>>>7;e.push(t)}else{for(let n=0;n<9;n++)e.push(t&127|128),t=t>>7;e.push(1)}}function If(){let t=this.buf[this.pos++],e=t&127;if(!(t&128))return this.assertBounds(),e;if(t=this.buf[this.pos++],e|=(t&127)<<7,!(t&128))return this.assertBounds(),e;if(t=this.buf[this.pos++],e|=(t&127)<<14,!(t&128))return this.assertBounds(),e;if(t=this.buf[this.pos++],e|=(t&127)<<21,!(t&128))return this.assertBounds(),e;t=this.buf[this.pos++],e|=(t&15)<<28;for(let n=5;t&128&&n<10;n++)t=this.buf[this.pos++];if(t&128)throw new Error("invalid varint");return this.assertBounds(),e>>>0}function _0(){let t=new DataView(new ArrayBuffer(8));if(typeof BigInt=="function"&&typeof t.getBigInt64=="function"&&typeof t.getBigUint64=="function"&&typeof t.setBigInt64=="function"&&typeof t.setBigUint64=="function"&&(typeof process!="object"||typeof process.env!="object"||process.env.BUF_BIGINT_DISABLE!=="1")){let r=BigInt("-9223372036854775808"),i=BigInt("9223372036854775807"),a=BigInt("0"),s=BigInt("18446744073709551615");return{zero:BigInt(0),supported:!0,parse(c){let l=typeof c=="bigint"?c:BigInt(c);if(l>i||l<r)throw new Error(`int64 invalid: ${c}`);return l},uParse(c){let l=typeof c=="bigint"?c:BigInt(c);if(l>s||l<a)throw new Error(`uint64 invalid: ${c}`);return l},enc(c){return t.setBigInt64(0,this.parse(c),!0),{lo:t.getInt32(0,!0),hi:t.getInt32(4,!0)}},uEnc(c){return t.setBigInt64(0,this.uParse(c),!0),{lo:t.getInt32(0,!0),hi:t.getInt32(4,!0)}},dec(c,l){return t.setInt32(0,c,!0),t.setInt32(4,l,!0),t.getBigInt64(0,!0)},uDec(c,l){return t.setInt32(0,c,!0),t.setInt32(4,l,!0),t.getBigUint64(0,!0)}}}let n=r=>st(/^-?[0-9]+$/.test(r),`int64 invalid: ${r}`),o=r=>st(/^[0-9]+$/.test(r),`uint64 invalid: ${r}`);return{zero:"0",supported:!1,parse(r){return typeof r!="string"&&(r=r.toString()),n(r),r},uParse(r){return typeof r!="string"&&(r=r.toString()),o(r),r},enc(r){return typeof r!="string"&&(r=r.toString()),n(r),Cs(r)},uEnc(r){return typeof r!="string"&&(r=r.toString()),o(r),Cs(r)},dec(r,i){return Rf(r,i)},uDec(r,i){return Ss(r,i)}}}var dt=_0();var nt;(function(t){t[t.Varint=0]="Varint",t[t.Bit64=1]="Bit64",t[t.LengthDelimited=2]="LengthDelimited",t[t.StartGroup=3]="StartGroup",t[t.EndGroup=4]="EndGroup",t[t.Bit32=5]="Bit32"})(nt||(nt={}));var Ei=class{constructor(e){this.stack=[],this.textEncoder=e!=null?e:new TextEncoder,this.chunks=[],this.buf=[]}finish(){this.chunks.push(new Uint8Array(this.buf));let e=0;for(let r=0;r<this.chunks.length;r++)e+=this.chunks[r].length;let n=new Uint8Array(e),o=0;for(let r=0;r<this.chunks.length;r++)n.set(this.chunks[r],o),o+=this.chunks[r].length;return this.chunks=[],n}fork(){return this.stack.push({chunks:this.chunks,buf:this.buf}),this.chunks=[],this.buf=[],this}join(){let e=this.finish(),n=this.stack.pop();if(!n)throw new Error("invalid state, fork stack empty");return this.chunks=n.chunks,this.buf=n.buf,this.uint32(e.byteLength),this.raw(e)}tag(e,n){return this.uint32((e<<3|n)>>>0)}raw(e){return this.buf.length&&(this.chunks.push(new Uint8Array(this.buf)),this.buf=[]),this.chunks.push(e),this}uint32(e){for(Ao(e);e>127;)this.buf.push(e&127|128),e=e>>>7;return this.buf.push(e),this}int32(e){return Ir(e),Os(e,this.buf),this}bool(e){return this.buf.push(e?1:0),this}bytes(e){return this.uint32(e.byteLength),this.raw(e)}string(e){let n=this.textEncoder.encode(e);return this.uint32(n.byteLength),this.raw(n)}float(e){Ti(e);let n=new Uint8Array(4);return new DataView(n.buffer).setFloat32(0,e,!0),this.raw(n)}double(e){let n=new Uint8Array(8);return new DataView(n.buffer).setFloat64(0,e,!0),this.raw(n)}fixed32(e){Ao(e);let n=new Uint8Array(4);return new DataView(n.buffer).setUint32(0,e,!0),this.raw(n)}sfixed32(e){Ir(e);let n=new Uint8Array(4);return new DataView(n.buffer).setInt32(0,e,!0),this.raw(n)}sint32(e){return Ir(e),e=(e<<1^e>>31)>>>0,Os(e,this.buf),this}sfixed64(e){let n=new Uint8Array(8),o=new DataView(n.buffer),r=dt.enc(e);return o.setInt32(0,r.lo,!0),o.setInt32(4,r.hi,!0),this.raw(n)}fixed64(e){let n=new Uint8Array(8),o=new DataView(n.buffer),r=dt.uEnc(e);return o.setInt32(0,r.lo,!0),o.setInt32(4,r.hi,!0),this.raw(n)}int64(e){let n=dt.enc(e);return Si(n.lo,n.hi,this.buf),this}sint64(e){let n=dt.enc(e),o=n.hi>>31,r=n.lo<<1^o,i=(n.hi<<1|n.lo>>>31)^o;return Si(r,i,this.buf),this}uint64(e){let n=dt.uEnc(e);return Si(n.lo,n.hi,this.buf),this}},Oi=class{constructor(e,n){this.varint64=Af,this.uint32=If,this.buf=e,this.len=e.length,this.pos=0,this.view=new DataView(e.buffer,e.byteOffset,e.byteLength),this.textDecoder=n!=null?n:new TextDecoder}tag(){let e=this.uint32(),n=e>>>3,o=e&7;if(n<=0||o<0||o>5)throw new Error("illegal tag: field no "+n+" wire type "+o);return[n,o]}skip(e){let n=this.pos;switch(e){case nt.Varint:for(;this.buf[this.pos++]&128;);break;case nt.Bit64:this.pos+=4;case nt.Bit32:this.pos+=4;break;case nt.LengthDelimited:let o=this.uint32();this.pos+=o;break;case nt.StartGroup:let r;for(;(r=this.tag()[1])!==nt.EndGroup;)this.skip(r);break;default:throw new Error("cant skip wire type "+e)}return this.assertBounds(),this.buf.subarray(n,this.pos)}assertBounds(){if(this.pos>this.len)throw new RangeError("premature EOF")}int32(){return this.uint32()|0}sint32(){let e=this.uint32();return e>>>1^-(e&1)}int64(){return dt.dec(...this.varint64())}uint64(){return dt.uDec(...this.varint64())}sint64(){let[e,n]=this.varint64(),o=-(e&1);return e=(e>>>1|(n&1)<<31)^o,n=n>>>1^o,dt.dec(e,n)}bool(){let[e,n]=this.varint64();return e!==0||n!==0}fixed32(){return this.view.getUint32((this.pos+=4)-4,!0)}sfixed32(){return this.view.getInt32((this.pos+=4)-4,!0)}fixed64(){return dt.uDec(this.sfixed32(),this.sfixed32())}sfixed64(){return dt.dec(this.sfixed32(),this.sfixed32())}float(){return this.view.getFloat32((this.pos+=4)-4,!0)}double(){return this.view.getFloat64((this.pos+=8)-8,!0)}bytes(){let e=this.uint32(),n=this.pos;return this.pos+=e,this.assertBounds(),this.buf.subarray(n,n+e)}string(){return this.textDecoder.decode(this.bytes())}};function Ro(t,e){return e instanceof Vt||!t.fieldWrapper?e:t.fieldWrapper.wrapField(e)}var $O={"google.protobuf.DoubleValue":oe.DOUBLE,"google.protobuf.FloatValue":oe.FLOAT,"google.protobuf.Int64Value":oe.INT64,"google.protobuf.UInt64Value":oe.UINT64,"google.protobuf.Int32Value":oe.INT32,"google.protobuf.UInt32Value":oe.UINT32,"google.protobuf.BoolValue":oe.BOOL,"google.protobuf.StringValue":oe.STRING,"google.protobuf.BytesValue":oe.BYTES};function yn(t,e,n){if(e===n)return!0;if(t==oe.BYTES){if(!(e instanceof Uint8Array)||!(n instanceof Uint8Array)||e.length!==n.length)return!1;for(let o=0;o<e.length;o++)if(e[o]!==n[o])return!1;return!0}switch(t){case oe.UINT64:case oe.FIXED64:case oe.INT64:case oe.SFIXED64:case oe.SINT64:return e==n}return!1}function No(t,e){switch(t){case oe.BOOL:return!1;case oe.UINT64:case oe.FIXED64:case oe.INT64:case oe.SFIXED64:case oe.SINT64:return e==0?dt.zero:"0";case oe.DOUBLE:case oe.FLOAT:return 0;case oe.BYTES:return new Uint8Array(0);case oe.STRING:return"";default:return 0}}function As(t,e){let n=e===void 0,o=nt.Varint,r=e===0;switch(t){case oe.STRING:r=n||!e.length,o=nt.LengthDelimited;break;case oe.BOOL:r=e===!1;break;case oe.DOUBLE:o=nt.Bit64;break;case oe.FLOAT:o=nt.Bit32;break;case oe.INT64:r=n||e==0;break;case oe.UINT64:r=n||e==0;break;case oe.FIXED64:r=n||e==0,o=nt.Bit64;break;case oe.BYTES:r=n||!e.byteLength,o=nt.LengthDelimited;break;case oe.FIXED32:o=nt.Bit32;break;case oe.SFIXED32:o=nt.Bit32;break;case oe.SFIXED64:r=n||e==0,o=nt.Bit64;break;case oe.SINT64:r=n||e==0;break}let i=oe[t].toLowerCase();return[o,i,n||r]}var Fr=Symbol("@bufbuild/protobuf/unknown-fields"),Ff={readUnknownFields:!0,readerFactory:t=>new Oi(t)},Df={writeUnknownFields:!0,writerFactory:()=>new Ei};function k0(t){return t?Object.assign(Object.assign({},Ff),t):Ff}function T0(t){return t?Object.assign(Object.assign({},Df),t):Df}function Mf(){return{makeReadOptions:k0,makeWriteOptions:T0,listUnknownFields(t){var e;return(e=t[Fr])!==null&&e!==void 0?e:[]},discardUnknownFields(t){delete t[Fr]},writeUnknownFields(t,e){let o=t[Fr];if(o)for(let r of o)e.tag(r.no,r.wireType).raw(r.data)},onUnknownField(t,e,n,o){let r=t;Array.isArray(r[Fr])||(r[Fr]=[]),r[Fr].push({no:e,wireType:n,data:o})},readMessage(t,e,n,o){let r=t.getType(),i=n===void 0?e.len:e.pos+n;for(;e.pos<i;){let[a,s]=e.tag(),c=r.fields.find(a);if(!c){let f=e.skip(s);o.readUnknownFields&&this.onUnknownField(t,a,s,f);continue}let l=t,u=c.repeated,d=c.localName;switch(c.oneof&&(l=l[c.oneof.localName],l.case!=d&&delete l.value,l.case=d,d="value"),c.kind){case"scalar":case"enum":let f=c.kind=="enum"?oe.INT32:c.T,p=Ri;if(c.kind=="scalar"&&c.L>0&&(p=S0),u){let x=l[d];if(s==nt.LengthDelimited&&f!=oe.STRING&&f!=oe.BYTES){let y=e.uint32()+e.pos;for(;e.pos<y;)x.push(p(e,f))}else x.push(p(e,f))}else l[d]=p(e,f);break;case"message":let m=c.T;u?l[d].push(Ai(e,new m,o)):l[d]instanceof Vt?Ai(e,l[d],o):(l[d]=Ai(e,new m,o),m.fieldWrapper&&!c.oneof&&!c.repeated&&(l[d]=m.fieldWrapper.unwrapField(l[d])));break;case"map":let[h,b]=C0(c,e,o);l[d][h]=b;break}}}}}function Ai(t,e,n){return e.getType().runtime.bin.readMessage(e,t,t.uint32(),n),e}function C0(t,e,n){let o=e.uint32(),r=e.pos+o,i,a;for(;e.pos<r;){let[s]=e.tag();switch(s){case 1:i=Ri(e,t.K);break;case 2:switch(t.V.kind){case"scalar":a=Ri(e,t.V.T);break;case"enum":a=e.int32();break;case"message":a=Ai(e,new t.V.T,n);break}break}}if(i===void 0){let s=No(t.K,an.BIGINT);i=t.K==oe.BOOL?s.toString():s}if(typeof i!="string"&&typeof i!="number"&&(i=i.toString()),a===void 0)switch(t.V.kind){case"scalar":a=No(t.V.T,an.BIGINT);break;case"enum":a=0;break;case"message":a=new t.V.T;break}return[i,a]}function S0(t,e){let n=Ri(t,e);return typeof n=="bigint"?n.toString():n}function Ri(t,e){switch(e){case oe.STRING:return t.string();case oe.BOOL:return t.bool();case oe.DOUBLE:return t.double();case oe.FLOAT:return t.float();case oe.INT32:return t.int32();case oe.INT64:return t.int64();case oe.UINT64:return t.uint64();case oe.FIXED64:return t.fixed64();case oe.BYTES:return t.bytes();case oe.FIXED32:return t.fixed32();case oe.SFIXED32:return t.sfixed32();case oe.SFIXED64:return t.sfixed64();case oe.SINT64:return t.sint64();case oe.UINT32:return t.uint32();case oe.SINT32:return t.sint32()}}function Lf(t,e,n,o,r){t.tag(n.no,nt.LengthDelimited),t.fork();let i=o;switch(n.K){case oe.INT32:case oe.FIXED32:case oe.UINT32:case oe.SFIXED32:case oe.SINT32:i=Number.parseInt(o);break;case oe.BOOL:st(o=="true"||o=="false"),i=o=="true";break}switch(Dr(t,n.K,1,i,!0),n.V.kind){case"scalar":Dr(t,n.V.T,2,r,!0);break;case"enum":Dr(t,oe.INT32,2,r,!0);break;case"message":Ni(t,e,n.V.T,2,r);break}t.join()}function Ni(t,e,n,o,r){if(r!==void 0){let i=Ro(n,r);t.tag(o,nt.LengthDelimited).bytes(i.toBinary(e))}}function Dr(t,e,n,o,r){let[i,a,s]=As(e,o);(!s||r)&&t.tag(n,i)[a](o)}function Pf(t,e,n,o){if(!o.length)return;t.tag(n,nt.LengthDelimited).fork();let[,r]=As(e);for(let i=0;i<o.length;i++)t[r](o[i]);t.join()}function Bf(){return Object.assign(Object.assign({},Mf()),{writeMessage(t,e,n){let o=t.getType();for(let r of o.fields.byNumber()){let i,a=r.repeated,s=r.localName;if(r.oneof){let c=t[r.oneof.localName];if(c.case!==s)continue;i=c.value}else i=t[s];switch(r.kind){case"scalar":case"enum":let c=r.kind=="enum"?oe.INT32:r.T;if(a)if(r.packed)Pf(e,c,r.no,i);else for(let l of i)Dr(e,c,r.no,l,!0);else i!==void 0&&Dr(e,c,r.no,i,!!r.oneof||r.opt);break;case"message":if(a)for(let l of i)Ni(e,n,r.T,r.no,l);else Ni(e,n,r.T,r.no,i);break;case"map":for(let[l,u]of Object.entries(i))Lf(e,n,r,l,u);break}}return n.writeUnknownFields&&this.writeUnknownFields(t,e),e}})}var wn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),Ii=[];for(let t=0;t<wn.length;t++)Ii[wn[t].charCodeAt(0)]=t;Ii["-".charCodeAt(0)]=wn.indexOf("+");Ii["_".charCodeAt(0)]=wn.indexOf("/");var Rs={dec(t){let e=t.length*3/4;t[t.length-2]=="="?e-=2:t[t.length-1]=="="&&(e-=1);let n=new Uint8Array(e),o=0,r=0,i,a=0;for(let s=0;s<t.length;s++){if(i=Ii[t.charCodeAt(s)],i===void 0)switch(t[s]){case"=":r=0;case`
`:case"\r":case"	":case" ":continue;default:throw Error("invalid base64 string.")}switch(r){case 0:a=i,r=1;break;case 1:n[o++]=a<<2|(i&48)>>4,a=i,r=2;break;case 2:n[o++]=(a&15)<<4|(i&60)>>2,a=i,r=3;break;case 3:n[o++]=(a&3)<<6|i,r=0;break}}if(r==1)throw Error("invalid base64 string.");return n.subarray(0,o)},enc(t){let e="",n=0,o,r=0;for(let i=0;i<t.length;i++)switch(o=t[i],n){case 0:e+=wn[o>>2],r=(o&3)<<4,n=1;break;case 1:e+=wn[r|o>>4],r=(o&15)<<2,n=2;break;case 2:e+=wn[r|o>>6],e+=wn[o&63],n=0;break}return n&&(e+=wn[r],e+="=",n==1&&(e+="=")),e}};var jf={ignoreUnknownFields:!1},Uf={emitDefaultValues:!1,enumAsInteger:!1,useProtoFieldName:!1,prettySpaces:0};function E0(t){return t?Object.assign(Object.assign({},jf),t):jf}function O0(t){return t?Object.assign(Object.assign({},Uf),t):Uf}function Vf(t){let e=t(A0,zf);return{makeReadOptions:E0,makeWriteOptions:O0,readMessage(n,o,r,i){if(o==null||Array.isArray(o)||typeof o!="object")throw new Error(`cannot decode message ${n.typeName} from JSON: ${this.debug(o)}`);i=i!=null?i:new n;let a={};for(let[s,c]of Object.entries(o)){let l=n.fields.findJsonName(s);if(!l){if(!r.ignoreUnknownFields)throw new Error(`cannot decode message ${n.typeName} from JSON: key "${s}" is unknown`);continue}let u=l.localName,d=i;if(l.oneof){if(c===null&&l.kind=="scalar")continue;let f=a[l.oneof.localName];if(f)throw new Error(`cannot decode message ${n.typeName} from JSON: multiple keys for oneof "${l.oneof.name}" present: "${f}", "${s}"`);a[l.oneof.localName]=s,d=d[l.oneof.localName]={case:u},u="value"}if(l.repeated){if(c===null)continue;if(!Array.isArray(c))throw new Error(`cannot decode field ${n.typeName}.${l.name} from JSON: ${this.debug(c)}`);let f=d[u];for(let p of c){if(p===null)throw new Error(`cannot decode field ${n.typeName}.${l.name} from JSON: ${this.debug(p)}`);let m;switch(l.kind){case"message":m=l.T.fromJson(p,r);break;case"enum":if(m=Ns(l.T,p,r.ignoreUnknownFields),m===void 0)continue;break;case"scalar":try{m=Io(l.T,p,l.L)}catch(h){let b=`cannot decode field ${n.typeName}.${l.name} from JSON: ${this.debug(p)}`;throw h instanceof Error&&h.message.length>0&&(b+=`: ${h.message}`),new Error(b)}break}f.push(m)}}else if(l.kind=="map"){if(c===null)continue;if(Array.isArray(c)||typeof c!="object")throw new Error(`cannot decode field ${n.typeName}.${l.name} from JSON: ${this.debug(c)}`);let f=d[u];for(let[p,m]of Object.entries(c)){if(m===null)throw new Error(`cannot decode field ${n.typeName}.${l.name} from JSON: map value null`);let h;switch(l.V.kind){case"message":h=l.V.T.fromJson(m,r);break;case"enum":if(h=Ns(l.V.T,m,r.ignoreUnknownFields),h===void 0)continue;break;case"scalar":try{h=Io(l.V.T,m,an.BIGINT)}catch(b){let x=`cannot decode map value for field ${n.typeName}.${l.name} from JSON: ${this.debug(c)}`;throw b instanceof Error&&b.message.length>0&&(x+=`: ${b.message}`),new Error(x)}break}try{f[Io(l.K,l.K==oe.BOOL?p=="true"?!0:p=="false"?!1:p:p,an.BIGINT).toString()]=h}catch(b){let x=`cannot decode map key for field ${n.typeName}.${l.name} from JSON: ${this.debug(c)}`;throw b instanceof Error&&b.message.length>0&&(x+=`: ${b.message}`),new Error(x)}}}else switch(l.kind){case"message":let f=l.T;if(c===null&&f.typeName!="google.protobuf.Value"){if(l.oneof)throw new Error(`cannot decode field ${n.typeName}.${l.name} from JSON: null is invalid for oneof field "${s}"`);continue}d[u]instanceof Vt?d[u].fromJson(c,r):(d[u]=f.fromJson(c,r),f.fieldWrapper&&!l.oneof&&(d[u]=f.fieldWrapper.unwrapField(d[u])));break;case"enum":let p=Ns(l.T,c,r.ignoreUnknownFields);p!==void 0&&(d[u]=p);break;case"scalar":try{d[u]=Io(l.T,c,l.L)}catch(m){let h=`cannot decode field ${n.typeName}.${l.name} from JSON: ${this.debug(c)}`;throw m instanceof Error&&m.message.length>0&&(h+=`: ${m.message}`),new Error(h)}break}}return i},writeMessage(n,o){let r=n.getType(),i={},a;try{for(let s of r.fields.byMember()){let c;if(s.kind=="oneof"){let l=n[s.localName];if(l.value===void 0)continue;if(a=s.findField(l.case),!a)throw"oneof case not found: "+l.case;c=e(a,l.value,o)}else a=s,c=e(a,n[a.localName],o);c!==void 0&&(i[o.useProtoFieldName?a.name:a.jsonName]=c)}}catch(s){let c=a?`cannot encode field ${r.typeName}.${a.name} to JSON`:`cannot encode message ${r.typeName} to JSON`,l=s instanceof Error?s.message:String(s);throw new Error(c+(l.length>0?`: ${l}`:""))}return i},readScalar:Io,writeScalar:zf,debug:Wf}}function Wf(t){if(t===null)return"null";switch(typeof t){case"object":return Array.isArray(t)?"array":"object";case"string":return t.length>100?"string":`"${t.split('"').join('\\"')}"`;default:return String(t)}}function Io(t,e,n){switch(t){case oe.DOUBLE:case oe.FLOAT:if(e===null)return 0;if(e==="NaN")return Number.NaN;if(e==="Infinity")return Number.POSITIVE_INFINITY;if(e==="-Infinity")return Number.NEGATIVE_INFINITY;if(e===""||typeof e=="string"&&e.trim().length!==e.length||typeof e!="string"&&typeof e!="number")break;let o=Number(e);if(Number.isNaN(o)||!Number.isFinite(o))break;return t==oe.FLOAT&&Ti(o),o;case oe.INT32:case oe.FIXED32:case oe.SFIXED32:case oe.SINT32:case oe.UINT32:if(e===null)return 0;let r;if(typeof e=="number"?r=e:typeof e=="string"&&e.length>0&&e.trim().length===e.length&&(r=Number(e)),r===void 0)break;return t==oe.UINT32?Ao(r):Ir(r),r;case oe.INT64:case oe.SFIXED64:case oe.SINT64:if(e===null)return dt.zero;if(typeof e!="number"&&typeof e!="string")break;let i=dt.parse(e);return n?i.toString():i;case oe.FIXED64:case oe.UINT64:if(e===null)return dt.zero;if(typeof e!="number"&&typeof e!="string")break;let a=dt.uParse(e);return n?a.toString():a;case oe.BOOL:if(e===null)return!1;if(typeof e!="boolean")break;return e;case oe.STRING:if(e===null)return"";if(typeof e!="string")break;try{encodeURIComponent(e)}catch{throw new Error("invalid UTF8")}return e;case oe.BYTES:if(e===null||e==="")return new Uint8Array(0);if(typeof e!="string")break;return Rs.dec(e)}throw new Error}function Ns(t,e,n){if(e===null)return 0;switch(typeof e){case"number":if(Number.isInteger(e))return e;break;case"string":let o=t.findName(e);if(o||n)return o==null?void 0:o.no;break}throw new Error(`cannot decode enum ${t.typeName} from JSON: ${Wf(e)}`)}function A0(t,e,n,o){var r;if(e===void 0)return e;if(e===0&&!n)return;if(o)return e;if(t.typeName=="google.protobuf.NullValue")return null;let i=t.findNumber(e);return(r=i==null?void 0:i.name)!==null&&r!==void 0?r:e}function zf(t,e,n){if(e!==void 0)switch(t){case oe.INT32:case oe.SFIXED32:case oe.SINT32:case oe.FIXED32:case oe.UINT32:return st(typeof e=="number"),e!=0||n?e:void 0;case oe.FLOAT:case oe.DOUBLE:return st(typeof e=="number"),Number.isNaN(e)?"NaN":e===Number.POSITIVE_INFINITY?"Infinity":e===Number.NEGATIVE_INFINITY?"-Infinity":e!==0||n?e:void 0;case oe.STRING:return st(typeof e=="string"),e.length>0||n?e:void 0;case oe.BOOL:return st(typeof e=="boolean"),e||n?e:void 0;case oe.UINT64:case oe.FIXED64:case oe.INT64:case oe.SFIXED64:case oe.SINT64:return st(typeof e=="bigint"||typeof e=="string"||typeof e=="number"),n||e!=0?e.toString(10):void 0;case oe.BYTES:return st(e instanceof Uint8Array),n||e.byteLength>0?Rs.enc(e):void 0}}function Hf(){return Vf((t,e)=>function(o,r,i){if(o.kind=="map"){let a={};switch(o.V.kind){case"scalar":for(let[c,l]of Object.entries(r)){let u=e(o.V.T,l,!0);st(u!==void 0),a[c.toString()]=u}break;case"message":for(let[c,l]of Object.entries(r))a[c.toString()]=l.toJson(i);break;case"enum":let s=o.V.T;for(let[c,l]of Object.entries(r)){st(l===void 0||typeof l=="number");let u=t(s,l,!0,i.enumAsInteger);st(u!==void 0),a[c.toString()]=u}break}return i.emitDefaultValues||Object.keys(a).length>0?a:void 0}else if(o.repeated){let a=[];switch(o.kind){case"scalar":for(let s=0;s<r.length;s++)a.push(e(o.T,r[s],!0));break;case"enum":for(let s=0;s<r.length;s++)a.push(t(o.T,r[s],!0,i.enumAsInteger));break;case"message":for(let s=0;s<r.length;s++)a.push(Ro(o.T,r[s]).toJson(i));break}return i.emitDefaultValues||a.length>0?a:void 0}else switch(o.kind){case"scalar":return e(o.T,r,!!o.oneof||o.opt||i.emitDefaultValues);case"enum":return t(o.T,r,!!o.oneof||o.opt||i.emitDefaultValues,i.enumAsInteger);case"message":return r!==void 0?Ro(o.T,r).toJson(i):void 0}})}function Gf(){return{setEnumType:ks,initPartial(t,e){if(t===void 0)return;let n=e.getType();for(let o of n.fields.byMember()){let r=o.localName,i=e,a=t;if(a[r]!==void 0)switch(o.kind){case"oneof":let s=a[r].case;if(s===void 0)continue;let c=o.findField(s),l=a[r].value;c&&c.kind=="message"&&!(l instanceof c.T)?l=new c.T(l):c&&c.kind==="scalar"&&c.T===oe.BYTES&&(l=Fo(l)),i[r]={case:s,value:l};break;case"scalar":case"enum":let u=a[r];o.T===oe.BYTES&&(u=o.repeated?u.map(Fo):Fo(u)),i[r]=u;break;case"map":switch(o.V.kind){case"scalar":case"enum":if(o.V.T===oe.BYTES)for(let[p,m]of Object.entries(a[r]))i[r][p]=Fo(m);else Object.assign(i[r],a[r]);break;case"message":let f=o.V.T;for(let p of Object.keys(a[r])){let m=a[r][p];f.fieldWrapper||(m=new f(m)),i[r][p]=m}break}break;case"message":let d=o.T;if(o.repeated)i[r]=a[r].map(f=>f instanceof d?f:new d(f));else if(a[r]!==void 0){let f=a[r];d.fieldWrapper?d.typeName==="google.protobuf.BytesValue"?i[r]=Fo(f):i[r]=f:i[r]=f instanceof d?f:new d(f)}break}}},equals(t,e,n){return e===n?!0:!e||!n?!1:t.fields.byMember().every(o=>{let r=e[o.localName],i=n[o.localName];if(o.repeated){if(r.length!==i.length)return!1;switch(o.kind){case"message":return r.every((a,s)=>o.T.equals(a,i[s]));case"scalar":return r.every((a,s)=>yn(o.T,a,i[s]));case"enum":return r.every((a,s)=>yn(oe.INT32,a,i[s]))}throw new Error(`repeated cannot contain ${o.kind}`)}switch(o.kind){case"message":return o.T.equals(r,i);case"enum":return yn(oe.INT32,r,i);case"scalar":return yn(o.T,r,i);case"oneof":if(r.case!==i.case)return!1;let a=o.findField(r.case);if(a===void 0)return!0;switch(a.kind){case"message":return a.T.equals(r.value,i.value);case"enum":return yn(oe.INT32,r.value,i.value);case"scalar":return yn(a.T,r.value,i.value)}throw new Error(`oneof cannot contain ${a.kind}`);case"map":let s=Object.keys(r).concat(Object.keys(i));switch(o.V.kind){case"message":let c=o.V.T;return s.every(u=>c.equals(r[u],i[u]));case"enum":return s.every(u=>yn(oe.INT32,r[u],i[u]));case"scalar":let l=o.V.T;return s.every(u=>yn(l,r[u],i[u]))}break}})},clone(t){let e=t.getType(),n=new e,o=n;for(let r of e.fields.byMember()){let i=t[r.localName],a;if(r.repeated)a=i.map(Fi);else if(r.kind=="map"){a=o[r.localName];for(let[s,c]of Object.entries(i))a[s]=Fi(c)}else r.kind=="oneof"?a=r.findField(i.case)?{case:i.case,value:Fi(i.value)}:{case:void 0}:a=Fi(i);o[r.localName]=a}return n}}}function Fi(t){if(t===void 0)return t;if(t instanceof Vt)return t.clone();if(t instanceof Uint8Array){let e=new Uint8Array(t.byteLength);return e.set(t),e}return t}function Fo(t){return t instanceof Uint8Array?t:new Uint8Array(t)}var Di=class{constructor(e,n){this._fields=e,this._normalizer=n}findJsonName(e){if(!this.jsonNames){let n={};for(let o of this.list())n[o.jsonName]=n[o.name]=o;this.jsonNames=n}return this.jsonNames[e]}find(e){if(!this.numbers){let n={};for(let o of this.list())n[o.no]=o;this.numbers=n}return this.numbers[e]}list(){return this.all||(this.all=this._normalizer(this._fields)),this.all}byNumber(){return this.numbersAsc||(this.numbersAsc=this.list().concat().sort((e,n)=>e.no-n.no)),this.numbersAsc}byMember(){if(!this.members){this.members=[];let e=this.members,n;for(let o of this.list())o.oneof?o.oneof!==n&&(n=o.oneof,e.push(n)):e.push(o)}return this.members}};function Is(t,e){let n=Yf(t);return e?n:F0(I0(n))}function qf(t){return Is(t,!1)}var Xf=Yf;function Yf(t){let e=!1,n=[];for(let o=0;o<t.length;o++){let r=t.charAt(o);switch(r){case"_":e=!0;break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":n.push(r),e=!1;break;default:e&&(e=!1,r=r.toUpperCase()),n.push(r);break}}return n.join("")}var R0=new Set(["constructor","toString","toJSON","valueOf"]),N0=new Set(["getType","clone","equals","fromBinary","fromJson","fromJsonString","toBinary","toJson","toJsonString","toObject"]),Qf=t=>`${t}$`,I0=t=>N0.has(t)?Qf(t):t,F0=t=>R0.has(t)?Qf(t):t;var Mi=class{constructor(e){this.kind="oneof",this.repeated=!1,this.packed=!1,this.opt=!1,this.default=void 0,this.fields=[],this.name=e,this.localName=qf(e)}addField(e){st(e.oneof===this,`field ${e.name} not one of ${this.name}`),this.fields.push(e)}findField(e){if(!this._lookup){this._lookup=Object.create(null);for(let n=0;n<this.fields.length;n++)this._lookup[this.fields[n].localName]=this.fields[n]}return this._lookup[e]}};var it=Ef("proto3",Hf(),Bf(),Object.assign(Object.assign({},Gf()),{newFieldList(t){return new Di(t,D0)},initFields(t){for(let e of t.getType().fields.byMember()){if(e.opt)continue;let n=e.localName,o=t;if(e.repeated){o[n]=[];continue}switch(e.kind){case"oneof":o[n]={case:void 0};break;case"enum":o[n]=0;break;case"map":o[n]={};break;case"scalar":o[n]=No(e.T,e.L);break;case"message":break}}}}));function D0(t){var e,n,o,r;let i=[],a;for(let s of typeof t=="function"?t():t){let c=s;if(c.localName=Is(s.name,s.oneof!==void 0),c.jsonName=(e=s.jsonName)!==null&&e!==void 0?e:Xf(s.name),c.repeated=(n=s.repeated)!==null&&n!==void 0?n:!1,s.kind=="scalar"&&(c.L=(o=s.L)!==null&&o!==void 0?o:an.BIGINT),c.packed=(r=s.packed)!==null&&r!==void 0?r:s.kind=="enum"||s.kind=="scalar"&&s.T!=oe.BYTES&&s.T!=oe.STRING,s.oneof!==void 0){let l=typeof s.oneof=="string"?s.oneof:s.oneof.name;(!a||a.name!=l)&&(a=new Mi(l)),c.oneof=a,a.addField(c)}i.push(c)}return i}var Kf=it.makeMessageType("",()=>[{no:1,name:"json",kind:"scalar",T:12}]);var Do=it.makeMessageType("",()=>[{no:1,name:"card",kind:"scalar",T:8},{no:2,name:"note",kind:"scalar",T:8},{no:3,name:"deck",kind:"scalar",T:8},{no:4,name:"tag",kind:"scalar",T:8},{no:5,name:"notetype",kind:"scalar",T:8},{no:6,name:"config",kind:"scalar",T:8},{no:11,name:"deck_config",kind:"scalar",T:8},{no:12,name:"mtime",kind:"scalar",T:8},{no:7,name:"browser_table",kind:"scalar",T:8},{no:8,name:"browser_sidebar",kind:"scalar",T:8},{no:9,name:"note_text",kind:"scalar",T:8},{no:10,name:"study_queues",kind:"scalar",T:8}]);var Jf=it.makeMessageType("",()=>[{no:1,name:"modules",kind:"scalar",T:9,repeated:!0}]);var $f=it.makeMessageType("",()=>[{no:1,name:"path",kind:"scalar",T:9}]),Zf=it.makeMessageType("",()=>[{no:1,name:"data",kind:"scalar",T:12},{no:2,name:"name",kind:"scalar",T:9}]),ep=it.makeMessageType("",()=>[{no:1,name:"image_path",kind:"scalar",T:9},{no:2,name:"occlusions",kind:"scalar",T:9},{no:3,name:"header",kind:"scalar",T:9},{no:4,name:"back_extra",kind:"scalar",T:9},{no:5,name:"tags",kind:"scalar",T:9,repeated:!0},{no:6,name:"notetype_id",kind:"scalar",T:3}]),tp=it.makeMessageType("",()=>[{no:1,name:"note_id",kind:"scalar",T:3}]),np=it.makeMessageType("",()=>[{no:1,name:"note",kind:"message",T:r1,oneof:"value"},{no:2,name:"error",kind:"scalar",T:9,oneof:"value"}]),e1=it.makeMessageType("",()=>[{no:1,name:"name",kind:"scalar",T:9},{no:2,name:"value",kind:"scalar",T:9}],{localName:"GetImageOcclusionNoteResponse_ImageOcclusionProperty"}),t1=it.makeMessageType("",()=>[{no:1,name:"shape",kind:"scalar",T:9},{no:2,name:"properties",kind:"message",T:e1,repeated:!0}],{localName:"GetImageOcclusionNoteResponse_ImageOcclusionShape"}),n1=it.makeMessageType("",()=>[{no:1,name:"shapes",kind:"message",T:t1,repeated:!0}],{localName:"GetImageOcclusionNoteResponse_ImageOcclusion"}),r1=it.makeMessageType("",()=>[{no:1,name:"image_data",kind:"scalar",T:12},{no:2,name:"occlusions",kind:"message",T:n1,repeated:!0},{no:3,name:"header",kind:"scalar",T:9},{no:4,name:"back_extra",kind:"scalar",T:9},{no:5,name:"tags",kind:"scalar",T:9,repeated:!0},{no:6,name:"image_file_name",kind:"scalar",T:9}],{localName:"GetImageOcclusionNoteResponse_ImageOcclusionNote"}),rp=it.makeMessageType("",()=>[{no:1,name:"note_id",kind:"scalar",T:3},{no:2,name:"occlusions",kind:"scalar",T:9},{no:3,name:"header",kind:"scalar",T:9},{no:4,name:"back_extra",kind:"scalar",T:9},{no:5,name:"tags",kind:"scalar",T:9,repeated:!0}]);var op=it.makeMessageType("",()=>[{no:1,name:"input",kind:"scalar",T:9},{no:2,name:"match_limit",kind:"scalar",T:13}]),ip=it.makeMessageType("",()=>[{no:1,name:"tags",kind:"scalar",T:9,repeated:!0}]);async function ap(t,e={}){return await(0,cr.postProto)("i18nResources",new Jf(t),Kf,e)}async function Ds(t,e={}){return await(0,cr.postProto)("getImageForOcclusion",new $f(t),Zf,e)}async function sp(t,e={}){return await(0,cr.postProto)("getImageOcclusionNote",new tp(t),np,e)}async function lp(t,e={}){return await(0,cr.postProto)("addImageOcclusionNote",new ep(t),Do,e)}async function cp(t,e={}){return await(0,cr.postProto)("updateImageOcclusionNote",new rp(t),Do,e)}async function up(t,e={}){return await(0,cr.postProto)("completeTag",new op(t),ip,e)}function h1(){let t=nf();return t.startsWith("ar")||t.startsWith("he")||t.startsWith("fa")?"rtl":"ltr"}var g1=[];async function dp(t){let e=await ap(t),n=JSON.parse(new TextDecoder().decode(e.json)),o=[];for(let r in n.resources){let i=n.resources[r],a=n.langs[r],s=new Co([a,"en-US"]),c=new So(i);s.addResource(c),o.push(s)}tf(o),g1=n.langs,document.dir=h1()}as.getMessage=rf;function fp(){let t=window.location.hash=="#night";return t&&(document.documentElement.className="night-mode",document.documentElement.dataset.bsTheme="dark"),t}function ye(){}function b1(t,e){for(let n in e)t[n]=e[n];return t}function Ms(t){return t()}function Li(){return Object.create(null)}function Pe(t){t.forEach(Ms)}function Ft(t){return typeof t=="function"}function me(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}function pp(t){return Object.keys(t).length===0}function sn(t,...e){if(t==null){for(let o of e)o(void 0);return ye}let n=t.subscribe(...e);return n.unsubscribe?()=>n.unsubscribe():n}function rt(t){let e;return sn(t,n=>e=n)(),e}function ot(t,e,n){t.$$.on_destroy.push(sn(e,n))}function Ne(t,e,n,o){if(t){let r=mp(t,e,n,o);return t[0](r)}}function mp(t,e,n,o){return t[1]&&o?b1(n.ctx.slice(),t[1](o(e))):n.ctx}function Ie(t,e,n,o){if(t[2]&&o){let r=t[2](o(n));if(e.dirty===void 0)return r;if(typeof r=="object"){let i=[],a=Math.max(e.dirty.length,r.length);for(let s=0;s<a;s+=1)i[s]=e.dirty[s]|r[s];return i}return e.dirty|r}return e.dirty}function Fe(t,e,n,o,r,i){if(r){let a=mp(e,n,o,i);t.p(a,r)}}function De(t){if(t.ctx.length>32){let e=[],n=t.ctx.length/32;for(let o=0;o<n;o++)e[o]=-1;return e}return-1}function hp(t){let e={};for(let n in t)e[n]=!0;return e}function zn(t,e,n){return t.set(n),e}function Tt(t){return t&&Ft(t.destroy)?t.destroy:ye}var Ls=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;var Pi=class t{constructor(e){tt(this,"_listeners","WeakMap"in Ls?new WeakMap:void 0);tt(this,"_observer");tt(this,"options");this.options=e}observe(e,n){return this._listeners.set(e,n),this._getObserver().observe(e,this.options),()=>{this._listeners.delete(e),this._observer.unobserve(e)}}_getObserver(){var e;return(e=this._observer)!=null?e:this._observer=new ResizeObserver(n=>{var o;for(let r of n)t.entries.set(r.target,r),(o=this._listeners.get(r.target))==null||o(r)})}};Pi.entries="WeakMap"in Ls?new WeakMap:void 0;var gp=!1;function bp(){gp=!0}function xp(){gp=!1}function Ce(t,e){t.appendChild(e)}function Y(t,e,n){t.insertBefore(e,n||null)}function X(t){t.parentNode&&t.parentNode.removeChild(t)}function pt(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function ie(t){return document.createElement(t)}function y1(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function We(t){return document.createTextNode(t)}function xe(){return We(" ")}function Ue(){return We("")}function _e(t,e,n,o){return t.addEventListener(e,n,o),()=>t.removeEventListener(e,n,o)}function Ct(t){return function(e){return e.preventDefault(),t.call(this,e)}}function Q(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function vp(t){return Array.from(t.childNodes)}function Dt(t,e){e=""+e,t.data!==e&&(t.data=e)}function Mr(t,e){t.value=e==null?"":e}function ze(t,e,n,o){n==null?t.style.removeProperty(e):t.style.setProperty(e,n,o?"important":"")}var Bi;function w1(){if(Bi===void 0){Bi=!1;try{typeof window<"u"&&window.parent&&window.parent.document}catch{Bi=!0}}return Bi}function Lr(t,e){getComputedStyle(t).position==="static"&&(t.style.position="relative");let o=ie("iframe");o.setAttribute("style","display: block; position: absolute; top: 0; left: 0; width: 100%; height: 100%; overflow: hidden; border: 0; opacity: 0; pointer-events: none; z-index: -1;"),o.setAttribute("aria-hidden","true"),o.tabIndex=-1;let r=w1(),i;return r?(o.src="data:text/html,<script>onresize=function(){parent.postMessage(0,'*')}<\/script>",i=_e(window,"message",a=>{a.source===o.contentWindow&&e()})):(o.src="about:blank",o.onload=()=>{i=_e(o.contentWindow,"resize",e),e()}),Ce(t,o),()=>{(r||i&&o.contentWindow)&&i(),X(o)}}function de(t,e,n){t.classList.toggle(e,!!n)}function ji(t,e,{bubbles:n=!1,cancelable:o=!1}={}){return new CustomEvent(t,{detail:e,bubbles:n,cancelable:o})}var $e=class{constructor(e=!1){tt(this,"is_svg",!1);tt(this,"e");tt(this,"n");tt(this,"t");tt(this,"a");this.is_svg=e,this.e=this.n=null}c(e){this.h(e)}m(e,n,o=null){this.e||(this.is_svg?this.e=y1(n.nodeName):this.e=ie(n.nodeType===11?"TEMPLATE":n.nodeName),this.t=n.tagName!=="TEMPLATE"?n:n.content,this.c(e)),this.i(o)}h(e){this.e.innerHTML=e,this.n=Array.from(this.e.nodeName==="TEMPLATE"?this.e.content.childNodes:this.e.childNodes)}i(e){for(let n=0;n<this.n.length;n+=1)Y(this.t,this.n[n],e)}p(e){this.d(),this.h(e),this.i(this.a)}d(){this.n.forEach(X)}};function yp(t){let e={};return t.childNodes.forEach(n=>{e[n.slot||"default"]=!0}),e}var Vn;function _n(t){Vn=t}function Pr(){if(!Vn)throw new Error("Function called outside component initialization");return Vn}function mt(t){Pr().$$.on_mount.push(t)}function ur(t){Pr().$$.on_destroy.push(t)}function qe(){let t=Pr();return(e,n,{cancelable:o=!1}={})=>{let r=t.$$.callbacks[e];if(r){let i=ji(e,n,{cancelable:o});return r.slice().forEach(a=>{a.call(t,i)}),!i.defaultPrevented}return!0}}function Mo(t,e){return Pr().$$.context.set(t,e),e}function kn(t){return Pr().$$.context.get(t)}function Oe(t,e){let n=t.$$.callbacks[e.type];n&&n.slice().forEach(o=>o.call(this,e))}var dr=[];var He=[],jr=[],Bs=[],wp=Promise.resolve(),js=!1;function Us(){js||(js=!0,wp.then(Ui))}function xt(){return Us(),wp}function Mt(t){jr.push(t)}function Yt(t){Bs.push(t)}var Ps=new Set,Br=0;function Ui(){if(Br!==0)return;let t=Vn;do{try{for(;Br<dr.length;){let e=dr[Br];Br++,_n(e),E1(e.$$)}}catch(e){throw dr.length=0,Br=0,e}for(_n(null),dr.length=0,Br=0;He.length;)He.pop()();for(let e=0;e<jr.length;e+=1){let n=jr[e];Ps.has(n)||(Ps.add(n),n())}jr.length=0}while(dr.length);for(;Bs.length;)Bs.pop()();js=!1,Ps.clear(),_n(t)}function E1(t){if(t.fragment!==null){t.update(),Pe(t.before_update);let e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(Mt)}}function _p(t){let e=[],n=[];jr.forEach(o=>t.indexOf(o)===-1?e.push(o):n.push(o)),n.forEach(o=>o()),jr=e}var zi=new Set,fr;function Me(){fr={r:0,c:[],p:fr}}function Le(){fr.r||Pe(fr.c),fr=fr.p}function W(t,e){t&&t.i&&(zi.delete(t),t.i(e))}function H(t,e,n,o){if(t&&t.o){if(zi.has(t))return;zi.add(t),fr.c.push(()=>{zi.delete(t),o&&(n&&t.d(1),o())}),t.o(e)}else o&&o()}function Ve(t){return(t==null?void 0:t.length)!==void 0?t:Array.from(t)}function kp(t,e){H(t,1,1,()=>{e.delete(t.key)})}function Tp(t,e,n,o,r,i,a,s,c,l,u,d){let f=t.length,p=i.length,m=f,h={};for(;m--;)h[t[m].key]=m;let b=[],x=new Map,y=new Map,M=[];for(m=p;m--;){let P=d(r,i,m),D=n(P),N=a.get(D);N?o&&M.push(()=>N.p(P,e)):(N=l(D,P),N.c()),x.set(D,b[m]=N),D in h&&y.set(D,Math.abs(m-h[D]))}let E=new Set,C=new Set;function j(P){W(P,1),P.m(s,u),a.set(P.key,P),u=P.first,p--}for(;f&&p;){let P=b[p-1],D=t[f-1],N=P.key,S=D.key;P===D?(u=P.first,f--,p--):x.has(S)?!a.has(N)||E.has(N)?j(P):C.has(S)?f--:y.get(N)>y.get(S)?(C.add(N),j(P)):(E.add(S),f--):(c(D,a),f--)}for(;f--;){let P=t[f];x.has(P.key)||c(P,a)}for(;p;)j(b[p-1]);return Pe(M),b}var O1=["allowfullscreen","allowpaymentrequest","async","autofocus","autoplay","checked","controls","default","defer","disabled","formnovalidate","hidden","inert","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","selected"],A1=new Set([...O1]);function Qt(t,e,n){let o=t.$$.props[e];o!==void 0&&(t.$$.bound[o]=n,n(t.$$.ctx[o]))}function le(t){t&&t.c()}function ae(t,e,n){let{fragment:o,after_update:r}=t.$$;o&&o.m(e,n),Mt(()=>{let i=t.$$.on_mount.map(Ms).filter(Ft);t.$$.on_destroy?t.$$.on_destroy.push(...i):Pe(i),t.$$.on_mount=[]}),r.forEach(Mt)}function se(t,e){let n=t.$$;n.fragment!==null&&(_p(n.after_update),Pe(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function N1(t,e){t.$$.dirty[0]===-1&&(dr.push(t),Us(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function he(t,e,n,o,r,i,a=null,s=[-1]){let c=Vn;_n(t);let l=t.$$={fragment:null,ctx:[],props:i,update:ye,not_equal:r,bound:Li(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(c?c.$$.context:[])),callbacks:Li(),dirty:s,skip_bound:!1,root:e.target||c.$$.root};a&&a(l.root);let u=!1;if(l.ctx=n?n(t,e.props||{},(d,f,...p)=>{let m=p.length?p[0]:f;return l.ctx&&r(l.ctx[d],l.ctx[d]=m)&&(!l.skip_bound&&l.bound[d]&&l.bound[d](m),u&&N1(t,d)),f}):[],l.update(),u=!0,Pe(l.before_update),l.fragment=o?o(l.ctx):!1,e.target){if(e.hydrate){bp();let d=vp(e.target);l.fragment&&l.fragment.l(d),d.forEach(X)}else l.fragment&&l.fragment.c();e.intro&&W(t.$$.fragment),ae(t,e.target,e.anchor),xp(),Ui()}_n(c)}var I1;typeof HTMLElement=="function"&&(I1=class extends HTMLElement{constructor(e,n,o){super();tt(this,"$$ctor");tt(this,"$$s");tt(this,"$$c");tt(this,"$$cn",!1);tt(this,"$$d",{});tt(this,"$$r",!1);tt(this,"$$p_d",{});tt(this,"$$l",{});tt(this,"$$l_u",new Map);this.$$ctor=e,this.$$s=n,o&&this.attachShadow({mode:"open"})}addEventListener(e,n,o){if(this.$$l[e]=this.$$l[e]||[],this.$$l[e].push(n),this.$$c){let r=this.$$c.$on(e,n);this.$$l_u.set(n,r)}super.addEventListener(e,n,o)}removeEventListener(e,n,o){if(super.removeEventListener(e,n,o),this.$$c){let r=this.$$l_u.get(n);r&&(r(),this.$$l_u.delete(n))}}async connectedCallback(){if(this.$$cn=!0,!this.$$c){let e=function(i){return()=>{let a;return{c:function(){a=ie("slot"),i!=="default"&&Q(a,"name",i)},m:function(l,u){Y(l,a,u)},d:function(l){l&&X(a)}}}};if(await Promise.resolve(),!this.$$cn)return;let n={},o=yp(this);for(let i of this.$$s)i in o&&(n[i]=[e(i)]);for(let i of this.attributes){let a=this.$$g_p(i.name);a in this.$$d||(this.$$d[a]=zs(a,i.value,this.$$p_d,"toProp"))}this.$$c=new this.$$ctor({target:this.shadowRoot||this,props:{...this.$$d,$$slots:n,$$scope:{ctx:[]}}});let r=()=>{this.$$r=!0;for(let i in this.$$p_d)if(this.$$d[i]=this.$$c.$$.ctx[this.$$c.$$.props[i]],this.$$p_d[i].reflect){let a=zs(i,this.$$d[i],this.$$p_d,"toAttribute");a==null?this.removeAttribute(this.$$p_d[i].attribute||i):this.setAttribute(this.$$p_d[i].attribute||i,a)}this.$$r=!1};this.$$c.$$.after_update.push(r),r();for(let i in this.$$l)for(let a of this.$$l[i]){let s=this.$$c.$on(i,a);this.$$l_u.set(a,s)}this.$$l={}}}attributeChangedCallback(e,n,o){var r;this.$$r||(e=this.$$g_p(e),this.$$d[e]=zs(e,o,this.$$p_d,"toProp"),(r=this.$$c)==null||r.$set({[e]:this.$$d[e]}))}disconnectedCallback(){this.$$cn=!1,Promise.resolve().then(()=>{this.$$cn||(this.$$c.$destroy(),this.$$c=void 0)})}$$g_p(e){return Object.keys(this.$$p_d).find(n=>this.$$p_d[n].attribute===e||!this.$$p_d[n].attribute&&n.toLowerCase()===e)||e}});function zs(t,e,n,o){var i;let r=(i=n[t])==null?void 0:i.type;if(e=r==="Boolean"&&typeof e!="boolean"?e!=null:e,!o||!n[t])return e;if(o==="toAttribute")switch(r){case"Object":case"Array":return e==null?null:JSON.stringify(e);case"Boolean":return e?"":null;case"Number":return e==null?null:e;default:return e}else switch(r){case"Object":case"Array":return e&&JSON.parse(e);case"Boolean":return e;case"Number":return e!=null?+e:e;default:return e}}var pe=class{constructor(){tt(this,"$$");tt(this,"$$set")}$destroy(){se(this,1),this.$destroy=ye}$on(e,n){if(!Ft(n))return ye;let o=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return o.push(n),()=>{let r=o.indexOf(n);r!==-1&&o.splice(r,1)}}$set(e){this.$$set&&!pp(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}};var Cp="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(Cp);function F1(t){let e,n,o,r=t[4].default,i=Ne(r,t,t[3],null);return{c(){e=ie("div"),i&&i.c(),Q(e,"id",t[0]),Q(e,"class",n="container "+t[1]+" svelte-14e7rtp"),de(e,"container-xs",t[2]==="xs"),de(e,"container-sm",t[2]==="sm"),de(e,"container-md",t[2]==="md"),de(e,"container-lg",t[2]==="lg"),de(e,"container-xl",t[2]==="xl"),de(e,"container-xxl",t[2]==="xxl"),de(e,"container-fluid",t[2]==="fluid")},m(a,s){Y(a,e,s),i&&i.m(e,null),o=!0},p(a,[s]){i&&i.p&&(!o||s&8)&&Fe(i,r,a,a[3],o?Ie(r,a[3],s,null):De(a[3]),null),(!o||s&1)&&Q(e,"id",a[0]),(!o||s&2&&n!==(n="container "+a[1]+" svelte-14e7rtp"))&&Q(e,"class",n),(!o||s&6)&&de(e,"container-xs",a[2]==="xs"),(!o||s&6)&&de(e,"container-sm",a[2]==="sm"),(!o||s&6)&&de(e,"container-md",a[2]==="md"),(!o||s&6)&&de(e,"container-lg",a[2]==="lg"),(!o||s&6)&&de(e,"container-xl",a[2]==="xl"),(!o||s&6)&&de(e,"container-xxl",a[2]==="xxl"),(!o||s&6)&&de(e,"container-fluid",a[2]==="fluid")},i(a){o||(W(i,a),o=!0)},o(a){H(i,a),o=!1},d(a){a&&X(e),i&&i.d(a)}}}function D1(t,e,n){let{$$slots:o={},$$scope:r}=e,{id:i=void 0}=e,{class:a=""}=e,{breakpoint:s="fluid"}=e;return t.$$set=c=>{"id"in c&&n(0,i=c.id),"class"in c&&n(1,a=c.class),"breakpoint"in c&&n(2,s=c.breakpoint),"$$scope"in c&&n(3,r=c.$$scope)},[i,a,s,r,o]}var Vs=class extends pe{constructor(e){super(),he(this,e,D1,F1,me,{id:0,class:1,breakpoint:2})}},Sp=Vs;var Ur=[];function zr(t,e){return{subscribe:at(t,e).subscribe}}function at(t,e=ye){let n,o=new Set;function r(s){if(me(t,s)&&(t=s,n)){let c=!Ur.length;for(let l of o)l[1](),Ur.push(l,t);if(c){for(let l=0;l<Ur.length;l+=2)Ur[l][0](Ur[l+1]);Ur.length=0}}}function i(s){r(s(t))}function a(s,c=ye){let l=[s,c];return o.add(l),o.size===1&&(n=e(r,i)||ye),s(t),()=>{o.delete(l),o.size===0&&n&&(n(),n=null)}}return{set:r,update:i,subscribe:a}}function Vr(t,e,n){let o=!Array.isArray(t),r=o?[t]:t;if(!r.every(Boolean))throw new Error("derived() expects stores as input, got a falsy value");let i=e.length<2;return zr(n,(a,s)=>{let c=!1,l=[],u=0,d=ye,f=()=>{if(u)return;d();let m=e(o?l[0]:l,a,s);i?a(m):d=Ft(m)?m:ye},p=r.map((m,h)=>sn(m,b=>{l[h]=b,u&=~(1<<h),c&&f()},()=>{u|=1<<h}));return c=!0,f(),function(){Pe(p),d(),c=!1}})}var tl=gt(Lt());var L1=typeof global=="object"&&global&&global.Object===Object&&global,Vi=L1;var P1=typeof self=="object"&&self&&self.Object===Object&&self,B1=Vi||P1||Function("return this")(),lt=B1;var j1=lt.Symbol,Tn=j1;var Np=Object.prototype,U1=Np.hasOwnProperty,z1=Np.toString,Lo=Tn?Tn.toStringTag:void 0;function V1(t){var e=U1.call(t,Lo),n=t[Lo];try{t[Lo]=void 0;var o=!0}catch{}var r=z1.call(t);return o&&(e?t[Lo]=n:delete t[Lo]),r}var Ip=V1;var W1=Object.prototype,H1=W1.toString;function G1(t){return H1.call(t)}var Fp=G1;var q1="[object Null]",X1="[object Undefined]",Dp=Tn?Tn.toStringTag:void 0;function Y1(t){return t==null?t===void 0?X1:q1:Dp&&Dp in Object(t)?Ip(t):Fp(t)}var Cn=Y1;function Q1(t){return t!=null&&typeof t=="object"}var ln=Q1;var K1=Array.isArray,Wr=K1;function J1(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var cn=J1;var $1="[object AsyncFunction]",Z1="[object Function]",ew="[object GeneratorFunction]",tw="[object Proxy]";function nw(t){if(!cn(t))return!1;var e=Cn(t);return e==Z1||e==ew||e==$1||e==tw}var Wi=nw;var rw=lt["__core-js_shared__"],Hi=rw;var Mp=function(){var t=/[^.]+$/.exec(Hi&&Hi.keys&&Hi.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function ow(t){return!!Mp&&Mp in t}var Lp=ow;var iw=Function.prototype,aw=iw.toString;function sw(t){if(t!=null){try{return aw.call(t)}catch{}try{return t+""}catch{}}return""}var Sn=sw;var lw=/[\\^$.*+?()[\]{}|]/g,cw=/^\[object .+?Constructor\]$/,uw=Function.prototype,dw=Object.prototype,fw=uw.toString,pw=dw.hasOwnProperty,mw=RegExp("^"+fw.call(pw).replace(lw,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function hw(t){if(!cn(t)||Lp(t))return!1;var e=Wi(t)?mw:cw;return e.test(Sn(t))}var Pp=hw;function gw(t,e){return t==null?void 0:t[e]}var Bp=gw;function bw(t,e){var n=Bp(t,e);return Pp(n)?n:void 0}var St=bw;var xw=St(lt,"WeakMap"),Gi=xw;var jp=Object.create,vw=function(){function t(){}return function(e){if(!cn(e))return{};if(jp)return jp(e);t.prototype=e;var n=new t;return t.prototype=void 0,n}}(),Up=vw;function yw(t,e){var n=-1,o=t.length;for(e||(e=Array(o));++n<o;)e[n]=t[n];return e}var zp=yw;var ww=function(){try{var t=St(Object,"defineProperty");return t({},"",{}),t}catch{}}(),qs=ww;function _w(t,e){for(var n=-1,o=t==null?0:t.length;++n<o&&e(t[n],n,t)!==!1;);return t}var Vp=_w;var kw=9007199254740991,Tw=/^(?:0|[1-9]\d*)$/;function Cw(t,e){var n=typeof t;return e=e==null?kw:e,!!e&&(n=="number"||n!="symbol"&&Tw.test(t))&&t>-1&&t%1==0&&t<e}var Wp=Cw;function Sw(t,e,n){e=="__proto__"&&qs?qs(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}var qi=Sw;function Ew(t,e){return t===e||t!==t&&e!==e}var Xi=Ew;var Ow=Object.prototype,Aw=Ow.hasOwnProperty;function Rw(t,e,n){var o=t[e];(!(Aw.call(t,e)&&Xi(o,n))||n===void 0&&!(e in t))&&qi(t,e,n)}var Yi=Rw;function Nw(t,e,n,o){var r=!n;n||(n={});for(var i=-1,a=e.length;++i<a;){var s=e[i],c=o?o(n[s],t[s],s,n,t):void 0;c===void 0&&(c=t[s]),r?qi(n,s,c):Yi(n,s,c)}return n}var Wn=Nw;var Iw=9007199254740991;function Fw(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=Iw}var Qi=Fw;function Dw(t){return t!=null&&Qi(t.length)&&!Wi(t)}var Ki=Dw;var Mw=Object.prototype;function Lw(t){var e=t&&t.constructor,n=typeof e=="function"&&e.prototype||Mw;return t===n}var Hr=Lw;function Pw(t,e){for(var n=-1,o=Array(t);++n<t;)o[n]=e(n);return o}var Hp=Pw;var Bw="[object Arguments]";function jw(t){return ln(t)&&Cn(t)==Bw}var Xs=jw;var Gp=Object.prototype,Uw=Gp.hasOwnProperty,zw=Gp.propertyIsEnumerable,Vw=Xs(function(){return arguments}())?Xs:function(t){return ln(t)&&Uw.call(t,"callee")&&!zw.call(t,"callee")},qp=Vw;function Ww(){return!1}var Xp=Ww;var Kp=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Yp=Kp&&typeof module=="object"&&module&&!module.nodeType&&module,Hw=Yp&&Yp.exports===Kp,Qp=Hw?lt.Buffer:void 0,Gw=Qp?Qp.isBuffer:void 0,qw=Gw||Xp,Ji=qw;var Xw="[object Arguments]",Yw="[object Array]",Qw="[object Boolean]",Kw="[object Date]",Jw="[object Error]",$w="[object Function]",Zw="[object Map]",e_="[object Number]",t_="[object Object]",n_="[object RegExp]",r_="[object Set]",o_="[object String]",i_="[object WeakMap]",a_="[object ArrayBuffer]",s_="[object DataView]",l_="[object Float32Array]",c_="[object Float64Array]",u_="[object Int8Array]",d_="[object Int16Array]",f_="[object Int32Array]",p_="[object Uint8Array]",m_="[object Uint8ClampedArray]",h_="[object Uint16Array]",g_="[object Uint32Array]",Ze={};Ze[l_]=Ze[c_]=Ze[u_]=Ze[d_]=Ze[f_]=Ze[p_]=Ze[m_]=Ze[h_]=Ze[g_]=!0;Ze[Xw]=Ze[Yw]=Ze[a_]=Ze[Qw]=Ze[s_]=Ze[Kw]=Ze[Jw]=Ze[$w]=Ze[Zw]=Ze[e_]=Ze[t_]=Ze[n_]=Ze[r_]=Ze[o_]=Ze[i_]=!1;function b_(t){return ln(t)&&Qi(t.length)&&!!Ze[Cn(t)]}var Jp=b_;function x_(t){return function(e){return t(e)}}var Gr=x_;var $p=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Po=$p&&typeof module=="object"&&module&&!module.nodeType&&module,v_=Po&&Po.exports===$p,Ys=v_&&Vi.process,y_=function(){try{var t=Po&&Po.require&&Po.require("util").types;return t||Ys&&Ys.binding&&Ys.binding("util")}catch{}}(),En=y_;var Zp=En&&En.isTypedArray,w_=Zp?Gr(Zp):Jp,em=w_;var __=Object.prototype,k_=__.hasOwnProperty;function T_(t,e){var n=Wr(t),o=!n&&qp(t),r=!n&&!o&&Ji(t),i=!n&&!o&&!r&&em(t),a=n||o||r||i,s=a?Hp(t.length,String):[],c=s.length;for(var l in t)(e||k_.call(t,l))&&!(a&&(l=="length"||r&&(l=="offset"||l=="parent")||i&&(l=="buffer"||l=="byteLength"||l=="byteOffset")||Wp(l,c)))&&s.push(l);return s}var $i=T_;function C_(t,e){return function(n){return t(e(n))}}var Zi=C_;var S_=Zi(Object.keys,Object),tm=S_;var E_=Object.prototype,O_=E_.hasOwnProperty;function A_(t){if(!Hr(t))return tm(t);var e=[];for(var n in Object(t))O_.call(t,n)&&n!="constructor"&&e.push(n);return e}var nm=A_;function R_(t){return Ki(t)?$i(t):nm(t)}var qr=R_;function N_(t){var e=[];if(t!=null)for(var n in Object(t))e.push(n);return e}var rm=N_;var I_=Object.prototype,F_=I_.hasOwnProperty;function D_(t){if(!cn(t))return rm(t);var e=Hr(t),n=[];for(var o in t)o=="constructor"&&(e||!F_.call(t,o))||n.push(o);return n}var om=D_;function M_(t){return Ki(t)?$i(t,!0):om(t)}var Xr=M_;var L_=St(Object,"create"),On=L_;function P_(){this.__data__=On?On(null):{},this.size=0}var im=P_;function B_(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}var am=B_;var j_="__lodash_hash_undefined__",U_=Object.prototype,z_=U_.hasOwnProperty;function V_(t){var e=this.__data__;if(On){var n=e[t];return n===j_?void 0:n}return z_.call(e,t)?e[t]:void 0}var sm=V_;var W_=Object.prototype,H_=W_.hasOwnProperty;function G_(t){var e=this.__data__;return On?e[t]!==void 0:H_.call(e,t)}var lm=G_;var q_="__lodash_hash_undefined__";function X_(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=On&&e===void 0?q_:e,this}var cm=X_;function Yr(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var o=t[e];this.set(o[0],o[1])}}Yr.prototype.clear=im;Yr.prototype.delete=am;Yr.prototype.get=sm;Yr.prototype.has=lm;Yr.prototype.set=cm;var Qs=Yr;function Y_(){this.__data__=[],this.size=0}var um=Y_;function Q_(t,e){for(var n=t.length;n--;)if(Xi(t[n][0],e))return n;return-1}var Hn=Q_;var K_=Array.prototype,J_=K_.splice;function $_(t){var e=this.__data__,n=Hn(e,t);if(n<0)return!1;var o=e.length-1;return n==o?e.pop():J_.call(e,n,1),--this.size,!0}var dm=$_;function Z_(t){var e=this.__data__,n=Hn(e,t);return n<0?void 0:e[n][1]}var fm=Z_;function ek(t){return Hn(this.__data__,t)>-1}var pm=ek;function tk(t,e){var n=this.__data__,o=Hn(n,t);return o<0?(++this.size,n.push([t,e])):n[o][1]=e,this}var mm=tk;function Qr(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var o=t[e];this.set(o[0],o[1])}}Qr.prototype.clear=um;Qr.prototype.delete=dm;Qr.prototype.get=fm;Qr.prototype.has=pm;Qr.prototype.set=mm;var Gn=Qr;var nk=St(lt,"Map"),qn=nk;function rk(){this.size=0,this.__data__={hash:new Qs,map:new(qn||Gn),string:new Qs}}var hm=rk;function ok(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}var gm=ok;function ik(t,e){var n=t.__data__;return gm(e)?n[typeof e=="string"?"string":"hash"]:n.map}var Xn=ik;function ak(t){var e=Xn(this,t).delete(t);return this.size-=e?1:0,e}var bm=ak;function sk(t){return Xn(this,t).get(t)}var xm=sk;function lk(t){return Xn(this,t).has(t)}var vm=lk;function ck(t,e){var n=Xn(this,t),o=n.size;return n.set(t,e),this.size+=n.size==o?0:1,this}var ym=ck;function Kr(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var o=t[e];this.set(o[0],o[1])}}Kr.prototype.clear=hm;Kr.prototype.delete=bm;Kr.prototype.get=xm;Kr.prototype.has=vm;Kr.prototype.set=ym;var wm=Kr;function uk(t,e){for(var n=-1,o=e.length,r=t.length;++n<o;)t[r+n]=e[n];return t}var ea=uk;var dk=Zi(Object.getPrototypeOf,Object),ta=dk;function fk(){this.__data__=new Gn,this.size=0}var _m=fk;function pk(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n}var km=pk;function mk(t){return this.__data__.get(t)}var Tm=mk;function hk(t){return this.__data__.has(t)}var Cm=hk;var gk=200;function bk(t,e){var n=this.__data__;if(n instanceof Gn){var o=n.__data__;if(!qn||o.length<gk-1)return o.push([t,e]),this.size=++n.size,this;n=this.__data__=new wm(o)}return n.set(t,e),this.size=n.size,this}var Sm=bk;function Jr(t){var e=this.__data__=new Gn(t);this.size=e.size}Jr.prototype.clear=_m;Jr.prototype.delete=km;Jr.prototype.get=Tm;Jr.prototype.has=Cm;Jr.prototype.set=Sm;var Em=Jr;function xk(t,e){return t&&Wn(e,qr(e),t)}var Om=xk;function vk(t,e){return t&&Wn(e,Xr(e),t)}var Am=vk;var Fm=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Rm=Fm&&typeof module=="object"&&module&&!module.nodeType&&module,yk=Rm&&Rm.exports===Fm,Nm=yk?lt.Buffer:void 0,Im=Nm?Nm.allocUnsafe:void 0;function wk(t,e){if(e)return t.slice();var n=t.length,o=Im?Im(n):new t.constructor(n);return t.copy(o),o}var Dm=wk;function _k(t,e){for(var n=-1,o=t==null?0:t.length,r=0,i=[];++n<o;){var a=t[n];e(a,n,t)&&(i[r++]=a)}return i}var Mm=_k;function kk(){return[]}var na=kk;var Tk=Object.prototype,Ck=Tk.propertyIsEnumerable,Lm=Object.getOwnPropertySymbols,Sk=Lm?function(t){return t==null?[]:(t=Object(t),Mm(Lm(t),function(e){return Ck.call(t,e)}))}:na,$r=Sk;function Ek(t,e){return Wn(t,$r(t),e)}var Pm=Ek;var Ok=Object.getOwnPropertySymbols,Ak=Ok?function(t){for(var e=[];t;)ea(e,$r(t)),t=ta(t);return e}:na,ra=Ak;function Rk(t,e){return Wn(t,ra(t),e)}var Bm=Rk;function Nk(t,e,n){var o=e(t);return Wr(t)?o:ea(o,n(t))}var oa=Nk;function Ik(t){return oa(t,qr,$r)}var jm=Ik;function Fk(t){return oa(t,Xr,ra)}var Um=Fk;var Dk=St(lt,"DataView"),ia=Dk;var Mk=St(lt,"Promise"),aa=Mk;var Lk=St(lt,"Set"),sa=Lk;var zm="[object Map]",Pk="[object Object]",Vm="[object Promise]",Wm="[object Set]",Hm="[object WeakMap]",Gm="[object DataView]",Bk=Sn(ia),jk=Sn(qn),Uk=Sn(aa),zk=Sn(sa),Vk=Sn(Gi),pr=Cn;(ia&&pr(new ia(new ArrayBuffer(1)))!=Gm||qn&&pr(new qn)!=zm||aa&&pr(aa.resolve())!=Vm||sa&&pr(new sa)!=Wm||Gi&&pr(new Gi)!=Hm)&&(pr=function(t){var e=Cn(t),n=e==Pk?t.constructor:void 0,o=n?Sn(n):"";if(o)switch(o){case Bk:return Gm;case jk:return zm;case Uk:return Vm;case zk:return Wm;case Vk:return Hm}return e});var Zr=pr;var Wk=Object.prototype,Hk=Wk.hasOwnProperty;function Gk(t){var e=t.length,n=new t.constructor(e);return e&&typeof t[0]=="string"&&Hk.call(t,"index")&&(n.index=t.index,n.input=t.input),n}var qm=Gk;var qk=lt.Uint8Array,Ks=qk;function Xk(t){var e=new t.constructor(t.byteLength);return new Ks(e).set(new Ks(t)),e}var eo=Xk;function Yk(t,e){var n=e?eo(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)}var Xm=Yk;var Qk=/\w*$/;function Kk(t){var e=new t.constructor(t.source,Qk.exec(t));return e.lastIndex=t.lastIndex,e}var Ym=Kk;var Qm=Tn?Tn.prototype:void 0,Km=Qm?Qm.valueOf:void 0;function Jk(t){return Km?Object(Km.call(t)):{}}var Jm=Jk;function $k(t,e){var n=e?eo(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)}var $m=$k;var Zk="[object Boolean]",eT="[object Date]",tT="[object Map]",nT="[object Number]",rT="[object RegExp]",oT="[object Set]",iT="[object String]",aT="[object Symbol]",sT="[object ArrayBuffer]",lT="[object DataView]",cT="[object Float32Array]",uT="[object Float64Array]",dT="[object Int8Array]",fT="[object Int16Array]",pT="[object Int32Array]",mT="[object Uint8Array]",hT="[object Uint8ClampedArray]",gT="[object Uint16Array]",bT="[object Uint32Array]";function xT(t,e,n){var o=t.constructor;switch(e){case sT:return eo(t);case Zk:case eT:return new o(+t);case lT:return Xm(t,n);case cT:case uT:case dT:case fT:case pT:case mT:case hT:case gT:case bT:return $m(t,n);case tT:return new o;case nT:case iT:return new o(t);case rT:return Ym(t);case oT:return new o;case aT:return Jm(t)}}var Zm=xT;function vT(t){return typeof t.constructor=="function"&&!Hr(t)?Up(ta(t)):{}}var eh=vT;var yT="[object Map]";function wT(t){return ln(t)&&Zr(t)==yT}var th=wT;var nh=En&&En.isMap,_T=nh?Gr(nh):th,rh=_T;var kT="[object Set]";function TT(t){return ln(t)&&Zr(t)==kT}var oh=TT;var ih=En&&En.isSet,CT=ih?Gr(ih):oh,ah=CT;var ST=1,ET=2,OT=4,sh="[object Arguments]",AT="[object Array]",RT="[object Boolean]",NT="[object Date]",IT="[object Error]",lh="[object Function]",FT="[object GeneratorFunction]",DT="[object Map]",MT="[object Number]",ch="[object Object]",LT="[object RegExp]",PT="[object Set]",BT="[object String]",jT="[object Symbol]",UT="[object WeakMap]",zT="[object ArrayBuffer]",VT="[object DataView]",WT="[object Float32Array]",HT="[object Float64Array]",GT="[object Int8Array]",qT="[object Int16Array]",XT="[object Int32Array]",YT="[object Uint8Array]",QT="[object Uint8ClampedArray]",KT="[object Uint16Array]",JT="[object Uint32Array]",Je={};Je[sh]=Je[AT]=Je[zT]=Je[VT]=Je[RT]=Je[NT]=Je[WT]=Je[HT]=Je[GT]=Je[qT]=Je[XT]=Je[DT]=Je[MT]=Je[ch]=Je[LT]=Je[PT]=Je[BT]=Je[jT]=Je[YT]=Je[QT]=Je[KT]=Je[JT]=!0;Je[IT]=Je[lh]=Je[UT]=!1;function la(t,e,n,o,r,i){var a,s=e&ST,c=e&ET,l=e&OT;if(n&&(a=r?n(t,o,r,i):n(t)),a!==void 0)return a;if(!cn(t))return t;var u=Wr(t);if(u){if(a=qm(t),!s)return zp(t,a)}else{var d=Zr(t),f=d==lh||d==FT;if(Ji(t))return Dm(t,s);if(d==ch||d==sh||f&&!r){if(a=c||f?{}:eh(t),!s)return c?Bm(t,Am(a,t)):Pm(t,Om(a,t))}else{if(!Je[d])return r?t:{};a=Zm(t,d,s)}}i||(i=new Em);var p=i.get(t);if(p)return p;i.set(t,a),ah(t)?t.forEach(function(b){a.add(la(b,e,n,b,t,i))}):rh(t)&&t.forEach(function(b,x){a.set(x,la(b,e,n,x,t,i))});var m=l?c?Um:jm:c?Xr:qr,h=u?void 0:m(t);return Vp(h||t,function(b,x){h&&(x=b,b=t[x]),Yi(a,x,la(b,e,n,x,t,i))}),a}var uh=la;var $T=1,ZT=4;function eC(t){return uh(t,$T|ZT)}var Js=eC;var kh=gt(Lt());var _h=gt(Lt());var to=at({id:"",title:"",divValue:"",textareaValue:""}[0]),ca=at(1),mr=at([""]),dh=at(!0),Bo=at(!0),ua=at(0),xj=at(!1),Pt=at(!1),hr=at(!1);var Kt="#ffeba2",Yn="#212121",fa="#ffffff",pa="Arial",ma=5,da,Qn=t=>{t.off("mouse:down"),t.off("mouse:up"),t.off("mouse:move")},no=(t,e)=>{t.selection=e,t.forEachObject(function(n){n.selectable=e}),t.renderAll()},fh=t=>{let e=t.getActiveObject();e&&(t.remove(e),e.type=="activeSelection"&&(e.getObjects().forEach(n=>t.remove(n)),t.discardActiveObject().renderAll()))},ph=t=>{t.getActiveObject()&&(tC(t),nC(t))},mh=t=>{if(!t.getActiveObject()||t.getActiveObject().type!=="activeSelection")return;let e=t.getActiveObject();e.getObjects().forEach(o=>{o.set({opacity:1})}),e.toGroup().set({opacity:rt(Pt)?.4:1}),gr(t)},hh=t=>{if(!t.getActiveObject()||t.getActiveObject().type!=="group")return;let e=t.getActiveObject(),n=e.getObjects();e._restoreObjectsState(),t.remove(e),n.forEach(o=>{o.set({opacity:rt(Pt)?.4:1}),t.add(o)}),gr(t)},gh=t=>{let e=xh();t.smoothZoom(e.x,e.y,1.25)},bh=t=>{let e=xh();t.smoothZoom(e.x,e.y,.8)},ha=t=>{ro(globalThis.canvas),t.moveTo(rt(ua),0),t.smoothZoomAbs(rt(ua),0,rt(ca))},xh=()=>{let e=globalThis.canvas.getElement().getBoundingClientRect(),n=e.x+e.width/2,o=e.y+e.height/2;return{x:n,y:o}},ro=t=>{let n=document.querySelector(".editor-main").clientWidth,o=t.getElement().offsetWidth,r=n/2-o/2;ua.set(r)},tC=t=>{t.getActiveObject()&&t.getActiveObject().clone(function(e){da=e})},nC=t=>{da.clone(function(e){t.discardActiveObject(),e.set({left:e.left+10,top:e.top+10,evented:!0}),e.type==="activeSelection"?(e.canvas=t,e.forEachObject(function(n){t.add(n)}),e.setCoords()):t.add(e),da.top+=10,da.left+=10,t.setActiveObject(e),gr(t)})},$s=(t,e=!1)=>{Pt.set(e),t.getObjects().forEach(o=>{o.set({opacity:e?.4:1,transparentCorners:!1})}),t.renderAll()},vh=t=>{t.on("object:modified",function(e){let n=e.target;n&&(n.type==="rect"&&rC(t,n),n.type==="ellipse"&&oC(t,n),n.type==="i-text"&&iC(t,n))})},rC=(t,e)=>{let n=e.width*e.scaleX,o=e.height*e.scaleY;e.set({width:n,height:o,scaleX:1,scaleY:1}),Zs(t,e)},oC=(t,e)=>{let n=e.rx*e.scaleX,o=e.ry*e.scaleY,r=e.width*e.scaleX,i=e.height*e.scaleY;e.set({rx:n,ry:o,width:r,height:i,scaleX:1,scaleY:1}),Zs(t,e)},iC=(t,e)=>{Zs(t,e)},Zs=(t,e)=>{e.left<0&&e.set({left:0}),e.top<0&&e.set({top:0}),e.left+e.width*e.scaleX+e.strokeWidth>t.width&&e.set({left:t.width-e.width*e.scaleX}),e.top+e.height*e.scaleY+e.strokeWidth>t.height&&e.set({top:t.height-e.height*e.scaleY}),e.setCoords()};function ga(t,e){e.setControlsVisibility({mb:!1,ml:!1,mt:!1,mr:!1});let n;e.on("scaling",o=>{["bl","br","tr","tl"].includes(o.transform.corner)&&(clearTimeout(n),t.uniformScaling=!0,n=setTimeout(()=>{t.uniformScaling=!1},500))})}function el(t){t.stroke=Yn}var gr=t=>{t.requestRenderAll()},yh=t=>{t.clear()},wh=t=>{t.on("object:moving",function(e){let n=e.target;n.getScaledHeight()>n.canvas.height||n.getScaledWidth()>n.canvas.width||(n.setCoords(),(n.getBoundingRect().top<0||n.getBoundingRect().left<0)&&(n.top=Math.max(n.top,n.top-n.getBoundingRect().top),n.left=Math.max(n.left,n.left-n.getBoundingRect().left)),(n.getBoundingRect().top+n.getBoundingRect().height>n.canvas.height||n.getBoundingRect().left+n.getBoundingRect().width>n.canvas.width)&&(n.top=Math.min(n.top,n.canvas.height-n.getBoundingRect().height+n.top-n.getBoundingRect().top),n.left=Math.min(n.left,n.canvas.width-n.getBoundingRect().width+n.left-n.getBoundingRect().left)))})};function Et(t){return Number.isNaN(t)||t==0?".0000":t.toFixed(4).replace(/^0+|0+$/g,"")}function Kn(t,e){return e/t.width}function Jn(t,e){return e/t.height}function $n(t,e){return Math.round(e*t.width)}function Zn(t,e){return Math.round(e*t.height)}var Bt=class t{constructor({left:e=0,top:n=0,fill:o=Kt,occludeInactive:r,ordinal:i=0}={}){this.fill=Kt;this.ordinal=0;this.left=e,this.top=n,this.fill=o,this.occludeInactive=r,this.ordinal=i}toDataForCloze(){return{left:Et(this.left),top:Et(this.top),...this.fill===Kt?{}:{fill:this.fill}}}toFabric(e){let n=this.toAbsolute(e);return new _h.fabric.Object(n)}normalPosition(e){return{left:Kn(e,this.left),top:Jn(e,this.top)}}toNormal(e){return new t({...this,...this.normalPosition(e)})}absolutePosition(e){return{left:$n(e,this.left),top:Zn(e,this.top)}}toAbsolute(e){return new t({...this,...this.absolutePosition(e)})}};var un=class t extends Bt{constructor({rx:n=0,ry:o=0,...r}={}){super(r);this.rx=n,this.ry=o}toDataForCloze(){return{...super.toDataForCloze(),rx:Et(this.rx),ry:Et(this.ry)}}toFabric(n){let o=this.toAbsolute(n);return new kh.fabric.Ellipse(o)}toNormal(n){return new t({...this,...super.normalPosition(n),rx:Kn(n,this.rx),ry:Jn(n,this.ry)})}toAbsolute(n){return new t({...this,...super.absolutePosition(n),rx:$n(n,this.rx),ry:Zn(n,this.ry)})}};var Th=gt(Lt());var dn=class t extends Bt{constructor({points:n=[],...o}={}){super(o);this.points=n}toDataForCloze(){return{...super.toDataForCloze(),points:this.points.map(({x:n,y:o})=>`${Et(n)},${Et(o)}`).join(" ")}}toFabric(n){let o=this.toAbsolute(n);return new Th.fabric.Polygon(o.points,o)}toNormal(n){let o=[];return this.points.forEach(r=>{o.push({x:Kn(n,r.x),y:Jn(n,r.y)})}),new t({...this,...super.normalPosition(n),points:o})}toAbsolute(n){let o=[];return this.points.forEach(r=>{o.push({x:$n(n,r.x),y:Zn(n,r.y)})}),new t({...this,...super.absolutePosition(n),points:o})}},jo=class{constructor({x:e=0,y:n=0}={}){this.x=0;this.y=0;this.x=e,this.y=n}};var Ch=gt(Lt());var fn=class t extends Bt{constructor({width:n=0,height:o=0,...r}={}){super(r);this.width=n,this.height=o}toDataForCloze(){return{...super.toDataForCloze(),width:Et(this.width),height:Et(this.height)}}toFabric(n){let o=this.toAbsolute(n);return new Ch.fabric.Rect(o)}toNormal(n){return new t({...this,...super.normalPosition(n),width:Kn(n,this.width),height:Jn(n,this.height)})}toAbsolute(n){return new t({...this,...super.absolutePosition(n),width:$n(n,this.width),height:Zn(n,this.height)})}};var Sh=gt(Lt());var Jt=class t extends Bt{constructor({text:n="",scaleX:o=1,scaleY:r=1,...i}={}){super(i);this.text=n,this.scaleX=o,this.scaleY=r}toDataForCloze(){return{...super.toDataForCloze(),text:this.text,scale:Et(this.scaleX)}}toFabric(n){let o=this.toAbsolute(n);return new Sh.fabric.IText(o.text,{...o,fontFamily:pa,backgroundColor:fa,padding:ma})}toNormal(n){return new t({...this,...super.normalPosition(n)})}toAbsolute(n){return new t({...this,...super.absolutePosition(n)})}};function ba(t){let e=nl(),n="",o=0;return e.forEach(r=>{n+=Oh(r,o,t),r instanceof Jt||o++}),{clozes:n,noteCount:o}}function nl(){let t=globalThis.canvas,e=t.getActiveObject(),n=e instanceof tl.fabric.ActiveSelection&&e.size()>1?e:null;return t.getObjects().map(r=>{let i=n!=null&&n.contains(r)?n:void 0;return Eh(t,r,i)}).filter(r=>r!==null)}function Eh(t,e,n){let o,r=Js(e);if(n){let i=n.getObjectScaling();r.width=r.width*i.scaleX,r.height=r.height*i.scaleY}switch(e.type){case"rect":o=new fn(r);break;case"ellipse":o=new un(r);break;case"polygon":o=new dn(r);break;case"i-text":o=new Jt(r);break;case"group":return e._objects.map(i=>Eh(t,i,e));default:return null}if(n){let i=tl.fabric.util.transformPoint({x:o.left,y:o.top},n.calcTransformMatrix());o.left=i.x,o.top=i.y}return o=o.toNormal(t),o}function Oh(t,e,n){let o="";function r(s,c){c=c.replace(":","\\:"),o+=`:${s}=${c}`}let i;if(Array.isArray(t))return t.map(s=>Oh(s,e,n)).join("");if(t instanceof fn)i="rect";else if(t instanceof un)i="ellipse";else if(t instanceof dn)i="polygon";else if(t instanceof Jt)i="text";else throw new Error("Unknown shape type");for(let[s,c]of Object.entries(t.toDataForCloze()))r(s,c);n&&r("oi","1");let a;return i==="text"?a=0:a=e+1,t.ordinal=a,o=`{{c${a}::image-occlusion:${i}${o}}}<br>`,o}function aC(t){let e,n,o=t[4].default,r=Ne(o,t,t[3],null);return{c(){e=ie("span"),r&&r.c(),ze(e,"--width-multiplier",t[1]),ze(e,"--icon-size",t[0]+"%"),Q(e,"class","svelte-111fj0e"),de(e,"flip-x",t[2])},m(i,a){Y(i,e,a),r&&r.m(e,null),n=!0},p(i,[a]){r&&r.p&&(!n||a&8)&&Fe(r,o,i,i[3],n?Ie(o,i[3],a,null):De(i[3]),null),(!n||a&2)&&ze(e,"--width-multiplier",i[1]),(!n||a&1)&&ze(e,"--icon-size",i[0]+"%"),(!n||a&4)&&de(e,"flip-x",i[2])},i(i){n||(W(r,i),n=!0)},o(i){H(r,i),n=!1},d(i){i&&X(e),r&&r.d(i)}}}function sC(t,e,n){let{$$slots:o={},$$scope:r}=e,{iconSize:i=100}=e,{widthMultiplier:a=1}=e,{flipX:s=!1}=e;return t.$$set=c=>{"iconSize"in c&&n(0,i=c.iconSize),"widthMultiplier"in c&&n(1,a=c.widthMultiplier),"flipX"in c&&n(2,s=c.flipX),"$$scope"in c&&n(3,r=c.$$scope)},[i,a,s,r,o]}var rl=class extends pe{constructor(e){super(),he(this,e,sC,aC,me,{iconSize:0,widthMultiplier:1,flipX:2})}},er=rl;function lC(t){let e,n=t[10].default,o=Ne(n,t,t[13],null);return{c(){o&&o.c()},m(r,i){o&&o.m(r,i),e=!0},p(r,i){o&&o.p&&(!e||i&8192)&&Fe(o,n,r,r[13],e?Ie(n,r[13],i,null):De(r[13]),null)},i(r){e||(W(o,r),e=!0)},o(r){H(o,r),e=!1},d(r){o&&o.d(r)}}}function cC(t){let e,n,o,r,i,a,s;return n=new er({props:{flipX:t[9],widthMultiplier:t[8],iconSize:t[7],$$slots:{default:[lC]},$$scope:{ctx:t}}}),{c(){e=ie("button"),le(n.$$.fragment),Q(e,"id",t[0]),Q(e,"class",o="icon-button "+t[1]+" svelte-1p77nr8"),Q(e,"title",t[2]),e.disabled=t[5],Q(e,"tabindex",r=t[6]?0:-1),de(e,"active",t[4]),de(e,"primary",t[3])},m(c,l){Y(c,e,l),ae(n,e,null),i=!0,a||(s=[_e(e,"click",t[11]),_e(e,"mousedown",Ct(t[12]))],a=!0)},p(c,[l]){let u={};l&512&&(u.flipX=c[9]),l&256&&(u.widthMultiplier=c[8]),l&128&&(u.iconSize=c[7]),l&8192&&(u.$$scope={dirty:l,ctx:c}),n.$set(u),(!i||l&1)&&Q(e,"id",c[0]),(!i||l&2&&o!==(o="icon-button "+c[1]+" svelte-1p77nr8"))&&Q(e,"class",o),(!i||l&4)&&Q(e,"title",c[2]),(!i||l&32)&&(e.disabled=c[5]),(!i||l&64&&r!==(r=c[6]?0:-1))&&Q(e,"tabindex",r),(!i||l&18)&&de(e,"active",c[4]),(!i||l&10)&&de(e,"primary",c[3])},i(c){i||(W(n.$$.fragment,c),i=!0)},o(c){H(n.$$.fragment,c),i=!1},d(c){c&&X(e),se(n),a=!1,Pe(s)}}}function uC(t,e,n){let{$$slots:o={},$$scope:r}=e,{id:i=void 0}=e,{class:a=""}=e,{tooltip:s=void 0}=e,{primary:c=!1}=e,{active:l=!1}=e,{disabled:u=!1}=e,{tabbable:d=!1}=e,{iconSize:f=75}=e,{widthMultiplier:p=1}=e,{flipX:m=!1}=e;function h(x){Oe.call(this,t,x)}function b(x){Oe.call(this,t,x)}return t.$$set=x=>{"id"in x&&n(0,i=x.id),"class"in x&&n(1,a=x.class),"tooltip"in x&&n(2,s=x.tooltip),"primary"in x&&n(3,c=x.primary),"active"in x&&n(4,l=x.active),"disabled"in x&&n(5,u=x.disabled),"tabbable"in x&&n(6,d=x.tabbable),"iconSize"in x&&n(7,f=x.iconSize),"widthMultiplier"in x&&n(8,p=x.widthMultiplier),"flipX"in x&&n(9,m=x.flipX),"$$scope"in x&&n(13,r=x.$$scope)},[i,a,s,c,l,u,d,f,p,m,o,h,b,r]}var ol=class extends pe{constructor(e){super(),he(this,e,uC,cC,me,{id:0,class:1,tooltip:2,primary:3,active:4,disabled:5,tabbable:6,iconSize:7,widthMultiplier:8,flipX:9})}},vt=ol;var il='<svg xmlns="http://www.w3.org/2000/svg" id="mdi-align-horizontal-center" viewBox="0 0 24 24"><path d="M11 2H13V7H21V10H13V14H18V17H13V22H11V17H6V14H11V10H3V7H11V2Z" /></svg>';var al='<svg xmlns="http://www.w3.org/2000/svg" id="mdi-align-horizontal-left" viewBox="0 0 24 24"><path d="M4 22H2V2H4V22M22 7H6V10H22V7M16 14H6V17H16V14Z" /></svg>';var sl='<svg xmlns="http://www.w3.org/2000/svg" id="mdi-align-horizontal-right" viewBox="0 0 24 24"><path d="M20 2H22V22H20V2M2 10H18V7H2V10M8 17H18V14H8V17Z" /></svg>';var ll='<svg xmlns="http://www.w3.org/2000/svg" id="mdi-align-vertical-bottom" viewBox="0 0 24 24"><path d="M22 22H2V20H22V22M10 2H7V18H10V2M17 8H14V18H17V8Z" /></svg>';var cl='<svg xmlns="http://www.w3.org/2000/svg" id="mdi-align-vertical-center" viewBox="0 0 24 24"><path d="M22 11H17V6H14V11H10V3H7V11H1.8V13H7V21H10V13H14V18H17V13H22V11Z" /></svg>';var ul='<svg xmlns="http://www.w3.org/2000/svg" id="mdi-align-vertical-top" viewBox="0 0 24 24"><path d="M22 2V4H2V2H22M7 22H10V6H7V22M14 16H17V6H14V16Z" /></svg>';var dl='<svg xmlns="http://www.w3.org/2000/svg" id="mdi-close" viewBox="0 0 24 24"><path d="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z" /></svg>';var fl='<svg xmlns="http://www.w3.org/2000/svg" id="mdi-code-tags" viewBox="0 0 24 24"><path d="M14.6,16.6L19.2,12L14.6,7.4L16,6L22,12L16,18L14.6,16.6M9.4,16.6L4.8,12L9.4,7.4L8,6L2,12L8,18L9.4,16.6Z" /></svg>';var pl='<svg xmlns="http://www.w3.org/2000/svg" id="mdi-content-copy" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z" /></svg>';var ml='<svg xmlns="http://www.w3.org/2000/svg" id="mdi-cursor-default-outline" viewBox="0 0 24 24"><path d="M10.07,14.27C10.57,14.03 11.16,14.25 11.4,14.75L13.7,19.74L15.5,18.89L13.19,13.91C12.95,13.41 13.17,12.81 13.67,12.58L13.95,12.5L16.25,12.05L8,5.12V15.9L9.82,14.43L10.07,14.27M13.64,21.97C13.14,22.21 12.54,22 12.31,21.5L10.13,16.76L7.62,18.78C7.45,18.92 7.24,19 7,19A1,1 0 0,1 6,18V3A1,1 0 0,1 7,2C7.24,2 7.47,2.09 7.64,2.23L7.65,2.22L19.14,11.86C19.57,12.22 19.62,12.85 19.27,13.27C19.12,13.45 18.91,13.57 18.7,13.61L15.54,14.23L17.74,18.96C18,19.46 17.76,20.05 17.26,20.28L13.64,21.97Z" /></svg>';var hl='<svg xmlns="http://www.w3.org/2000/svg" id="mdi-delete-outline" viewBox="0 0 24 24"><path d="M6,19A2,2 0 0,0 8,21H16A2,2 0 0,0 18,19V7H6V19M8,9H16V19H8V9M15.5,4L14.5,3H9.5L8.5,4H5V6H19V4H15.5Z" /></svg>';var gl='<svg xmlns="http://www.w3.org/2000/svg" id="mdi-ellipse-outline" viewBox="0 0 24 24"><path d="M12,6C16.41,6 20,8.69 20,12C20,15.31 16.41,18 12,18C7.59,18 4,15.31 4,12C4,8.69 7.59,6 12,6M12,4C6.5,4 2,7.58 2,12C2,16.42 6.5,20 12,20C17.5,20 22,16.42 22,12C22,7.58 17.5,4 12,4Z" /></svg>';var bl='<svg xmlns="http://www.w3.org/2000/svg" id="mdi-eye" viewBox="0 0 24 24"><path d="M12,9A3,3 0 0,0 9,12A3,3 0 0,0 12,15A3,3 0 0,0 15,12A3,3 0 0,0 12,9M12,17A5,5 0 0,1 7,12A5,5 0 0,1 12,7A5,5 0 0,1 17,12A5,5 0 0,1 12,17M12,4.5C7,4.5 2.73,7.61 1,12C2.73,16.39 7,19.5 12,19.5C17,19.5 21.27,16.39 23,12C21.27,7.61 17,4.5 12,4.5Z" /></svg>';var xl='<svg xmlns="http://www.w3.org/2000/svg" id="mdi-format-align-center" viewBox="0 0 24 24"><path d="M3,3H21V5H3V3M7,7H17V9H7V7M3,11H21V13H3V11M7,15H17V17H7V15M3,19H21V21H3V19Z" /></svg>';var vl='<svg xmlns="http://www.w3.org/2000/svg" id="mdi-format-bold" viewBox="0 0 24 24"><path d="M13.5,15.5H10V12.5H13.5A1.5,1.5 0 0,1 15,14A1.5,1.5 0 0,1 13.5,15.5M10,6.5H13A1.5,1.5 0 0,1 14.5,8A1.5,1.5 0 0,1 13,9.5H10M15.6,10.79C16.57,10.11 17.25,9 17.25,8C17.25,5.74 15.5,4 13.25,4H7V18H14.04C16.14,18 17.75,16.3 17.75,14.21C17.75,12.69 16.89,11.39 15.6,10.79Z" /></svg>';var yl='<svg xmlns="http://www.w3.org/2000/svg" id="mdi-format-italic" viewBox="0 0 24 24"><path d="M10,4V7H12.21L8.79,15H6V18H14V15H11.79L15.21,7H18V4H10Z" /></svg>';var wl='<svg xmlns="http://www.w3.org/2000/svg" id="mdi-format-underline" viewBox="0 0 24 24"><path d="M5,21H19V19H5V21M12,17A6,6 0 0,0 18,11V3H15.5V11A3.5,3.5 0 0,1 12,14.5A3.5,3.5 0 0,1 8.5,11V3H6V11A6,6 0 0,0 12,17Z" /></svg>';var _l='<svg xmlns="http://www.w3.org/2000/svg" id="mdi-group" viewBox="0 0 24 24"><path d="M1,1V5H2V19H1V23H5V22H19V23H23V19H22V5H23V1H19V2H5V1M5,4H19V5H20V19H19V20H5V19H4V5H5M6,6V14H9V18H18V9H14V6M8,8H12V12H8M14,11H16V16H11V14H14" /></svg>';var kl='<svg xmlns="http://www.w3.org/2000/svg" id="mdi-magnify-expand" viewBox="0 0 24 24"><path d="M18 16H17.42L16.61 15.19C17.5 14 18 12.5 18 11C18 7.13 14.87 4 11 4C9.5 4 8 4.5 6.79 5.4C3.7 7.72 3.07 12.11 5.39 15.2C7.71 18.29 12.1 18.92 15.19 16.6L16 17.41V18L21 23L23 21L18 16M11 16C8.24 16 6 13.76 6 11S8.24 6 11 6 16 8.24 16 11 13.76 16 11 16M3 6L1 8V1H8L6 3H3V6M21 1V8L19 6V3H16L14 1H21M6 19L8 21H1V14L3 16V19H6Z" /></svg>';var Tl='<svg xmlns="http://www.w3.org/2000/svg" id="mdi-magnify-minus-outline" viewBox="0 0 24 24"><path d="M15.5,14H14.71L14.43,13.73C15.41,12.59 16,11.11 16,9.5A6.5,6.5 0 0,0 9.5,3A6.5,6.5 0 0,0 3,9.5A6.5,6.5 0 0,0 9.5,16C11.11,16 12.59,15.41 13.73,14.43L14,14.71V15.5L19,20.5L20.5,19L15.5,14M9.5,14C7,14 5,12 5,9.5C5,7 7,5 9.5,5C12,5 14,7 14,9.5C14,12 12,14 9.5,14M7,9H12V10H7V9Z" /></svg>';var Cl='<svg xmlns="http://www.w3.org/2000/svg" id="mdi-magnify-plus-outline" viewBox="0 0 24 24"><path d="M15.5,14L20.5,19L19,20.5L14,15.5V14.71L13.73,14.43C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.43,13.73L14.71,14H15.5M9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14M12,10H10V12H9V10H7V9H9V7H10V9H12V10Z" /></svg>';var Sl='<svg xmlns="http://www.w3.org/2000/svg" id="mdi-magnify-scan" viewBox="0 0 24 24"><path d="M17 22V20H20V17H22V20.5C22 20.89 21.84 21.24 21.54 21.54C21.24 21.84 20.89 22 20.5 22H17M7 22H3.5C3.11 22 2.76 21.84 2.46 21.54C2.16 21.24 2 20.89 2 20.5V17H4V20H7V22M17 2H20.5C20.89 2 21.24 2.16 21.54 2.46C21.84 2.76 22 3.11 22 3.5V7H20V4H17V2M7 2V4H4V7H2V3.5C2 3.11 2.16 2.76 2.46 2.46C2.76 2.16 3.11 2 3.5 2H7M10.5 6C13 6 15 8 15 10.5C15 11.38 14.75 12.2 14.31 12.9L17.57 16.16L16.16 17.57L12.9 14.31C12.2 14.75 11.38 15 10.5 15C8 15 6 13 6 10.5C6 8 8 6 10.5 6M10.5 8C9.12 8 8 9.12 8 10.5C8 11.88 9.12 13 10.5 13C11.88 13 13 11.88 13 10.5C13 9.12 11.88 8 10.5 8Z" /></svg>';var El='<svg xmlns="http://www.w3.org/2000/svg" id="mdi-rectangle-outline" viewBox="0 0 24 24"><path d="M4,6V19H20V6H4M18,17H6V8H18V17Z" /></svg>';var Ol='<svg xmlns="http://www.w3.org/2000/svg" id="mdi-redo" viewBox="0 0 24 24"><path d="M18.4,10.6C16.55,9 14.15,8 11.5,8C6.85,8 2.92,11.03 1.54,15.22L3.9,16C4.95,12.81 7.95,10.5 11.5,10.5C13.45,10.5 15.23,11.22 16.62,12.38L13,16H22V7L18.4,10.6Z" /></svg>';var xa='<svg xmlns="http://www.w3.org/2000/svg" id="mdi-square" viewBox="0 0 24 24"><path d="M3,3V21H21V3" /></svg>';var Al='<svg xmlns="http://www.w3.org/2000/svg" id="mdi-text-box" viewBox="0 0 24 24"><path d="M14,17H7V15H14M17,13H7V11H17M17,9H7V7H17M19,3H5C3.89,3 3,3.89 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5C21,3.89 20.1,3 19,3Z" /></svg>';var Rl='<svg xmlns="http://www.w3.org/2000/svg" id="mdi-undo" viewBox="0 0 24 24"><path d="M12.5,8C9.85,8 7.45,9 5.6,10.6L2,7V16H11L7.38,12.38C8.77,11.22 10.54,10.5 12.5,10.5C16.04,10.5 19.05,12.81 20.1,16L22.47,15.22C21.08,11.03 17.15,8 12.5,8Z" /></svg>';var Nl='<svg xmlns="http://www.w3.org/2000/svg" id="mdi-ungroup" viewBox="0 0 24 24"><path d="M2,2H6V3H13V2H17V6H16V9H18V8H22V12H21V18H22V22H18V21H12V22H8V18H9V16H6V17H2V13H3V6H2V2M18,12V11H16V13H17V17H13V16H11V18H12V19H18V18H19V12H18M13,6V5H6V6H5V13H6V14H9V12H8V8H12V9H14V6H13M12,12H11V14H13V13H14V11H12V12Z" /></svg>';var Il='<svg xmlns="http://www.w3.org/2000/svg" id="mdi-vector-polygon-variant" viewBox="0 0 24 24"><path d="M22 8V2H16V5.8L14.4 8H9.6L8 5.8V2H2V8H4V16H2V22H8V20H16V22H22V16H20V8H22M11 10H13V12H11V10M4 4H6V6H4V4M6 20H4V18H6V20M16 18H8V16H6V8H7.1L9 10.6V14H15V10.6L16.9 8H18V16H16V18M20 20H18V18H20V20M18 6V4H20V6H18Z" /></svg>';var va='<svg xmlns="http://www.w3.org/2000/svg" id="mdi-view-dashboard" viewBox="0 0 24 24"><path d="M13,3V9H21V3M13,21H21V11H13M3,21H11V15H3M3,13H11V3H3V13Z" /></svg>';function Ah(t){let e,n,o,r,i,a,s;return i=new vt({props:{iconSize:96,class:"toast-icon",$$slots:{default:[zC]},$$scope:{ctx:t}}}),i.$on("click",t[3]),{c(){e=ie("div"),n=ie("div"),o=We(t[2]),r=xe(),le(i.$$.fragment),Q(n,"class",a="toast "+(t[1]==="success"?"success":"error")+" svelte-1svf720"),Q(e,"class","toast-container desktop-only svelte-1svf720")},m(c,l){Y(c,e,l),Ce(e,n),Ce(n,o),Ce(n,r),ae(i,n,null),s=!0},p(c,l){(!s||l&4)&&Dt(o,c[2]);let u={};l&16&&(u.$$scope={dirty:l,ctx:c}),i.$set(u),(!s||l&2&&a!==(a="toast "+(c[1]==="success"?"success":"error")+" svelte-1svf720"))&&Q(n,"class",a)},i(c){s||(W(i.$$.fragment,c),s=!0)},o(c){H(i.$$.fragment,c),s=!1},d(c){c&&X(e),se(i)}}}function zC(t){let e,n;return{c(){e=new $e(!1),n=Ue(),e.a=n},m(o,r){e.m(dl,o,r),Y(o,n,r)},p:ye,d(o){o&&(X(n),e.d())}}}function VC(t){let e,n,o=t[0]&&Ah(t);return{c(){o&&o.c(),e=Ue()},m(r,i){o&&o.m(r,i),Y(r,e,i),n=!0},p(r,[i]){r[0]?o?(o.p(r,i),i&1&&W(o,1)):(o=Ah(r),o.c(),W(o,1),o.m(e.parentNode,e)):o&&(Me(),H(o,1,1,()=>{o=null}),Le())},i(r){n||(W(o),n=!0)},o(r){H(o),n=!1},d(r){r&&X(e),o&&o.d(r)}}}function WC(t,e,n){let{type:o="success"}=e,{message:r}=e,{showToast:i=!1}=e,a=()=>{n(0,i=!1)};return t.$$set=s=>{"type"in s&&n(1,o=s.type),"message"in s&&n(2,r=s.message),"showToast"in s&&n(0,i=s.showToast)},[i,o,r,a]}var Fl=class extends pe{constructor(e){super(),he(this,e,WC,VC,me,{type:1,message:2,showToast:0})}},ya=Fl;var Nh=async function(t,e){let{clozes:n,noteCount:o}=ba(e);if(o===0)return;let r=rt(to),i=rt(mr),a=r[0].textareaValue,s=r[1].textareaValue;if(a=a?`<div>${a}</div>`:"",s=a?`<div>${s}</div>`:"",t.kind=="edit"){let c=await cp({noteId:BigInt(t.noteId),occlusions:n,header:a,backExtra:s,tags:i});Rh(t.noteId,c,o)}else{let c=await lp({notetypeId:BigInt(t.notetypeId),imagePath:t.imagePath,occlusions:n,header:a,backExtra:s,tags:i});Rh(null,c,o)}},Rh=(t,e,n)=>{let o=new ya({target:document.body,props:{message:"",type:"error"}});if(e.note){let r=t?Zu({count:n}):Od({count:n});o.$set({message:r,type:"success",showToast:!0})}else{let r=Id();o.$set({message:r,showToast:!0})}};var wx=gt(mg());var An="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),Ca=[];for(let t=0;t<An.length;t++)Ca[An[t].charCodeAt(0)]=t;Ca["-".charCodeAt(0)]=An.indexOf("+");Ca["_".charCodeAt(0)]=An.indexOf("/");var Bl={dec(t){let e=t.length*3/4;t[t.length-2]=="="?e-=2:t[t.length-1]=="="&&(e-=1);let n=new Uint8Array(e),o=0,r=0,i,a=0;for(let s=0;s<t.length;s++){if(i=Ca[t.charCodeAt(s)],i===void 0)switch(t[s]){case"=":r=0;case`
`:case"\r":case"	":case" ":continue;default:throw Error("invalid base64 string.")}switch(r){case 0:a=i,r=1;break;case 1:n[o++]=a<<2|(i&48)>>4,a=i,r=2;break;case 2:n[o++]=(a&15)<<4|(i&60)>>2,a=i,r=3;break;case 3:n[o++]=(a&3)<<6|i,r=0;break}}if(r==1)throw Error("invalid base64 string.");return n.subarray(0,o)},enc(t){let e="",n=0,o,r=0;for(let i=0;i<t.length;i++)switch(o=t[i],n){case 0:e+=An[o>>2],r=(o&3)<<4,n=1;break;case 1:e+=An[r|o>>4],r=(o&15)<<2,n=2;break;case 2:e+=An[r|o>>6],e+=An[o&63],n=0;break}return n&&(e+=An[r],e+="=",n==1&&(e+="=")),e}};var br=gt(Lt());function _2(t,e){let{width:n,height:o}=t,r=window.devicePixelRatio;e.width*=r,e.height*=r;let i=Math.min(e.width/t.width,e.height/t.height);n*=i,o*=i;let a=4096*4096,s=n*o;if(s>a){let c=Math.sqrt(a)/Math.sqrt(s);n*=c,o*=c}return{width:Math.floor(n),height:Math.floor(o)}}function Sa(t,e){let{width:n,height:o}=_2(t,e);return{width:n/window.devicePixelRatio,height:o/window.devicePixelRatio}}function hg(t){let e=[];for(let n of t){let o=[];for(let r of n.shapes)if(k2(r.shape)){let i=Object.fromEntries(r.properties.map(a=>[a.name,a.value]));o.push(T2(r.shape,i))}o.length>1?e.push(o):e.push(o[0])}return e}function k2(t){return["rect","ellipse","polygon","text"].includes(t)}function T2(t,e){switch(e.left=parseFloat(Number.isNaN(Number(e.left))?".0000":e.left),e.top=parseFloat(Number.isNaN(Number(e.top))?".0000":e.top),t){case"rect":return new fn({...e,width:parseFloat(e.width),height:parseFloat(e.height)});case"ellipse":return new un({...e,rx:parseFloat(e.rx),ry:parseFloat(e.ry)});case"polygon":return e.points!==""?e.points=e.points.split(" ").map(n=>{let[o,r]=n.split(",");return new jo({x:o,y:r})}):e.points=[new jo({x:0,y:0})],new dn(e);case"text":return new Jt({...e,scaleX:parseFloat(e.scale),scaleY:parseFloat(e.scale)})}}var gg=gt(Lt());var Ea=(t,e)=>{let n=e.toFabric(t);el(n),n.type==="i-text"&&ga(t,n),t.add(n)},Oa=(t,e)=>{let n=new gg.fabric.Group;e.map(o=>{let r=o.toFabric(t);el(r),n.addWithUpdate(r)}),t.add(n)};var bg=(t,e)=>{for(let n of hg(e))Array.isArray(n)?Oa(t,n):Ea(t,n);gr(t)};var Rn=gt(Lt());var xg="S",vg="R",yg="E",wg="P",_g="T",kg="M",Tg="Control+Z",Cg="Control+Y",Sg="[",Eg="]",Og="F",jl="L",Ag="Delete",Rg="D",Ng="G",Ig="U",Fg="Shift+L",Dg="Shift+H",Mg="Shift+R",Lg="Shift+T",Pg="Shift+V",Bg="Shift+B";var C2=["rect","ellipse","i-text"],S2=t=>!(t.width<=5||t.height<=5||C2.indexOf(t.type)===-1),Ul=class{constructor(){this.stack=[];this.index=-1;this.locked=!1;this.shapeIds=new Set;this.state=at({undoable:!1,redoable:!1});this.subscribe=this.state.subscribe}setCanvas(e){this.canvas=e,this.canvas.on("object:modified",n=>this.maybePush(n)),this.canvas.on("object:removed",n=>this.maybePush(n))}reset(){this.shapeIds.clear(),this.stack.length=0,this.index=-1,this.push(),this.updateState()}canUndo(){return this.index>0}canRedo(){return this.index<this.stack.length-1}updateState(){this.state.set({undoable:this.canUndo(),redoable:this.canRedo()})}updateCanvas(){var e;this.locked=!0,(e=this.canvas)==null||e.loadFromJSON(this.stack[this.index],()=>{var n;(n=this.canvas)==null||n.renderAll(),tr(),this.locked=!1})}onObjectAdded(e){this.shapeIds.has(e)||this.push(),this.shapeIds.add(e),tr()}onObjectModified(){this.push()}maybePush(e){!this.locked&&S2(e.target)&&this.push()}push(){this.stack.length=this.index+1,this.stack.push(JSON.stringify(this.canvas)),this.index++,this.updateState()}undo(){this.canUndo()&&(this.index--,this.updateState(),this.updateCanvas())}redo(){this.canRedo()&&(this.index++,this.updateState(),this.updateCanvas())}},ht=new Ul,zl=[{name:"undo",icon:Rl,action:()=>ht.undo(),tooltip:Ud,shortcut:Tg},{name:"redo",icon:Ol,action:()=>ht.redo(),tooltip:jd,shortcut:Cg}];var nr,$t,Vo=[],rr=[],ao=!1,Vl=1,Wl=(t,e)=>{t.discardActiveObject(),t.forEachObject(function(n){n.selectable=!1}),t.selectionColor="rgba(0, 0, 0, 0)",t.on("mouse:down",function(n){try{n.target&&n.target.id===rr[0].id?A2(t,rr):O2(t,n,e)}catch{}}),t.on("mouse:move",function(n){if(nr&&nr.class==="line"){let o=t.getPointer(n.e);nr.set({x2:o.x,y2:o.y});let r=$t.get("points");r[rr.length]={x:o.x,y:o.y},$t.set({points:r})}t.renderAll()})},E2=t=>{ao=!ao,ao?(nr=null,$t=null,Vo=[],rr=[],ao=!1,t.selection=!0):(ao=!0,t.selection=!1)},O2=(t,e,n)=>{Vl=n.getTransform().scale;let o=document.querySelector(".canvas-container").getBoundingClientRect(),r=e.e.touches?e.e.touches[0].clientX:e.e.clientX,i=e.e.touches?e.e.touches[0].clientY:e.e.clientY;r=(r-o.left)/Vl,i=(i-o.top)/Vl;let a=new Rn.fabric.Circle({radius:5,fill:"#ffffff",stroke:"#333333",strokeWidth:.5,originX:"left",originY:"top",left:r,top:i,selectable:!1,hasBorders:!1,hasControls:!1,objectCaching:!1});rr.length===0&&a.set({fill:"red"});let s=[r,i,r,i],c=new Rn.fabric.Line(s,{strokeWidth:2,fill:"#999999",stroke:"#999999",originX:"left",originY:"top",selectable:!1,hasBorders:!1,hasControls:!1,evented:!1,objectCaching:!1});if(c.class="line",$t){let l=t.getPointer(e.e),u=$t.get("points");u.push({x:l.x,y:l.y});let d=new Rn.fabric.Polygon(u,{stroke:"#333333",strokeWidth:1,fill:"#cccccc",opacity:.3,selectable:!1,hasBorders:!1,hasControls:!1,evented:!1,objectCaching:!1});t.remove($t),t.add(d),$t=d,t.renderAll()}else{let l=[{x:r,y:i}],u=new Rn.fabric.Polygon(l,{stroke:"#333333",strokeWidth:1,fill:"#cccccc",opacity:.3,selectable:!1,hasBorders:!1,hasControls:!1,evented:!1,objectCaching:!1});$t=u,t.add(u)}nr=c,rr.push(a),Vo.push(c),t.add(c),t.add(a)},A2=(t,e)=>{let n=[];e.forEach(r=>{n.push({x:r.left,y:r.top}),t.remove(r)}),Vo.forEach(r=>{t.remove(r)}),t.remove($t).remove(nr);let o=new Rn.fabric.Polygon(n,{id:"polygon-"+new Date().getTime(),fill:Kt,objectCaching:!1,stroke:Yn,strokeWidth:1,strokeUniform:!0,noScaleCache:!1,opacity:rt(Pt)?.4:1});o.width>5&&o.height>5&&(t.add(o),t.setActiveObject(o),ht.onObjectAdded(o.id)),E2(t)},jg=(t,e)=>{let n=e.calcTransformMatrix(),o=e.get("points").map(function(i){return new Rn.fabric.Point(i.x-e.pathOffset.x,i.y-e.pathOffset.y)}).map(function(i){return Rn.fabric.util.transformPoint(i,n)}),r=new Rn.fabric.Polygon(o,{id:e.id,fill:Kt,objectCaching:!1,stroke:Yn,strokeWidth:1,strokeUniform:!0,noScaleCache:!1,opacity:rt(Pt)?.4:1});t.remove(e),t.add(r)},Ug=t=>{t.remove($t).remove(nr),rr.forEach(e=>{t.remove(e)}),Vo.forEach(e=>{t.remove(e)}),nr=null,$t=null,Vo=[],rr=[],ao=!1,t.selection=!0};var zg=async(t,e,n,o)=>{let r=await Ds({path:t}),i=Wg(n),a=document.getElementById("image");return a.src=Hl(r.data,t),a.onload=function(){let s=Sa({width:a.width,height:a.height},Gl());i.setWidth(s.width),i.setHeight(s.height),a.height=s.height,a.width=s.width,Wo(i,e),ht.reset(),o({path:t})},i},Vg=async(t,e,n,o)=>{var l;let r=await sp({noteId:BigInt(t)}),i=(l=r.value)==null?void 0:l.case;if(!i||i==="error"){new ya({target:document.body,props:{message:Fd(),type:"error"}}).$set({showToast:!0});return}let a=r.value.value,s=Wg(n),c=document.getElementById("image");return c.style.visibility="hidden",c.src=Hl(a.imageData,a.imageFileName),c.onload=function(){let u=Sa({width:c.width,height:c.height},Gl());s.setWidth(u.width),s.setHeight(u.height),c.height=u.height,c.width=u.width,Wo(s,e),bg(s,a.occlusions),no(s,!0),R2(a.header,a.backExtra,a.tags),ht.reset(),window.requestAnimationFrame(()=>{c.style.visibility="visible",o({noteId:BigInt(t)})})},s};function Wg(t){let e=new br.fabric.Canvas("canvas");return mr.set([]),globalThis.canvas=e,ht.setCanvas(e),e.perPixelTargetFind=!0,e.uniformScaling=!1,e.uniScaleKey="none",delete br.fabric.Object.prototype.controls.mtr,br.fabric.Object.prototype.transparentCorners=!1,br.fabric.Object.prototype.cornerStyle="circle",br.fabric.Object.prototype.cornerStrokeColor="#000000",vh(e),wh(e),e.on("object:modified",n=>{n.target instanceof br.fabric.Polygon&&(jg(e,n.target),ht.onObjectModified()),t()}),e.on("object:removed",t),ro(e),e}var Hl=(t,e)=>{let n=Bl.enc(t),o=e.split(".").pop();return`data:image/${{jpg:"jpeg",jpeg:"jpeg",gif:"gif",svg:"svg+xml",webp:"webp",avif:"avif",png:"png"}[o]||"png"};base64,${n}`},Wo=(t,e)=>{let n=(innerWidth-40)/t.width,o=(innerHeight-100)/t.height,r=n<o?n:o;ca.set(r),ha(e)},R2=(t,e,n)=>{let o=rt(to);o[0].divValue=t,o[1].divValue=e,o[0].textareaValue=t,o[1].textareaValue=e,mr.set(n),o.forEach(r=>{let i=`${r.id}--div`,a=`${r.id}--textarea`,s=document.getElementById(i),c=document.getElementById(a);s.innerHTML=r.divValue,c.value=r.textareaValue})};function Gl(){let t=document.querySelector(".editor-main");return{width:t.clientWidth,height:t.clientHeight}}async function N2(t,e){let n=await Ds({path:t}),o=document.getElementById("image");o.src=Hl(n.data,t);let r=globalThis.canvas;o.onload=function(){let i=Sa({width:o.naturalWidth,height:o.naturalHeight},Gl());r.setWidth(i.width),r.setHeight(i.height),o.height=i.height,o.width=i.width,e({path:t})}}globalThis.resetIOImage=N2;var H8=Symbol("fontFamily"),G8=Symbol("fontSize"),Hg=Symbol("direction"),q8=Symbol("description"),X8=Symbol("collapsed"),so=Symbol("tagActionsShortcuts");function xr(t,e,n,o){return t.addEventListener(e,n,o),()=>t.removeEventListener(e,n,o)}function Gg(t){t.preventDefault()}function Nn(){let t=window.navigator["platform"];return t.startsWith("Mac")||t.startsWith("iP")}var ql=["Control","Alt","Shift","Meta"],Xl=Nn()?["Meta","Alt","Shift","Control"]:["Control","Alt","Shift","OS"];function I2(t){return Xl[ql.indexOf(t)]}function qg(t){let e=!1;for(let n of ql)e||(e=t.code.startsWith(n));return e}var Xg=(t,e=[])=>n=>ql.reduce((o,r,i)=>o&&(e.includes(r)||n.getModifierState(Xl[i])===t.includes(r)),!0),Aa=t=>e=>{let n=I2(t),o=e.getModifierState(n);return e.type==="keyup"?o&&e.key!==n:o},Yg=Aa("Control"),Qg=Aa("Shift"),$8=Aa("Alt"),Ra=Aa("Meta");function Kg(t){let e=Nn()?["^","\u2325","\u21E7","\u2318"]:[`${Ad()}+`,"Alt+",`${Rd()}+`,"Win+"],n="";for(let o of t)n+=e[Xl.indexOf(o)];return n}function Jg(t){switch(t){case"Backspace":return"\u232B";case"Delete":return"\u2326";case"Escape":return"\u238B";default:return t}}function $g(t){return t.code==="ArrowLeft"?!0:Nn()&&Ra(t)&&t.code==="KeyB"}function Zg(t){return t.code==="ArrowRight"?!0:Nn()&&Ra(t)&&t.code==="KeyF"}function eb(t){return t.code==="ArrowUp"?!0:Nn()&&Ra(t)&&t.code==="KeyP"}function tb(t){return t.code==="ArrowDown"?!0:Nn()&&Ra(t)&&t.code==="KeyN"}function Yl(t){return e=>{switch(e.code){case"Enter":case"Space":t();break}}}var Ho={},Ql=()=>!1;function F2(t,e){Ho[t]=e}function vr(t,e,n){let o=n?new Proxy(e,{set:Ql,defineProperty:Ql,deleteProperty:Ql,get:(r,i)=>(i in n&&console.log(`anki: ${i} is deprecated: ${n[i]}`),r[i])}):e;F2(t,o)}function nb(t){if(t in Ho)return Ho[t];throw new Error(`Cannot require "${t}" at runtime.`)}function D2(){return Object.keys(Ho)}function M2(...t){for(let e of t)if(!(e in Ho))return!1;return!0}Object.assign(window,{require:nb});vr("anki/packages",{require:nb,listPackages:D2,hasPackages:M2});var L2={Backspace:8,Delete:46,Tab:9,Enter:13,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,"=":187,"-":189,"[":219,"]":221,"\\":220,";":186,"'":222,",":188,".":190,"/":191,"`":192};function rb(t){return!t.endsWith("?")}function ob(t){return t.split(", ").map(e=>e.split("+"))}function P2(t){return Kg(t.slice(0,-1).filter(rb))+Jg(t[t.length-1])}function yt(t){return ob(t).map(P2).join(", ")}function B2(t,e){return t["which"]===e}function j2(t,e){let n=[],o=[];return e.forEach(r=>{(t(r)?n:o).push(r)}),[n,o]}function U2(t){return t.substring(0,t.length-1)}function z2(t){let[e,n]=j2(rb,t),o=n.map(U2);return[e,o]}var V2=(t,e,n)=>o=>B2(o,t)&&Xg(e,n)(o);function W2(t){return L2[t]||t.toUpperCase().charCodeAt(0)}function H2(t){let e=W2(t[t.length-1]),[n,o]=z2(t.slice(0,-1));return V2(e,n,o)}function ib(t,e,n,...o){if(o.length===0)return n(e);let[r,...i]=o,a=xr(document,"keydown",s,{once:!0});function s(c){r(c)?ib(t,c,n,...i):qg(c)||a()}}var Kl={target:document,event:"keydown"};function Go(t,e,n=Kl){let{target:o=Kl.target,event:r=Kl.event}=n,[i,...a]=ob(e).map(H2);function s(c){i(c)&&ib(o,c,t,...a)}return xr(o,r,s)}vr("anki/shortcuts",{registerShortcut:Go,getPlatformString:yt});function G2(t){let e,n,o,r,i,a,s=t[11].default,c=Ne(s,t,t[10],null);return{c(){e=ie("button"),c&&c.c(),Q(e,"id",t[1]),Q(e,"role",t[2]),Q(e,"aria-selected",t[3]),Q(e,"tabindex",n=t[8]?0:-1),Q(e,"class",o="dropdown-item "+t[4]+" svelte-1ft3k22"),Q(e,"title",t[5]),e.disabled=t[7],de(e,"active",t[6]),de(e,"rtl",t[9])},m(l,u){Y(l,e,u),c&&c.m(e,null),t[17](e),r=!0,i||(a=[_e(e,"mouseenter",t[12]),_e(e,"focus",t[13]),_e(e,"keydown",t[14]),_e(e,"click",t[15]),_e(e,"mousedown",Ct(t[16]))],i=!0)},p(l,[u]){c&&c.p&&(!r||u&1024)&&Fe(c,s,l,l[10],r?Ie(s,l[10],u,null):De(l[10]),null),(!r||u&2)&&Q(e,"id",l[1]),(!r||u&4)&&Q(e,"role",l[2]),(!r||u&8)&&Q(e,"aria-selected",l[3]),(!r||u&256&&n!==(n=l[8]?0:-1))&&Q(e,"tabindex",n),(!r||u&16&&o!==(o="dropdown-item "+l[4]+" svelte-1ft3k22"))&&Q(e,"class",o),(!r||u&32)&&Q(e,"title",l[5]),(!r||u&128)&&(e.disabled=l[7]),(!r||u&80)&&de(e,"active",l[6]),(!r||u&528)&&de(e,"rtl",l[9])},i(l){r||(W(c,l),r=!0)},o(l){H(c,l),r=!1},d(l){l&&X(e),c&&c.d(l),t[17](null),i=!1,Pe(a)}}}function q2(t,e,n){let{$$slots:o={},$$scope:r}=e,{id:i=void 0}=e,{role:a=void 0}=e,{selected:s=!1}=e,{class:c=""}=e,{buttonRef:l=void 0}=e,{tooltip:u=void 0}=e,{active:d=!1}=e,{disabled:f=!1}=e,p=window.getComputedStyle(document.body).direction=="rtl",{tabbable:m=!1}=e;function h(C){Oe.call(this,t,C)}function b(C){Oe.call(this,t,C)}function x(C){Oe.call(this,t,C)}function y(C){Oe.call(this,t,C)}function M(C){Oe.call(this,t,C)}function E(C){He[C?"unshift":"push"](()=>{l=C,n(0,l)})}return t.$$set=C=>{"id"in C&&n(1,i=C.id),"role"in C&&n(2,a=C.role),"selected"in C&&n(3,s=C.selected),"class"in C&&n(4,c=C.class),"buttonRef"in C&&n(0,l=C.buttonRef),"tooltip"in C&&n(5,u=C.tooltip),"active"in C&&n(6,d=C.active),"disabled"in C&&n(7,f=C.disabled),"tabbable"in C&&n(8,m=C.tabbable),"$$scope"in C&&n(10,r=C.$$scope)},t.$$.update=()=>{t.$$.dirty&65&&l&&d&&l.scrollIntoView({behavior:"smooth",block:"nearest"})},[l,i,a,s,c,u,d,f,m,p,r,o,h,b,x,y,M,E]}var Jl=class extends pe{constructor(e){super(),he(this,e,q2,G2,me,{id:1,role:2,selected:3,class:4,buttonRef:0,tooltip:5,active:6,disabled:7,tabbable:8})}},yr=Jl;var d7=Symbol("touchDevice"),f7=Symbol("section"),p7=Symbol("buttonGroup"),m7=Symbol("dropdown"),h7=Symbol("modals"),Na=Symbol("floating"),g7=Symbol("overlay"),b7=Symbol("select"),x7=Symbol("selectShow"),v7=Symbol("selectFocusId");function X2(t){let e,n,o,r=`${t[5]}px`,i,a,s,c=t[10].default,l=Ne(c,t,t[9],null);return{c(){e=ie("div"),n=ie("div"),l&&l.c(),Q(n,"class","popover svelte-1hgq719"),Q(n,"id",t[0]),Q(n,"role","listbox"),de(n,"scrollable",t[1]),de(n,"hidden",t[2]),de(n,"top",t[3]==="top"),de(n,"right",t[3]==="right"),de(n,"bottom",t[3]==="bottom"),de(n,"left",t[3]==="left"),Q(e,"class","popover-wrapper d-flex svelte-1hgq719"),ze(e,"--min-height",r)},m(u,d){Y(u,e,d),Ce(e,n),l&&l.m(n,null),t[11](e),i=!0,a||(s=Tt(o=t[7].call(null,n)),a=!0)},p(u,[d]){l&&l.p&&(!i||d&512)&&Fe(l,c,u,u[9],i?Ie(c,u[9],d,null):De(u[9]),null),(!i||d&1)&&Q(n,"id",u[0]),(!i||d&2)&&de(n,"scrollable",u[1]),(!i||d&4)&&de(n,"hidden",u[2]),(!i||d&8)&&de(n,"top",u[3]==="top"),(!i||d&8)&&de(n,"right",u[3]==="right"),(!i||d&8)&&de(n,"bottom",u[3]==="bottom"),(!i||d&8)&&de(n,"left",u[3]==="left"),d&32&&r!==(r=`${u[5]}px`)&&ze(e,"--min-height",r)},i(u){i||(W(l,u),i=!0)},o(u){H(l,u),i=!1},d(u){u&&X(e),l&&l.d(u),t[11](null),a=!1,s()}}}function Y2(t,e,n){let o,{$$slots:r={},$$scope:i}=e,{id:a=""}=e,{scrollable:s=!1}=e,c,l=!0,u=0,d,f=qe(),p=kn(Na);ot(t,p,b=>n(8,o=b)),mt(async()=>{n(5,u=c.offsetHeight)});function m(b){f("revealed",b)}function h(b){He[b?"unshift":"push"](()=>{c=b,n(4,c)})}return t.$$set=b=>{"id"in b&&n(0,a=b.id),"scrollable"in b&&n(1,s=b.scrollable),"$$scope"in b&&n(9,i=b.$$scope)},t.$$.update=()=>{t.$$.dirty&268&&o!==void 0&&l&&o.then(b=>{d!=b&&(n(3,d=b),n(2,l=!1))})},[a,s,l,d,c,u,p,m,o,i,r,h]}var $l=class extends pe{constructor(e){super(),he(this,e,Y2,X2,me,{id:0,scrollable:1})}},lo=$l;function Q2(t,e,n){let{keyCombination:o}=e,{event:r=void 0}=e,i=qe();return mt(()=>Go(a=>{Gg(a),i("action",{originalEvent:a})},o,{event:r})),t.$$set=a=>{"keyCombination"in a&&n(0,o=a.keyCombination),"event"in a&&n(1,r=a.event)},[o,r]}var Zl=class extends pe{constructor(e){super(),he(this,e,Q2,null,me,{keyCombination:0,event:1})}},Ot=Zl;function ab(...t){return()=>{for(let e of t)e()}}function K2(t){return t.button===2}function J2(t,{reference:e,floating:n,inside:o,outside:r}){function i(s){return s.includes(e)?!1:o&&s.includes(n)?"insideClick":r&&!s.includes(n)?"outsideClick":!1}function a(s){return K2(s)?"secondaryButton":i(s.composedPath())}return Vr(t,(s,c)=>{let l=a(s);l&&c({reason:l,originalEvent:s})})}var sb=J2;function $2(t,e){function n(o){return o.key==="Tab"?!1:"keyup"}return Vr(t,(o,r)=>{let i=n(o);i&&r({reason:i,originalEvent:o})})}var lb=$2;function Z2(t,e,n){let o=new n(e);return zr(o,r=>xr(t,e,r))}function eS(){let t=new MouseEvent("click");return zr(t,e=>{let n,o;function r(a){n=a.clientX,o=a.clientY}function i(a){Math.abs(n-a.clientX)<5&&Math.abs(o-a.clientY)<5&&e(a)}return document.addEventListener("mousedown",r),document.addEventListener("click",i),()=>{document.removeEventListener("click",i),document.removeEventListener("mousedown",r)}})}var cb=eS(),ub=Z2(document,"keyup",KeyboardEvent);function db(t){let e=!1;function n(r){e=r}let o=xr(document,"keydown",r=>{r.key==="Escape"&&e&&(r.stopImmediatePropagation(),t&&t())},{capture:!0});return{set:n,remove:o}}function tS(t,e=document.body){let n;async function o(i){n=i,n&&n.append(t)}function r(){t.remove()}return o(e),{update:o,destroy:r}}var fb=tS;var pb=["top","right","bottom","left"];var Zt=Math.min,Wt=Math.max,Xo=Math.round,Yo=Math.floor,In=t=>({x:t,y:t}),nS={left:"right",right:"left",bottom:"top",top:"bottom"},rS={start:"end",end:"start"};function Fa(t,e,n){return Wt(t,Zt(e,n))}function or(t,e){return typeof t=="function"?t(e):t}function pn(t){return t.split("-")[0]}function co(t){return t.split("-")[1]}function ec(t){return t==="x"?"y":"x"}function Da(t){return t==="y"?"height":"width"}function uo(t){return["top","bottom"].includes(pn(t))?"y":"x"}function Ma(t){return ec(uo(t))}function mb(t,e,n){n===void 0&&(n=!1);let o=co(t),r=Ma(t),i=Da(r),a=r==="x"?o===(n?"end":"start")?"right":"left":o==="start"?"bottom":"top";return e.reference[i]>e.floating[i]&&(a=qo(a)),[a,qo(a)]}function hb(t){let e=qo(t);return[Ia(t),e,Ia(e)]}function Ia(t){return t.replace(/start|end/g,e=>rS[e])}function oS(t,e,n){let o=["left","right"],r=["right","left"],i=["top","bottom"],a=["bottom","top"];switch(t){case"top":case"bottom":return n?e?r:o:e?o:r;case"left":case"right":return e?i:a;default:return[]}}function gb(t,e,n,o){let r=co(t),i=oS(pn(t),n==="start",o);return r&&(i=i.map(a=>a+"-"+r),e&&(i=i.concat(i.map(Ia)))),i}function qo(t){return t.replace(/left|right|bottom|top/g,e=>nS[e])}function iS(t){return{top:0,right:0,bottom:0,left:0,...t}}function La(t){return typeof t!="number"?iS(t):{top:t,right:t,bottom:t,left:t}}function Fn(t){return{...t,top:t.y,left:t.x,right:t.x+t.width,bottom:t.y+t.height}}function bb(t,e,n){let{reference:o,floating:r}=t,i=uo(e),a=Ma(e),s=Da(a),c=pn(e),l=i==="y",u=o.x+o.width/2-r.width/2,d=o.y+o.height/2-r.height/2,f=o[s]/2-r[s]/2,p;switch(c){case"top":p={x:u,y:o.y-r.height};break;case"bottom":p={x:u,y:o.y+o.height};break;case"right":p={x:o.x+o.width,y:d};break;case"left":p={x:o.x-r.width,y:d};break;default:p={x:o.x,y:o.y}}switch(co(e)){case"start":p[a]-=f*(n&&l?-1:1);break;case"end":p[a]+=f*(n&&l?-1:1);break}return p}var yb=async(t,e,n)=>{let{placement:o="bottom",strategy:r="absolute",middleware:i=[],platform:a}=n,s=i.filter(Boolean),c=await(a.isRTL==null?void 0:a.isRTL(e)),l=await a.getElementRects({reference:t,floating:e,strategy:r}),{x:u,y:d}=bb(l,o,c),f=o,p={},m=0;for(let h=0;h<s.length;h++){let{name:b,fn:x}=s[h],{x:y,y:M,data:E,reset:C}=await x({x:u,y:d,initialPlacement:o,placement:f,strategy:r,middlewareData:p,rects:l,platform:a,elements:{reference:t,floating:e}});if(u=y!=null?y:u,d=M!=null?M:d,p={...p,[b]:{...p[b],...E}},C&&m<=50){m++,typeof C=="object"&&(C.placement&&(f=C.placement),C.rects&&(l=C.rects===!0?await a.getElementRects({reference:t,floating:e,strategy:r}):C.rects),{x:u,y:d}=bb(l,f,c)),h=-1;continue}}return{x:u,y:d,placement:f,strategy:r,middlewareData:p}};async function Qo(t,e){var n;e===void 0&&(e={});let{x:o,y:r,platform:i,rects:a,elements:s,strategy:c}=t,{boundary:l="clippingAncestors",rootBoundary:u="viewport",elementContext:d="floating",altBoundary:f=!1,padding:p=0}=or(e,t),m=La(p),b=s[f?d==="floating"?"reference":"floating":d],x=Fn(await i.getClippingRect({element:(n=await(i.isElement==null?void 0:i.isElement(b)))==null||n?b:b.contextElement||await(i.getDocumentElement==null?void 0:i.getDocumentElement(s.floating)),boundary:l,rootBoundary:u,strategy:c})),y=d==="floating"?{...a.floating,x:o,y:r}:a.reference,M=await(i.getOffsetParent==null?void 0:i.getOffsetParent(s.floating)),E=await(i.isElement==null?void 0:i.isElement(M))?await(i.getScale==null?void 0:i.getScale(M))||{x:1,y:1}:{x:1,y:1},C=Fn(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({rect:y,offsetParent:M,strategy:c}):y);return{top:(x.top-C.top+m.top)/E.y,bottom:(C.bottom-x.bottom+m.bottom)/E.y,left:(x.left-C.left+m.left)/E.x,right:(C.right-x.right+m.right)/E.x}}var tc=t=>({name:"arrow",options:t,async fn(e){let{x:n,y:o,placement:r,rects:i,platform:a,elements:s,middlewareData:c}=e,{element:l,padding:u=0}=or(t,e)||{};if(l==null)return{};let d=La(u),f={x:n,y:o},p=Ma(r),m=Da(p),h=await a.getDimensions(l),b=p==="y",x=b?"top":"left",y=b?"bottom":"right",M=b?"clientHeight":"clientWidth",E=i.reference[m]+i.reference[p]-f[p]-i.floating[m],C=f[p]-i.reference[p],j=await(a.getOffsetParent==null?void 0:a.getOffsetParent(l)),P=j?j[M]:0;(!P||!await(a.isElement==null?void 0:a.isElement(j)))&&(P=s.floating[M]||i.floating[m]);let D=E/2-C/2,N=P/2-h[m]/2-1,S=Zt(d[x],N),G=Zt(d[y],N),v=S,T=P-h[m]-G,R=P/2-h[m]/2+D,A=Fa(v,R,T),U=!c.arrow&&co(r)!=null&&R!=A&&i.reference[m]/2-(R<v?S:G)-h[m]/2<0,k=U?R<v?R-v:R-T:0;return{[p]:f[p]+k,data:{[p]:A,centerOffset:R-A-k,...U&&{alignmentOffset:k}},reset:U}}});var nc=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var n,o;let{placement:r,middlewareData:i,rects:a,initialPlacement:s,platform:c,elements:l}=e,{mainAxis:u=!0,crossAxis:d=!0,fallbackPlacements:f,fallbackStrategy:p="bestFit",fallbackAxisSideDirection:m="none",flipAlignment:h=!0,...b}=or(t,e);if((n=i.arrow)!=null&&n.alignmentOffset)return{};let x=pn(r),y=pn(s)===s,M=await(c.isRTL==null?void 0:c.isRTL(l.floating)),E=f||(y||!h?[qo(s)]:hb(s));!f&&m!=="none"&&E.push(...gb(s,h,m,M));let C=[s,...E],j=await Qo(e,b),P=[],D=((o=i.flip)==null?void 0:o.overflows)||[];if(u&&P.push(j[x]),d){let v=mb(r,a,M);P.push(j[v[0]],j[v[1]])}if(D=[...D,{placement:r,overflows:P}],!P.every(v=>v<=0)){var N,S;let v=(((N=i.flip)==null?void 0:N.index)||0)+1,T=C[v];if(T)return{data:{index:v,overflows:D},reset:{placement:T}};let R=(S=D.filter(A=>A.overflows[0]<=0).sort((A,U)=>A.overflows[1]-U.overflows[1])[0])==null?void 0:S.placement;if(!R)switch(p){case"bestFit":{var G;let A=(G=D.map(U=>[U.placement,U.overflows.filter(k=>k>0).reduce((k,w)=>k+w,0)]).sort((U,k)=>U[1]-k[1])[0])==null?void 0:G[0];A&&(R=A);break}case"initialPlacement":R=s;break}if(r!==R)return{reset:{placement:R}}}return{}}}};function xb(t,e){return{top:t.top-e.height,right:t.right-e.width,bottom:t.bottom-e.height,left:t.left-e.width}}function vb(t){return pb.some(e=>t[e]>=0)}var Pa=function(t){return t===void 0&&(t={}),{name:"hide",options:t,async fn(e){let{rects:n}=e,{strategy:o="referenceHidden",...r}=or(t,e);switch(o){case"referenceHidden":{let i=await Qo(e,{...r,elementContext:"reference"}),a=xb(i,n.reference);return{data:{referenceHiddenOffsets:a,referenceHidden:vb(a)}}}case"escaped":{let i=await Qo(e,{...r,altBoundary:!0}),a=xb(i,n.floating);return{data:{escapedOffsets:a,escaped:vb(a)}}}default:return{}}}}};function wb(t){let e=Zt(...t.map(i=>i.left)),n=Zt(...t.map(i=>i.top)),o=Wt(...t.map(i=>i.right)),r=Wt(...t.map(i=>i.bottom));return{x:e,y:n,width:o-e,height:r-n}}function aS(t){let e=t.slice().sort((r,i)=>r.y-i.y),n=[],o=null;for(let r=0;r<e.length;r++){let i=e[r];!o||i.y-o.y>o.height/2?n.push([i]):n[n.length-1].push(i),o=i}return n.map(r=>Fn(wb(r)))}var rc=function(t){return t===void 0&&(t={}),{name:"inline",options:t,async fn(e){let{placement:n,elements:o,rects:r,platform:i,strategy:a}=e,{padding:s=2,x:c,y:l}=or(t,e),u=Array.from(await(i.getClientRects==null?void 0:i.getClientRects(o.reference))||[]),d=aS(u),f=Fn(wb(u)),p=La(s);function m(){if(d.length===2&&d[0].left>d[1].right&&c!=null&&l!=null)return d.find(b=>c>b.left-p.left&&c<b.right+p.right&&l>b.top-p.top&&l<b.bottom+p.bottom)||f;if(d.length>=2){if(uo(n)==="y"){let S=d[0],G=d[d.length-1],v=pn(n)==="top",T=S.top,R=G.bottom,A=v?S.left:G.left,U=v?S.right:G.right,k=U-A,w=R-T;return{top:T,bottom:R,left:A,right:U,width:k,height:w,x:A,y:T}}let b=pn(n)==="left",x=Wt(...d.map(S=>S.right)),y=Zt(...d.map(S=>S.left)),M=d.filter(S=>b?S.left===y:S.right===x),E=M[0].top,C=M[M.length-1].bottom,j=y,P=x,D=P-j,N=C-E;return{top:E,bottom:C,left:j,right:P,width:D,height:N,x:j,y:E}}return f}let h=await i.getElementRects({reference:{getBoundingClientRect:m},floating:o.floating,strategy:a});return r.reference.x!==h.reference.x||r.reference.y!==h.reference.y||r.reference.width!==h.reference.width||r.reference.height!==h.reference.height?{reset:{rects:h}}:{}}}};async function sS(t,e){let{placement:n,platform:o,elements:r}=t,i=await(o.isRTL==null?void 0:o.isRTL(r.floating)),a=pn(n),s=co(n),c=uo(n)==="y",l=["left","top"].includes(a)?-1:1,u=i&&c?-1:1,d=or(e,t),{mainAxis:f,crossAxis:p,alignmentAxis:m}=typeof d=="number"?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...d};return s&&typeof m=="number"&&(p=s==="end"?m*-1:m),c?{x:p*u,y:f*l}:{x:f*l,y:p*u}}var oc=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){let{x:n,y:o}=e,r=await sS(e,t);return{x:n+r.x,y:o+r.y,data:r}}}},ic=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){let{x:n,y:o,placement:r}=e,{mainAxis:i=!0,crossAxis:a=!1,limiter:s={fn:b=>{let{x,y}=b;return{x,y}}},...c}=or(t,e),l={x:n,y:o},u=await Qo(e,c),d=uo(pn(r)),f=ec(d),p=l[f],m=l[d];if(i){let b=f==="y"?"top":"left",x=f==="y"?"bottom":"right",y=p+u[b],M=p-u[x];p=Fa(y,p,M)}if(a){let b=d==="y"?"top":"left",x=d==="y"?"bottom":"right",y=m+u[b],M=m-u[x];m=Fa(y,m,M)}let h=s.fn({...e,[f]:p,[d]:m});return{...h,data:{x:h.x-n,y:h.y-o}}}}};function Dn(t){return kb(t)?(t.nodeName||"").toLowerCase():"#document"}function At(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function mn(t){var e;return(e=(kb(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function kb(t){return t instanceof Node||t instanceof At(t).Node}function hn(t){return t instanceof Element||t instanceof At(t).Element}function en(t){return t instanceof HTMLElement||t instanceof At(t).HTMLElement}function _b(t){return typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof At(t).ShadowRoot}function po(t){let{overflow:e,overflowX:n,overflowY:o,display:r}=jt(t);return/auto|scroll|overlay|hidden|clip/.test(e+o+n)&&!["inline","contents"].includes(r)}function Tb(t){return["table","td","th"].includes(Dn(t))}function Ba(t){let e=ja(),n=jt(t);return n.transform!=="none"||n.perspective!=="none"||(n.containerType?n.containerType!=="normal":!1)||!e&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!e&&(n.filter?n.filter!=="none":!1)||["transform","perspective","filter"].some(o=>(n.willChange||"").includes(o))||["paint","layout","strict","content"].some(o=>(n.contain||"").includes(o))}function Cb(t){let e=wr(t);for(;en(e)&&!Ko(e);){if(Ba(e))return e;e=wr(e)}return null}function ja(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function Ko(t){return["html","body","#document"].includes(Dn(t))}function jt(t){return At(t).getComputedStyle(t)}function Jo(t){return hn(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.pageXOffset,scrollTop:t.pageYOffset}}function wr(t){if(Dn(t)==="html")return t;let e=t.assignedSlot||t.parentNode||_b(t)&&t.host||mn(t);return _b(e)?e.host:e}function Sb(t){let e=wr(t);return Ko(e)?t.ownerDocument?t.ownerDocument.body:t.body:en(e)&&po(e)?e:Sb(e)}function fo(t,e,n){var o;e===void 0&&(e=[]),n===void 0&&(n=!0);let r=Sb(t),i=r===((o=t.ownerDocument)==null?void 0:o.body),a=At(r);return i?e.concat(a,a.visualViewport||[],po(r)?r:[],a.frameElement&&n?fo(a.frameElement):[]):e.concat(r,fo(r,[],n))}function Ab(t){let e=jt(t),n=parseFloat(e.width)||0,o=parseFloat(e.height)||0,r=en(t),i=r?t.offsetWidth:n,a=r?t.offsetHeight:o,s=Xo(n)!==i||Xo(o)!==a;return s&&(n=i,o=a),{width:n,height:o,$:s}}function ac(t){return hn(t)?t:t.contextElement}function mo(t){let e=ac(t);if(!en(e))return In(1);let n=e.getBoundingClientRect(),{width:o,height:r,$:i}=Ab(e),a=(i?Xo(n.width):n.width)/o,s=(i?Xo(n.height):n.height)/r;return(!a||!Number.isFinite(a))&&(a=1),(!s||!Number.isFinite(s))&&(s=1),{x:a,y:s}}var lS=In(0);function Rb(t){let e=At(t);return!ja()||!e.visualViewport?lS:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function cS(t,e,n){return e===void 0&&(e=!1),!n||e&&n!==At(t)?!1:e}function _r(t,e,n,o){e===void 0&&(e=!1),n===void 0&&(n=!1);let r=t.getBoundingClientRect(),i=ac(t),a=In(1);e&&(o?hn(o)&&(a=mo(o)):a=mo(t));let s=cS(i,n,o)?Rb(i):In(0),c=(r.left+s.x)/a.x,l=(r.top+s.y)/a.y,u=r.width/a.x,d=r.height/a.y;if(i){let f=At(i),p=o&&hn(o)?At(o):o,m=f.frameElement;for(;m&&o&&p!==f;){let h=mo(m),b=m.getBoundingClientRect(),x=jt(m),y=b.left+(m.clientLeft+parseFloat(x.paddingLeft))*h.x,M=b.top+(m.clientTop+parseFloat(x.paddingTop))*h.y;c*=h.x,l*=h.y,u*=h.x,d*=h.y,c+=y,l+=M,m=At(m).frameElement}}return Fn({width:u,height:d,x:c,y:l})}function uS(t){let{rect:e,offsetParent:n,strategy:o}=t,r=en(n),i=mn(n);if(n===i)return e;let a={scrollLeft:0,scrollTop:0},s=In(1),c=In(0);if((r||!r&&o!=="fixed")&&((Dn(n)!=="body"||po(i))&&(a=Jo(n)),en(n))){let l=_r(n);s=mo(n),c.x=l.x+n.clientLeft,c.y=l.y+n.clientTop}return{width:e.width*s.x,height:e.height*s.y,x:e.x*s.x-a.scrollLeft*s.x+c.x,y:e.y*s.y-a.scrollTop*s.y+c.y}}function dS(t){return Array.from(t.getClientRects())}function Nb(t){return _r(mn(t)).left+Jo(t).scrollLeft}function fS(t){let e=mn(t),n=Jo(t),o=t.ownerDocument.body,r=Wt(e.scrollWidth,e.clientWidth,o.scrollWidth,o.clientWidth),i=Wt(e.scrollHeight,e.clientHeight,o.scrollHeight,o.clientHeight),a=-n.scrollLeft+Nb(t),s=-n.scrollTop;return jt(o).direction==="rtl"&&(a+=Wt(e.clientWidth,o.clientWidth)-r),{width:r,height:i,x:a,y:s}}function pS(t,e){let n=At(t),o=mn(t),r=n.visualViewport,i=o.clientWidth,a=o.clientHeight,s=0,c=0;if(r){i=r.width,a=r.height;let l=ja();(!l||l&&e==="fixed")&&(s=r.offsetLeft,c=r.offsetTop)}return{width:i,height:a,x:s,y:c}}function mS(t,e){let n=_r(t,!0,e==="fixed"),o=n.top+t.clientTop,r=n.left+t.clientLeft,i=en(t)?mo(t):In(1),a=t.clientWidth*i.x,s=t.clientHeight*i.y,c=r*i.x,l=o*i.y;return{width:a,height:s,x:c,y:l}}function Eb(t,e,n){let o;if(e==="viewport")o=pS(t,n);else if(e==="document")o=fS(mn(t));else if(hn(e))o=mS(e,n);else{let r=Rb(t);o={...e,x:e.x-r.x,y:e.y-r.y}}return Fn(o)}function Ib(t,e){let n=wr(t);return n===e||!hn(n)||Ko(n)?!1:jt(n).position==="fixed"||Ib(n,e)}function hS(t,e){let n=e.get(t);if(n)return n;let o=fo(t,[],!1).filter(s=>hn(s)&&Dn(s)!=="body"),r=null,i=jt(t).position==="fixed",a=i?wr(t):t;for(;hn(a)&&!Ko(a);){let s=jt(a),c=Ba(a);!c&&s.position==="fixed"&&(r=null),(i?!c&&!r:!c&&s.position==="static"&&!!r&&["absolute","fixed"].includes(r.position)||po(a)&&!c&&Ib(t,a))?o=o.filter(u=>u!==a):r=s,a=wr(a)}return e.set(t,o),o}function gS(t){let{element:e,boundary:n,rootBoundary:o,strategy:r}=t,a=[...n==="clippingAncestors"?hS(e,this._c):[].concat(n),o],s=a[0],c=a.reduce((l,u)=>{let d=Eb(e,u,r);return l.top=Wt(d.top,l.top),l.right=Zt(d.right,l.right),l.bottom=Zt(d.bottom,l.bottom),l.left=Wt(d.left,l.left),l},Eb(e,s,r));return{width:c.right-c.left,height:c.bottom-c.top,x:c.left,y:c.top}}function bS(t){return Ab(t)}function xS(t,e,n){let o=en(e),r=mn(e),i=n==="fixed",a=_r(t,!0,i,e),s={scrollLeft:0,scrollTop:0},c=In(0);if(o||!o&&!i)if((Dn(e)!=="body"||po(r))&&(s=Jo(e)),o){let l=_r(e,!0,i,e);c.x=l.x+e.clientLeft,c.y=l.y+e.clientTop}else r&&(c.x=Nb(r));return{x:a.left+s.scrollLeft-c.x,y:a.top+s.scrollTop-c.y,width:a.width,height:a.height}}function Ob(t,e){return!en(t)||jt(t).position==="fixed"?null:e?e(t):t.offsetParent}function Fb(t,e){let n=At(t);if(!en(t))return n;let o=Ob(t,e);for(;o&&Tb(o)&&jt(o).position==="static";)o=Ob(o,e);return o&&(Dn(o)==="html"||Dn(o)==="body"&&jt(o).position==="static"&&!Ba(o))?n:o||Cb(t)||n}var vS=async function(t){let{reference:e,floating:n,strategy:o}=t,r=this.getOffsetParent||Fb,i=this.getDimensions;return{reference:xS(e,await r(n),o),floating:{x:0,y:0,...await i(n)}}};function yS(t){return jt(t).direction==="rtl"}var wS={convertOffsetParentRelativeRectToViewportRelativeRect:uS,getDocumentElement:mn,getClippingRect:gS,getOffsetParent:Fb,getElementRects:vS,getClientRects:dS,getDimensions:bS,getScale:mo,isElement:hn,isRTL:yS};function _S(t,e){let n=null,o,r=mn(t);function i(){clearTimeout(o),n&&n.disconnect(),n=null}function a(s,c){s===void 0&&(s=!1),c===void 0&&(c=1),i();let{left:l,top:u,width:d,height:f}=t.getBoundingClientRect();if(s||e(),!d||!f)return;let p=Yo(u),m=Yo(r.clientWidth-(l+d)),h=Yo(r.clientHeight-(u+f)),b=Yo(l),y={rootMargin:-p+"px "+-m+"px "+-h+"px "+-b+"px",threshold:Wt(0,Zt(1,c))||1},M=!0;function E(C){let j=C[0].intersectionRatio;if(j!==c){if(!M)return a();j?a(!1,j):o=setTimeout(()=>{a(!1,1e-7)},100)}M=!1}try{n=new IntersectionObserver(E,{...y,root:r.ownerDocument})}catch{n=new IntersectionObserver(E,y)}n.observe(t)}return a(!0),i}function Db(t,e,n,o){o===void 0&&(o={});let{ancestorScroll:r=!0,ancestorResize:i=!0,elementResize:a=typeof ResizeObserver=="function",layoutShift:s=typeof IntersectionObserver=="function",animationFrame:c=!1}=o,l=ac(t),u=r||i?[...l?fo(l):[],...fo(e)]:[];u.forEach(x=>{r&&x.addEventListener("scroll",n,{passive:!0}),i&&x.addEventListener("resize",n)});let d=l&&s?_S(l,n):null,f=-1,p=null;a&&(p=new ResizeObserver(x=>{let[y]=x;y&&y.target===l&&p&&(p.unobserve(e),cancelAnimationFrame(f),f=requestAnimationFrame(()=>{p&&p.observe(e)})),n()}),l&&!c&&p.observe(l),p.observe(e));let m,h=c?_r(t):null;c&&b();function b(){let x=_r(t);h&&(x.x!==h.x||x.y!==h.y||x.width!==h.width||x.height!==h.height)&&n(),h=x,m=requestAnimationFrame(b)}return n(),()=>{u.forEach(x=>{r&&x.removeEventListener("scroll",n),i&&x.removeEventListener("resize",n)}),d&&d(),p&&p.disconnect(),p=null,c&&cancelAnimationFrame(m)}}var Mb=(t,e,n)=>{let o=new Map,r={platform:wS,...n},i={...r.platform,_c:o};return yb(t,e,{...r,platform:i})};function kS(t,e){let n;function o(){n==null||n()}function r(i){o(),n=i(t,Db)}return r(e),{destroy:o,update:r}}var Lb=kS;function TS({placement:t,arrow:e,shift:n,offset:o,inline:r,hideIfEscaped:i,hideIfReferenceHidden:a,hideCallback:s}){return async function(c,l){var M,E,C,j,P,D;let u=[nc(),oc(o),ic({padding:n}),tc({element:e,padding:5})];r&&u.unshift(rc());let d={middleware:u,placement:t};i&&u.push(Pa({strategy:"escaped"})),a&&u.push(Pa({strategy:"referenceHidden"}));let{x:f,y:p,middlewareData:m,placement:h}=await Mb(c,l,d);if((M=m.hide)!=null&&M.escaped)return s("escaped"),h;if((E=m.hide)!=null&&E.referenceHidden)return s("referenceHidden"),h;Object.assign(l.style,{left:`${f}px`,top:`${p}px`});let b,x,y;return h.startsWith("bottom")?(b=45,x=(C=m.arrow)==null?void 0:C.x,y=-5):h.startsWith("left")?(b=135,x=l.offsetWidth-5,y=(j=m.arrow)==null?void 0:j.y):h.startsWith("top")?(b=225,x=(P=m.arrow)==null?void 0:P.x,y=l.offsetHeight-5):(b=315,x=-5,y=(D=m.arrow)==null?void 0:D.y),Object.assign(e.style,{left:x?`${x}px`:"",top:y?`${y}px`:"",transform:`rotate(${b}deg)`}),h}}var Pb=TS;function CS(t,e){let n=!0;return t.subscribe(o=>{n?n=!1:e(o)})}var sc=CS;function SS(t){let e;return{c(){e=ie("div"),Q(e,"class","arrow svelte-137gj59")},m(n,o){Y(n,e,o)},p:ye,i:ye,o:ye,d(n){n&&X(e)}}}var lc=class extends pe{constructor(e){super(),he(this,e,null,SS,me,{})}},Bb=lc;var ES=t=>({}),jb=t=>({position:t[7]}),OS=t=>({}),Ub=t=>({}),AS=t=>({}),zb=t=>({}),RS=t=>({}),Vb=t=>({position:t[7],asReference:t[8]});function Wb(t){let e,n,o,r,i=[IS,NS],a=[];function s(c,l){return c[1]?0:1}return e=s(t,[-1,-1]),n=a[e]=i[e](t),{c(){n.c(),o=Ue()},m(c,l){a[e].m(c,l),Y(c,o,l),r=!0},p(c,l){let u=e;e=s(c,l),e===u?a[e].p(c,l):(Me(),H(a[u],1,1,()=>{a[u]=null}),Le(),n=a[e],n?n.p(c,l):(n=a[e]=i[e](c),n.c()),W(n,1),n.m(o.parentNode,o))},i(c){r||(W(n),r=!0)},o(c){H(n),r=!1},d(c){c&&X(o),a[e].d(c)}}}function NS(t){let e,n,o,r,i,a=t[22].reference,s=Ne(a,t,t[21],Ub);return{c(){e=ie("div"),s&&s.c(),Q(e,"class","floating-reference")},m(c,l){Y(c,e,l),s&&s.m(e,null),o=!0,r||(i=Tt(n=t[8].call(null,e)),r=!0)},p(c,l){s&&s.p&&(!o||l[0]&2097152)&&Fe(s,a,c,c[21],o?Ie(a,c[21],l,OS):De(c[21]),Ub)},i(c){o||(W(s,c),o=!0)},o(c){H(s,c),o=!1},d(c){c&&X(e),s&&s.d(c),r=!1,i()}}}function IS(t){let e,n,o,r,i,a=t[22].reference,s=Ne(a,t,t[21],zb);return{c(){e=ie("span"),s&&s.c(),Q(e,"class","floating-reference svelte-1rg7qgv")},m(c,l){Y(c,e,l),s&&s.m(e,null),o=!0,r||(i=Tt(n=t[8].call(null,e)),r=!0)},p(c,l){s&&s.p&&(!o||l[0]&2097152)&&Fe(s,a,c,c[21],o?Ie(a,c[21],l,AS):De(c[21]),zb)},i(c){o||(W(s,c),o=!0)},o(c){H(s,c),o=!1},d(c){c&&X(e),s&&s.d(c),r=!1,i()}}}function Hb(t){let e,n=t[22].floating,o=Ne(n,t,t[21],jb);return{c(){o&&o.c()},m(r,i){o&&o.m(r,i),e=!0},p(r,i){o&&o.p&&(!e||i[0]&2097152)&&Fe(o,n,r,r[21],e?Ie(n,r[21],i,ES):De(r[21]),jb)},i(r){e||(W(o,r),e=!0)},o(r){H(o,r),e=!1},d(r){o&&o.d(r)}}}function Gb(t){let e,n;return e=new Bb({}),{c(){le(e.$$.fragment)},m(o,r){ae(e,o,r),n=!0},i(o){n||(W(e.$$.fragment,o),n=!0)},o(o){H(e.$$.fragment,o),n=!1},d(o){se(e,o)}}}function FS(t){let e,n,o,r,i,a,s,c,l,u,d=t[22].default,f=Ne(d,t,t[21],Vb),p=t[9].reference&&Wb(t),m=t[2]&&Hb(t),h=!t[3]&&Gb(t);return{c(){f&&f.c(),e=xe(),p&&p.c(),n=xe(),o=ie("div"),m&&m.c(),r=xe(),i=ie("div"),h&&h.c(),Q(i,"class","floating-arrow svelte-1rg7qgv"),i.hidden=a=!t[2],Q(o,"class","floating svelte-1rg7qgv"),de(o,"show",t[2])},m(b,x){f&&f.m(b,x),Y(b,e,x),p&&p.m(b,x),Y(b,n,x),Y(b,o,x),m&&m.m(o,null),Ce(o,r),Ce(o,i),h&&h.m(i,null),t[23](i),t[24](o),c=!0,l||(u=Tt(s=fb.call(null,o,t[0])),l=!0)},p(b,x){f&&f.p&&(!c||x[0]&2097152)&&Fe(f,d,b,b[21],c?Ie(d,b[21],x,RS):De(b[21]),Vb),b[9].reference?p?(p.p(b,x),x[0]&512&&W(p,1)):(p=Wb(b),p.c(),W(p,1),p.m(n.parentNode,n)):p&&(Me(),H(p,1,1,()=>{p=null}),Le()),b[2]?m?(m.p(b,x),x[0]&4&&W(m,1)):(m=Hb(b),m.c(),W(m,1),m.m(o,r)):m&&(Me(),H(m,1,1,()=>{m=null}),Le()),b[3]?h&&(Me(),H(h,1,1,()=>{h=null}),Le()):h?x[0]&8&&W(h,1):(h=Gb(b),h.c(),W(h,1),h.m(i,null)),(!c||x[0]&4&&a!==(a=!b[2]))&&(i.hidden=a),s&&Ft(s.update)&&x[0]&1&&s.update.call(null,b[0]),(!c||x[0]&4)&&de(o,"show",b[2])},i(b){c||(W(f,b),W(p),W(m),W(h),c=!0)},o(b){H(f,b),H(p),H(m),H(h),c=!1},d(b){b&&(X(e),X(n),X(o)),f&&f.d(b),p&&p.d(b),m&&m.d(),h&&h.d(),t[23](null),t[24](null),l=!1,u()}}}function DS(t,e,n){let o,r,{$$slots:i={},$$scope:a}=e,s=hp(i);var c;let{portalTarget:l=null}=e,{preferredPlacement:u="bottom"}=e,d=at(void 0);ot(t,d,_=>n(26,r=_)),Mo(Na,d);let{offset:f=5}=e,{shift:p=30}=e,{inline:m=!1}=e,{hideIfEscaped:h=!1}=e,{hideIfReferenceHidden:b=!1}=e,{show:x=!0}=e,y=qe(),M,{set:E,remove:C}=db(()=>y("close",{reason:"esc"})),j={},{closeOnInsideClick:P=!1}=e,{keepOnKeyup:D=!1}=e,{hideArrow:N=!1}=e,{reference:S=void 0}=e,G;function v(_,F,z){let q=z(_,F);return zn(d,r=q,r),q}async function T(_=v){if(S&&G)return _(S,G,o)}function R(_){n(10,S=_)}function A(_,F){let z=G;return F(_,z,()=>{zn(d,r=o(_,z),r)})}let U=null;function k(_,F,z){if(U==null||U(),U=null,E(z),!_||!F||!z)return;if(n(19,j=Lb(_,A)),!(_ instanceof EventTarget)){U=j.destroy;return}let q=sb(cb,{reference:_,floating:F,inside:P,outside:!0}),ee=[sc(q,O=>y("close",O))];if(!D){let O=lb(ub,{reference:_,floating:F});ee.push(sc(O,B=>y("close",B)))}U=ab(...ee,j.destroy,C)}ur(()=>U==null?void 0:U());function w(_){He[_?"unshift":"push"](()=>{M=_,n(4,M)})}function I(_){He[_?"unshift":"push"](()=>{G=_,n(5,G)})}return t.$$set=_=>{"portalTarget"in _&&n(0,l=_.portalTarget),"preferredPlacement"in _&&n(11,u=_.preferredPlacement),"offset"in _&&n(12,f=_.offset),"shift"in _&&n(13,p=_.shift),"inline"in _&&n(1,m=_.inline),"hideIfEscaped"in _&&n(14,h=_.hideIfEscaped),"hideIfReferenceHidden"in _&&n(15,b=_.hideIfReferenceHidden),"show"in _&&n(2,x=_.show),"closeOnInsideClick"in _&&n(16,P=_.closeOnInsideClick),"keepOnKeyup"in _&&n(17,D=_.keepOnKeyup),"hideArrow"in _&&n(3,N=_.hideArrow),"reference"in _&&n(10,S=_.reference),"$$scope"in _&&n(21,a=_.$$scope)},t.$$.update=()=>{t.$$.dirty[0]&63506&&n(20,o=Pb({placement:u,offset:f,shift:p,inline:m,arrow:M,hideIfEscaped:h,hideIfReferenceHidden:b,hideCallback:_=>y("close",{reason:_})})),t.$$.dirty[0]&1835008&&(n(18,c=j.update)==null||c.call(j,A)),t.$$.dirty[0]&1060&&k(S,G,x)},[l,m,x,N,M,G,d,T,R,s,S,u,f,p,h,b,P,D,c,j,o,a,i,w,I]}var cc=class extends pe{constructor(e){super(),he(this,e,DS,FS,me,{portalTarget:0,preferredPlacement:11,offset:12,shift:13,inline:1,hideIfEscaped:14,hideIfReferenceHidden:15,show:2,closeOnInsideClick:16,keepOnKeyup:17,hideArrow:3,reference:10},null,[-1,-1])}},ho=cc;var qb=gt(Lt());var uc=t=>{t.selectionColor="rgba(0, 0, 0, 0)";let e,n,o,r;Qn(t),t.on("mouse:down",function(i){if(i.target)return;n=!0;let a=t.getPointer(i.e);o=a.x,r=a.y,e=new qb.fabric.Ellipse({id:"ellipse-"+new Date().getTime(),left:o,top:r,originX:"left",originY:"top",rx:a.x-o,ry:a.y-r,fill:Kt,transparentCorners:!1,selectable:!0,stroke:Yn,strokeWidth:1,strokeUniform:!0,noScaleCache:!1,opacity:rt(Pt)?.4:1}),t.add(e)}),t.on("mouse:move",function(i){if(!n)return;let a=t.getPointer(i.e),s=Math.abs(o-a.x)/2,c=Math.abs(r-a.y)/2,l=a.x,u=a.y;s>e.strokeWidth&&(s-=e.strokeWidth/2),c>e.strokeWidth&&(c-=e.strokeWidth/2),l<o?e.set({originX:"right"}):e.set({originX:"left"}),u<r?e.set({originY:"bottom"}):e.set({originY:"top"}),e.set({rx:s,ry:c}),t.renderAll()}),t.on("mouse:up",function(){if(n=!1,!!e){if(e.width<5||e.height<5){t.remove(e),e=void 0;return}e.originX==="right"&&e.set({originX:"left",left:e.left-e.width+e.strokeWidth}),e.originY==="bottom"&&e.set({originY:"top",top:e.top-e.height+e.strokeWidth}),e.setCoords(),t.setActiveObject(e),ht.onObjectAdded(e.id),e=void 0}})};var Xb=gt(Lt());var dc=t=>{t.selectionColor="rgba(0, 0, 0, 0)";let e,n,o,r;Qn(t),t.on("mouse:down",function(i){if(i.target)return;n=!0;let a=t.getPointer(i.e);o=a.x,r=a.y,e=new Xb.fabric.Rect({id:"rect-"+new Date().getTime(),left:o,top:r,originX:"left",originY:"top",width:a.x-o,height:a.y-r,angle:0,fill:Kt,transparentCorners:!1,selectable:!0,stroke:Yn,strokeWidth:1,strokeUniform:!0,noScaleCache:!1,opacity:rt(Pt)?.4:1}),t.add(e)}),t.on("mouse:move",function(i){if(!n)return;let a=t.getPointer(i.e),s=a.x,c=a.y;s<o?e.set({originX:"right"}):e.set({originX:"left"}),c<r?e.set({originY:"bottom"}):e.set({originY:"top"}),e.set({width:Math.abs(s-e.left),height:Math.abs(c-e.top)}),t.renderAll()}),t.on("mouse:up",function(){if(n=!1,!!e){if(e.width<5||e.height<5){t.remove(e),e=void 0;return}e.originX==="right"&&e.set({originX:"left",left:e.left-e.width+e.strokeWidth}),e.originY==="bottom"&&e.set({originY:"top",top:e.top-e.height+e.strokeWidth}),e.setCoords(),t.setActiveObject(e),ht.onObjectAdded(e.id),e=void 0}})};var Yb=gt(Lt());var fc=t=>{t.selectionColor="rgba(0, 0, 0, 0)",Qn(t),t.on("mouse:down",function(e){if(e.target)return;let n=t.getPointer(e.e),o=new Yb.fabric.IText("text",{id:"text-"+new Date().getTime(),left:n.x,top:n.y,originX:"left",originY:"top",selectable:!0,strokeWidth:1,noScaleCache:!1,fontFamily:pa,backgroundColor:fa,padding:ma,opacity:rt(Pt)?.4:1});ga(t,o),t.add(o),t.setActiveObject(o),ht.onObjectAdded(o.id),o.enterEditing(),o.selectAll()}),t.on("text:editing:entered",function(){hr.set(!0)}),t.on("text:editing:exited",function(){hr.set(!1)})};var Qb=t=>{if(!t.getActiveObject())return;let e=t.getActiveObject();t.getActiveObject().type=="activeSelection"?MS(t,e):e.set({left:0}),e.setCoords(),t.renderAll()},Kb=t=>{if(!t.getActiveObject())return;let e=t.getActiveObject();t.getActiveObject().type=="activeSelection"?jS(t,e):e.set({left:t.width/2-e.width/2}),e.setCoords(),t.renderAll()},Jb=t=>{if(!t.getActiveObject())return;let e=t.getActiveObject();t.getActiveObject().type=="activeSelection"?LS(t,e):e.set({left:t.getWidth()-e.width}),e.setCoords(),t.renderAll()},$b=t=>{if(!t.getActiveObject())return;let e=t.getActiveObject();t.getActiveObject().type=="activeSelection"?PS(t,e):e.set({top:0}),e.setCoords(),t.renderAll()},Zb=t=>{if(!t.getActiveObject())return;let e=t.getActiveObject();t.getActiveObject().type=="activeSelection"?US(t,e):e.set({top:t.getHeight()/2-e.height/2}),e.setCoords(),t.renderAll()},ex=t=>{if(!t.getActiveObject())return;let e=t.getActiveObject();t.getActiveObject().type=="activeSelection"?BS(t,e):e.set({top:t.height-e.height}),e.setCoords(),t.renderAll()},MS=(t,e)=>{let n=e.getObjects(),o=n[0];for(let r=1;r<n.length;r++)n[r].left<o.left&&(o=n[r]);n.forEach(r=>{r.left=o.left,r.setCoords()})},LS=(t,e)=>{let n=e.getObjects(),o=n[0];for(let r=1;r<n.length;r++)n[r].left>o.left&&(o=n[r]);n.forEach(r=>{r.left=o.left+o.width-r.width,r.setCoords()})},PS=(t,e)=>{let n=e.getObjects(),o=n[0];for(let r=1;r<n.length;r++)n[r].top<o.top&&(o=n[r]);n.forEach(r=>{r.top=o.top,r.setCoords()})},BS=(t,e)=>{let n=e.getObjects(),o=n[0];for(let r=1;r<n.length;r++)n[r].top+n[r].height>o.top+o.height&&(o=n[r]);n.forEach(function(r){r!==o&&(r.set({top:o.top+o.height-r.height}),r.setCoords())})},jS=(t,e)=>{let n=e.getObjects(),o=n[0],r=n[0];for(let a=1;a<n.length;a++)n[a].left<o.left&&(o=n[a]),n[a].left>r.left&&(r=n[a]);let i=(o.left+r.left+r.width)/2;n.forEach(a=>{a.left=i-a.width/2,a.setCoords()})},US=(t,e)=>{let n=e.getObjects(),o=n[0],r=n[0];for(let a=1;a<n.length;a++)n[a].top<o.top&&(o=n[a]),n[a].top>r.top&&(r=n[a]);let i=(o.top+r.top+r.height)/2;n.forEach(a=>{a.top=i-a.height/2,a.setCoords()})};var pc=[{name:"group",icon:_l,action:mh,tooltip:dd,shortcut:Ng},{name:"ungroup",icon:Nl,action:hh,tooltip:xd,shortcut:Ig}],mc=[{name:"delete",icon:hl,action:fh,tooltip:ld,shortcut:Ag},{name:"duplicate",icon:pl,action:ph,tooltip:cd,shortcut:Rg}],hc=[{name:"zoomOut",icon:Tl,action:bh,tooltip:yd,shortcut:Sg},{name:"zoomIn",icon:Cl,action:gh,tooltip:vd,shortcut:Eg},{name:"zoomReset",icon:kl,action:ha,tooltip:wd,shortcut:Og}],gc=[{id:1,icon:al,action:Qb,tooltip:rd,shortcut:Fg},{id:2,icon:il,action:Kb,tooltip:nd,shortcut:Dg},{id:3,icon:sl,action:Jb,tooltip:od,shortcut:Mg},{id:4,icon:ul,action:$b,tooltip:id,shortcut:Lg},{id:5,icon:cl,action:Zb,tooltip:ad,shortcut:Pg},{id:6,icon:ll,action:ex,tooltip:td,shortcut:Bg}];var bc=[{id:"cursor",icon:ml,tooltip:hd,shortcut:xg},{id:"magnify",icon:Sl,tooltip:_d,shortcut:kg},{id:"draw-rectangle",icon:El,tooltip:md,shortcut:vg},{id:"draw-ellipse",icon:gl,tooltip:ud,shortcut:yg},{id:"draw-polygon",icon:Il,tooltip:pd,shortcut:wg},{id:"draw-text",icon:Al,tooltip:gd,shortcut:_g}];function tx(t,e,n){let o=t.slice();return o[38]=e[n],o}function nx(t,e,n){let o=t.slice();return o[41]=e[n],o}function rx(t,e,n){let o=t.slice();return o[41]=e[n],o}function ox(t,e,n){let o=t.slice();return o[41]=e[n],o}function ix(t,e,n){let o=t.slice();return o[41]=e[n],o}function ax(t,e,n){let o=t.slice();return o[41]=e[n],o}function zS(t){let e,n=t[41].icon+"",o;return{c(){e=new $e(!1),o=Ue(),e.a=o},m(r,i){e.m(n,r,i),Y(r,o,i)},p:ye,d(r){r&&(X(o),e.d())}}}function sx(t){let e,n;function o(){return t[16](t[41])}return e=new Ot({props:{keyCombination:t[41].shortcut}}),e.$on("action",o),{c(){le(e.$$.fragment)},m(r,i){ae(e,r,i),n=!0},p(r,i){t=r},i(r){n||(W(e.$$.fragment,r),n=!0)},o(r){H(e.$$.fragment,r),n=!1},d(r){se(e,r)}}}function lx(t){let e,n,o,r;function i(){return t[15](t[41])}e=new vt({props:{class:"tool-icon-button "+(t[1]==t[41].id?"active-tool":""),iconSize:t[3],tooltip:t[41].tooltip()+" ("+yt(t[41].shortcut)+")",active:t[1]===t[41].id,$$slots:{default:[zS]},$$scope:{ctx:t}}}),e.$on("click",i);let a=t[9]&&!t[10]&&sx(t);return{c(){le(e.$$.fragment),n=xe(),a&&a.c(),o=Ue()},m(s,c){ae(e,s,c),Y(s,n,c),a&&a.m(s,c),Y(s,o,c),r=!0},p(s,c){t=s;let l={};c[0]&2&&(l.class="tool-icon-button "+(t[1]==t[41].id?"active-tool":"")),c[0]&8&&(l.iconSize=t[3]),c[0]&2&&(l.active=t[1]===t[41].id),c[1]&2097152&&(l.$$scope={dirty:c,ctx:t}),e.$set(l),t[9]&&!t[10]?a?(a.p(t,c),c[0]&1536&&W(a,1)):(a=sx(t),a.c(),W(a,1),a.m(o.parentNode,o)):a&&(Me(),H(a,1,1,()=>{a=null}),Le())},i(s){r||(W(e.$$.fragment,s),W(a),r=!0)},o(s){H(e.$$.fragment,s),H(a),r=!1},d(s){s&&(X(n),X(o)),se(e,s),a&&a.d(s)}}}function VS(t){let e,n=(t[8]?va:xa)+"",o;return{c(){e=new $e(!1),o=Ue(),e.a=o},m(r,i){e.m(n,r,i),Y(r,o,i)},p(r,i){i[0]&256&&n!==(n=(r[8]?va:xa)+"")&&e.p(n)},d(r){r&&(X(o),e.d())}}}function WS(t){let e,n;return e=new vt({props:{class:"top-tool-icon-button border-radius dropdown-tool-mode",slot:"reference",tooltip:fd(),iconSize:t[3],$$slots:{default:[VS]},$$scope:{ctx:t}}}),e.$on("click",t[19]),{c(){le(e.$$.fragment)},m(o,r){ae(e,o,r),n=!0},p(o,r){let i={};r[0]&8&&(i.iconSize=o[3]),r[0]&256|r[1]&2097152&&(i.$$scope={dirty:r,ctx:o}),e.$set(i)},i(o){n||(W(e.$$.fragment,o),n=!0)},o(o){H(e.$$.fragment,o),n=!1},d(o){se(e,o)}}}function HS(t){let e;return{c(){e=ie("span"),e.textContent=`${Md()}`,Q(e,"class","svelte-zj29gp")},m(n,o){Y(n,e,o)},p:ye,d(n){n&&X(e)}}}function GS(t){let e;return{c(){e=ie("span"),e.textContent=`${Ld()}`,Q(e,"class","svelte-zj29gp")},m(n,o){Y(n,e,o)},p:ye,d(n){n&&X(e)}}}function qS(t){let e,n,o,r;return e=new yr({props:{active:t[8],$$slots:{default:[HS]},$$scope:{ctx:t}}}),e.$on("click",t[17]),o=new yr({props:{active:!t[8],$$slots:{default:[GS]},$$scope:{ctx:t}}}),o.$on("click",t[18]),{c(){le(e.$$.fragment),n=xe(),le(o.$$.fragment)},m(i,a){ae(e,i,a),Y(i,n,a),ae(o,i,a),r=!0},p(i,a){let s={};a[0]&256&&(s.active=i[8]),a[1]&2097152&&(s.$$scope={dirty:a,ctx:i}),e.$set(s);let c={};a[0]&256&&(c.active=!i[8]),a[1]&2097152&&(c.$$scope={dirty:a,ctx:i}),o.$set(c)},i(i){r||(W(e.$$.fragment,i),W(o.$$.fragment,i),r=!0)},o(i){H(e.$$.fragment,i),H(o.$$.fragment,i),r=!1},d(i){i&&X(n),se(e,i),se(o,i)}}}function XS(t){let e,n;return e=new lo({props:{slot:"floating",$$slots:{default:[qS]},$$scope:{ctx:t}}}),{c(){le(e.$$.fragment)},m(o,r){ae(e,o,r),n=!0},p(o,r){let i={};r[0]&256|r[1]&2097152&&(i.$$scope={dirty:r,ctx:o}),e.$set(i)},i(o){n||(W(e.$$.fragment,o),n=!0)},o(o){H(e.$$.fragment,o),n=!1},d(o){se(e,o)}}}function YS(t){let e,n=t[41].icon+"",o;return{c(){e=new $e(!1),o=Ue(),e.a=o},m(r,i){e.m(n,r,i),Y(r,o,i)},p:ye,d(r){r&&(X(o),e.d())}}}function cx(t){let e,n;return e=new Ot({props:{keyCombination:t[41].shortcut}}),e.$on("action",t[41].action),{c(){le(e.$$.fragment)},m(o,r){ae(e,o,r),n=!0},i(o){n||(W(e.$$.fragment,o),n=!0)},o(o){H(e.$$.fragment,o),n=!1},d(o){se(e,o)}}}function ux(t){let e,n,o,r;e=new vt({props:{class:"top-tool-icon-button "+(t[41].name==="undo"?"left-border-radius":"right-border-radius"),iconSize:t[3],tooltip:t[41].tooltip()+" ("+yt(t[41].shortcut)+")",disabled:t[41].name==="undo"?!t[12].undoable:!t[12].redoable,$$slots:{default:[YS]},$$scope:{ctx:t}}}),e.$on("click",t[41].action);let i=t[9]&&!t[10]&&cx(t);return{c(){le(e.$$.fragment),n=xe(),i&&i.c(),o=Ue()},m(a,s){ae(e,a,s),Y(a,n,s),i&&i.m(a,s),Y(a,o,s),r=!0},p(a,s){let c={};s[0]&8&&(c.iconSize=a[3]),s[0]&4096&&(c.disabled=a[41].name==="undo"?!a[12].undoable:!a[12].redoable),s[1]&2097152&&(c.$$scope={dirty:s,ctx:a}),e.$set(c),a[9]&&!a[10]?i?s[0]&1536&&W(i,1):(i=cx(a),i.c(),W(i,1),i.m(o.parentNode,o)):i&&(Me(),H(i,1,1,()=>{i=null}),Le())},i(a){r||(W(e.$$.fragment,a),W(i),r=!0)},o(a){H(e.$$.fragment,a),H(i),r=!1},d(a){a&&(X(n),X(o)),se(e,a),i&&i.d(a)}}}function QS(t){let e,n=t[41].icon+"",o;return{c(){e=new $e(!1),o=Ue(),e.a=o},m(r,i){e.m(n,r,i),Y(r,o,i)},p:ye,d(r){r&&(X(o),e.d())}}}function dx(t){let e,n;function o(){return t[22](t[41])}return e=new Ot({props:{keyCombination:t[41].shortcut}}),e.$on("action",o),{c(){le(e.$$.fragment)},m(r,i){ae(e,r,i),n=!0},p(r,i){t=r},i(r){n||(W(e.$$.fragment,r),n=!0)},o(r){H(e.$$.fragment,r),n=!1},d(r){se(e,r)}}}function fx(t){let e,n,o,r;function i(){return t[21](t[41])}e=new vt({props:{class:"top-tool-icon-button "+(t[41].name==="zoomOut"?"left-border-radius":"")+" "+(t[41].name==="zoomReset"?"right-border-radius":""),iconSize:t[3],tooltip:t[41].tooltip()+" ("+yt(t[41].shortcut)+")",$$slots:{default:[QS]},$$scope:{ctx:t}}}),e.$on("click",i);let a=t[9]&&!t[10]&&dx(t);return{c(){le(e.$$.fragment),n=xe(),a&&a.c(),o=Ue()},m(s,c){ae(e,s,c),Y(s,n,c),a&&a.m(s,c),Y(s,o,c),r=!0},p(s,c){t=s;let l={};c[0]&8&&(l.iconSize=t[3]),c[1]&2097152&&(l.$$scope={dirty:c,ctx:t}),e.$set(l),t[9]&&!t[10]?a?(a.p(t,c),c[0]&1536&&W(a,1)):(a=dx(t),a.c(),W(a,1),a.m(o.parentNode,o)):a&&(Me(),H(a,1,1,()=>{a=null}),Le())},i(s){r||(W(e.$$.fragment,s),W(a),r=!0)},o(s){H(e.$$.fragment,s),H(a),r=!1},d(s){s&&(X(n),X(o)),se(e,s),a&&a.d(s)}}}function KS(t){let e,n;return{c(){e=new $e(!1),n=Ue(),e.a=n},m(o,r){e.m(bl,o,r),Y(o,n,r)},p:ye,d(o){o&&(X(n),e.d())}}}function px(t){let e,n;return e=new Ot({props:{keyCombination:jl}}),e.$on("action",t[24]),{c(){le(e.$$.fragment)},m(o,r){ae(e,o,r),n=!0},p:ye,i(o){n||(W(e.$$.fragment,o),n=!0)},o(o){H(e.$$.fragment,o),n=!1},d(o){se(e,o)}}}function JS(t){let e,n=t[41].icon+"",o;return{c(){e=new $e(!1),o=Ue(),e.a=o},m(r,i){e.m(n,r,i),Y(r,o,i)},p:ye,d(r){r&&(X(o),e.d())}}}function mx(t){let e,n;function o(){return t[26](t[41])}return e=new Ot({props:{keyCombination:t[41].shortcut}}),e.$on("action",o),{c(){le(e.$$.fragment)},m(r,i){ae(e,r,i),n=!0},p(r,i){t=r},i(r){n||(W(e.$$.fragment,r),n=!0)},o(r){H(e.$$.fragment,r),n=!1},d(r){se(e,r)}}}function hx(t){let e,n,o,r;function i(){return t[25](t[41])}e=new vt({props:{class:"top-tool-icon-button "+(t[41].name==="duplicate"?"right-border-radius":""),iconSize:t[3],tooltip:t[41].tooltip()+" ("+yt(t[41].shortcut)+")",$$slots:{default:[JS]},$$scope:{ctx:t}}}),e.$on("click",i);let a=t[9]&&!t[10]&&mx(t);return{c(){le(e.$$.fragment),n=xe(),a&&a.c(),o=Ue()},m(s,c){ae(e,s,c),Y(s,n,c),a&&a.m(s,c),Y(s,o,c),r=!0},p(s,c){t=s;let l={};c[0]&8&&(l.iconSize=t[3]),c[1]&2097152&&(l.$$scope={dirty:c,ctx:t}),e.$set(l),t[9]&&!t[10]?a?(a.p(t,c),c[0]&1536&&W(a,1)):(a=mx(t),a.c(),W(a,1),a.m(o.parentNode,o)):a&&(Me(),H(a,1,1,()=>{a=null}),Le())},i(s){r||(W(e.$$.fragment,s),W(a),r=!0)},o(s){H(e.$$.fragment,s),H(a),r=!1},d(s){s&&(X(n),X(o)),se(e,s),a&&a.d(s)}}}function $S(t){let e,n=t[41].icon+"",o;return{c(){e=new $e(!1),o=Ue(),e.a=o},m(r,i){e.m(n,r,i),Y(r,o,i)},p:ye,d(r){r&&(X(o),e.d())}}}function gx(t){let e,n;function o(){return t[28](t[41])}return e=new Ot({props:{keyCombination:t[41].shortcut}}),e.$on("action",o),{c(){le(e.$$.fragment)},m(r,i){ae(e,r,i),n=!0},p(r,i){t=r},i(r){n||(W(e.$$.fragment,r),n=!0)},o(r){H(e.$$.fragment,r),n=!1},d(r){se(e,r)}}}function bx(t){let e,n,o,r;function i(){return t[27](t[41])}e=new vt({props:{class:"top-tool-icon-button "+(t[41].name==="group"?"left-border-radius":""),iconSize:t[3],tooltip:t[41].tooltip()+" ("+yt(t[41].shortcut)+")",$$slots:{default:[$S]},$$scope:{ctx:t}}}),e.$on("click",i);let a=t[9]&&!t[10]&&gx(t);return{c(){le(e.$$.fragment),n=xe(),a&&a.c(),o=Ue()},m(s,c){ae(e,s,c),Y(s,n,c),a&&a.m(s,c),Y(s,o,c),r=!0},p(s,c){t=s;let l={};c[0]&8&&(l.iconSize=t[3]),c[1]&2097152&&(l.$$scope={dirty:c,ctx:t}),e.$set(l),t[9]&&!t[10]?a?(a.p(t,c),c[0]&1536&&W(a,1)):(a=gx(t),a.c(),W(a,1),a.m(o.parentNode,o)):a&&(Me(),H(a,1,1,()=>{a=null}),Le())},i(s){r||(W(e.$$.fragment,s),W(a),r=!0)},o(s){H(e.$$.fragment,s),H(a),r=!1},d(s){s&&(X(n),X(o)),se(e,s),a&&a.d(s)}}}function ZS(t){let e,n;return{c(){e=new $e(!1),n=Ue(),e.a=n},m(o,r){e.m(xl,o,r),Y(o,n,r)},p:ye,d(o){o&&(X(n),e.d())}}}function eE(t){let e,n=t[38].icon+"",o;return{c(){e=new $e(!1),o=Ue(),e.a=o},m(r,i){e.m(n,r,i),Y(r,o,i)},p:ye,d(r){r&&(X(o),e.d())}}}function xx(t){let e,n;function o(){return t[31](t[38])}return e=new Ot({props:{keyCombination:t[38].shortcut}}),e.$on("action",o),{c(){le(e.$$.fragment)},m(r,i){ae(e,r,i),n=!0},p(r,i){t=r},i(r){n||(W(e.$$.fragment,r),n=!0)},o(r){H(e.$$.fragment,r),n=!1},d(r){se(e,r)}}}function vx(t){let e,n,o,r;function i(){return t[30](t[38])}e=new vt({props:{class:"top-tool-icon-button",iconSize:t[3],tooltip:t[38].tooltip()+" ("+yt(t[38].shortcut)+")",$$slots:{default:[eE]},$$scope:{ctx:t}}}),e.$on("click",i);let a=t[9]&&!t[10]&&xx(t);return{c(){le(e.$$.fragment),n=xe(),a&&a.c(),o=Ue()},m(s,c){ae(e,s,c),Y(s,n,c),a&&a.m(s,c),Y(s,o,c),r=!0},p(s,c){t=s;let l={};c[0]&8&&(l.iconSize=t[3]),c[1]&2097152&&(l.$$scope={dirty:c,ctx:t}),e.$set(l),t[9]&&!t[10]?a?(a.p(t,c),c[0]&1536&&W(a,1)):(a=xx(t),a.c(),W(a,1),a.m(o.parentNode,o)):a&&(Me(),H(a,1,1,()=>{a=null}),Le())},i(s){r||(W(e.$$.fragment,s),W(a),r=!0)},o(s){H(e.$$.fragment,s),H(a),r=!1},d(s){s&&(X(n),X(o)),se(e,s),a&&a.d(s)}}}function tE(t){let e,n,o,r,i,a,s,c,l,u,d,f,p,m,h,b,x,y,M,E,C,j=Ve(bc),P=[];for(let O=0;O<j.length;O+=1)P[O]=lx(ax(t,j,O));let D=O=>H(P[O],1,1,()=>{P[O]=null});i=new ho({props:{show:t[7],closeOnInsideClick:!0,inline:!0,$$slots:{floating:[XS],reference:[WS]},$$scope:{ctx:t}}}),i.$on("close",t[20]);let N=Ve(zl),S=[];for(let O=0;O<N.length;O+=1)S[O]=ux(ix(t,N,O));let G=O=>H(S[O],1,1,()=>{S[O]=null}),v=Ve(hc),T=[];for(let O=0;O<v.length;O+=1)T[O]=fx(ox(t,v,O));let R=O=>H(T[O],1,1,()=>{T[O]=null});f=new vt({props:{class:"top-tool-icon-button left-border-radius",iconSize:t[3],tooltip:bd()+" ("+yt(jl)+")",$$slots:{default:[KS]},$$scope:{ctx:t}}}),f.$on("click",t[23]);let A=t[9]&&!t[10]&&px(t),U=Ve(mc),k=[];for(let O=0;O<U.length;O+=1)k[O]=hx(rx(t,U,O));let w=O=>H(k[O],1,1,()=>{k[O]=null}),I=Ve(pc),_=[];for(let O=0;O<I.length;O+=1)_[O]=bx(nx(t,I,O));let F=O=>H(_[O],1,1,()=>{_[O]=null});y=new vt({props:{class:"top-tool-icon-button dropdown-tool right-border-radius",iconSize:t[3],tooltip:sd(),$$slots:{default:[ZS]},$$scope:{ctx:t}}}),y.$on("click",t[29]);let z=Ve(gc),q=[];for(let O=0;O<z.length;O+=1)q[O]=vx(tx(t,z,O));let ee=O=>H(q[O],1,1,()=>{q[O]=null});return{c(){e=ie("div");for(let O=0;O<P.length;O+=1)P[O].c();n=xe(),o=ie("div"),r=ie("div"),le(i.$$.fragment),a=xe(),s=ie("div");for(let O=0;O<S.length;O+=1)S[O].c();c=xe(),l=ie("div");for(let O=0;O<T.length;O+=1)T[O].c();u=xe(),d=ie("div"),le(f.$$.fragment),p=xe(),A&&A.c(),m=xe();for(let O=0;O<k.length;O+=1)k[O].c();h=xe(),b=ie("div");for(let O=0;O<_.length;O+=1)_[O].c();x=xe(),le(y.$$.fragment),M=xe(),E=ie("div");for(let O=0;O<q.length;O+=1)q[O].c();Q(e,"class","tool-bar-container svelte-zj29gp"),Q(s,"class","undo-redo-button svelte-zj29gp"),Q(l,"class","tool-button-container svelte-zj29gp"),Q(d,"class","tool-button-container svelte-zj29gp"),Q(b,"class","tool-button-container svelte-zj29gp"),Q(r,"class","top-tool-bar-container svelte-zj29gp"),Q(E,"class","dropdown-content svelte-zj29gp"),ze(E,"left",t[5]+"px"),de(E,"show",t[4]),Q(o,"dir",t[11]),Q(o,"class","svelte-zj29gp")},m(O,B){Y(O,e,B);for(let V=0;V<P.length;V+=1)P[V]&&P[V].m(e,null);Y(O,n,B),Y(O,o,B),Ce(o,r),ae(i,r,null),Ce(r,a),Ce(r,s);for(let V=0;V<S.length;V+=1)S[V]&&S[V].m(s,null);Ce(r,c),Ce(r,l);for(let V=0;V<T.length;V+=1)T[V]&&T[V].m(l,null);Ce(r,u),Ce(r,d),ae(f,d,null),Ce(d,p),A&&A.m(d,null),Ce(d,m);for(let V=0;V<k.length;V+=1)k[V]&&k[V].m(d,null);Ce(r,h),Ce(r,b);for(let V=0;V<_.length;V+=1)_[V]&&_[V].m(b,null);Ce(b,x),ae(y,b,null),Ce(o,M),Ce(o,E);for(let V=0;V<q.length;V+=1)q[V]&&q[V].m(E,null);C=!0},p(O,B){if(B[0]&1546){j=Ve(bc);let L;for(L=0;L<j.length;L+=1){let Z=ax(O,j,L);P[L]?(P[L].p(Z,B),W(P[L],1)):(P[L]=lx(Z),P[L].c(),W(P[L],1),P[L].m(e,null))}for(Me(),L=j.length;L<P.length;L+=1)D(L);Le()}let V={};if(B[0]&128&&(V.show=O[7]),B[0]&392|B[1]&2097152&&(V.$$scope={dirty:B,ctx:O}),i.$set(V),B[0]&5640){N=Ve(zl);let L;for(L=0;L<N.length;L+=1){let Z=ix(O,N,L);S[L]?(S[L].p(Z,B),W(S[L],1)):(S[L]=ux(Z),S[L].c(),W(S[L],1),S[L].m(s,null))}for(Me(),L=N.length;L<S.length;L+=1)G(L);Le()}if(B[0]&1548){v=Ve(hc);let L;for(L=0;L<v.length;L+=1){let Z=ox(O,v,L);T[L]?(T[L].p(Z,B),W(T[L],1)):(T[L]=fx(Z),T[L].c(),W(T[L],1),T[L].m(l,null))}for(Me(),L=v.length;L<T.length;L+=1)R(L);Le()}let $={};if(B[0]&8&&($.iconSize=O[3]),B[1]&2097152&&($.$$scope={dirty:B,ctx:O}),f.$set($),O[9]&&!O[10]?A?(A.p(O,B),B[0]&1536&&W(A,1)):(A=px(O),A.c(),W(A,1),A.m(d,m)):A&&(Me(),H(A,1,1,()=>{A=null}),Le()),B[0]&1545){U=Ve(mc);let L;for(L=0;L<U.length;L+=1){let Z=rx(O,U,L);k[L]?(k[L].p(Z,B),W(k[L],1)):(k[L]=hx(Z),k[L].c(),W(k[L],1),k[L].m(d,null))}for(Me(),L=U.length;L<k.length;L+=1)w(L);Le()}if(B[0]&1545){I=Ve(pc);let L;for(L=0;L<I.length;L+=1){let Z=nx(O,I,L);_[L]?(_[L].p(Z,B),W(_[L],1)):(_[L]=bx(Z),_[L].c(),W(_[L],1),_[L].m(b,x))}for(Me(),L=I.length;L<_.length;L+=1)F(L);Le()}let te={};if(B[0]&8&&(te.iconSize=O[3]),B[1]&2097152&&(te.$$scope={dirty:B,ctx:O}),y.$set(te),B[0]&1545){z=Ve(gc);let L;for(L=0;L<z.length;L+=1){let Z=tx(O,z,L);q[L]?(q[L].p(Z,B),W(q[L],1)):(q[L]=vx(Z),q[L].c(),W(q[L],1),q[L].m(E,null))}for(Me(),L=z.length;L<q.length;L+=1)ee(L);Le()}(!C||B[0]&32)&&ze(E,"left",O[5]+"px"),(!C||B[0]&16)&&de(E,"show",O[4]),(!C||B[0]&2048)&&Q(o,"dir",O[11])},i(O){if(!C){for(let B=0;B<j.length;B+=1)W(P[B]);W(i.$$.fragment,O);for(let B=0;B<N.length;B+=1)W(S[B]);for(let B=0;B<v.length;B+=1)W(T[B]);W(f.$$.fragment,O),W(A);for(let B=0;B<U.length;B+=1)W(k[B]);for(let B=0;B<I.length;B+=1)W(_[B]);W(y.$$.fragment,O);for(let B=0;B<z.length;B+=1)W(q[B]);C=!0}},o(O){P=P.filter(Boolean);for(let B=0;B<P.length;B+=1)H(P[B]);H(i.$$.fragment,O),S=S.filter(Boolean);for(let B=0;B<S.length;B+=1)H(S[B]);T=T.filter(Boolean);for(let B=0;B<T.length;B+=1)H(T[B]);H(f.$$.fragment,O),H(A),k=k.filter(Boolean);for(let B=0;B<k.length;B+=1)H(k[B]);_=_.filter(Boolean);for(let B=0;B<_.length;B+=1)H(_[B]);H(y.$$.fragment,O),q=q.filter(Boolean);for(let B=0;B<q.length;B+=1)H(q[B]);C=!1},d(O){O&&(X(e),X(n),X(o)),pt(P,O),se(i),pt(S,O),pt(T,O),se(f),A&&A.d(),pt(k,O),pt(_,O),se(y),pt(q,O)}}}function nE(t,e,n){let o,r,i,a,s;ot(t,Bo,O=>n(8,o=O)),ot(t,dh,O=>n(9,r=O)),ot(t,hr,O=>n(10,i=O)),ot(t,ht,O=>n(12,s=O));let{canvas:c}=e,{instance:l}=e,{iconSize:u}=e,{activeTool:d="cursor"}=e,f=!1,p=82,m=!1,h=!1,b=kn(Hg);ot(t,b,O=>n(11,a=O)),document.addEventListener("click",O=>{let B=document.querySelector(".upper-canvas");O.target==B&&n(4,f=!1)});let x=!1,y=!1,M=!1,E=!1;mt(()=>{window.addEventListener("mousedown",O=>{O.ctrlKey&&(x=!0)}),window.addEventListener("mouseup",O=>{O.ctrlKey&&(x=!1)}),window.addEventListener("mousemove",O=>{O.ctrlKey&&(M=!0)}),window.addEventListener("wheel",O=>{O.ctrlKey&&(E=!0)}),window.addEventListener("dblclick",O=>{O.ctrlKey&&(y=!0)}),window.addEventListener("keyup",O=>{O.key=="Control"&&(x=!1,M=!1,E=!1,y=!1)}),window.addEventListener("keydown",O=>{O.key=="Control"&&(x=!1,M=!1,E=!1,y=!1)}),window.addEventListener("keydown",O=>{O.key=="Control"&&d!="magnify"&&l.resume()}),window.addEventListener("keyup",O=>{O.key=="Control"&&d!="magnify"&&l.pause()}),window.addEventListener("wheel",()=>{x&&M&&E&&!y&&P()})});let C=()=>{l.pause(),Qn(c),n(0,c.selectionColor="rgba(100, 100, 255, 0.3)",c)};function j(O){zn(Bo,o=O==="all",o),tr()}let P=()=>{C(),no(c,!1),l.resume(),n(1,d="magnify")},D=O=>{n(1,d=O.id)},N=O=>{n(1,d=O.id)},S=()=>j("all"),G=()=>j("one"),v=()=>n(7,h=!h),T=()=>n(7,h=!1),R=O=>{O.action(l)},A=O=>{O.action(l)},U=()=>{n(6,m=!m),$s(c,m)},k=()=>{n(6,m=!m),$s(c,m)},w=O=>{O.action(c)},I=O=>{O.action(c),tr()},_=O=>{O.action(c),tr()},F=O=>{O.action(c),tr()},z=O=>{n(4,f=!f),n(5,p=O.pageX-100)},q=O=>{O.action(c)},ee=O=>{O.action(c)};return t.$$set=O=>{"canvas"in O&&n(0,c=O.canvas),"instance"in O&&n(2,l=O.instance),"iconSize"in O&&n(3,u=O.iconSize),"activeTool"in O&&n(1,d=O.activeTool)},t.$$.update=()=>{if(t.$$.dirty[0]&7&&l&&c)switch(C(),no(c,!0),Ug(c),d){case"magnify":no(c,!1),l.resume();break;case"draw-rectangle":dc(c);break;case"draw-ellipse":uc(c);break;case"draw-polygon":Wl(c,l);break;case"draw-text":fc(c);break;default:break}},[c,d,l,u,f,p,m,h,o,r,i,a,s,b,j,D,N,S,G,v,T,R,A,U,k,w,I,_,F,z,q,ee]}var xc=class extends pe{constructor(e){super(),he(this,e,nE,tE,me,{canvas:0,instance:2,iconSize:3,activeTool:1},null,[-1,-1])}},yx=xc;var Ua=class{constructor(e){this.Shape=Bt;this.Rectangle=fn;this.Ellipse=un;this.Polygon=dn;this.Text=Jt;this.canvas=e}addShape(e){Ea(this.canvas,e)}addShapeGroup(e){Oa(this.canvas,e)}getClozes(e){let{clozes:n,noteCount:o}=ba(e);return{clozes:n,cardCount:o}}getShapes(){return nl()}redraw(){gr(this.canvas)}clear(){yh(this.canvas)}};function rE(t){let e,n,o,r,i,a,s,c,l;return e=new yx({props:{canvas:t[0],instance:t[1],iconSize:oE,activeTool:t[3]}}),{c(){le(e.$$.fragment),n=xe(),o=ie("div"),r=ie("div"),r.innerHTML='<img id="image" class="svelte-xrccfh"/> <canvas id="canvas"></canvas>',Q(r,"class","editor-container svelte-xrccfh"),Q(o,"class","editor-main svelte-xrccfh"),Mt(()=>t[7].call(o))},m(u,d){ae(e,u,d),Y(u,n,d),Y(u,o,d),Ce(o,r),a=Lr(o,t[7].bind(o)),s=!0,c||(l=Tt(i=t[4].call(null,r)),c=!0)},p(u,[d]){let f={};d&1&&(f.canvas=u[0]),d&2&&(f.instance=u[1]),e.$set(f)},i(u){s||(W(e.$$.fragment,u),s=!0)},o(u){H(e.$$.fragment,u),s=!1},d(u){u&&(X(n),X(o)),se(e,u),a(),c=!1,l()}}}var _x=at(Symbol());function tr(){_x.set(Symbol())}var oE=80;function iE(t,e,n){let o,r;ot(t,_x,m=>n(6,r=m));let{mode:i}=e,a,s=0,c=i.kind==="add"?"draw-rectangle":"cursor",l=qe();function u(){l("change",{canvas:o})}function d({path:m,noteId:h}){l("image-loaded",{path:m,noteId:h})}function f(m){n(1,a=(0,wx.default)(m,{bounds:!0,maxZoom:3,minZoom:.1,zoomDoubleClickSpeed:1,smoothScroll:!1,transformOrigin:{x:.5,y:.5}})),a.pause(),globalThis.panzoom=a,i.kind=="add"?zg(i.imagePath,a,u,d).then(h=>{n(0,o=h)}):Vg(i.noteId,a,u,d).then(h=>{n(0,o=h)})}mt(()=>{window.addEventListener("resize",()=>{Wo(o,a),ro(o)})}),ur(()=>{window.removeEventListener("resize",()=>{Wo(o,a),ro(o)})});function p(){s=this.clientWidth,n(2,s)}return t.$$set=m=>{"mode"in m&&n(5,i=m.mode)},t.$$.update=()=>{t.$$.dirty&1&&(globalThis.maskEditor=o?new Ua(o):null),t.$$.dirty&64&&u()},n(0,o=null),[o,a,s,c,f,i,r,p]}var vc=class extends pe{constructor(e){super(),he(this,e,iE,rE,me,{mode:5})}},kx=vc;function aE(t){let e,n,o,r=t[3].default,i=Ne(r,t,t[2],null);return{c(){e=ie("div"),i&&i.c(),Q(e,"class",n="col "+t[0]+" svelte-1wesuxj"),de(e,"col-xs",t[1]==="xs"),de(e,"col-sm",t[1]==="sm"),de(e,"col-md",t[1]==="md"),de(e,"col-lg",t[1]==="lg"),de(e,"col-xl",t[1]==="xl"),de(e,"col-xxl",t[1]==="xxl")},m(a,s){Y(a,e,s),i&&i.m(e,null),o=!0},p(a,[s]){i&&i.p&&(!o||s&4)&&Fe(i,r,a,a[2],o?Ie(r,a[2],s,null):De(a[2]),null),(!o||s&1&&n!==(n="col "+a[0]+" svelte-1wesuxj"))&&Q(e,"class",n),(!o||s&3)&&de(e,"col-xs",a[1]==="xs"),(!o||s&3)&&de(e,"col-sm",a[1]==="sm"),(!o||s&3)&&de(e,"col-md",a[1]==="md"),(!o||s&3)&&de(e,"col-lg",a[1]==="lg"),(!o||s&3)&&de(e,"col-xl",a[1]==="xl"),(!o||s&3)&&de(e,"col-xxl",a[1]==="xxl")},i(a){o||(W(i,a),o=!0)},o(a){H(i,a),o=!1},d(a){a&&X(e),i&&i.d(a)}}}function sE(t,e,n){let{$$slots:o={},$$scope:r}=e,{class:i=""}=e,{breakpoint:a="xs"}=e;return t.$$set=s=>{"class"in s&&n(0,i=s.class),"breakpoint"in s&&n(1,a=s.breakpoint),"$$scope"in s&&n(2,r=s.$$scope)},[i,a,r,o]}var yc=class extends pe{constructor(e){super(),he(this,e,sE,aE,me,{class:0,breakpoint:1})}},Tx=yc;function lE(t){let e,n,o,r=t[2].default,i=Ne(r,t,t[1],null);return{c(){e=ie("div"),i&&i.c(),Q(e,"class",n="row "+t[0]+" svelte-1r5bk3q")},m(a,s){Y(a,e,s),i&&i.m(e,null),o=!0},p(a,[s]){i&&i.p&&(!o||s&2)&&Fe(i,r,a,a[1],o?Ie(r,a[1],s,null):De(a[1]),null),(!o||s&1&&n!==(n="row "+a[0]+" svelte-1r5bk3q"))&&Q(e,"class",n)},i(a){o||(W(i,a),o=!0)},o(a){H(i,a),o=!1},d(a){a&&X(e),i&&i.d(a)}}}function cE(t,e,n){let{$$slots:o={},$$scope:r}=e,{class:i=""}=e;return t.$$set=a=>{"class"in a&&n(0,i=a.class),"$$scope"in a&&n(1,r=a.$$scope)},[i,r,o]}var wc=class extends pe{constructor(e){super(),he(this,e,cE,lE,me,{class:0})}},$o=wc;var Cx=()=>{let t=document.activeElement;if(!t||!t.id.includes("--"))return;let e=t.id.split("--")[0],n=`${e}--div`,o=`${e}--textarea`,r=document.getElementById(n),i=document.getElementById(o);r.style.display=="none"?(r.style.display="block",i.style.display="none",r.focus()):(r.style.display="none",i.style.display="block",i.focus())};function Sx(t,e,n){let o=t.slice();return o[3]=e[n],o}function uE(t){let e,n=t[3].icon+"",o;return{c(){e=new $e(!1),o=xe(),e.a=o},m(r,i){e.m(n,r,i),Y(r,o,i)},p:ye,d(r){r&&(e.d(),X(o))}}}function Ex(t){let e,n;function o(){return t[2](t[3])}return e=new vt({props:{class:"note-tool-icon-button right-border-radius",iconSize:t[0],tooltip:t[3].title,$$slots:{default:[uE]},$$scope:{ctx:t}}}),e.$on("click",o),{c(){le(e.$$.fragment)},m(r,i){ae(e,r,i),n=!0},p(r,i){t=r;let a={};i&1&&(a.iconSize=t[0]),i&64&&(a.$$scope={dirty:i,ctx:t}),e.$set(a)},i(r){n||(W(e.$$.fragment,r),n=!0)},o(r){H(e.$$.fragment,r),n=!1},d(r){se(e,r)}}}function dE(t){let e,n,o=Ve(t[1]),r=[];for(let a=0;a<o.length;a+=1)r[a]=Ex(Sx(t,o,a));let i=a=>H(r[a],1,1,()=>{r[a]=null});return{c(){for(let a=0;a<r.length;a+=1)r[a].c();e=Ue()},m(a,s){for(let c=0;c<r.length;c+=1)r[c]&&r[c].m(a,s);Y(a,e,s),n=!0},p(a,[s]){if(s&3){o=Ve(a[1]);let c;for(c=0;c<o.length;c+=1){let l=Sx(a,o,c);r[c]?(r[c].p(l,s),W(r[c],1)):(r[c]=Ex(l),r[c].c(),W(r[c],1),r[c].m(e.parentNode,e))}for(Me(),c=o.length;c<r.length;c+=1)i(c);Le()}},i(a){if(!n){for(let s=0;s<o.length;s+=1)W(r[s]);n=!0}},o(a){r=r.filter(Boolean);for(let s=0;s<r.length;s+=1)H(r[s]);n=!1},d(a){a&&X(e),pt(r,a)}}}function fE(t,e,n){let{iconSize:o}=e,r=[{name:"code",title:"Code",icon:fl,action:Cx}],i=a=>a.action();return t.$$set=a=>{"iconSize"in a&&n(0,o=a.iconSize)},[o,r,i]}var _c=class extends pe{constructor(e){super(),he(this,e,fE,dE,me,{iconSize:0})}},Ox=_c;function za(t,e,n){document.execCommand(t,e,n)}function kr(t){let e=t.getRootNode();return e.getSelection?e.getSelection():document.getSelection()}function Ax(t){let e=t.rangeCount;return e===0?null:t.getRangeAt(e-1)}function Rx(t,e,n){if(!t.parentNode||t===e)return n;{let o=t.parentNode,r=[Array.prototype.indexOf.call(t.parentNode.childNodes,t),...n];return Rx(o,e,r)}}function Zo(t,e){return Rx(t,e,[])}function ei(t,e){if(e.length===0)return t;if(t.childNodes[e[0]]){let[n,...o]=e;return ei(t.childNodes[n],o)}else return null}var ti=(o=>(o[o.Before=-1]="Before",o[o.Equal=0]="Equal",o[o.After=1]="After",o))(ti||{});function Nx(t,e){let n=Math.min(t.coordinates.length,e.coordinates.length);for(let o=0;o<=n;o++){if(t.coordinates.length===o)return e.coordinates.length===o?t.offset<e.offset?-1:t.offset>e.offset?1:0:-1;if(e.coordinates.length===o)return 1;if(t.coordinates[o]<e.coordinates[o])return-1;if(t.coordinates[o]>e.coordinates[o])return 1}throw new Error("compareLocations: Should never happen")}function Ix(t){let e=kr(t),n=Ax(e);if(!n)return null;let o=n.collapsed,i={coordinates:Zo(e.anchorNode,t),offset:e.anchorOffset};if(o)return{anchor:i,collapsed:o};let s={coordinates:Zo(e.focusNode,t),offset:e.focusOffset},l=Nx(i,s)===1?"backward":"forward";return{anchor:i,focus:s,collapsed:o,direction:l}}function pE(t){t.empty()}function mE(t,e,n,o){let r=o.focus,i=r.offset,a=ei(t,r.coordinates);o.direction==="forward"?(n.setEnd(a,i),e.addRange(n)):(e.addRange(n),e.extend(a,i))}function Fx(t){return Ix(t)}function Dx(t,e){let n=kr(t);pE(n);let o=new Range,r=ei(t,e.anchor.coordinates);o.setStart(r,e.anchor.offset),e.collapsed?(o.collapse(!0),n.addRange(o)):mE(t,n,o,e)}vr("anki/location",{Position:ti,restoreSelection:Dx,saveSelection:Fx});function ir(t){return t.nodeType===Node.ELEMENT_NODE}function ni(t){return t.nodeType===Node.TEXT_NODE}function Mx(t){return t.nodeType===Node.COMMENT_NODE}var kc=t=>e=>{var i;let n=(i=kr(e))==null?void 0:i.anchorNode;if(!n)return null;let o=null,r=ir(n)?n:n.parentElement;for(;r;)o=o||(t(r)?r:null),r=r.parentElement;return o},Lx=t=>window.getComputedStyle(t).display==="list-item",Px=t=>t.tagName==="P",hE=t=>Lx(t)||Px(t),YW=kc(Lx),QW=kc(Px),KW=kc(hE);function Tc(t){return t.parentNode}var Cc=class t{constructor(e,n,o){this.parent=e;this.startIndex=n;this.endIndex=o}static make(e,n,o=n+1){return new t(e,n,o)}static merge(e,n){return t.make(e.parent,e.startIndex,n.endIndex)}static fromNode(e){let n=Tc(e),o=Array.prototype.indexOf.call(n.childNodes,e);return t.make(n,o)}get firstChild(){return this.parent.childNodes[this.startIndex]}get lastChild(){return this.parent.childNodes[this.endIndex-1]}select(e){this.parent=Tc(e),this.startIndex=Array.prototype.indexOf.call(this.parent.childNodes,e),this.endIndex=this.startIndex+1}toDOMRange(){let e=new Range;if(e.setStart(this.parent,this.startIndex),e.setEnd(this.parent,this.endIndex),e.collapsed){let n=e.commonAncestorContainer.childNodes[e.startOffset];ir(n)&&e.selectNode(n)}return e}[Symbol.iterator](){let e=this.parent,n=this.endIndex,o=this.startIndex;return{next(){return o>=n?{value:null,done:!0}:{value:e.childNodes[o++],done:!1}}}}get length(){return this.endIndex-this.startIndex}toString(){let e="";for(let n of[...this])ni(n)?e+=n.data:Mx(n)?e+=`<!--${n.data}-->`:ir(n)&&(e+=n.outerHTML);return e}};function Ux(t,e,n){let o=t.slice();return o[4]=e[n],o}function SE(t){let e,n=t[4].icon+"",o;return{c(){e=new $e(!1),o=xe(),e.a=o},m(r,i){e.m(n,r,i),Y(r,o,i)},p:ye,d(r){r&&(e.d(),X(o))}}}function zx(t){let e,n;function o(){return t[3](t[4])}return e=new vt({props:{id:"note-tool-"+t[4].name,class:"note-tool-icon-button "+(t[4].name==="b"?"left-border-radius":""),iconSize:t[0],tooltip:t[4].title,$$slots:{default:[SE]},$$scope:{ctx:t}}}),e.$on("click",o),{c(){le(e.$$.fragment)},m(r,i){ae(e,r,i),n=!0},p(r,i){t=r;let a={};i&1&&(a.iconSize=t[0]),i&128&&(a.$$scope={dirty:i,ctx:t}),e.$set(a)},i(r){n||(W(e.$$.fragment,r),n=!0)},o(r){H(e.$$.fragment,r),n=!1},d(r){se(e,r)}}}function EE(t){let e,n,o=Ve(t[1]),r=[];for(let a=0;a<o.length;a+=1)r[a]=zx(Ux(t,o,a));let i=a=>H(r[a],1,1,()=>{r[a]=null});return{c(){for(let a=0;a<r.length;a+=1)r[a].c();e=Ue()},m(a,s){for(let c=0;c<r.length;c+=1)r[c]&&r[c].m(a,s);Y(a,e,s),n=!0},p(a,[s]){if(s&7){o=Ve(a[1]);let c;for(c=0;c<o.length;c+=1){let l=Ux(a,o,c);r[c]?(r[c].p(l,s),W(r[c],1)):(r[c]=zx(l),r[c].c(),W(r[c],1),r[c].m(e.parentNode,e))}for(Me(),c=o.length;c<r.length;c+=1)i(c);Le()}},i(a){if(!n){for(let s=0;s<o.length;s+=1)W(r[s]);n=!0}},o(a){r=r.filter(Boolean);for(let s=0;s<r.length;s+=1)H(r[s]);n=!1},d(a){a&&X(e),pt(r,a)}}}function OE(t,e,n){let{iconSize:o}=e,r=[{name:"b",title:ed(),icon:vl,action:"bold"},{name:"i",title:kd(),icon:yl,action:"italic"},{name:"u",title:Ed(),icon:wl,action:"underline"}],i=s=>{za(s.action,!1,s.name)},a=s=>{i(s)};return t.$$set=s=>{"iconSize"in s&&n(0,o=s.iconSize)},[o,r,i,a]}var Sc=class extends pe{constructor(e){super(),he(this,e,OE,EE,me,{iconSize:0})}},Vx=Sc;function AE(t){let e,n,o,r;return e=new Vx({props:{iconSize:Wx}}),o=new Ox({props:{iconSize:Wx}}),{c(){le(e.$$.fragment),n=xe(),le(o.$$.fragment)},m(i,a){ae(e,i,a),Y(i,n,a),ae(o,i,a),r=!0},p:ye,i(i){r||(W(e.$$.fragment,i),W(o.$$.fragment,i),r=!0)},o(i){H(e.$$.fragment,i),H(o.$$.fragment,i),r=!1},d(i){i&&X(n),se(e,i),se(o,i)}}}var Wx=80,Ec=class extends pe{constructor(e){super(),he(this,e,null,AE,me,{})}},Hx=Ec;var Ut="\u2237";function oi(t){return t.replace(/::/g,Ut)}function go(t){return t.replace(/\u2237/gu,"::")}function Oc(t){let e=t.trim();for(;e.startsWith(":")||e.startsWith(Ut);)e=e.slice(1).trimStart();for(;e.endsWith(":")||e.endsWith(Ut);)e=e.slice(0,-1).trimEnd();return e}function Va(t){return{id:Math.random().toString(36).substring(2),name:t,selected:!1,flash:()=>{}}}function Gx(t){return t.name}function RE(t){let e,n,o,r,i;return{c(){e=ie("input"),Q(e,"id",t[2]),Q(e,"class",n="tag-input "+t[3]+" svelte-1nk8ij0"),Q(e,"type","text"),Q(e,"tabindex","-1"),Q(e,"size","1"),de(e,"disabled",t[4])},m(a,s){Y(a,e,s),t[14](e),Mr(e,t[0]),r||(i=[_e(e,"input",t[15]),_e(e,"focus",t[11]),_e(e,"blur",Ct(t[6])),_e(e,"keydown",t[7]),_e(e,"keydown",t[12]),_e(e,"keyup",t[13]),_e(e,"input",t[16]),_e(e,"copy",Ct(t[8])),_e(e,"paste",Ct(t[9])),Tt(o=t[10].call(null,e))],r=!0)},p(a,s){s[0]&4&&Q(e,"id",a[2]),s[0]&8&&n!==(n="tag-input "+a[3]+" svelte-1nk8ij0")&&Q(e,"class",n),s[0]&1&&e.value!==a[0]&&Mr(e,a[0]),s[0]&24&&de(e,"disabled",a[4])},i:ye,o:ye,d(a){a&&X(e),t[14](null),r=!1,Pe(i)}}}var ar=at(null),YG=Vr(ar,t=>()=>t==null?void 0:t.blur());function NE(t,e,n){let o,r=ye,i=()=>(r(),r=sn(ar,F=>n(17,o=F)),ar);ot(t,ar,F=>n(17,o=F)),t.$$.on_destroy.push(()=>r());let{id:a=void 0}=e,{class:s=""}=e,{name:c}=e,{input:l}=e,{disabled:u}=e,d=qe();function f(){return l.selectionStart===l.selectionEnd}function p(){return l.selectionStart===0&&l.selectionEnd===0}function m(){return l.selectionStart===l.value.length&&l.selectionEnd===l.value.length}function h(F){l.setSelectionRange(F,F)}function b(){return c.length===0}async function x(F){let z=l.value.length;d("tagjoinprevious"),await xt(),h(l.value.length-z),F.preventDefault()}async function y(F,z){if(z>c.length)return;c.slice(0,z).endsWith(Ut)&&(n(0,c=c.slice(0,z-1)+c.slice(z,c.length)),await xt(),F.preventDefault(),h(z-1),d("taginput"))}function M(F){p()?x(F):y(F,l.selectionStart)}async function E(F){let z=l.value.length;d("tagjoinnext"),await xt(),h(z),F.preventDefault()}function C(F){m()?E(F):y(F,l.selectionStart+2)}function j(){n(0,c=Oc(c)),c.length===0&&d("tagdelete"),d("tagaccept")}function P(F){d("tagsplit",{start:l.selectionStart,end:l.selectionEnd}),F.preventDefault()}async function D(F,z=!1){let q=l.selectionStart,ee=l.selectionEnd,O=c.slice(0,q),B=c.slice(ee,c.length);if(O.endsWith(Ut)){F.preventDefault(),F.stopPropagation();return}else if(O.endsWith(":")){F.preventDefault(),n(0,c=`${O.slice(0,-1)}${Ut}${c.slice(ee,c.length)}`),await xt(),h(q),d("taginput");return}else if(B.startsWith(":"))F.preventDefault(),n(0,c=`${O}${Ut}${c.slice(ee+1,c.length)}`);else{if(z)return;F.preventDefault(),n(0,c=`${O}${Ut}${B}`)}await xt(),h(q+1),d("taginput")}function N(F){switch(F.code){case"Enter":P(F);break;case"Backspace":f()&&M(F);break;case"Delete":f()&&C(F);break}$g(F)?b()?x(F):p()&&(d("tagmoveprevious"),F.preventDefault()):Zg(F)?b()?E(F):m()&&(d("tagmovenext"),F.preventDefault()):F.key===" "?D(F,!1):F.key===":"&&D(F,!0)}function S(F){let z=document.getSelection();F.clipboardData.setData("text/plain",go(z.toString()))}function G(F){if(!F.clipboardData)return;let q=(c+F.clipboardData.getData("text/plain")).split(/\s+/).map(Oc).filter(O=>O.length>0).map(oi);if(q.length===0)return;let ee=q.pop();for(let O of q.reverse())n(0,c=O),d("tagadd");n(0,c=ee)}function v(F){c.length===0&&(F.preventDefault(),F.stopPropagation(),d("tagselectall"))}let{selectAllShortcut:T}=kn(so);mt(()=>{Go(v,T,{target:l}),l.focus()});function R(F){return zn(ar,o=F,o),{destroy(){o===F&&zn(ar,o=null,o)}}}function A(F){Oe.call(this,t,F)}function U(F){Oe.call(this,t,F)}function k(F){Oe.call(this,t,F)}function w(F){He[F?"unshift":"push"](()=>{l=F,n(1,l)})}function I(){c=this.value,n(0,c)}let _=()=>d("taginput");return t.$$set=F=>{"id"in F&&n(2,a=F.id),"class"in F&&n(3,s=F.class),"name"in F&&n(0,c=F.name),"input"in F&&n(1,l=F.input),"disabled"in F&&n(4,u=F.disabled)},[c,l,a,s,u,d,j,N,S,G,R,A,U,k,w,I,_]}var Ac=class extends pe{constructor(e){super(),he(this,e,NE,RE,me,{id:2,class:3,name:0,input:1,disabled:4},null,[-1,-1])}},qx=Ac;var Rc='<svg xmlns="http://www.w3.org/2000/svg" id="mdi-dots-vertical" viewBox="0 0 24 24"><path d="M12,16A2,2 0 0,1 14,18A2,2 0 0,1 12,20A2,2 0 0,1 10,18A2,2 0 0,1 12,16M12,10A2,2 0 0,1 14,12A2,2 0 0,1 12,14A2,2 0 0,1 10,12A2,2 0 0,1 12,10M12,4A2,2 0 0,1 14,6A2,2 0 0,1 12,8A2,2 0 0,1 10,6A2,2 0 0,1 12,4Z" /></svg>';var Nc='<svg xmlns="http://www.w3.org/2000/svg" id="mdi-tag-outline" viewBox="0 0 24 24"><path d="M21.41 11.58L12.41 2.58A2 2 0 0 0 11 2H4A2 2 0 0 0 2 4V11A2 2 0 0 0 2.59 12.42L11.59 21.42A2 2 0 0 0 13 22A2 2 0 0 0 14.41 21.41L21.41 14.41A2 2 0 0 0 22 13A2 2 0 0 0 21.41 11.58M13 20L4 11V4H11L20 13M6.5 5A1.5 1.5 0 1 1 5 6.5A1.5 1.5 0 0 1 6.5 5Z" /></svg>';var Ic='<svg xmlns="http://www.w3.org/2000/svg" id="mdi-tag-plus-outline" viewBox="0 0 24 24"><path d="M6.5 5A1.5 1.5 0 1 0 8 6.5A1.5 1.5 0 0 0 6.5 5M6.5 5A1.5 1.5 0 1 0 8 6.5A1.5 1.5 0 0 0 6.5 5M21.41 11.58L12.41 2.58A2 2 0 0 0 11 2H4A2 2 0 0 0 2 4V11A2 2 0 0 0 2.59 12.42L3 12.82A5.62 5.62 0 0 1 5.08 12.08L4 11V4H11L20 13L13 20L11.92 18.92A5.57 5.57 0 0 1 11.18 21L11.59 21.41A2 2 0 0 0 13 22A2 2 0 0 0 14.41 21.41L21.41 14.41A2 2 0 0 0 22 13A2 2 0 0 0 21.41 11.58M6.5 5A1.5 1.5 0 1 0 8 6.5A1.5 1.5 0 0 0 6.5 5M10 19H7V22H5V19H2V17H5V14H7V17H10Z" /></svg>';function ME(t){let e,n,o,r;return{c(){e=new $e(!1),n=xe(),o=new $e(!1),r=Ue(),e.a=n,o.a=r},m(i,a){e.m(Nc,i,a),Y(i,n,a),o.m(Ic,i,a),Y(i,r,a)},p:ye,d(i){i&&(e.d(),X(n),X(r),o.d())}}}function LE(t){let e,n,o,r,i,a,s,c,l,u,d;n=new er({props:{$$slots:{default:[ME]},$$scope:{ctx:t}}});let f=t[4].default,p=Ne(f,t,t[6],null);return c=new Ot({props:{keyCombination:t[0]}}),c.$on("action",t[5]),{c(){e=ie("div"),le(n.$$.fragment),o=xe(),r=ie("span"),p&&p.c(),s=xe(),le(c.$$.fragment),Q(r,"class","tags-info svelte-1rjs6r4"),Q(e,"class","tag-add-button svelte-1rjs6r4"),Q(e,"title",i=ls()+" ("+yt(t[0])+")"),Q(e,"role","button"),Q(e,"tabindex",a=t[1]?-1:0)},m(m,h){Y(m,e,h),ae(n,e,null),Ce(e,o),Ce(e,r),p&&p.m(r,null),Y(m,s,h),ae(c,m,h),l=!0,u||(d=[_e(e,"click",t[3]),_e(e,"focus",t[3])],u=!0)},p(m,[h]){let b={};h&64&&(b.$$scope={dirty:h,ctx:m}),n.$set(b),p&&p.p&&(!l||h&64)&&Fe(p,f,m,m[6],l?Ie(f,m[6],h,null):De(m[6]),null),(!l||h&1&&i!==(i=ls()+" ("+yt(m[0])+")"))&&Q(e,"title",i),(!l||h&2&&a!==(a=m[1]?-1:0))&&Q(e,"tabindex",a);let x={};h&1&&(x.keyCombination=m[0]),c.$set(x)},i(m){l||(W(n.$$.fragment,m),W(p,m),W(c.$$.fragment,m),l=!0)},o(m){H(n.$$.fragment,m),H(p,m),H(c.$$.fragment,m),l=!1},d(m){m&&(X(e),X(s)),se(n),p&&p.d(m),se(c,m),u=!1,Pe(d)}}}function PE(t,e,n){let o;ot(t,ar,u=>n(1,o=u));let{$$slots:r={},$$scope:i}=e,{keyCombination:a}=e,s=qe();function c(){s("tagappend")}let l=()=>s("tagappend");return t.$$set=u=>{"keyCombination"in u&&n(0,a=u.keyCombination),"$$scope"in u&&n(6,i=u.$$scope)},[a,o,s,c,r,l,i]}var Fc=class extends pe{constructor(e){super(),he(this,e,PE,LE,me,{keyCombination:0})}},Xx=Fc;function BE(t){let e,n;return{c(){e=new $e(!1),n=Ue(),e.a=n},m(o,r){e.m(Rc,o,r),Y(o,n,r)},p:ye,d(o){o&&(X(n),e.d())}}}function jE(t){let e,n,o,r,i,a;return n=new er({props:{$$slots:{default:[BE]},$$scope:{ctx:t}}}),{c(){e=ie("div"),le(n.$$.fragment),Q(e,"class","tags-selected-button svelte-1d1hiwg"),Q(e,"role","button"),Q(e,"tabindex","0")},m(s,c){Y(s,e,c),ae(n,e,null),r=!0,i||(a=[Tt(o=t[10].call(null,e)),_e(e,"click",t[8]),_e(e,"keydown",function(){Ft(Yl(t[9]))&&Yl(t[9]).apply(this,arguments)})],i=!0)},p(s,c){t=s;let l={};c&2048&&(l.$$scope={dirty:c,ctx:t}),n.$set(l)},i(s){r||(W(n.$$.fragment,s),r=!0)},o(s){H(n.$$.fragment,s),r=!1},d(s){s&&X(e),se(n),i=!1,Pe(a)}}}function UE(t){let e=Sd()+"",n,o,r=yt(t[2])+"",i,a;return{c(){n=We(e),o=We(" ("),i=We(r),a=We(")")},m(s,c){Y(s,n,c),Y(s,o,c),Y(s,i,c),Y(s,a,c)},p:ye,d(s){s&&(X(n),X(o),X(i),X(a))}}}function zE(t){let e=Td()+"",n,o,r=yt(t[3])+"",i,a;return{c(){n=We(e),o=We(" ("),i=We(r),a=We(")")},m(s,c){Y(s,n,c),Y(s,o,c),Y(s,i,c),Y(s,a,c)},p:ye,d(s){s&&(X(n),X(o),X(i),X(a))}}}function VE(t){let e=Cd()+"",n,o,r=yt(t[4])+"",i,a;return{c(){n=We(e),o=We(" ("),i=We(r),a=We(")")},m(s,c){Y(s,n,c),Y(s,o,c),Y(s,i,c),Y(s,a,c)},p:ye,d(s){s&&(X(n),X(o),X(i),X(a))}}}function WE(t){let e,n,o,r,i,a;return e=new yr({props:{$$slots:{default:[UE]},$$scope:{ctx:t}}}),e.$on("click",t[5]),o=new yr({props:{$$slots:{default:[zE]},$$scope:{ctx:t}}}),o.$on("click",t[6]),i=new yr({props:{$$slots:{default:[VE]},$$scope:{ctx:t}}}),i.$on("click",t[7]),{c(){le(e.$$.fragment),n=xe(),le(o.$$.fragment),r=xe(),le(i.$$.fragment)},m(s,c){ae(e,s,c),Y(s,n,c),ae(o,s,c),Y(s,r,c),ae(i,s,c),a=!0},p(s,c){let l={};c&2048&&(l.$$scope={dirty:c,ctx:s}),e.$set(l);let u={};c&2048&&(u.$$scope={dirty:c,ctx:s}),o.$set(u);let d={};c&2048&&(d.$$scope={dirty:c,ctx:s}),i.$set(d)},i(s){a||(W(e.$$.fragment,s),W(o.$$.fragment,s),W(i.$$.fragment,s),a=!0)},o(s){H(e.$$.fragment,s),H(o.$$.fragment,s),H(i.$$.fragment,s),a=!1},d(s){s&&(X(n),X(r)),se(e,s),se(o,s),se(i,s)}}}function HE(t){let e,n;return e=new lo({props:{slot:"floating",$$slots:{default:[WE]},$$scope:{ctx:t}}}),{c(){le(e.$$.fragment)},m(o,r){ae(e,o,r),n=!0},p(o,r){let i={};r&2048&&(i.$$scope={dirty:r,ctx:o}),e.$set(i)},i(o){n||(W(e.$$.fragment,o),n=!0)},o(o){H(e.$$.fragment,o),n=!1},d(o){se(e,o)}}}function GE(t){let e,n;return e=new ho({props:{show:t[0],preferredPlacement:"top",portalTarget:document.body,shift:0,$$slots:{floating:[HE],default:[jE,({asReference:o})=>({10:o}),({asReference:o})=>o?1024:0]},$$scope:{ctx:t}}}),{c(){le(e.$$.fragment)},m(o,r){ae(e,o,r),n=!0},p(o,[r]){let i={};r&1&&(i.show=o[0]),r&2049&&(i.$$scope={dirty:r,ctx:o}),e.$set(i)},i(o){n||(W(e.$$.fragment,o),n=!0)},o(o){H(e.$$.fragment,o),n=!1},d(o){se(e,o)}}}function qE(t,e,n){let o=qe(),r=!1,{selectAllShortcut:i,copyShortcut:a,removeShortcut:s}=kn(so);return[r,o,i,a,s,()=>o("tagselectall"),()=>o("tagcopy"),()=>o("tagdelete"),()=>n(0,r=!r),()=>n(0,r=!r)]}var Dc=class extends pe{constructor(e){super(),he(this,e,qE,GE,me,{})}},Yx=Dc;function XE(t){let e,n;return e=new Xx({props:{keyCombination:t[2]}}),e.$on("tagappend",t[7]),{c(){le(e.$$.fragment)},m(o,r){ae(e,o,r),n=!0},p(o,r){let i={};r&4&&(i.keyCombination=o[2]),e.$set(i)},i(o){n||(W(e.$$.fragment,o),n=!0)},o(o){H(e.$$.fragment,o),n=!1},d(o){se(e,o)}}}function YE(t){let e,n;return e=new Yx({}),e.$on("tagselectall",t[4]),e.$on("tagcopy",t[5]),e.$on("tagdelete",t[6]),{c(){le(e.$$.fragment)},m(o,r){ae(e,o,r),n=!0},p:ye,i(o){n||(W(e.$$.fragment,o),n=!0)},o(o){H(e.$$.fragment,o),n=!1},d(o){se(e,o)}}}function QE(t){let e,n,o,r,i,a,s,c=[YE,XE],l=[];function u(d,f){return d[1]?0:1}return n=u(t,-1),o=l[n]=c[n](t),{c(){e=ie("div"),o.c(),Q(e,"class","tag-options-button gap svelte-16efk4p"),Mt(()=>t[8].call(e))},m(d,f){Y(d,e,f),l[n].m(e,null),r=Lr(e,t[8].bind(e)),i=!0,a||(s=_e(e,"mousedown",Ct(t[3])),a=!0)},p(d,[f]){let p=n;n=u(d,f),n===p?l[n].p(d,f):(Me(),H(l[p],1,1,()=>{l[p]=null}),Le(),o=l[n],o?o.p(d,f):(o=l[n]=c[n](d),o.c()),W(o,1),o.m(e,null))},i(d){i||(W(o),i=!0)},o(d){H(o),i=!1},d(d){d&&X(e),l[n].d(),r(),a=!1,s()}}}function KE(t,e,n){let{badgeHeight:o}=e,{tagsSelected:r}=e,{keyCombination:i}=e;function a(f){Oe.call(this,t,f)}function s(f){Oe.call(this,t,f)}function c(f){Oe.call(this,t,f)}function l(f){Oe.call(this,t,f)}function u(f){Oe.call(this,t,f)}function d(){o=this.offsetHeight,n(0,o)}return t.$$set=f=>{"badgeHeight"in f&&n(0,o=f.badgeHeight),"tagsSelected"in f&&n(1,r=f.tagsSelected),"keyCombination"in f&&n(2,i=f.keyCombination)},[o,r,i,a,s,c,l,u,d]}var Mc=class extends pe{constructor(e){super(),he(this,e,KE,QE,me,{badgeHeight:0,tagsSelected:1,keyCombination:2})}},Lc=Mc;function JE(t){let e,n=t[6].default,o=Ne(n,t,t[11],null);return{c(){o&&o.c()},m(r,i){o&&o.m(r,i),e=!0},p(r,i){o&&o.p&&(!e||i&2048)&&Fe(o,n,r,r[11],e?Ie(n,r[11],i,null):De(r[11]),null)},i(r){e||(W(o,r),e=!0)},o(r){H(o,r),e=!1},d(r){o&&o.d(r)}}}function $E(t){let e,n,o,r,i,a;return n=new er({props:{iconSize:t[2],widthMultiplier:t[3],flipX:t[4],$$slots:{default:[JE]},$$scope:{ctx:t}}}),{c(){e=ie("button"),le(n.$$.fragment),Q(e,"title",t[1]),Q(e,"class",o="badge "+t[0]+" svelte-tvhc1n"),Q(e,"tabindex","-1")},m(s,c){Y(s,e,c),ae(n,e,null),t[10](e),r=!0,i||(a=[_e(e,"click",t[7]),_e(e,"mouseenter",t[8]),_e(e,"mouseleave",t[9])],i=!0)},p(s,[c]){let l={};c&4&&(l.iconSize=s[2]),c&8&&(l.widthMultiplier=s[3]),c&16&&(l.flipX=s[4]),c&2048&&(l.$$scope={dirty:c,ctx:s}),n.$set(l),(!r||c&2)&&Q(e,"title",s[1]),(!r||c&1&&o!==(o="badge "+s[0]+" svelte-tvhc1n"))&&Q(e,"class",o)},i(s){r||(W(n.$$.fragment,s),r=!0)},o(s){H(n.$$.fragment,s),r=!1},d(s){s&&X(e),se(n),t[10](null),i=!1,Pe(a)}}}function ZE(t,e,n){let{$$slots:o={},$$scope:r}=e,{class:i=""}=e,{tooltip:a=void 0}=e,{iconSize:s=100}=e,{widthMultiplier:c=1}=e,{flipX:l=!1}=e,u=qe(),d;mt(()=>{u("mount",{span:d})});function f(b){Oe.call(this,t,b)}function p(b){Oe.call(this,t,b)}function m(b){Oe.call(this,t,b)}function h(b){He[b?"unshift":"push"](()=>{d=b,n(5,d)})}return t.$$set=b=>{"class"in b&&n(0,i=b.class),"tooltip"in b&&n(1,a=b.tooltip),"iconSize"in b&&n(2,s=b.iconSize),"widthMultiplier"in b&&n(3,c=b.widthMultiplier),"flipX"in b&&n(4,l=b.flipX),"$$scope"in b&&n(11,r=b.$$scope)},[i,a,s,c,l,d,o,f,p,m,h,r]}var Pc=class extends pe{constructor(e){super(),he(this,e,ZE,$E,me,{class:0,tooltip:1,iconSize:2,widthMultiplier:3,flipX:4})}},Qx=Pc;var Bc=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-x" viewBox="0 0 16 16">
  <path d="M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708"/>
</svg>`;function t3(t){let e,n;return{c(){e=new $e(!1),n=Ue(),e.a=n},m(o,r){e.m(Bc,o,r),Y(o,n,r)},p:ye,d(o){o&&(X(n),e.d())}}}function n3(t){let e,n;return e=new Qx({props:{class:"d-flex align-items-center ms-1 "+t[0],iconSize:80,$$slots:{default:[t3]},$$scope:{ctx:t}}}),e.$on("click",t[1]),{c(){le(e.$$.fragment)},m(o,r){ae(e,o,r),n=!0},p(o,[r]){let i={};r&1&&(i.class="d-flex align-items-center ms-1 "+o[0]),r&4&&(i.$$scope={dirty:r,ctx:o}),e.$set(i)},i(o){n||(W(e.$$.fragment,o),n=!0)},o(o){H(e.$$.fragment,o),n=!1},d(o){se(e,o)}}}function r3(t,e,n){let{class:o=""}=e;function r(i){Oe.call(this,t,i)}return t.$$set=i=>{"class"in i&&n(0,o=i.class)},[o,r]}var jc=class extends pe{constructor(e){super(),he(this,e,r3,n3,me,{class:0})}},Kx=jc;var Rv=gt(Ov());var t5=t=>({tooltipObject:t&1}),Av=t=>({createTooltip:t[1],tooltipObject:t[0]});function n5(t){let e,n=t[10].default,o=Ne(n,t,t[9],Av);return{c(){o&&o.c()},m(r,i){o&&o.m(r,i),e=!0},p(r,[i]){o&&o.p&&(!e||i&513)&&Fe(o,n,r,r[9],e?Ie(n,r[9],i,t5):De(r[9]),Av)},i(r){e||(W(o,r),e=!0)},o(r){H(o,r),e=!1},d(r){o&&o.d(r)}}}function r5(t,e,n){let{$$slots:o={},$$scope:r}=e,{tooltip:i}=e,{trigger:a="hover focus"}=e,{placement:s="top"}=e,{html:c=!0}=e,{offset:l=[0,0]}=e,{showDelay:u=0}=e,{hideDelay:d=0}=e,f,p;function m(h){f=h,h.title=i,n(0,p=new Rv.default(h,{placement:s,html:c,offset:l,delay:{show:u,hide:d},trigger:a}))}return ur(()=>{f==null||f.addEventListener("hidden.bs.tooltip",()=>{p==null||p.dispose()}),p==null||p.hide()}),t.$$set=h=>{"tooltip"in h&&n(2,i=h.tooltip),"trigger"in h&&n(3,a=h.trigger),"placement"in h&&n(4,s=h.placement),"html"in h&&n(5,c=h.html),"offset"in h&&n(6,l=h.offset),"showDelay"in h&&n(7,u=h.showDelay),"hideDelay"in h&&n(8,d=h.hideDelay),"$$scope"in h&&n(9,r=h.$$scope)},[p,m,i,a,s,c,l,u,d,r,o]}var yu=class extends pe{constructor(e){super(),he(this,e,r5,n5,me,{tooltip:2,trigger:3,placement:4,html:5,offset:6,showDelay:7,hideDelay:8})}},Nv=yu;function Iv(){return{isDark:document.documentElement.classList.contains("night-mode")}}var Fv=null,Qa=zr(Iv(),t=>{Fv=t});rt(Qa);var o5=new MutationObserver((t,e)=>{Fv(Iv())});o5.observe(document.documentElement,{attributeFilter:["class"]});vr("anki/theme",{pageTheme:Qa});function i5(t){let e,n,o,r,i,a=t[7].default,s=Ne(a,t,t[6],null);return{c(){e=ie("button"),s&&s.c(),Q(e,"class",n="tag d-inline-flex align-items-center text-nowrap ps-2 pe-1 "+t[0]+" svelte-1cw7igw"),Q(e,"tabindex","-1"),Q(e,"title",t[1]),de(e,"selected",t[2]),de(e,"flashing",t[3])},m(c,l){Y(c,e,l),s&&s.m(e,null),t[10](e),o=!0,r||(i=[_e(e,"mousemove",t[8]),_e(e,"click",t[9])],r=!0)},p(c,[l]){s&&s.p&&(!o||l&64)&&Fe(s,a,c,c[6],o?Ie(a,c[6],l,null):De(c[6]),null),(!o||l&1&&n!==(n="tag d-inline-flex align-items-center text-nowrap ps-2 pe-1 "+c[0]+" svelte-1cw7igw"))&&Q(e,"class",n),(!o||l&2)&&Q(e,"title",c[1]),(!o||l&5)&&de(e,"selected",c[2]),(!o||l&9)&&de(e,"flashing",c[3])},i(c){o||(W(s,c),o=!0)},o(c){H(s,c),o=!1},d(c){c&&X(e),s&&s.d(c),t[10](null),r=!1,Pe(i)}}}function a5(t,e,n){let{$$slots:o={},$$scope:r}=e,{class:i=""}=e,{tooltip:a=void 0}=e,{selected:s=!1}=e,c=qe(),l=!1;function u(){n(3,l=!0),setTimeout(()=>n(3,l=!1),300)}let d;mt(()=>c("mount",{button:d}));function f(h){Oe.call(this,t,h)}function p(h){Oe.call(this,t,h)}function m(h){He[h?"unshift":"push"](()=>{d=h,n(4,d)})}return t.$$set=h=>{"class"in h&&n(0,i=h.class),"tooltip"in h&&n(1,a=h.tooltip),"selected"in h&&n(2,s=h.selected),"$$scope"in h&&n(6,r=h.$$scope)},[i,a,s,l,d,u,r,o,f,p,m]}var wu=class extends pe{constructor(e){super(),he(this,e,a5,i5,me,{class:0,tooltip:1,selected:2,flash:5})}get flash(){return this.$$.ctx[5]}},Ka=wu;var s5=t=>({selectMode:t&128}),Dv=t=>({selectMode:t[7],hoverClass:ku}),l5=t=>({selectMode:t&128}),Mv=t=>({selectMode:t[7],hoverClass:ku}),c5=t=>({selectMode:t&128}),Lv=t=>({selectMode:t[7],hoverClass:ku});function u5(t){let e,n,o,r;function i(c){t[19](c)}function a(c){t[20](c)}let s={class:t[3],$$slots:{default:[p5]},$$scope:{ctx:t}};return t[1]!==void 0&&(s.flash=t[1]),t[0]!==void 0&&(s.selected=t[0]),e=new Ka({props:s}),He.push(()=>Qt(e,"flash",i)),He.push(()=>Qt(e,"selected",a)),e.$on("mousemove",t[9]),e.$on("click",t[10]),{c(){le(e.$$.fragment)},m(c,l){ae(e,c,l),r=!0},p(c,l){let u={};l&8&&(u.class=c[3]),l&2097284&&(u.$$scope={dirty:l,ctx:c}),!n&&l&2&&(n=!0,u.flash=c[1],Yt(()=>n=!1)),!o&&l&1&&(o=!0,u.selected=c[0],Yt(()=>o=!1)),e.$set(u)},i(c){r||(W(e.$$.fragment,c),r=!0)},o(c){H(e.$$.fragment,c),r=!1},d(c){se(e,c)}}}function d5(t){let e,n;return e=new Nv({props:{tooltip:t[4],trigger:"hover",placement:"top",$$slots:{default:[h5,({createTooltip:o})=>({23:o}),({createTooltip:o})=>o?8388608:0]},$$scope:{ctx:t}}}),{c(){le(e.$$.fragment)},m(o,r){ae(e,o,r),n=!0},p(o,r){let i={};r&16&&(i.tooltip=o[4]),r&10485903&&(i.$$scope={dirty:r,ctx:o}),e.$set(i)},i(o){n||(W(e.$$.fragment,o),n=!0)},o(o){H(e.$$.fragment,o),n=!1},d(o){se(e,o)}}}function f5(t){let e,n;return e=new Ka({props:{class:t[3],$$slots:{default:[g5]},$$scope:{ctx:t}}}),e.$on("mousemove",t[9]),e.$on("click",t[10]),{c(){le(e.$$.fragment)},m(o,r){ae(e,o,r),n=!0},p(o,r){let i={};r&8&&(i.class=o[3]),r&2097284&&(i.$$scope={dirty:r,ctx:o}),e.$set(i)},i(o){n||(W(e.$$.fragment,o),n=!0)},o(o){H(e.$$.fragment,o),n=!1},d(o){se(e,o)}}}function p5(t){let e,n,o,r,i=t[15].default,a=Ne(i,t,t[21],Dv);return{c(){e=ie("span"),n=We(t[2]),o=xe(),a&&a.c()},m(s,c){Y(s,e,c),Ce(e,n),Y(s,o,c),a&&a.m(s,c),r=!0},p(s,c){(!r||c&4)&&Dt(n,s[2]),a&&a.p&&(!r||c&2097280)&&Fe(a,i,s,s[21],r?Ie(i,s[21],c,s5):De(s[21]),Dv)},i(s){r||(W(a,s),r=!0)},o(s){H(a,s),r=!1},d(s){s&&(X(e),X(o)),a&&a.d(s)}}}function m5(t){let e,n=t[11](t[2])+"",o,r,i,a=t[15].default,s=Ne(a,t,t[21],Mv);return{c(){e=ie("span"),o=We(n),r=xe(),s&&s.c()},m(c,l){Y(c,e,l),Ce(e,o),Y(c,r,l),s&&s.m(c,l),i=!0},p(c,l){(!i||l&4)&&n!==(n=c[11](c[2])+"")&&Dt(o,n),s&&s.p&&(!i||l&2097280)&&Fe(s,a,c,c[21],i?Ie(a,c[21],l,l5):De(c[21]),Mv)},i(c){i||(W(s,c),i=!0)},o(c){H(s,c),i=!1},d(c){c&&(X(e),X(r)),s&&s.d(c)}}}function h5(t){let e,n,o,r;function i(l){t[16](l)}function a(l){t[17](l)}function s(...l){return t[18](t[23],...l)}let c={class:t[3],$$slots:{default:[m5]},$$scope:{ctx:t}};return t[1]!==void 0&&(c.flash=t[1]),t[0]!==void 0&&(c.selected=t[0]),e=new Ka({props:c}),He.push(()=>Qt(e,"flash",i)),He.push(()=>Qt(e,"selected",a)),e.$on("mousemove",t[9]),e.$on("click",t[10]),e.$on("mount",s),{c(){le(e.$$.fragment)},m(l,u){ae(e,l,u),r=!0},p(l,u){t=l;let d={};u&8&&(d.class=t[3]),u&2097284&&(d.$$scope={dirty:u,ctx:t}),!n&&u&2&&(n=!0,d.flash=t[1],Yt(()=>n=!1)),!o&&u&1&&(o=!0,d.selected=t[0],Yt(()=>o=!1)),e.$set(d)},i(l){r||(W(e.$$.fragment,l),r=!0)},o(l){H(e.$$.fragment,l),r=!1},d(l){se(e,l)}}}function g5(t){let e,n,o,r=t[15].default,i=Ne(r,t,t[21],Lv);return{c(){e=We(t[2]),n=xe(),i&&i.c()},m(a,s){Y(a,e,s),Y(a,n,s),i&&i.m(a,s),o=!0},p(a,s){(!o||s&4)&&Dt(e,a[2]),i&&i.p&&(!o||s&2097280)&&Fe(i,r,a,a[21],o?Ie(r,a[21],s,c5):De(a[21]),Lv)},i(a){o||(W(i,a),o=!0)},o(a){H(i,a),o=!1},d(a){a&&(X(e),X(n)),i&&i.d(a)}}}function b5(t){let e,n,o,r,i,a,s,c,l=[f5,d5,u5],u=[];function d(f,p){return p&68&&(o=null),f[5]?0:(o==null&&(o=!!(f[6]&&f[12](f[2]))),o?1:2)}return r=d(t,-1),i=u[r]=l[r](t),{c(){e=xe(),n=ie("div"),i.c(),Q(n,"class","svelte-cc9c1q"),de(n,"select-mode",t[7]),de(n,"night-mode",t[8].isDark),de(n,"empty",t[2]==="")},m(f,p){Y(f,e,p),Y(f,n,p),u[r].m(n,null),a=!0,s||(c=[_e(document.body,"keydown",t[9]),_e(document.body,"keyup",t[9])],s=!0)},p(f,[p]){let m=r;r=d(f,p),r===m?u[r].p(f,p):(Me(),H(u[m],1,1,()=>{u[m]=null}),Le(),i=u[r],i?i.p(f,p):(i=u[r]=l[r](f),i.c()),W(i,1),i.m(n,null)),(!a||p&128)&&de(n,"select-mode",f[7]),(!a||p&256)&&de(n,"night-mode",f[8].isDark),(!a||p&4)&&de(n,"empty",f[2]==="")},i(f){a||(W(i),a=!0)},o(f){H(i),a=!1},d(f){f&&(X(e),X(n)),u[r].d(),s=!1,Pe(c)}}}var ku="tag-icon-hover";function x5(t,e,n){let o,r;ot(t,Qa,S=>n(8,r=S));let{$$slots:i={},$$scope:a}=e,{name:s}=e,{class:c=""}=e,{tooltip:l}=e,{selected:u}=e,{active:d}=e,{shorten:f}=e,{flash:p}=e,m=qe(),h=!1,b=!1;function x(S){n(13,h=Yg(S)),n(14,b=Qg(S))}function y(){m(b?"tagrange":h?"tagselect":"tagclick")}function M(S){let G=S.split(Ut);return G.length===1?S:`\u2026${Ut}`+G[G.length-1]}function E(S){return S.split(Ut).length>1}function C(S){p=S,n(1,p)}function j(S){u=S,n(0,u)}let P=(S,G)=>S(G.detail.button);function D(S){p=S,n(1,p)}function N(S){u=S,n(0,u)}return t.$$set=S=>{"name"in S&&n(2,s=S.name),"class"in S&&n(3,c=S.class),"tooltip"in S&&n(4,l=S.tooltip),"selected"in S&&n(0,u=S.selected),"active"in S&&n(5,d=S.active),"shorten"in S&&n(6,f=S.shorten),"flash"in S&&n(1,p=S.flash),"$$scope"in S&&n(21,a=S.$$scope)},t.$$.update=()=>{t.$$.dirty&24576&&n(7,o=h||b)},[u,p,s,c,l,d,f,o,r,x,y,M,E,h,b,i,C,j,P,D,N,a]}var _u=class extends pe{constructor(e){super(),he(this,e,x5,b5,me,{name:2,class:3,tooltip:4,selected:0,active:5,shorten:6,flash:1})}},Pv=_u;function v5(t){let e,n;function o(){return t[9](t[13])}return e=new Kx({props:{class:t[14]}}),e.$on("click",o),{c(){le(e.$$.fragment)},m(r,i){ae(e,r,i),n=!0},p(r,i){t=r;let a={};i&16384&&(a.class=t[14]),e.$set(a)},i(r){n||(W(e.$$.fragment,r),n=!0)},o(r){H(e.$$.fragment,r),n=!1},d(r){se(e,r)}}}function y5(t){let e,n;return e=new Pv({props:{name:t[0],class:t[1],tooltip:t[2],selected:t[3],active:t[4],shorten:t[5],flash:t[6],$$slots:{default:[v5,({selectMode:o,hoverClass:r})=>({13:o,14:r}),({selectMode:o,hoverClass:r})=>(o?8192:0)|(r?16384:0)]},$$scope:{ctx:t}}}),e.$on("tagrange",t[10]),e.$on("tagselect",t[11]),e.$on("tagclick",t[12]),{c(){le(e.$$.fragment)},m(o,r){ae(e,o,r),n=!0},p(o,[r]){let i={};r&1&&(i.name=o[0]),r&2&&(i.class=o[1]),r&4&&(i.tooltip=o[2]),r&8&&(i.selected=o[3]),r&16&&(i.active=o[4]),r&32&&(i.shorten=o[5]),r&64&&(i.flash=o[6]),r&57344&&(i.$$scope={dirty:r,ctx:o}),e.$set(i)},i(o){n||(W(e.$$.fragment,o),n=!0)},o(o){H(e.$$.fragment,o),n=!1},d(o){se(e,o)}}}function w5(t,e,n){let{name:o}=e,{class:r=""}=e,{tooltip:i}=e,{selected:a}=e,{active:s}=e,{shorten:c}=e,{flash:l}=e,u=qe();function d(){u("tagdelete")}let f=b=>{b||d()};function p(b){Oe.call(this,t,b)}function m(b){Oe.call(this,t,b)}let h=()=>u("tagedit");return t.$$set=b=>{"name"in b&&n(0,o=b.name),"class"in b&&n(1,r=b.class),"tooltip"in b&&n(2,i=b.tooltip),"selected"in b&&n(3,a=b.selected),"active"in b&&n(4,s=b.active),"shorten"in b&&n(5,c=b.shorten),"flash"in b&&n(6,l=b.flash)},[o,r,i,a,s,c,l,u,d,f,p,m,h]}var Tu=class extends pe{constructor(e){super(),he(this,e,w5,y5,me,{name:0,class:1,tooltip:2,selected:3,active:4,shorten:5,flash:6})}},Bv=Tu;function _5(t){let e,n,o;return{c(){e=ie("div"),e.innerHTML="<br/>",Q(e,"class","tag-spacer svelte-1k3couf"),Q(e,"role","textbox"),Q(e,"tabindex","-1")},m(r,i){Y(r,e,i),n||(o=_e(e,"click",t[0]),n=!0)},p:ye,i:ye,o:ye,d(r){r&&X(e),n=!1,o()}}}function k5(t){function e(n){Oe.call(this,t,n)}return[e]}var Cu=class extends pe{constructor(e){super(),he(this,e,k5,_5,me,{})}},jv=Cu;function T5(t){let e,n,o,r,i=t[4].default,a=Ne(i,t,t[3],null);return{c(){e=ie("div"),a&&a.c(),Q(e,"tabindex","-1"),Q(e,"class","autocomplete-item svelte-k8iwcm"),de(e,"selected",t[0]),de(e,"active",t[1])},m(s,c){Y(s,e,c),a&&a.m(e,null),t[9](e),n=!0,o||(r=[_e(e,"mousedown",Ct(t[5])),_e(e,"mouseup",t[6]),_e(e,"mouseenter",t[7]),_e(e,"mouseleave",t[8])],o=!0)},p(s,[c]){a&&a.p&&(!n||c&8)&&Fe(a,i,s,s[3],n?Ie(i,s[3],c,null):De(s[3]),null),(!n||c&1)&&de(e,"selected",s[0]),(!n||c&2)&&de(e,"active",s[1])},i(s){n||(W(a,s),n=!0)},o(s){H(a,s),n=!1},d(s){s&&X(e),a&&a.d(s),t[9](null),o=!1,Pe(r)}}}function C5(t,e,n){let{$$slots:o={},$$scope:r}=e,{selected:i=!1}=e,{active:a=!1}=e,s;function c(p){Oe.call(this,t,p)}function l(p){Oe.call(this,t,p)}function u(p){Oe.call(this,t,p)}function d(p){Oe.call(this,t,p)}function f(p){He[p?"unshift":"push"](()=>{s=p,n(2,s)})}return t.$$set=p=>{"selected"in p&&n(0,i=p.selected),"active"in p&&n(1,a=p.active),"$$scope"in p&&n(3,r=p.$$scope)},t.$$.update=()=>{t.$$.dirty&5&&i&&s&&s.scrollIntoViewIfNeeded({behavior:"smooth",block:"start"})},[i,a,s,r,o,c,l,u,d,f]}var Su=class extends pe{constructor(e){super(),he(this,e,C5,T5,me,{selected:0,active:1})}},Eu=Su;var S5=t=>({}),Uv=t=>({createAutocomplete:t[6]});function zv(t,e,n){let o=t.slice();return o[30]=e[n],o[32]=n,o}function E5(t){let e,n,o,r,i,a=t[11].default,s=Ne(a,t,t[20],Uv);return{c(){e=ie("span"),s&&s.c(),Q(e,"class","autocomplete-reference svelte-1bkz961")},m(c,l){Y(c,e,l),s&&s.m(e,null),o=!0,r||(i=Tt(n=t[33].call(null,e)),r=!0)},p(c,l){s&&s.p&&(!o||l[0]&1048576)&&Fe(s,a,c,c[20],o?Ie(a,c[20],l,S5):De(c[20]),Uv)},i(c){o||(W(s,c),o=!0)},o(c){H(s,c),o=!1},d(c){c&&X(e),s&&s.d(c),r=!1,i()}}}function O5(t){let e,n;function o(){return t[16](t[32])}function r(){return t[17](t[32])}function i(...a){return t[18](t[32],...a)}return e=new Eu({props:{$$slots:{default:[R5]},$$scope:{ctx:t}}}),e.$on("mousedown",o),e.$on("mouseup",r),e.$on("mouseenter",i),{c(){le(e.$$.fragment)},m(a,s){ae(e,a,s),n=!0},p(a,s){t=a;let c={};s[0]&1048578&&(c.$$scope={dirty:s,ctx:t}),e.$set(c)},i(a){n||(W(e.$$.fragment,a),n=!0)},o(a){H(e.$$.fragment,a),n=!1},d(a){se(e,a)}}}function A5(t){let e,n;function o(){return t[12](t[32])}function r(){return t[13](t[32])}function i(...a){return t[14](t[32],...a)}return e=new Eu({props:{selected:!0,active:t[3],$$slots:{default:[N5]},$$scope:{ctx:t}}}),e.$on("mousedown",o),e.$on("mouseup",r),e.$on("mouseenter",i),e.$on("mouseleave",t[15]),{c(){le(e.$$.fragment)},m(a,s){ae(e,a,s),n=!0},p(a,s){t=a;let c={};s[0]&8&&(c.active=t[3]),s[0]&1048578&&(c.$$scope={dirty:s,ctx:t}),e.$set(c)},i(a){n||(W(e.$$.fragment,a),n=!0)},o(a){H(e.$$.fragment,a),n=!1},d(a){se(e,a)}}}function R5(t){let e=t[30]+"",n,o;return{c(){n=We(e),o=xe()},m(r,i){Y(r,n,i),Y(r,o,i)},p(r,i){i[0]&2&&e!==(e=r[30]+"")&&Dt(n,e)},d(r){r&&(X(n),X(o))}}}function N5(t){let e=t[30]+"",n,o;return{c(){n=We(e),o=xe()},m(r,i){Y(r,n,i),Y(r,o,i)},p(r,i){i[0]&2&&e!==(e=r[30]+"")&&Dt(n,e)},d(r){r&&(X(n),X(o))}}}function Vv(t){let e,n,o,r,i=[A5,O5],a=[];function s(c,l){return c[32]===c[2]?0:1}return e=s(t,[-1,-1]),n=a[e]=i[e](t),{c(){n.c(),o=Ue()},m(c,l){a[e].m(c,l),Y(c,o,l),r=!0},p(c,l){let u=e;e=s(c,l),e===u?a[e].p(c,l):(Me(),H(a[u],1,1,()=>{a[u]=null}),Le(),n=a[e],n?n.p(c,l):(n=a[e]=i[e](c),n.c()),W(n,1),n.m(o.parentNode,o))},i(c){r||(W(n),r=!0)},o(c){H(n),r=!1},d(c){c&&X(o),a[e].d(c)}}}function I5(t){let e,n,o=Ve(t[1]),r=[];for(let a=0;a<o.length;a+=1)r[a]=Vv(zv(t,o,a));let i=a=>H(r[a],1,1,()=>{r[a]=null});return{c(){e=ie("div");for(let a=0;a<r.length;a+=1)r[a].c();Q(e,"class","autocomplete-menu svelte-1bkz961")},m(a,s){Y(a,e,s);for(let c=0;c<r.length;c+=1)r[c]&&r[c].m(e,null);n=!0},p(a,s){if(s[0]&942){o=Ve(a[1]);let c;for(c=0;c<o.length;c+=1){let l=zv(a,o,c);r[c]?(r[c].p(l,s),W(r[c],1)):(r[c]=Vv(l),r[c].c(),W(r[c],1),r[c].m(e,null))}for(Me(),c=o.length;c<r.length;c+=1)i(c);Le()}},i(a){if(!n){for(let s=0;s<o.length;s+=1)W(r[s]);n=!0}},o(a){r=r.filter(Boolean);for(let s=0;s<r.length;s+=1)H(r[s]);n=!1},d(a){a&&X(e),pt(r,a)}}}function F5(t){let e,n,o;return e=new lo({props:{slot:"floating",$$slots:{default:[I5]},$$scope:{ctx:t}}}),{c(){n=ie("div"),le(e.$$.fragment),ze(n,"display","contents"),ze(n,"--popover-padding-inline","0")},m(r,i){Y(r,n,i),ae(e,n,null),o=!0},p(r,i){let a={};i[0]&1048590&&(a.$$scope={dirty:i,ctx:r}),e.$set(a)},i(r){o||(W(e.$$.fragment,r),o=!0)},o(r){H(e.$$.fragment,r),o=!1},d(r){r&&e&&X(n),se(e,r)}}}function D5(t){let e,n;return e=new ho({props:{keepOnKeyup:!0,show:t[4],preferredPlacement:"top",portalTarget:document.body,$$slots:{floating:[F5],default:[E5,({asReference:o})=>({33:o}),({asReference:o})=>[0,o?4:0]]},$$scope:{ctx:t}}}),e.$on("close",t[19]),{c(){le(e.$$.fragment)},m(o,r){ae(e,o,r),n=!0},p(o,r){let i={};r[0]&16&&(i.show=o[4]),r[0]&1048590&&(i.$$scope={dirty:r,ctx:o}),e.$set(i)},i(o){n||(W(e.$$.fragment,o),n=!0)},o(o){H(e.$$.fragment,o),n=!1},d(o){se(e,o)}}}function M5(t,e,n){let o,r=ye,i=()=>(r(),r=sn(l,I=>n(4,o=I)),l);t.$$.on_destroy.push(()=>r());let{$$slots:a={},$$scope:s}=e,{suggestionsPromise:c}=e,{show:l}=e;i();let u=[],d=null,f=!1,p=qe();function m(){d===null?n(2,d=0):d>=u.length-1?n(2,d=null):n(2,d++,d)}function h(){d===null?n(2,d=u.length-1):d===0?n(2,d=null):n(2,d--,d)}async function b(){p("select",{selected:u[d!=null?d:-1]})}async function x(){m(),await b()}async function y(){h(),await b()}async function M(){n(3,f=!0),p("choose",{chosen:u[d!=null?d:-1]}),await xt(),l.set(!1)}async function E(){await xt(),p("update")}function C(){return d!==null}function j(){return{selectPrevious:y,selectNext:x,chooseSelected:M,update:E,hasSelected:C}}function P(I){n(2,d=I),n(3,f=!0)}function D(I){P(I)}async function N(I){n(3,f=!1),p("select",{selected:u[I]})}function S(I,_){I.buttons===1&&P(_)}let G=I=>D(I),v=I=>{N(I),M()},T=(I,_)=>S(_,I),R=()=>n(3,f=!1),A=I=>D(I),U=I=>{N(I),M()},k=(I,_)=>S(_,I),w=()=>l.set(!1);return t.$$set=I=>{"suggestionsPromise"in I&&n(10,c=I.suggestionsPromise),"show"in I&&i(n(0,l=I.show)),"$$scope"in I&&n(20,s=I.$$scope)},t.$$.update=()=>{t.$$.dirty[0]&1025&&c.then(I=>{l.set(I.length>0),Nn()&&navigator.userAgent.match(/Chrome\/77/)&&(I=I.slice(0,10)),n(1,u=I)})},[l,u,d,f,o,M,j,D,N,S,c,a,G,v,T,R,A,U,k,w,s]}var Ou=class extends pe{constructor(e){super(),he(this,e,M5,D5,me,{suggestionsPromise:10,show:0},null,[-1,-1])}},Wv=Ou;function Hv(t,e,n){let o=t.slice();return o[75]=e[n],o[76]=e,o[77]=n,o}function Gv(t){let e,n,o,r,i,a;return e=new Ot({props:{keyCombination:Kv}}),e.$on("action",t[34]),o=new Ot({props:{keyCombination:Jv}}),o.$on("action",t[35]),i=new Ot({props:{keyCombination:$v}}),i.$on("action",t[36]),{c(){le(e.$$.fragment),n=xe(),le(o.$$.fragment),r=xe(),le(i.$$.fragment)},m(s,c){ae(e,s,c),Y(s,n,c),ae(o,s,c),Y(s,r,c),ae(i,s,c),a=!0},p:ye,i(s){a||(W(e.$$.fragment,s),W(o.$$.fragment,s),W(i.$$.fragment,s),a=!0)},o(s){H(e.$$.fragment,s),H(o.$$.fragment,s),H(i.$$.fragment,s),a=!1},d(s){s&&(X(n),X(r)),se(e,s),se(o,s),se(i,s)}}}function qv(t){let e,n;function o(...r){return t[61](t[77],...r)}return e=new Wv({props:{suggestionsPromise:t[7],show:t[14],$$slots:{default:[L5,({createAutocomplete:r})=>({78:r}),({createAutocomplete:r})=>[0,0,r?65536:0]]},$$scope:{ctx:t}}}),e.$on("update",t[17]),e.$on("select",t[60]),e.$on("choose",o),{c(){le(e.$$.fragment)},m(r,i){ae(e,r,i),n=!0},p(r,i){t=r;let a={};i[0]&128&&(a.suggestionsPromise=t[7]),i[0]&7688|i[2]&196608&&(a.$$scope={dirty:i,ctx:t}),e.$set(a)},i(r){n||(W(e.$$.fragment,r),n=!0)},o(r){H(e.$$.fragment,r),n=!1},d(r){se(e,r)}}}function L5(t){let e,n,o,r;function i(y){t[46](y)}function a(y){t[47](y)}function s(){return t[48](t[75],t[78])}function c(){return t[50](t[75])}function l(...y){return t[51](t[77],...y)}function u(){return t[52](t[77])}function d(){return t[53](t[77])}function f(){return t[55](t[77])}function p(){return t[56](t[77])}function m(){return t[57](t[77])}function h(){return t[58](t[77])}function b(){return t[59](t[75],t[77])}let x={id:t[75].id,class:"position-absolute start-0 top-0 bottom-0 ps-2 py-0",disabled:t[12]};return t[9]!==void 0&&(x.name=t[9]),t[10]!==void 0&&(x.input=t[10]),e=new qx({props:x}),He.push(()=>Qt(e,"name",i)),He.push(()=>Qt(e,"input",a)),e.$on("focus",s),e.$on("keydown",t[29]),e.$on("keyup",t[49]),e.$on("taginput",c),e.$on("tagsplit",l),e.$on("tagadd",u),e.$on("tagdelete",d),e.$on("tagselectall",t[54]),e.$on("tagjoinprevious",f),e.$on("tagjoinnext",p),e.$on("tagmoveprevious",m),e.$on("tagmovenext",h),e.$on("tagaccept",b),{c(){le(e.$$.fragment)},m(y,M){ae(e,y,M),r=!0},p(y,M){t=y;let E={};M[0]&8&&(E.id=t[75].id),M[0]&4096&&(E.disabled=t[12]),!n&&M[0]&512&&(n=!0,E.name=t[9],Yt(()=>n=!1)),!o&&M[0]&1024&&(o=!0,E.input=t[10],Yt(()=>o=!1)),e.$set(E)},i(y){r||(W(e.$$.fragment,y),r=!0)},o(y){H(e.$$.fragment,y),r=!1},d(y){se(e,y)}}}function Xv(t,e){let n,o,r,i,a,s;function c(b){e[40](b,e[75])}function l(b){e[41](b,e[75])}function u(){return e[42](e[77])}function d(){return e[43](e[77])}function f(){return e[44](e[77])}function p(){return e[45](e[77])}let m={class:"ms-0",name:e[77]===e[8]?e[9]:e[75].name,tooltip:e[75].name,active:e[77]===e[8],shorten:e[6]};e[75].flash!==void 0&&(m.flash=e[75].flash),e[75].selected!==void 0&&(m.selected=e[75].selected),o=new Bv({props:m}),He.push(()=>Qt(o,"flash",c)),He.push(()=>Qt(o,"selected",l)),o.$on("tagedit",u),o.$on("tagselect",d),o.$on("tagrange",f),o.$on("tagdelete",p);let h=e[77]===e[8]&&qv(e);return{key:t,first:null,c(){n=ie("div"),le(o.$$.fragment),a=xe(),h&&h.c(),Q(n,"class","tag-relative svelte-1abeqln"),de(n,"hide-tag",e[77]===e[8]),this.first=n},m(b,x){Y(b,n,x),ae(o,n,null),Ce(n,a),h&&h.m(n,null),s=!0},p(b,x){e=b;let y={};x[0]&776&&(y.name=e[77]===e[8]?e[9]:e[75].name),x[0]&8&&(y.tooltip=e[75].name),x[0]&264&&(y.active=e[77]===e[8]),x[0]&64&&(y.shorten=e[6]),!r&&x[0]&8&&(r=!0,y.flash=e[75].flash,Yt(()=>r=!1)),!i&&x[0]&8&&(i=!0,y.selected=e[75].selected,Yt(()=>i=!1)),o.$set(y),e[77]===e[8]?h?(h.p(e,x),x[0]&264&&W(h,1)):(h=qv(e),h.c(),W(h,1),h.m(n,null)):h&&(Me(),H(h,1,1,()=>{h=null}),Le()),(!s||x[0]&264)&&de(n,"hide-tag",e[77]===e[8])},i(b){s||(W(o.$$.fragment,b),W(h),s=!0)},o(b){H(o.$$.fragment,b),H(h),s=!1},d(b){b&&X(n),se(o),h&&h.d()}}}function P5(t){let e,n,o,r,i,a,s=[],c=new Map,l,u,d,f,p,m,h=t[13]&&Gv(t);function b(E){t[39](E)}let x={tagsSelected:t[13],keyCombination:t[1]};t[5]!==void 0&&(x.badgeHeight=t[5]),o=new Lc({props:x}),He.push(()=>Qt(o,"badgeHeight",b)),o.$on("tagselectall",t[34]),o.$on("tagcopy",t[35]),o.$on("tagdelete",t[36]),o.$on("tagappend",t[2]);let y=Ve(t[3]),M=E=>E[75].id;for(let E=0;E<y.length;E+=1){let C=Hv(t,y,E),j=M(C);c.set(j,s[E]=Xv(j,C))}return u=new jv({}),u.$on("click",t[2]),{c(){h&&h.c(),e=xe(),n=ie("div"),r=ie("div"),le(o.$$.fragment),a=xe();for(let E=0;E<s.length;E+=1)s[E].c();l=xe(),le(u.$$.fragment),ze(r,"display","contents"),ze(r,"--icon-align","baseline"),Q(n,"class","tag-editor svelte-1abeqln"),Mt(()=>t[62].call(n))},m(E,C){h&&h.m(E,C),Y(E,e,C),Y(E,n,C),Ce(n,r),ae(o,r,null),Ce(n,a);for(let j=0;j<s.length;j+=1)s[j]&&s[j].m(n,null);Ce(n,l),ae(u,n,null),d=Lr(n,t[62].bind(n)),f=!0,p||(m=_e(n,"focusout",t[33]),p=!0)},p(E,C){E[13]?h?(h.p(E,C),C[0]&8192&&W(h,1)):(h=Gv(E),h.c(),W(h,1),h.m(e.parentNode,e)):h&&(Me(),H(h,1,1,()=>{h=null}),Le());let j={};C[0]&8192&&(j.tagsSelected=E[13]),C[0]&2&&(j.keyCombination=E[1]),!i&&C[0]&32&&(i=!0,j.badgeHeight=E[5],Yt(()=>i=!1)),o.$set(j),C[0]&2147475400|C[1]&11|C[2]&65536&&(y=Ve(E[3]),Me(),s=Tp(s,C,M,1,E,y,c,n,kp,Xv,l,Hv),Le())},i(E){if(!f){W(h),W(o.$$.fragment,E);for(let C=0;C<y.length;C+=1)W(s[C]);W(u.$$.fragment,E),f=!0}},o(E){H(h),H(o.$$.fragment,E);for(let C=0;C<s.length;C+=1)H(s[C]);H(u.$$.fragment,E),f=!1},d(E){E&&(X(e),X(n)),h&&h.d(E),se(o);for(let C=0;C<s.length;C+=1)s[C].d();se(u),d(),p=!1,m()}}}var Kv="Control+A",Jv="Control+C",$v="Backspace",Yv=/^:?([^:].*?[^:]):?$/;function Qv(t){return t===0}function B5(t,e,n){let o,r,i,a,s,c=ye,l=()=>(c(),c=sn(u,J=>n(38,s=J)),u);t.$$.on_destroy.push(()=>c());let{tags:u}=e;l();let{keyCombination:d="Control+Shift+T"}=e;Mo(so,{selectAllShortcut:Kv,copyShortcut:Jv,removeShortcut:$v});let f;function p(J){n(3,f=J.map(be=>Va(oi(be))))}let m=at(!1);ot(t,m,J=>n(66,a=J));let h=qe(),b=Promise.resolve([]),x=b;function y(){let J=f.map(be=>be.name).map(go);h("tagsupdate",{tags:J}),n(7,x=b)}let M=null,E=null,C="",j,P,D=!1;async function N(J){let{tags:be}=await up({input:J,matchLimit:500});return be}function S(){let be=f[M].name;if(n(12,D=be.length===0),D)n(7,x=b);else{let ut=go(be),nn=Yv.test(ut)?ut.replace(Yv,"$1"):ut;n(7,x=N(nn).then(rn=>(n(12,D=rn.length===0),rn.map(oi))))}}function G(J){let be=f[M];n(9,C=J!=null?J:be.name);let ut=j.value.length;j.setSelectionRange(ut,ut)}async function v(J){J.name=C,n(3,f),await xt(),j&&P.update()}function T(J){E===null&&(E=J)}function R(){ce();let J=f[f.length-1];(!J||J.name.length>0)&&A(f.length-1,"");let be=M===null;n(8,M=null),be&&B()}function A(J,be){f.splice(J+1,0,Va(be)),n(3,f),T(J+1)}function U(J){let be=f.map(Gx);be.splice(J,1);let ut=be.indexOf(C);return ut>=0?(f[ut>=J?ut+1:ut].flash(),!1):!0}async function k(J,be,ut){let nn=C.slice(0,be),rn=C.slice(ut);n(9,C=nn),await xt(),A(J,rn),n(8,M=null),await xt(),J!==M&&j.setSelectionRange(0,0)}function w(J){U(J)&&(f.splice(J,0,Va(C)),n(8,M++,M),n(3,f))}function I(J){let be=f.splice(J,1)[0];return n(3,f),E!==null&&E>J&&E--,be}function _(J){return J===f.length-1}function F(J){if(Qv(J))return;let be=I(J-1);n(9,C=be.name+C),n(8,M--,M),v(f[M])}function z(J){if(_(J))return;let be=I(J+1);n(9,C=C+be.name),v(f[M])}function q(J){Qv(J)||(E=J-1,n(8,M=null),j.blur())}async function ee(J){if(_(J)){C.length!==0&&(A(J,""),n(8,M=null));return}E=J+1,n(8,M=null),j.blur(),await xt(),j.setSelectionRange(0,0)}function O(J,be){f.includes(J)&&(U(be)||I(be))}function B(){n(8,M=E),E=null}function V(J){if(eb(J)){P.selectPrevious(),J.preventDefault();return}else if(tb(J)){P.selectNext(),J.preventDefault();return}switch(J.code){case"Tab":if(a)J.shiftKey?P.selectPrevious():P.selectNext();else break;J.preventDefault();break;case"Enter":P.chooseSelected(),J.preventDefault();break}}let $=null,te=null;function L(J){n(3,f[J].selected=!f[J].selected,f),n(3,f),$=J}function Z(J){if($===null){L(J);return}te=J;let be=Math.min($,te),ut=Math.max($,te);for(let nn=be;nn<=ut;nn++)n(3,f[nn].selected=!0,f);n(3,f)}function ce(){n(3,f=f.map(J=>({...J,selected:!1}))),$=null,te=null}function ke(J){let be=J.currentTarget;(J.relatedTarget===null||!be.contains(J.relatedTarget))&&ce()}function ve(J){let be=document.createElement("textarea");be.value=J,be.setAttribute("readonly",""),be.style.position="absolute",be.style.left="-9999px",document.body.appendChild(be),be.select(),za("copy"),document.body.removeChild(be)}function re(){for(let J of f)J.selected=!0;n(3,f)}function we(){let J=f.filter(be=>be.selected).map(be=>go(be.name)).join(`
`);ve(J),ce()}function Te(){f.map((J,be)=>[J.selected,be]).filter(([J])=>J).reverse().forEach(([,J])=>I(J)),ce(),y()}let Ae,je;function Re(J){je=J,n(5,je)}function et(J,be){t.$$.not_equal(be.flash,J)&&(be.flash=J,n(3,f))}function Ge(J,be){t.$$.not_equal(be.selected,J)&&(be.selected=J,n(3,f))}let _t=J=>{n(8,M=J),ce()},kt=J=>L(J),ct=J=>Z(J),Ln=J=>{ce(),I(J),y()};function xn(J){C=J,n(9,C)}function tn(J){j=J,n(10,j)}let Er=(J,be)=>{h("tagsFocused"),n(9,C=J.name),n(11,P=be())},Or=()=>{C.length===0&&(m==null||m.set(!1))},Ja=J=>v(J),$a=(J,{detail:be})=>k(J,be.start,be.end),Pn=J=>w(J),Za=J=>I(J),es=async()=>{f.length<=1||(j.blur(),await xt(),re())},di=J=>F(J),fi=J=>z(J),ts=J=>q(J),ns=J=>ee(J),pi=(J,be)=>{O(J,be),J&&v(J),y(),B()},rs=({detail:J})=>G(J.selected),mi=(J,{detail:be})=>{G(be.chosen),k(J,be.chosen.length,be.chosen.length)};function os(){Ae=this.offsetHeight,n(4,Ae)}return t.$$set=J=>{"tags"in J&&l(n(0,u=J.tags)),"keyCombination"in J&&n(1,d=J.keyCombination)},t.$$.update=()=>{t.$$.dirty[1]&128&&p(s),t.$$.dirty[0]&48&&n(37,o=Math.floor(Ae/je)),t.$$.dirty[0]&64|t.$$.dirty[1]&64&&n(6,r=r||o>2),t.$$.dirty[0]&8&&n(13,i=f.some(J=>J.selected))},[u,d,R,f,Ae,je,r,x,M,C,j,P,D,i,m,h,y,S,G,v,k,w,I,F,z,q,ee,O,B,V,L,Z,ce,ke,re,we,Te,o,s,Re,et,Ge,_t,kt,ct,Ln,xn,tn,Er,Or,Ja,$a,Pn,Za,es,di,fi,ts,ns,pi,rs,mi,os]}var Au=class extends pe{constructor(e){super(),he(this,e,B5,P5,me,{tags:0,keyCombination:1,appendEmptyTag:2},null,[-1,-1,-1])}get appendEmptyTag(){return this.$$.ctx[2]}},Zv=Au;function j5(t){let e,n;return e=new Zv({props:{tags:t[0],keyCombination:"Control+T"}}),e.$on("tagsupdate",t[2]),{c(){le(e.$$.fragment)},m(o,r){ae(e,o,r),n=!0},p(o,r){let i={};r&1&&(i.tags=o[0]),e.$set(i)},i(o){n||(W(e.$$.fragment,o),n=!0)},o(o){H(e.$$.fragment,o),n=!1},d(o){se(e,o)}}}function U5(t){let e,n,o,r;return e=new $o({props:{$$slots:{default:[j5]},$$scope:{ctx:t}}}),{c(){n=ie("div"),le(e.$$.fragment),ze(n,"display","contents"),ze(n,"--cols",o=1)},m(i,a){Y(i,n,a),ae(e,n,null),r=!0},p(i,[a]){let s={};a&11&&(s.$$scope={dirty:a,ctx:i}),e.$set(s)},i(i){r||(W(e.$$.fragment,i),r=!0)},o(i){H(e.$$.fragment,i),r=!1},d(i){i&&e&&X(n),se(e,i)}}}function z5(t,e,n){let{tagsWritable:o}=e,r,i=({detail:a})=>{n(1,r=a.tags),o.set(r)};return t.$$set=a=>{"tagsWritable"in a&&n(0,o=a.tagsWritable)},[o,r,i]}var Ru=class extends pe{constructor(e){super(),he(this,e,z5,U5,me,{tagsWritable:0})}},ey=Ru;function ty(t,e,n){let o=t.slice();return o[4]=e[n],o[5]=e,o[6]=n,o}function V5(t){let e=t[4].title+"",n;return{c(){n=We(e)},m(o,r){Y(o,n,r)},p(o,r){r&1&&e!==(e=o[4].title+"")&&Dt(n,e)},d(o){o&&X(n)}}}function W5(t){let e,n,o,r;return e=new Tx({props:{$$slots:{default:[V5]},$$scope:{ctx:t}}}),{c(){n=ie("div"),le(e.$$.fragment),ze(n,"display","contents"),ze(n,"--col-size",o=1)},m(i,a){Y(i,n,a),ae(e,n,null),r=!0},p(i,a){let s={};a&129&&(s.$$scope={dirty:a,ctx:i}),e.$set(s)},i(i){r||(W(e.$$.fragment,i),r=!0)},o(i){H(e.$$.fragment,i),r=!1},d(i){i&&e&&X(n),se(e,i)}}}function H5(t){let e,n,o,r,i,a,s,c;function l(){t[1].call(n,t[5],t[6])}function u(){return t[2](t[4],t[5],t[6])}function d(){t[3].call(i,t[5],t[6])}return{c(){e=ie("div"),n=ie("div"),r=xe(),i=ie("textarea"),Q(n,"id",o=t[4].id+"--div"),Q(n,"class","text-editor svelte-15uw96v"),Q(n,"contenteditable",""),t[4].divValue===void 0&&Mt(l),Q(i,"id",a=t[4].id+"--textarea"),Q(i,"class","text-area svelte-15uw96v"),Q(e,"id","note-container"),Q(e,"class","svelte-15uw96v")},m(f,p){Y(f,e,p),Ce(e,n),t[4].divValue!==void 0&&(n.innerHTML=t[4].divValue),Ce(e,r),Ce(e,i),Mr(i,t[4].textareaValue),s||(c=[_e(n,"input",l),_e(n,"input",u),_e(i,"input",d)],s=!0)},p(f,p){t=f,p&1&&o!==(o=t[4].id+"--div")&&Q(n,"id",o),p&1&&t[4].divValue!==n.innerHTML&&(n.innerHTML=t[4].divValue),p&1&&a!==(a=t[4].id+"--textarea")&&Q(i,"id",a),p&1&&Mr(i,t[4].textareaValue)},d(f){f&&X(e),s=!1,Pe(c)}}}function ny(t){let e,n,o,r,i,a,s,c;return e=new $o({props:{$$slots:{default:[W5]},$$scope:{ctx:t}}}),i=new $o({props:{$$slots:{default:[H5]},$$scope:{ctx:t}}}),{c(){n=ie("div"),le(e.$$.fragment),r=xe(),a=ie("div"),le(i.$$.fragment),ze(n,"display","contents"),ze(n,"--cols",o=1),ze(a,"display","contents"),ze(a,"--cols",s=1)},m(l,u){Y(l,n,u),ae(e,n,null),Y(l,r,u),Y(l,a,u),ae(i,a,null),c=!0},p(l,u){let d={};u&129&&(d.$$scope={dirty:u,ctx:l}),e.$set(d);let f={};u&129&&(f.$$scope={dirty:u,ctx:l}),i.$set(f)},i(l){c||(W(e.$$.fragment,l),W(i.$$.fragment,l),c=!0)},o(l){H(e.$$.fragment,l),H(i.$$.fragment,l),c=!1},d(l){l&&X(r),l&&e&&X(n),se(e,l),l&&i&&X(a),se(i,l)}}}function G5(t){let e,n,o,r,i,a,s;n=new Hx({});let c=Ve(t[0]),l=[];for(let d=0;d<c.length;d+=1)l[d]=ny(ty(t,c,d));let u=d=>H(l[d],1,1,()=>{l[d]=null});return a=new ey({props:{tagsWritable:mr}}),{c(){e=ie("div"),le(n.$$.fragment),o=xe();for(let d=0;d<l.length;d+=1)l[d].c();r=xe(),i=ie("div"),le(a.$$.fragment),Q(e,"class","note-toolbar svelte-15uw96v"),ze(i,"margin-top","10px"),Q(i,"class","svelte-15uw96v")},m(d,f){Y(d,e,f),ae(n,e,null),Y(d,o,f);for(let p=0;p<l.length;p+=1)l[p]&&l[p].m(d,f);Y(d,r,f),Y(d,i,f),ae(a,i,null),s=!0},p(d,[f]){if(f&1){c=Ve(d[0]);let p;for(p=0;p<c.length;p+=1){let m=ty(d,c,p);l[p]?(l[p].p(m,f),W(l[p],1)):(l[p]=ny(m),l[p].c(),W(l[p],1),l[p].m(r.parentNode,r))}for(Me(),p=c.length;p<l.length;p+=1)u(p);Le()}},i(d){if(!s){W(n.$$.fragment,d);for(let f=0;f<c.length;f+=1)W(l[f]);W(a.$$.fragment,d),s=!0}},o(d){H(n.$$.fragment,d),l=l.filter(Boolean);for(let f=0;f<l.length;f+=1)H(l[f]);H(a.$$.fragment,d),s=!1},d(d){d&&(X(e),X(o),X(r),X(i)),se(n),pt(l,d),se(a)}}}function q5(t,e,n){let o=[{id:"header",title:Dd(),divValue:"",textareaValue:""},{id:"back-extra",title:Nd(),divValue:"",textareaValue:""}];function r(s,c){s[c].divValue=this.innerHTML,n(0,o)}let i=(s,c,l)=>{n(0,c[l].textareaValue=s.divValue,o)};function a(s,c){s[c].textareaValue=this.value,n(0,o)}return t.$$.update=()=>{t.$$.dirty&1&&to.set(o)},[o,r,i,a]}var Nu=class extends pe{constructor(e){super(),he(this,e,q5,G5,me,{})}},ry=Nu;function X5(t){let e,n,o,r=t[8].default,i=Ne(r,t,t[7],null);return{c(){e=ie("div"),i&&i.c(),Q(e,"id",t[0]),Q(e,"class",n="button-group btn-group "+t[1]+" svelte-svn7mu"),Q(e,"style",t[2]),Q(e,"dir","ltr"),Q(e,"role","group")},m(a,s){Y(a,e,s),i&&i.m(e,null),o=!0},p(a,[s]){i&&i.p&&(!o||s&128)&&Fe(i,r,a,a[7],o?Ie(r,a[7],s,null):De(a[7]),null),(!o||s&1)&&Q(e,"id",a[0]),(!o||s&2&&n!==(n="button-group btn-group "+a[1]+" svelte-svn7mu"))&&Q(e,"class",n),(!o||s&4)&&Q(e,"style",a[2])},i(a){o||(W(i,a),o=!0)},o(a){H(i,a),o=!1},d(a){a&&X(e),i&&i.d(a)}}}function Y5(t,e,n){let o,r,{$$slots:i={},$$scope:a}=e,{id:s=void 0}=e,{class:c=""}=e,{size:l=void 0}=e,{wrap:u=void 0}=e,d;return t.$$set=f=>{"id"in f&&n(0,s=f.id),"class"in f&&n(1,c=f.class),"size"in f&&n(3,l=f.size),"wrap"in f&&n(4,u=f.wrap),"$$scope"in f&&n(7,a=f.$$scope)},t.$$.update=()=>{t.$$.dirty&8&&n(6,o=l?`--buttons-size: ${l}rem; `:""),t.$$.dirty&16&&(u===void 0?n(5,d=""):n(5,d=u?"--buttons-wrap: wrap; ":"--buttons-wrap: nowrap; ")),t.$$.dirty&96&&n(2,r=o+d)},[s,c,r,l,u,d,o,a,i]}var Iu=class extends pe{constructor(e){super(),he(this,e,Y5,X5,me,{id:0,class:1,size:3,wrap:4})}},oy=Iu;function Q5(t){let e,n,o,r,i,a,s=t[10].default,c=Ne(s,t,t[9],null);return{c(){e=ie("button"),c&&c.c(),Q(e,"id",t[0]),Q(e,"class",n="label-button "+t[1]+" svelte-gv0fwz"),Q(e,"title",t[3]),e.disabled=t[5],Q(e,"tabindex",o=t[6]?0:-1),de(e,"active",t[4]),de(e,"primary",t[2]),de(e,"ellipsis",t[7])},m(l,u){Y(l,e,u),c&&c.m(e,null),t[13](e),r=!0,i||(a=[_e(e,"click",t[11]),_e(e,"mousedown",Ct(t[12]))],i=!0)},p(l,[u]){c&&c.p&&(!r||u&512)&&Fe(c,s,l,l[9],r?Ie(s,l[9],u,null):De(l[9]),null),(!r||u&1)&&Q(e,"id",l[0]),(!r||u&2&&n!==(n="label-button "+l[1]+" svelte-gv0fwz"))&&Q(e,"class",n),(!r||u&8)&&Q(e,"title",l[3]),(!r||u&32)&&(e.disabled=l[5]),(!r||u&64&&o!==(o=l[6]?0:-1))&&Q(e,"tabindex",o),(!r||u&18)&&de(e,"active",l[4]),(!r||u&6)&&de(e,"primary",l[2]),(!r||u&130)&&de(e,"ellipsis",l[7])},i(l){r||(W(c,l),r=!0)},o(l){H(c,l),r=!1},d(l){l&&X(e),c&&c.d(l),t[13](null),i=!1,Pe(a)}}}function K5(t,e,n){let{$$slots:o={},$$scope:r}=e,{id:i=void 0}=e,{class:a=""}=e,{primary:s=!1}=e,{tooltip:c=void 0}=e,{active:l=!1}=e,{disabled:u=!1}=e,{tabbable:d=!1}=e,{ellipsis:f=!1}=e,p,m=qe();mt(()=>m("mount",{button:p}));function h(y){Oe.call(this,t,y)}function b(y){Oe.call(this,t,y)}function x(y){He[y?"unshift":"push"](()=>{p=y,n(8,p)})}return t.$$set=y=>{"id"in y&&n(0,i=y.id),"class"in y&&n(1,a=y.class),"primary"in y&&n(2,s=y.primary),"tooltip"in y&&n(3,c=y.tooltip),"active"in y&&n(4,l=y.active),"disabled"in y&&n(5,u=y.disabled),"tabbable"in y&&n(6,d=y.tabbable),"ellipsis"in y&&n(7,f=y.ellipsis),"$$scope"in y&&n(9,r=y.$$scope)},[i,a,s,c,l,u,d,f,p,r,o,h,b,x]}var Fu=class extends pe{constructor(e){super(),he(this,e,K5,Q5,me,{id:0,class:1,primary:2,tooltip:3,active:4,disabled:5,tabbable:6,ellipsis:7})}},iy=Fu;function J5(t){let e=(t[0].kind==="add"?ss():cs())+"",n;return{c(){n=We(e)},m(o,r){Y(o,n,r)},p(o,r){r&1&&e!==(e=(o[0].kind==="add"?ss():cs())+"")&&Dt(n,e)},d(o){o&&X(n)}}}function $5(t){let e,n,o;return e=new iy({props:{class:" bottom-btn",$$slots:{default:[J5]},$$scope:{ctx:t}}}),e.$on("click",function(){Ft(t[1])&&t[1].apply(this,arguments)}),{c(){n=ie("div"),le(e.$$.fragment),ze(n,"display","contents"),ze(n,"--border-left-radius","5px"),ze(n,"--border-right-radius","5px")},m(r,i){Y(r,n,i),ae(e,n,null),o=!0},p(r,i){t=r;let a={};i&5&&(a.$$scope={dirty:i,ctx:t}),e.$set(a)},i(r){o||(W(e.$$.fragment,r),o=!0)},o(r){H(e.$$.fragment,r),o=!1},d(r){r&&e&&X(n),se(e,r)}}}function Z5(t){let e,n,o,r,i;return r=new oy({props:{size:2,$$slots:{default:[$5]},$$scope:{ctx:t}}}),{c(){e=ie("div"),n=xe(),o=ie("div"),le(r.$$.fragment),ze(e,"flex-grow","1"),Q(o,"class","sticky-footer svelte-644rdf")},m(a,s){Y(a,e,s),Y(a,n,s),Y(a,o,s),ae(r,o,null),i=!0},p(a,[s]){let c={};s&7&&(c.$$scope={dirty:s,ctx:a}),r.$set(c)},i(a){i||(W(r.$$.fragment,a),i=!0)},o(a){H(r.$$.fragment,a),i=!1},d(a){a&&(X(e),X(n),X(o)),se(r)}}}function eO(t,e,n){let{mode:o}=e,{addNote:r}=e;return t.$$set=i=>{"mode"in i&&n(0,o=i.mode),"addNote"in i&&n(1,r=i.addNote)},[o,r]}var Du=class extends pe{constructor(e){super(),he(this,e,eO,Z5,me,{mode:0,addNote:1})}},ay=Du;function sy(t,e,n){let o=t.slice();return o[9]=e[n],o}function ly(t){let e,n=t[9].label+"",o,r,i,a,s;function c(){return t[5](t[9])}return{c(){e=ie("button"),o=We(n),r=xe(),Q(e,"class",i="tab-item "+(t[1]===t[9].value?"active":"")+" "+(t[9].value===1?"left-border-radius":"right-border-radius")+" svelte-1kszhh")},m(l,u){Y(l,e,u),Ce(e,o),Ce(e,r),a||(s=_e(e,"click",c),a=!0)},p(l,u){t=l,u&2&&i!==(i="tab-item "+(t[1]===t[9].value?"active":"")+" "+(t[9].value===1?"left-border-radius":"right-border-radius")+" svelte-1kszhh")&&Q(e,"class",i)},d(l){l&&X(e),a=!1,s()}}}function tO(t){let e,n,o,r,i,a,s,c,l,u,d,f,p=Ve(t[3]),m=[];for(let h=0;h<p.length;h+=1)m[h]=ly(sy(t,p,h));return r=new kx({props:{mode:t[0]}}),r.$on("change",t[6]),r.$on("image-loaded",t[7]),c=new ry({}),d=new ay({props:{mode:t[0],addNote:t[2]}}),{c(){e=ie("div");for(let h=0;h<m.length;h+=1)m[h].c();n=xe(),o=ie("div"),le(r.$$.fragment),a=xe(),s=ie("div"),le(c.$$.fragment),u=xe(),le(d.$$.fragment),Q(e,"class","tab-buttons svelte-1kszhh"),o.hidden=i=t[1]!=1,s.hidden=l=t[1]!=2},m(h,b){Y(h,e,b);for(let x=0;x<m.length;x+=1)m[x]&&m[x].m(e,null);Y(h,n,b),Y(h,o,b),ae(r,o,null),Y(h,a,b),Y(h,s,b),ae(c,s,null),Y(h,u,b),ae(d,h,b),f=!0},p(h,b){if(b&26){p=Ve(h[3]);let M;for(M=0;M<p.length;M+=1){let E=sy(h,p,M);m[M]?m[M].p(E,b):(m[M]=ly(E),m[M].c(),m[M].m(e,null))}for(;M<m.length;M+=1)m[M].d(1);m.length=p.length}let x={};b&1&&(x.mode=h[0]),r.$set(x),(!f||b&2&&i!==(i=h[1]!=1))&&(o.hidden=i),(!f||b&2&&l!==(l=h[1]!=2))&&(s.hidden=l);let y={};b&1&&(y.mode=h[0]),d.$set(y)},i(h){f||(W(r.$$.fragment,h),W(c.$$.fragment,h),W(d.$$.fragment,h),f=!0)},o(h){H(r.$$.fragment,h),H(c.$$.fragment,h),H(d.$$.fragment,h),f=!1},d(h){h&&(X(e),X(n),X(o),X(a),X(s),X(u)),pt(m,h),se(r),se(c),se(d,h)}}}function nO(t){let e,n;return e=new Sp({props:{class:"image-occlusion",$$slots:{default:[tO]},$$scope:{ctx:t}}}),{c(){le(e.$$.fragment)},m(o,r){ae(e,o,r),n=!0},p(o,[r]){let i={};r&4099&&(i.$$scope={dirty:r,ctx:o}),e.$set(i)},i(o){n||(W(e.$$.fragment,o),n=!0)},o(o){H(e.$$.fragment,o),n=!1},d(o){se(e,o)}}}function rO(t,e,n){let o;ot(t,Bo,f=>n(8,o=f));let{mode:r}=e;async function i(){Nh(r,o)}let a=[{label:Pd(),value:1},{label:Bd(),value:2}],s=1,c=f=>{hr.set(f===2),n(1,s=f)},l=f=>c(f.value);function u(f){Oe.call(this,t,f)}function d(f){Oe.call(this,t,f)}return t.$$set=f=>{"mode"in f&&n(0,r=f.mode)},[r,s,i,a,c,l,u,d]}var Mu=class extends pe{constructor(e){super(),he(this,e,rO,nO,me,{mode:0})}},cy=Mu;var oO=dp({modules:[Ee.IMPORTING,Ee.DECKS,Ee.EDITING,Ee.NOTETYPES,Ee.ACTIONS,Ee.BROWSING,Ee.UNDO]});async function Lu(t,e=document.body){return fp(),await oO,new cy({target:e,props:{mode:t}})}if(window.location.hash.startsWith("#test-")){let t=window.location.hash.replace("#test-","");Lu({kind:"add",imagePath:t,notetypeId:0})}if(window.location.hash.startsWith("#testforedit-")){let t=parseInt(window.location.hash.replace("#testforedit-",""));Lu({kind:"edit",noteId:t})}return $u(iO);})();
/*! Bundled license information:

fabric/dist/fabric.js:
  (*! Fabric.js Copyright 2008-2015, Printio (Juriy Zaytsev, Maxim Chernyak) *)

bootstrap/js/dist/dom/data.js:
  (*!
    * Bootstrap data.js v5.3.2 (https://getbootstrap.com/)
    * Copyright 2011-2023 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
    * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
    *)

bootstrap/js/dist/util/index.js:
  (*!
    * Bootstrap index.js v5.3.2 (https://getbootstrap.com/)
    * Copyright 2011-2023 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
    * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
    *)

bootstrap/js/dist/dom/event-handler.js:
  (*!
    * Bootstrap event-handler.js v5.3.2 (https://getbootstrap.com/)
    * Copyright 2011-2023 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
    * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
    *)

bootstrap/js/dist/dom/manipulator.js:
  (*!
    * Bootstrap manipulator.js v5.3.2 (https://getbootstrap.com/)
    * Copyright 2011-2023 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
    * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
    *)

bootstrap/js/dist/util/config.js:
  (*!
    * Bootstrap config.js v5.3.2 (https://getbootstrap.com/)
    * Copyright 2011-2023 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
    * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
    *)

bootstrap/js/dist/base-component.js:
  (*!
    * Bootstrap base-component.js v5.3.2 (https://getbootstrap.com/)
    * Copyright 2011-2023 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
    * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
    *)

bootstrap/js/dist/util/sanitizer.js:
  (*!
    * Bootstrap sanitizer.js v5.3.2 (https://getbootstrap.com/)
    * Copyright 2011-2023 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
    * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
    *)

bootstrap/js/dist/dom/selector-engine.js:
  (*!
    * Bootstrap selector-engine.js v5.3.2 (https://getbootstrap.com/)
    * Copyright 2011-2023 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
    * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
    *)

bootstrap/js/dist/util/template-factory.js:
  (*!
    * Bootstrap template-factory.js v5.3.2 (https://getbootstrap.com/)
    * Copyright 2011-2023 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
    * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
    *)

bootstrap/js/dist/tooltip.js:
  (*!
    * Bootstrap tooltip.js v5.3.2 (https://getbootstrap.com/)
    * Copyright 2011-2023 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
    * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
    *)

lodash-es/lodash.js:
  (**
   * @license
   * Lodash (Custom Build) <https://lodash.com/>
   * Build: `lodash modularize exports="es" -o ./`
   * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
   * Released under MIT license <https://lodash.com/license>
   * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
   * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
   *)
*/
